{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Welcome to MkDocs"},{"location":"#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"000_todolist/","text":"","title":"000 todolist"},{"location":"bookmark/","text":"\u751f\u7269\u4fe1\u606f\u6587\u4ef6\u5939: https://pzweuj.github.io/ https://yantinger.com/ https://www.bioinfo-scrounger.com/ https://life2cloud.com/cn/","title":"Bookmark"},{"location":"zzzzz/","text":"20200204 20200120 FilterMutectCalls: + technical artifacts + non-somatic + sequencing error strandQ is the phred-scaled posterior quality of an artifact. In this case a strandQ of 83 means FilterMutectCalls thinks there's a 1 in 10^8.3 chance of a strand artifact. 20200118 benchmark: https://github.com/chapmanb/bcbio-nextgen/tree/master/config/examples The DREAM challenge has synthetically generated tumor/normal truth sets for somatic variations. We typically use the synthetic 3 and synthetic 4 datasets for validation. synthetic 3 is publicly available and synthetic 4 requires access. Both have truth sets (https://www.synapse.org/#!Synapse:syn2177211). A mixture of two Genome in a Bottle samples, NA12878 and NA24385, with variations at 30% and 15% allele frequency. There are also other deeply sequenced and characterized real tumor datasets that require access permissions: Chronic lymphocytic leukaemia and medulloblastoma from ICGC: http://www.nature.com/articles/ncomms10001 AML from WashU (http://aml31.genome.wustl.edu/) have higher rates of C>A (oxidative damage) and C>T (deamination) errors in tumor data 20200107 filter_file7[\"site_tmp\"].isin(hotsites) filter_file7[\"site_tmp\"].apply(lambda x: any([ i in x for i in hotsites])) 20200106 \u56e0\u4e3aVEP\u5bf9\u6bcf\u4e2a\u8f6c\u7eff\u672c\u5355\u72ec\u8fdb\u884c\u6ce8\u91ca\uff0c\u6240\u4ee5\u5728\u7edf\u8ba1\u65f6\uff0c\u4efb\u4e00\u8f6c\u5f55\u672c\u8ba4\u4e3a\u6709\u5bb3\u5373\u8ba4\u4e3a\u8be5\u4f4d\u70b9\u6709\u5bb3\u3002 rs2coordinates library(biomaRt) grch37_snp = useMart(biomart=\"ENSEMBL_MART_SNP\", host=\"grch37.ensembl.org\", path=\"/biomart/martservice\", dataset=\"hsapiens_snp\") #snp_ids = c(\"rs1149222\", \"rs4148808\") snp_ids = read.csv(\"/local_data1/work/zhangbo/tmp/0522/rs2coordinates2.txt\", header = T, sep = \"\\t\") snp_attributes = c(\"refsnp_id\", \"chr_name\", \"chrom_start\") #'ensembl_gene_stable_id' snp_locations = getBM(attributes=snp_attributes, filters=\"snp_filter\", values=snp_ids$Location, mart=grch37_snp) final_o = merge(snp_locations, snp_ids, by.y = \"Location\", by.x = \"refsnp_id\", all.x = TRUE) write.table(final_o, \"final_o.xls\", sep = \"\\t\", quote = F, row.names = F) 20191230 the default TLOD filtration cutoff is 6.3:This roughly corresponds to a prior probability of 10^(-6.3) of somatic variants at any given site, which is about right for many tumors. Note however that this argument is obsolete as of GATK 4.1.1. 20191213 shell \u83b7\u53d6\u53cd\u5411\u4e92\u8865\u5e8f\u5217 [zhangbo@mu01 heyueqing_PW59-1]$ echo 'GTACATGTCA' |rev|tr \"ATCG\" \"TAGC\" 20191206 F1-Measure: $$F_{A} = $$ \u5176\u4e2d\u662f\u53c2\u6570\uff0cP\u662f\u7cbe\u786e\u7387(Precision)\uff0cR\u662f\u53ec\u56de\u7387(Recall)\u3002 [1] \u5f53\u53c2\u6570=1\u65f6\uff0c\u5c31\u662f\u6700\u5e38\u89c1\u7684F1-Measure\u4e86\uff1a F1=2*RP/(R+P) http://genome.ucsc.edu/cgi-bin/das/hg38/dna?segment=chr1:186318317,186318337 [zhangbo@mu01 fusioncatcher]$ $bedtools getfasta -s -fi $hsa_ref -bed tmp.bedplus -fo tmp.faplus [zhangbo@mu01 fusioncatcher]$ cat tmp.faplus >chr1:186318317-186318337(+) ACTCTGTCTCAAAAAAAAAA 20191201 Targeted method: In the targeted fusion detection method, panel primers are designed to target specific exon-exon junctions of fusions where the driver gene, the partner gene, and the breakpoint between the driver and the partner gene are known. The sequencing reads are mapped to a reference file that contains only the known gene fusions. Non\u2011targeted method: In the non-targeted fusion detection method, the panel primers are used to detect fusions between novel combinations of known diver and partner genes. The sequencing reads are mapped to a broader reference, such as the whole\u2011exome. Mapping the reads to a broader reference allows for the detection of multiple configurations of driver and partner genes as well as detection of novel breakpoints between the known partner and driver genes. https://ionreporter.thermofisher.com/ionreporter/help/GUID-F6403251-CB0F-4955-9C2F-637E7C535387.html https://ionreporter.thermofisher.com/ionreporter/help/GUID-759AEE0F-3542-4774-AC5E-E630E2A4B1FB.html \u9ad8\u7ea7\u5206\u6790 http://www.feiaituan.com/?p=1289 20191128 cosmic fusion \u6570\u636e\u5e93\u4ecb\u7ecd \u5b98\u7f51\u5730\u5740\uff1a + https://cancer.sanger.ac.uk/cosmic/fusion \u5185\u5bb9\u63cf\u8ff0\uff1a + https://cancer.sanger.ac.uk/cosmic/help/fusion/summary#summary_tab_content + https://cancer.sanger.ac.uk/cosmic/help#types_tab_content Gene name 1 {Accession number 1 }: r. _ Gene name 2{ Accession number 2 } : r. Gene name\uff1a \u57fa\u56e0\u7684HUGO symbol Accession number\uff1aGenebank\u5bf9\u5e94\u7684\u8f6c\u5f55\u672c\u7f16\u53f7 :\uff1a\u5192\u53f7\u7528\u4e8e\u533a\u5206\u57fa\u56e0ID\u548c\u4f4d\u7f6e\u4fe1\u606f r.\uff1a\u57fa\u4e8eRNA\u6c34\u5e73\u7684\u4f4d\u7f6e\u63cf\u8ff0 _\uff1a\u533a\u5206\u524d\u540e\u4e24\u4e2a\u65ad\u70b9 20191122 \u9274\u522b\u57fa\u56e0\u7ec4\u7248\u672c Identifying reference genome, if not stated, isn't always straightforward. In DanteLabs's case, though, looking at the BAM file headers we have: @SQ SN:chrM LN:16571 The 16571 basepair chrM is NC_001807 which UCSC used, but is used by practically nobody nowadays (It's not the same as rCRS or RSRS). Since in mapping reads will align to a location they best match with, changing the reference, even something as simple as the mitochondrial DNA, can cause reads to map differently elsewhere, and labs like to keep things unchanged so the results remain comparable. This one probably should be changed though, but YFull interpreted full mtDNA from the sequence, which is probably easiest option. STAR-Fusion --genome_lib_dir $starfusion_lib \\ --samples_file $sampleId.samples \\ --output_dir ./STAR-Fusion/ \\ --FusionInspector validate \\ --denovo_reconstruct \\ --examine_coding_effect \\ --CPU $ncpus \\ --min_FFPM 1 https://github.com/ShixiangWang/DoAbsolute dna rna \u6574\u5408 https://github.com/griffithlab/regtools \u7ebf\u7c92\u4f53 : https://link.springer.com/article/10.1007%2Fs00414-019-02205-y bgi\u6570\u636e\u5904\u7406 \u672c\u5730\u96c6\u7fa4\u4e0a\uff1a /lustre/Work/project/3d_genome/BGI_data_segmentation/20191109 https://github.com/zpeng1989/Cancer_Study https://bioconductor.org/packages/devel/workflows/vignettes/SingscoreAMLMutations/inst/doc/workflow_transcriptional_mut_sig_chinese.html \u80bf\u7624\u5f02\u8d28\u6027 1.\u80bf\u7624\u95f4\u5f02\u8d28\u6027(intertumour heterogeneity) 2.\u80bf\u7624\u5185\u5f02\u8d28\u6027(intratumour heterogeneity) 3.\u7ec6\u80de\u95f4\u5f02\u8d28\u6027(intercellular heterogeneity) https://github.com/bio-ontology-research-group https://github.com/ChristofferFlensburg/superFreq aneuploidy \u975e\u6574\u500d\u884c https://github.com/SilenWang/fastaAnno 2019113 ExtractUmisFromBam --molecular-index-tags ZA ZB align reads ORIENTATIONS=FR GroupReadsByUmi -s Paired CallDuplexConsensusReads CallMolecularConsensusReads https://stldevs.com/developers/zlskidmore Extracting UMIs within sample index reads during demultiplexing 9 https://www.sciencedirect.com/science/article/pii/S2001037017300946","title":"Zzzzz"},{"location":"zzzzz/#20200204","text":"","title":"20200204"},{"location":"zzzzz/#20200120","text":"FilterMutectCalls: + technical artifacts + non-somatic + sequencing error strandQ is the phred-scaled posterior quality of an artifact. In this case a strandQ of 83 means FilterMutectCalls thinks there's a 1 in 10^8.3 chance of a strand artifact.","title":"20200120"},{"location":"zzzzz/#20200118","text":"benchmark: https://github.com/chapmanb/bcbio-nextgen/tree/master/config/examples The DREAM challenge has synthetically generated tumor/normal truth sets for somatic variations. We typically use the synthetic 3 and synthetic 4 datasets for validation. synthetic 3 is publicly available and synthetic 4 requires access. Both have truth sets (https://www.synapse.org/#!Synapse:syn2177211). A mixture of two Genome in a Bottle samples, NA12878 and NA24385, with variations at 30% and 15% allele frequency. There are also other deeply sequenced and characterized real tumor datasets that require access permissions: Chronic lymphocytic leukaemia and medulloblastoma from ICGC: http://www.nature.com/articles/ncomms10001 AML from WashU (http://aml31.genome.wustl.edu/) have higher rates of C>A (oxidative damage) and C>T (deamination) errors in tumor data","title":"20200118"},{"location":"zzzzz/#20200107","text":"filter_file7[\"site_tmp\"].isin(hotsites) filter_file7[\"site_tmp\"].apply(lambda x: any([ i in x for i in hotsites]))","title":"20200107"},{"location":"zzzzz/#20200106","text":"\u56e0\u4e3aVEP\u5bf9\u6bcf\u4e2a\u8f6c\u7eff\u672c\u5355\u72ec\u8fdb\u884c\u6ce8\u91ca\uff0c\u6240\u4ee5\u5728\u7edf\u8ba1\u65f6\uff0c\u4efb\u4e00\u8f6c\u5f55\u672c\u8ba4\u4e3a\u6709\u5bb3\u5373\u8ba4\u4e3a\u8be5\u4f4d\u70b9\u6709\u5bb3\u3002 rs2coordinates library(biomaRt) grch37_snp = useMart(biomart=\"ENSEMBL_MART_SNP\", host=\"grch37.ensembl.org\", path=\"/biomart/martservice\", dataset=\"hsapiens_snp\") #snp_ids = c(\"rs1149222\", \"rs4148808\") snp_ids = read.csv(\"/local_data1/work/zhangbo/tmp/0522/rs2coordinates2.txt\", header = T, sep = \"\\t\") snp_attributes = c(\"refsnp_id\", \"chr_name\", \"chrom_start\") #'ensembl_gene_stable_id' snp_locations = getBM(attributes=snp_attributes, filters=\"snp_filter\", values=snp_ids$Location, mart=grch37_snp) final_o = merge(snp_locations, snp_ids, by.y = \"Location\", by.x = \"refsnp_id\", all.x = TRUE) write.table(final_o, \"final_o.xls\", sep = \"\\t\", quote = F, row.names = F)","title":"20200106"},{"location":"zzzzz/#20191230","text":"the default TLOD filtration cutoff is 6.3:This roughly corresponds to a prior probability of 10^(-6.3) of somatic variants at any given site, which is about right for many tumors. Note however that this argument is obsolete as of GATK 4.1.1.","title":"20191230"},{"location":"zzzzz/#20191213","text":"shell \u83b7\u53d6\u53cd\u5411\u4e92\u8865\u5e8f\u5217 [zhangbo@mu01 heyueqing_PW59-1]$ echo 'GTACATGTCA' |rev|tr \"ATCG\" \"TAGC\"","title":"20191213"},{"location":"zzzzz/#20191206","text":"F1-Measure: $$F_{A} = $$ \u5176\u4e2d\u662f\u53c2\u6570\uff0cP\u662f\u7cbe\u786e\u7387(Precision)\uff0cR\u662f\u53ec\u56de\u7387(Recall)\u3002 [1] \u5f53\u53c2\u6570=1\u65f6\uff0c\u5c31\u662f\u6700\u5e38\u89c1\u7684F1-Measure\u4e86\uff1a F1=2*RP/(R+P) http://genome.ucsc.edu/cgi-bin/das/hg38/dna?segment=chr1:186318317,186318337 [zhangbo@mu01 fusioncatcher]$ $bedtools getfasta -s -fi $hsa_ref -bed tmp.bedplus -fo tmp.faplus [zhangbo@mu01 fusioncatcher]$ cat tmp.faplus >chr1:186318317-186318337(+) ACTCTGTCTCAAAAAAAAAA","title":"20191206"},{"location":"zzzzz/#20191201","text":"Targeted method: In the targeted fusion detection method, panel primers are designed to target specific exon-exon junctions of fusions where the driver gene, the partner gene, and the breakpoint between the driver and the partner gene are known. The sequencing reads are mapped to a reference file that contains only the known gene fusions. Non\u2011targeted method: In the non-targeted fusion detection method, the panel primers are used to detect fusions between novel combinations of known diver and partner genes. The sequencing reads are mapped to a broader reference, such as the whole\u2011exome. Mapping the reads to a broader reference allows for the detection of multiple configurations of driver and partner genes as well as detection of novel breakpoints between the known partner and driver genes. https://ionreporter.thermofisher.com/ionreporter/help/GUID-F6403251-CB0F-4955-9C2F-637E7C535387.html https://ionreporter.thermofisher.com/ionreporter/help/GUID-759AEE0F-3542-4774-AC5E-E630E2A4B1FB.html \u9ad8\u7ea7\u5206\u6790 http://www.feiaituan.com/?p=1289","title":"20191201"},{"location":"zzzzz/#20191128","text":"","title":"20191128"},{"location":"zzzzz/#cosmic-fusion","text":"\u5b98\u7f51\u5730\u5740\uff1a + https://cancer.sanger.ac.uk/cosmic/fusion \u5185\u5bb9\u63cf\u8ff0\uff1a + https://cancer.sanger.ac.uk/cosmic/help/fusion/summary#summary_tab_content + https://cancer.sanger.ac.uk/cosmic/help#types_tab_content Gene name 1 {Accession number 1 }: r. _ Gene name 2{ Accession number 2 } : r. Gene name\uff1a \u57fa\u56e0\u7684HUGO symbol Accession number\uff1aGenebank\u5bf9\u5e94\u7684\u8f6c\u5f55\u672c\u7f16\u53f7 :\uff1a\u5192\u53f7\u7528\u4e8e\u533a\u5206\u57fa\u56e0ID\u548c\u4f4d\u7f6e\u4fe1\u606f r.\uff1a\u57fa\u4e8eRNA\u6c34\u5e73\u7684\u4f4d\u7f6e\u63cf\u8ff0 _\uff1a\u533a\u5206\u524d\u540e\u4e24\u4e2a\u65ad\u70b9","title":"cosmic fusion \u6570\u636e\u5e93\u4ecb\u7ecd"},{"location":"zzzzz/#20191122","text":"\u9274\u522b\u57fa\u56e0\u7ec4\u7248\u672c Identifying reference genome, if not stated, isn't always straightforward. In DanteLabs's case, though, looking at the BAM file headers we have: @SQ SN:chrM LN:16571 The 16571 basepair chrM is NC_001807 which UCSC used, but is used by practically nobody nowadays (It's not the same as rCRS or RSRS). Since in mapping reads will align to a location they best match with, changing the reference, even something as simple as the mitochondrial DNA, can cause reads to map differently elsewhere, and labs like to keep things unchanged so the results remain comparable. This one probably should be changed though, but YFull interpreted full mtDNA from the sequence, which is probably easiest option. STAR-Fusion --genome_lib_dir $starfusion_lib \\ --samples_file $sampleId.samples \\ --output_dir ./STAR-Fusion/ \\ --FusionInspector validate \\ --denovo_reconstruct \\ --examine_coding_effect \\ --CPU $ncpus \\ --min_FFPM 1 https://github.com/ShixiangWang/DoAbsolute dna rna \u6574\u5408 https://github.com/griffithlab/regtools \u7ebf\u7c92\u4f53 : https://link.springer.com/article/10.1007%2Fs00414-019-02205-y","title":"20191122"},{"location":"zzzzz/#bgi","text":"\u672c\u5730\u96c6\u7fa4\u4e0a\uff1a /lustre/Work/project/3d_genome/BGI_data_segmentation/20191109 https://github.com/zpeng1989/Cancer_Study https://bioconductor.org/packages/devel/workflows/vignettes/SingscoreAMLMutations/inst/doc/workflow_transcriptional_mut_sig_chinese.html","title":"bgi\u6570\u636e\u5904\u7406"},{"location":"zzzzz/#_1","text":"1.\u80bf\u7624\u95f4\u5f02\u8d28\u6027(intertumour heterogeneity) 2.\u80bf\u7624\u5185\u5f02\u8d28\u6027(intratumour heterogeneity) 3.\u7ec6\u80de\u95f4\u5f02\u8d28\u6027(intercellular heterogeneity)","title":"\u80bf\u7624\u5f02\u8d28\u6027"},{"location":"zzzzz/#_2","text":"https://github.com/bio-ontology-research-group https://github.com/ChristofferFlensburg/superFreq aneuploidy \u975e\u6574\u500d\u884c https://github.com/SilenWang/fastaAnno","title":""},{"location":"zzzzz/#2019113","text":"ExtractUmisFromBam --molecular-index-tags ZA ZB align reads ORIENTATIONS=FR GroupReadsByUmi -s Paired CallDuplexConsensusReads CallMolecularConsensusReads https://stldevs.com/developers/zlskidmore Extracting UMIs within sample index reads during demultiplexing 9 https://www.sciencedirect.com/science/article/pii/S2001037017300946","title":"2019113"},{"location":"%E5%8D%95%E8%AF%8D/","text":"It seems odd that Sorry for the naive question but I am a little bit confused with the \"--required_maximum_alt_allele_mapping_quality_score\" parameter. Shouldn't it be the threshold for the minimum required mapping quality ensuring that there is \"at least one observation of the mutant allele\" with a decent mapping quality?.. Otherwise I can't make sense out of it. And one more question concerning filter parameters. Was this argument discarded or renamed\uff1f discordance between Hi Sebastian, I really like your tool arriba, it's really fast. But recently I encountered this weird issue, what's the possible reason for it ? is it because some GTF records ? very similar splicing junction structures ? or anything else ... Thanks. It's really strange and I have no real clue about what can cause that behavior. homvars or hetvars post-chemotherapy sample \u5316\u7597\u540e\u7684\u836f\u7269 ReferenceBases BIALLELIC cross-sample contamination\uff08cross-individual contamination\uff09, not tissue contamination evenness of coverage for the genomic intervals which seems very weird to me for this type of analysis. compound het/homozygous. heterozygous homopolymer reciprocal overlap \u76f8\u4e92\u91cd\u53e0 a trivial problem \u5c0f\u95ee\u9898 Each entry in a VCF file break these ambiguities \u6253\u6d88\u6b67\u4e49 Thank you very much for your patience and any feedback you might have will be greatly appreciated. multiallelic Can you clarify on : high volume of spam \u5927\u91cf\u7684\u5783\u573e\u90ae\u4ef6 requiring subsequent filtering and/or manual review to eliminate this artifact. The 1000 Genome Project is a large international effort to create a set of publicly available sequence data for a large cohort of ethnically diverse individuals. minimal residual disease tracking, \u6700\u5c0f\u6b8b\u7559\u75be\u75c5\u8ffd\u8e2a predisposing \u6613\u611f\u6027 Could you give a simple explain on why synonyms default thresholds The default thresholds are just an empirical compromise between speed, sensitivty, and precision. I've run into this problem a few times now having attempted to debug the issue in various ways. Can you elaborate on what makes this output looks abnormal? experimental validation To get a first impression, we use a data set, in which CNVs have been artificially implanted. copy number variations and aberrations (CNVs and CNAs) mechanism \u539f\u7406\u673a\u5236 Disclaimer \u514d\u8d23\u58f0\u660e Methodologically \u65b9\u6cd5\u4e0a Any guidance at all is greatly appreciated. Awaiting response/suggestions from Team GATK. Sorry about the delay in response elimination \u6d88\u9664 @deprecated This argument is obsolete as of June 2017. It was previously used for the M1-style strand bias filter. Thank you for your tremendous service developing this tool. Can you please elaborate a little bit on how enabling this parameter affects variant calling? Regarding this situation of multiallelic sites, I also have one question. Thank you in advance for your help, and sorry if something is unclear -- please let me know.","title":"\u5355\u8bcd"},{"location":"%E5%B7%A5%E4%BD%9C%E8%AE%B0%E5%BD%95/","text":"99. pg67 chrx:129162627 \u8fd9\u4e2a\u70b9\u5468\u56f4\u8d28\u91cf\u5dee\uff0c\u68c0\u6d4b\u8d28\u63a7\u8fc7\u7a0b 20191207 \u5bf9\u4e8epanel fanqiugui_PG61\u6837\u672c\u7684\u63a5\u5934\u95ee\u9898\uff0c TGAGTGCA + ### 20191206 clean_AG647-1_vs_AM647-1.final.hg19_multianno chr3:176769301 \u5bf9\u4e8e\u8fd9\u4e2a\u70b9\uff0cmutect2 \u6ca1\u6709\u62a5\u51fa\u6765 ```","title":"\u5de5\u4f5c\u8bb0\u5f55"},{"location":"%E5%B7%A5%E4%BD%9C%E8%AE%B0%E5%BD%95/#99","text":"","title":"99."},{"location":"%E5%B7%A5%E4%BD%9C%E8%AE%B0%E5%BD%95/#_1","text":"pg67 chrx:129162627 \u8fd9\u4e2a\u70b9\u5468\u56f4\u8d28\u91cf\u5dee\uff0c\u68c0\u6d4b\u8d28\u63a7\u8fc7\u7a0b","title":""},{"location":"%E5%B7%A5%E4%BD%9C%E8%AE%B0%E5%BD%95/#20191207","text":"\u5bf9\u4e8epanel fanqiugui_PG61\u6837\u672c\u7684\u63a5\u5934\u95ee\u9898\uff0c TGAGTGCA + ### 20191206 clean_AG647-1_vs_AM647-1.final.hg19_multianno chr3:176769301 \u5bf9\u4e8e\u8fd9\u4e2a\u70b9\uff0cmutect2 \u6ca1\u6709\u62a5\u51fa\u6765 ```","title":"20191207"},{"location":"00_/000_%E5%9F%BA%E5%9B%A0%E7%BB%93%E6%9E%84/","text":"\u4e00\u4e2a\u57fa\u56e0\u4e2d\uff1a 1\u3001\u5305\u542b\u76f8\u540c\u4e2a\u6570\u7684CDS\u548c\u5916\u663e\u5b50 2\u3001\u9664\u7b2c\u4e00\u4e2a\u548c\u6700\u540e\u4e00\u4e2aCDS\u548c\u5916\u663e\u5b50\u7684\u5e8f\u5217\u4e0d\u540c\u4e4b\u5916\uff0c\u5176\u5b83\u90fd\u662f\u76f8\u540c\u7684 3\u3001\u7b2c\u4e00\u4e2a\u5916\u663e\u5b50\u6bd4CDS\u8981\u957f\uff0c\u8fd9\u662f\u56e0\u4e3a\u7b2c\u4e00\u4e2a\u5916\u663e\u5b50\u4e2d\u6709\u7ffb\u8bd1\u4fe1\u53f7\uff0c\u540c\u7406\u6700\u540e\u4e00\u4e2a\u91cc\u9762\u6709\u4ec0\u4e48\u6211\u73b0\u5728\u4e5f\u4e0d\u77e5\u9053\u3002\uff08\u54c8\u54c8\u54c8\uff09 4\u3001CDS\u5e76\u4e0d\u662f\u4ece\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\u8fdb\u884c\u7ffb\u8bd1\u7684\uff0c\u800c\u662f\u6839\u636e\u5176frame\u51b3\u5b9a\u3002 5\u3001\u8981\u8bb0\u4f4f\uff0cCDS\u76f4\u63a5\u5bf9\u5e94\u4e8e\u86cb\u767d\u8d28\u5e8f\u5217\uff0c\u800c\u5916\u663e\u5b50\u5219\u662f\u76f8\u5bf9\u4e8emRNA\u81ea\u6211\u526a\u63a5\u8fc7\u7a0b\u800c\u8a00\u7684\uff0c\u8fd9\u5c31\u662f\u4e24\u8005\u7684\u4e0d\u540c\u3002 Giemsa banding (G-banding) - G\u663e\u5e26 + Dark bands are AT-rich and have less genes. + Light bands are GC-rich DNA and are more transcriptionally active.","title":"000 \u57fa\u56e0\u7ed3\u6784"},{"location":"00_/001_%20CombineVariants/","text":"","title":"001  CombineVariants"},{"location":"01_database/00/","text":"2. Common 2.1. Ucsc(\u53c2\u8003\u5e8f\u5217\u6587\u4ef6\u63a8\u8350\u4e0b\u8f7d\u8fd9\u4e2a) 2.2. Gencode\uff08\u57fa\u56e0\u6ce8\u91ca\u6587\u4ef6\u4e0b\u8f7d\uff09 2.3. Ensembl 2.4. Refseq Ref_Info Reference genome patches 3. OMIM genemap2.txt\u8bf4\u660e 4. CADD 5. ExAC 6. Cosmic 6. 7. dbSNP Ref_Info dbNSFP(\u975e\u540c\u4e49\u53d8\u5f02\u529f\u80fd\u9884\u6d4b\u6570\u636e\u5e93\uff09 https://anjingwd.github.io/AnJingwd.github.io/2017/08/12/\u53c2\u8003\u57fa\u56e0\u7ec4\u6570\u636e\u4e0b\u8f7d/ 2. Common 2.1. Ucsc(\u53c2\u8003\u5e8f\u5217\u6587\u4ef6\u63a8\u8350\u4e0b\u8f7d\u8fd9\u4e2a) \u8fdb\u5165UCSC\u540e\u9009\u62e9Downloads > Genome Data > Human > hg19 Full Dataset\uff0c \u4e0b\u8f7d\u5b8c\u6210\u540e\u9700\u8981\u89e3\u538b\u6587\u4ef6\u5e76\u5c06\u6240\u6709\u67d3\u8272\u4f53\u5e8f\u5217\u6587\u4ef6\u62fc\u63a5\u6574\u5408\u6210\u4e00\u4e2a\u5b8c\u6574\u7684hg38.fa\u6587\u4ef6 http://genome.ucsc.edu/cgi-bin/hgTables http://genome.ucsc.edu/cgi-bin/hgTables?hgsid=682987339_Q4QiJkTbj7alIOKSnfjFgXGdrGKS&clade=mammal&org=&db=hg19&hgta_group=genes&hgta_track=knownGene&hgta_table=knownGene&hgta_regionType=genome&position=&hgta_outputType=primaryTable&hgta_outFileName= wegt http://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/chromFa.tar.gz ##hg19 wget http://hgdownload.cse.ucsc.edu/goldenPath/hg38/bigZips/chromFa.tar.gz ##hg38 tar -zxvf chromFa.tar.gz cd chroms cat *.fa >hg19.fa 2.2. Gencode\uff08\u57fa\u56e0\u6ce8\u91ca\u6587\u4ef6\u4e0b\u8f7d\uff09 (http://www.gencodegenes.org/)\u4e0b\u8f7d\u9700\u8981\u7684\u6ce8\u91ca\u6587\u4ef6\uff0c\u8fdb\u5165\u7f51\u7ad9\u540e\u9009\u62e9Data > Human > GRCh37-mapped Releases ftp://ftp.sanger.ac.uk/pub/gencode/Gencode_human/ axel ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_28/GRCh37_mapping/gencode.v28lift37.annotation.gtf.gz axel ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_28/GRCh37_mapping/gencode.v28lift37.annotation.gff3.gz 2.3. Ensembl http://asia.ensembl.org/info/data/ftp/index.html ftp://ftp.ensembl.org/pub/ ftp://ftp.ensembl.org/pub/release-87/gtf/homo_sapiens/Homo_sapiens.GRCh38.87.chr.gtf.gz ftp://ftp.ensembl.org/pub/current_gtf/homo_sapiens/Homo_sapiens.GRCh38.90.gtf.gz## hg38 Gencode vs. Ensembl: X/Y\u67d3\u8272\u4f53\u4e0aPAR\u533a\u57df\u7684\u6ce8\u91ca\uff1a\u8be5\u533a\u57df\u7684\u6ce8\u91ca\u5728Gencode\u4e2dX\u67d3\u8272\u4f53\u548cY\u67d3\u8272\u4f53\u5404\u6ce8\u91ca\u4e00\u6b21\uff0c\u800c\u5728Ensembl\u6587\u4ef6\u4e2d\uff0c\u53ea\u5728X\u67d3\u8272\u4f53\u8fdb\u884c\u4e86\u6ce8\u91ca PAR region(Pseudoautosomal region)\uff1a\u8be5\u533a\u57df\u662fX\u548cY\u67d3\u8272\u4f53\u7684\u540c\u6e90\u5e8f\u5217\uff0c\u56e0\u4e3a\u8fd9\u4e0a\u9762\u7684\u4efb\u4f55\u57fa\u56e0\u53ef\u4ee5\u548c\u5e38\u67d3\u8272\u4f53\u57fa\u56e0\u4e00\u6837\u6b63\u5e38\u9057\u4f20\u800c\u5f97\u540d Gencode\u7684\u7b2c\u4e5d\u5217\uff0c\u4e5f\u5c31\u662fattribute\u90a3\u4e00\u5217\uff0c\u6709\u4e00\u4e9b\u5176\u4ed6\u989d\u5916\u7684tags\uff0c\u8fd9\u4e9btags\u662fEnsebl\u6240\u6ca1\u6709\u7684 2.4. Refseq ftp://ftp.ncbi.nlm.nih.gov/genomes/refseq/vertebrate_mammalian/Homo_sapiens/latest_assembly_versions/ wget ftp://ftp.ncbi.nlm.nih.gov/genomes/Homo_sapiens/GFF/ref_GRCh38.p7_top_level.gff3.gz ## hg38 wget ftp://ftp.ncbi.nlm.nih.gov/genomes/Homo_sapiens/ARCHIVE/BUILD.37.3/GFF/ref_GRCh37.p5_top_level.gff3.gz ## hg19 ftp://ftp.ncbi.nlm.nih.gov/refseq/H_sapiens/annotation/GRCh37_latest/refseq_identifiers/ ##hg19 ##hg19\uff1a for i in $(seq 1 22) X Y M; do wget ftp://ftp.ncbi.nlm.nih.gov/genomes/Homo_sapiens/ARCHIVE/BUILD.37.3/Assembled_chromosomes/seq/hs_ref_GRCh37.p5_chr${i}.fa.gz; gzip -d hs_ref_GRCh37.p5_chr${i}.fa.gz; cat hs_ref_GRCh37.p5_chr${i}.fa.gz >>hg19.fa; sleep 10s; done; ##hg38\uff1a \u540c\u7406\uff0c\u53ea\u8981\u627e\u5230\u4e0b\u8f7d\u5730\u5740\uff0c\u6539\u52a8\u4e00\u4e0b\u5373\u53ef\u3002 ### ftp://ftp.ncbi.nlm.nih.gov/genomes/Homo_sapiens/Assembled_chromosomes/seq/hs_ref_GRCh38.p7_chr${i}.fa.gz 1000g: http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/reference/ Ref_Info https://blog.csdn.net/tanzuozhev/article/details/78861704 Reference genome patches https://janbio.home.blog/2018/11/27/reference-genome-patches/ 3. OMIM OMIM\uff0c\u201c0nline MendelianInheritance in Man\u201d https://www.omim.org https://omim.org/static/omim/data/mim2gene.txt genemap2.txt\u8bf4\u660e 'Charcot-Marie-Tooth disease, axonal, type 2A2A, 609260 (3), Autosomal dominant; Charcot-Marie-Tooth disease, axonal, type 2A2B, 617087 (3), Autosomal recessive; Hereditary motor and sensory neuropathy VIA, 601152 (3), Autosomal dominant' # Each Phenotype is followed by its MIM number, if different from # that of the locus, preceded by a comma # Phenotype mapping key in parentheses follows the phenotype MIM # number (explanation below). # Allelic disorders are separated by a semi-colon following the # phenotype mapping key. # Inheritance for the phenotype follows the phenotype mapping key # preceded by a ,<space> Allelic disorders, phenotype_MIMnumber(Phenotype mapping key), Inheritance http://vlambda.com/wz_x5GNF7ezSN.html 4. CADD 5. ExAC Exome Aggregation Consortium (ExAC) Consists of 60,706 unrelated individuals that were exome sequenced Various disease-specific and population genetic studies Search for any human gene or variant or region https://raw.githubusercontent.com/zhezhangsh/rchive/master/R/ParseOmim.r 6. Cosmic https://cancer.sanger.ac.uk/census 6. https://zhuanlan.zhihu.com/p/ 7. dbSNP NCBI Assay ID(ss) Reference SNP ID(rs) \u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u63d0\u4ea4\u5230dbSNP\u6570\u636e\u5e93\u7684SNP\u4f4d\u70b9, \u9996\u5148\u4f1a\u8d4b\u4e88\u4e00\u4e2a\u552f\u4e00\u7684ss ID\u3002 \u7531\u4e8e\u4e0d\u540c\u7814\u7a76\u7ed3\u6784\u63d0\u4ea4\u7684SNP\u4f1a\u5b58\u5728\u5197\u4f59\uff0c\u63d0\u53d6SNP\u4f4d\u70b9\u4e0a\u4e0b\u6e38\u533a\u57df\u7684\u5e8f\u5217\uff0c\u6bd4\u5bf9\u53c2\u8003\u57fa\u56e0\u7ec4\uff0c\u5982\u679c\u591a\u4e2ass ID \u6bd4\u5bf9\u4e0a\u76f8\u540c\u7684\u4f4d\u7f6e\uff0c\u8bf4\u660e\u8fd9\u51e0\u4e2aSNP\u4f4d\u70b9\u662f\u5197\u4f59\u7684\uff0c\u4f1a\u8d4b\u4e88\u4e00\u4e2a\u65b0\u7684reference SNP ID, \u4ee5rs\u5f00\u5934\u3002 ftp://ftp.ncbi.nih.gov/snp/organisms/human_9606/VCF/ Ref_Info dbNSFP(\u975e\u540c\u4e49\u53d8\u5f02\u529f\u80fd\u9884\u6d4b\u6570\u636e\u5e93\uff09 \u6240\u6709\u975e\u540c\u4e49SNP\u4f4d\u70b9\u7684\u529f\u80fd\u9884\u6d4b\u3001\u4fdd\u5b88\u6027\u4ee5\u53ca\u4eba\u53e3\u9891\u7387\u4fe1\u606f\uff08\u5982\u679c\u53ef\u7528\uff09 https://github.com/jmzeng1314/bioinformatics123/blob/master/appendix/database.md https://anjingwd.github.io/AnJingwd.github.io/2017/08/12/\u53c2\u8003\u57fa\u56e0\u7ec4\u6570\u636e\u4e0b\u8f7d/","title":"00"},{"location":"01_database/00/#_1","text":"https://anjingwd.github.io/AnJingwd.github.io/2017/08/12/\u53c2\u8003\u57fa\u56e0\u7ec4\u6570\u636e\u4e0b\u8f7d/","title":""},{"location":"01_database/00/#2-common","text":"","title":"2. Common"},{"location":"01_database/00/#21-ucsc","text":"\u8fdb\u5165UCSC\u540e\u9009\u62e9Downloads > Genome Data > Human > hg19 Full Dataset\uff0c \u4e0b\u8f7d\u5b8c\u6210\u540e\u9700\u8981\u89e3\u538b\u6587\u4ef6\u5e76\u5c06\u6240\u6709\u67d3\u8272\u4f53\u5e8f\u5217\u6587\u4ef6\u62fc\u63a5\u6574\u5408\u6210\u4e00\u4e2a\u5b8c\u6574\u7684hg38.fa\u6587\u4ef6 http://genome.ucsc.edu/cgi-bin/hgTables http://genome.ucsc.edu/cgi-bin/hgTables?hgsid=682987339_Q4QiJkTbj7alIOKSnfjFgXGdrGKS&clade=mammal&org=&db=hg19&hgta_group=genes&hgta_track=knownGene&hgta_table=knownGene&hgta_regionType=genome&position=&hgta_outputType=primaryTable&hgta_outFileName= wegt http://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/chromFa.tar.gz ##hg19 wget http://hgdownload.cse.ucsc.edu/goldenPath/hg38/bigZips/chromFa.tar.gz ##hg38 tar -zxvf chromFa.tar.gz cd chroms cat *.fa >hg19.fa","title":"2.1. Ucsc(\u53c2\u8003\u5e8f\u5217\u6587\u4ef6\u63a8\u8350\u4e0b\u8f7d\u8fd9\u4e2a)"},{"location":"01_database/00/#22-gencode","text":"(http://www.gencodegenes.org/)\u4e0b\u8f7d\u9700\u8981\u7684\u6ce8\u91ca\u6587\u4ef6\uff0c\u8fdb\u5165\u7f51\u7ad9\u540e\u9009\u62e9Data > Human > GRCh37-mapped Releases ftp://ftp.sanger.ac.uk/pub/gencode/Gencode_human/ axel ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_28/GRCh37_mapping/gencode.v28lift37.annotation.gtf.gz axel ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_28/GRCh37_mapping/gencode.v28lift37.annotation.gff3.gz","title":"2.2. Gencode\uff08\u57fa\u56e0\u6ce8\u91ca\u6587\u4ef6\u4e0b\u8f7d\uff09"},{"location":"01_database/00/#23-ensembl","text":"http://asia.ensembl.org/info/data/ftp/index.html ftp://ftp.ensembl.org/pub/ ftp://ftp.ensembl.org/pub/release-87/gtf/homo_sapiens/Homo_sapiens.GRCh38.87.chr.gtf.gz ftp://ftp.ensembl.org/pub/current_gtf/homo_sapiens/Homo_sapiens.GRCh38.90.gtf.gz## hg38 Gencode vs. Ensembl: X/Y\u67d3\u8272\u4f53\u4e0aPAR\u533a\u57df\u7684\u6ce8\u91ca\uff1a\u8be5\u533a\u57df\u7684\u6ce8\u91ca\u5728Gencode\u4e2dX\u67d3\u8272\u4f53\u548cY\u67d3\u8272\u4f53\u5404\u6ce8\u91ca\u4e00\u6b21\uff0c\u800c\u5728Ensembl\u6587\u4ef6\u4e2d\uff0c\u53ea\u5728X\u67d3\u8272\u4f53\u8fdb\u884c\u4e86\u6ce8\u91ca PAR region(Pseudoautosomal region)\uff1a\u8be5\u533a\u57df\u662fX\u548cY\u67d3\u8272\u4f53\u7684\u540c\u6e90\u5e8f\u5217\uff0c\u56e0\u4e3a\u8fd9\u4e0a\u9762\u7684\u4efb\u4f55\u57fa\u56e0\u53ef\u4ee5\u548c\u5e38\u67d3\u8272\u4f53\u57fa\u56e0\u4e00\u6837\u6b63\u5e38\u9057\u4f20\u800c\u5f97\u540d Gencode\u7684\u7b2c\u4e5d\u5217\uff0c\u4e5f\u5c31\u662fattribute\u90a3\u4e00\u5217\uff0c\u6709\u4e00\u4e9b\u5176\u4ed6\u989d\u5916\u7684tags\uff0c\u8fd9\u4e9btags\u662fEnsebl\u6240\u6ca1\u6709\u7684","title":"2.3. Ensembl"},{"location":"01_database/00/#24-refseq","text":"ftp://ftp.ncbi.nlm.nih.gov/genomes/refseq/vertebrate_mammalian/Homo_sapiens/latest_assembly_versions/ wget ftp://ftp.ncbi.nlm.nih.gov/genomes/Homo_sapiens/GFF/ref_GRCh38.p7_top_level.gff3.gz ## hg38 wget ftp://ftp.ncbi.nlm.nih.gov/genomes/Homo_sapiens/ARCHIVE/BUILD.37.3/GFF/ref_GRCh37.p5_top_level.gff3.gz ## hg19 ftp://ftp.ncbi.nlm.nih.gov/refseq/H_sapiens/annotation/GRCh37_latest/refseq_identifiers/ ##hg19 ##hg19\uff1a for i in $(seq 1 22) X Y M; do wget ftp://ftp.ncbi.nlm.nih.gov/genomes/Homo_sapiens/ARCHIVE/BUILD.37.3/Assembled_chromosomes/seq/hs_ref_GRCh37.p5_chr${i}.fa.gz; gzip -d hs_ref_GRCh37.p5_chr${i}.fa.gz; cat hs_ref_GRCh37.p5_chr${i}.fa.gz >>hg19.fa; sleep 10s; done; ##hg38\uff1a \u540c\u7406\uff0c\u53ea\u8981\u627e\u5230\u4e0b\u8f7d\u5730\u5740\uff0c\u6539\u52a8\u4e00\u4e0b\u5373\u53ef\u3002 ### ftp://ftp.ncbi.nlm.nih.gov/genomes/Homo_sapiens/Assembled_chromosomes/seq/hs_ref_GRCh38.p7_chr${i}.fa.gz 1000g: http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/reference/","title":"2.4. Refseq"},{"location":"01_database/00/#ref_info","text":"https://blog.csdn.net/tanzuozhev/article/details/78861704","title":"Ref_Info"},{"location":"01_database/00/#reference-genome-patches","text":"https://janbio.home.blog/2018/11/27/reference-genome-patches/","title":"Reference genome patches"},{"location":"01_database/00/#3-omim","text":"OMIM\uff0c\u201c0nline MendelianInheritance in Man\u201d https://www.omim.org https://omim.org/static/omim/data/mim2gene.txt","title":"3. OMIM"},{"location":"01_database/00/#genemap2txt","text":"'Charcot-Marie-Tooth disease, axonal, type 2A2A, 609260 (3), Autosomal dominant; Charcot-Marie-Tooth disease, axonal, type 2A2B, 617087 (3), Autosomal recessive; Hereditary motor and sensory neuropathy VIA, 601152 (3), Autosomal dominant' # Each Phenotype is followed by its MIM number, if different from # that of the locus, preceded by a comma # Phenotype mapping key in parentheses follows the phenotype MIM # number (explanation below). # Allelic disorders are separated by a semi-colon following the # phenotype mapping key. # Inheritance for the phenotype follows the phenotype mapping key # preceded by a ,<space> Allelic disorders, phenotype_MIMnumber(Phenotype mapping key), Inheritance","title":"genemap2.txt\u8bf4\u660e"},{"location":"01_database/00/#_2","text":"http://vlambda.com/wz_x5GNF7ezSN.html","title":""},{"location":"01_database/00/#4-cadd","text":"","title":"4. CADD"},{"location":"01_database/00/#5-exac","text":"Exome Aggregation Consortium (ExAC) Consists of 60,706 unrelated individuals that were exome sequenced Various disease-specific and population genetic studies Search for any human gene or variant or region https://raw.githubusercontent.com/zhezhangsh/rchive/master/R/ParseOmim.r","title":"5. ExAC"},{"location":"01_database/00/#6-cosmic","text":"https://cancer.sanger.ac.uk/census","title":"6. Cosmic"},{"location":"01_database/00/#6","text":"https://zhuanlan.zhihu.com/p/","title":"6."},{"location":"01_database/00/#7-dbsnp","text":"NCBI Assay ID(ss) Reference SNP ID(rs) \u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u63d0\u4ea4\u5230dbSNP\u6570\u636e\u5e93\u7684SNP\u4f4d\u70b9, \u9996\u5148\u4f1a\u8d4b\u4e88\u4e00\u4e2a\u552f\u4e00\u7684ss ID\u3002 \u7531\u4e8e\u4e0d\u540c\u7814\u7a76\u7ed3\u6784\u63d0\u4ea4\u7684SNP\u4f1a\u5b58\u5728\u5197\u4f59\uff0c\u63d0\u53d6SNP\u4f4d\u70b9\u4e0a\u4e0b\u6e38\u533a\u57df\u7684\u5e8f\u5217\uff0c\u6bd4\u5bf9\u53c2\u8003\u57fa\u56e0\u7ec4\uff0c\u5982\u679c\u591a\u4e2ass ID \u6bd4\u5bf9\u4e0a\u76f8\u540c\u7684\u4f4d\u7f6e\uff0c\u8bf4\u660e\u8fd9\u51e0\u4e2aSNP\u4f4d\u70b9\u662f\u5197\u4f59\u7684\uff0c\u4f1a\u8d4b\u4e88\u4e00\u4e2a\u65b0\u7684reference SNP ID, \u4ee5rs\u5f00\u5934\u3002 ftp://ftp.ncbi.nih.gov/snp/organisms/human_9606/VCF/","title":"7. dbSNP"},{"location":"01_database/00/#ref_info_1","text":"","title":"Ref_Info"},{"location":"01_database/00/#dbnsfp","text":"\u6240\u6709\u975e\u540c\u4e49SNP\u4f4d\u70b9\u7684\u529f\u80fd\u9884\u6d4b\u3001\u4fdd\u5b88\u6027\u4ee5\u53ca\u4eba\u53e3\u9891\u7387\u4fe1\u606f\uff08\u5982\u679c\u53ef\u7528\uff09 https://github.com/jmzeng1314/bioinformatics123/blob/master/appendix/database.md https://anjingwd.github.io/AnJingwd.github.io/2017/08/12/\u53c2\u8003\u57fa\u56e0\u7ec4\u6570\u636e\u4e0b\u8f7d/","title":"dbNSFP(\u975e\u540c\u4e49\u53d8\u5f02\u529f\u80fd\u9884\u6d4b\u6570\u636e\u5e93\uff09"},{"location":"01_database/01_annovar/","text":"\u7248\u672c\u66f4\u65b0 2019Oct24\uff1a + \u5229\u7528annotate_variation.pl\u4e2d\u7684-downdb\u53c2\u6570\u53ef\u4ee5\u5141\u8bb8refGeneWithVer\u4f5c\u4e3a\u4e00\u4e2a\u6709\u6548\u7684\u57fa\u56e0\u6ce8\u91ca + add -intronhgvs argument to print out HGVS notations for intronic variants; + add startloss and startgain as functional consequences that affects the first ATG codon; add -nofirstcodondel to table_ by default to enable calculation of amino acid changes for certain variants previously annotated as 'wholegene'; minor adjustment on nonframeshift vs startloss vs stopgain for certain variants with multiple valid notations; changed p. notation for block substitution that does not cause protein change; changed table_ so that ExAC and gnomAD are treated as float fields in VCF annotation; allow genericdb for region annotation; allow chromosome name to contain . or - for certain species; the -polish argument is ON by default in table_.pl; table_.pl can generate column headers such as Otherinfo, Otherinfo2, Otherinfo3, etc; fixed a bug of cdot notation for block substitutions that cover 5UTR and start codon cosmic\u6570\u636e\u5e93\u51c6\u5907 #!/bin/bash # ./cosmic2annovar.sh mail:passwd for i in \"CosmicCodingMuts.vcf.gz\" \"CosmicNonCodingVariants.vcf.gz\" do curl $(curl -H \"Authorization: Basic $(echo \"$1\" | base64)\" https://cancer.sanger.ac.uk/cosmic/file_download/GRCh37/cosmic/v90/VCF/$i | awk -F '\"' '{print $4}') -o $i done for i in \"CosmicMutantExport.tsv.gz\" \"CosmicNCV.tsv.gz\" do curl $(curl -H \"Authorization: Basic $(echo \"$1\" | base64)\" https://cancer.sanger.ac.uk/cosmic/file_download/GRCh37/cosmic/v90/$i | awk -F '\"' '{print $4}') -o $i done gunzip *.gz ./prepare_annovar_user.pl -dbtype cosmic CosmicMutantExport.tsv -vcf CosmicCodingMuts.vcf >hg19_cosmic90.txt ./prepare_annovar_user.pl -dbtype cosmic CosmicNCV.tsv -vcf CosmicNonCodingVariants.vcf >>hg19_cosmic90.txt sort -V hg19_cosmic90.txt >hg19_cosmic90_sort.txt mv hg19_cosmic90_sort.txt hg19_cosmic90.txt ./index_annovar.pl hg19_cosmic90.txt 1000","title":"01 annovar"},{"location":"01_database/01_annovar/#_1","text":"2019Oct24\uff1a + \u5229\u7528annotate_variation.pl\u4e2d\u7684-downdb\u53c2\u6570\u53ef\u4ee5\u5141\u8bb8refGeneWithVer\u4f5c\u4e3a\u4e00\u4e2a\u6709\u6548\u7684\u57fa\u56e0\u6ce8\u91ca + add -intronhgvs argument to print out HGVS notations for intronic variants; + add startloss and startgain as functional consequences that affects the first ATG codon; add -nofirstcodondel to table_ by default to enable calculation of amino acid changes for certain variants previously annotated as 'wholegene'; minor adjustment on nonframeshift vs startloss vs stopgain for certain variants with multiple valid notations; changed p. notation for block substitution that does not cause protein change; changed table_ so that ExAC and gnomAD are treated as float fields in VCF annotation; allow genericdb for region annotation; allow chromosome name to contain . or - for certain species; the -polish argument is ON by default in table_.pl; table_.pl can generate column headers such as Otherinfo, Otherinfo2, Otherinfo3, etc; fixed a bug of cdot notation for block substitutions that cover 5UTR and start codon","title":"\u7248\u672c\u66f4\u65b0"},{"location":"01_database/01_annovar/#cosmic","text":"#!/bin/bash # ./cosmic2annovar.sh mail:passwd for i in \"CosmicCodingMuts.vcf.gz\" \"CosmicNonCodingVariants.vcf.gz\" do curl $(curl -H \"Authorization: Basic $(echo \"$1\" | base64)\" https://cancer.sanger.ac.uk/cosmic/file_download/GRCh37/cosmic/v90/VCF/$i | awk -F '\"' '{print $4}') -o $i done for i in \"CosmicMutantExport.tsv.gz\" \"CosmicNCV.tsv.gz\" do curl $(curl -H \"Authorization: Basic $(echo \"$1\" | base64)\" https://cancer.sanger.ac.uk/cosmic/file_download/GRCh37/cosmic/v90/$i | awk -F '\"' '{print $4}') -o $i done gunzip *.gz ./prepare_annovar_user.pl -dbtype cosmic CosmicMutantExport.tsv -vcf CosmicCodingMuts.vcf >hg19_cosmic90.txt ./prepare_annovar_user.pl -dbtype cosmic CosmicNCV.tsv -vcf CosmicNonCodingVariants.vcf >>hg19_cosmic90.txt sort -V hg19_cosmic90.txt >hg19_cosmic90_sort.txt mv hg19_cosmic90_sort.txt hg19_cosmic90.txt ./index_annovar.pl hg19_cosmic90.txt 1000","title":"cosmic\u6570\u636e\u5e93\u51c6\u5907"},{"location":"01_database/01_ensemble/","text":"","title":"01 ensemble"},{"location":"01_database/01_vep/","text":"[toc] \u5728\u7ebf\u6ce8\u91ca http://grch37.ensembl.org/Homo_sapiens/Tools/VEP?db=core","title":"01 vep"},{"location":"01_database/01_vep/#_1","text":"http://grch37.ensembl.org/Homo_sapiens/Tools/VEP?db=core","title":"\u5728\u7ebf\u6ce8\u91ca"},{"location":"01_database/02_datasets/","text":"https://umccr.org/blog/bwa-mem-vs-minimap2/ - We downloaded 2 datasets with curated somatic variants: - ICGC medulloblastoma. Tumor: 103x, normal: 89x (downsampled from tumor: 314x, normal: 272x). - https://www.nature.com/articles/ncomms10001 - COLO829 metastatic melanoma cell line. Tumor: 81x, normal: 79x - https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4837349/","title":"02 datasets"},{"location":"01_database/03_dbNSFP/","text":"","title":"03 dbNSFP"},{"location":"01_database/04_dbSNP/","text":"","title":"04 dbSNP"},{"location":"01_database/05_MalaCards/","text":"\u7f51\u5740\uff1ahttps://www.malacards.org/","title":"05 MalaCards"},{"location":"01_database/06_revel/","text":"\u5b98\u7f51\u7f51\u5740: https://sites.google.com/site/revelgenomics/about","title":"06 revel"},{"location":"01_database/pic/readme/","text":"","title":"Readme"},{"location":"02_course/01_%E7%94%9F%E4%BF%A1%E8%B5%84%E6%BA%90%E8%AF%BE/","text":"dna https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course Using R and Bioconductor in Clinical Genomics and Transcriptomics\uff1a https://jmd.amjpathol.org/article/S1525-1578(19)30397-6/fulltext https://jmd.amjpathol.org/article/S1525-1578(19)30397-6/pdf","title":"01 \u751f\u4fe1\u8d44\u6e90\u8bfe"},{"location":"02_course/01_%E7%94%9F%E4%BF%A1%E8%B5%84%E6%BA%90%E8%AF%BE/#dna","text":"https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course Using R and Bioconductor in Clinical Genomics and Transcriptomics\uff1a https://jmd.amjpathol.org/article/S1525-1578(19)30397-6/fulltext https://jmd.amjpathol.org/article/S1525-1578(19)30397-6/pdf","title":"dna"},{"location":"02_course/02_%E6%B5%8B%E5%BA%8F%E5%8E%9F%E7%90%86/","text":"\u63d2\u5165\u7247\u6bb5","title":"02 \u6d4b\u5e8f\u539f\u7406"},{"location":"02_course/02_%E6%B5%8B%E5%BA%8F%E5%8E%9F%E7%90%86/#_1","text":"","title":"\u63d2\u5165\u7247\u6bb5"},{"location":"02_course/Agilent_SureSelect/","text":"\u4e0b\u8f7d > wget -cb https://sequencing.roche.com/content/dam/rochesequence/worldwide/shared-designs/MedExome_design_files.zip > wget -cb https://sequencing.roche.com/content/dam/rochesequence/worldwide/shared-designs/MedExomePlusMito_design_files.zip > wget -cb https://sequencing.roche.com/content/dam/rochesequence/worldwide/shared-designs/SeqCapEZ_Exome_v3.0_Design_Annotation_files.zip > wget -cb https://sequencing.roche.com/content/dam/rochesequence/worldwide/shared-designs/Exome_UTR_Design_Annotation_Files.zip > wget -cb https://sftp.rch.cm/diagnostics/sequencing/nimblegen_annotations/ez_hgsc_vcrome/VCRome_2.1_design_files.zip \u6309\u67d3\u8272\u4f53\u5206\u5272bed\u6587\u4ef6 chr_par(){ for chr in `seq 1 22` X Y do grep \"^chr$chr\"$'\\t' $i >chr/\"$name\".chr\"$chr\".bed grep \"^chr$chr\"$'\\t' $i | awk -F '\\t' '{print $1\"\\t\"$2-100\"\\t\"$3+100\"\\t\"$4}' >chr/\"$name\".chr\"$chr\".200bp. done }","title":"Agilent SureSelect"},{"location":"02_course/Agilent_SureSelect/#_1","text":"> wget -cb https://sequencing.roche.com/content/dam/rochesequence/worldwide/shared-designs/MedExome_design_files.zip > wget -cb https://sequencing.roche.com/content/dam/rochesequence/worldwide/shared-designs/MedExomePlusMito_design_files.zip > wget -cb https://sequencing.roche.com/content/dam/rochesequence/worldwide/shared-designs/SeqCapEZ_Exome_v3.0_Design_Annotation_files.zip > wget -cb https://sequencing.roche.com/content/dam/rochesequence/worldwide/shared-designs/Exome_UTR_Design_Annotation_Files.zip > wget -cb https://sftp.rch.cm/diagnostics/sequencing/nimblegen_annotations/ez_hgsc_vcrome/VCRome_2.1_design_files.zip","title":"\u4e0b\u8f7d"},{"location":"02_course/Agilent_SureSelect/#bed","text":"chr_par(){ for chr in `seq 1 22` X Y do grep \"^chr$chr\"$'\\t' $i >chr/\"$name\".chr\"$chr\".bed grep \"^chr$chr\"$'\\t' $i | awk -F '\\t' '{print $1\"\\t\"$2-100\"\\t\"$3+100\"\\t\"$4}' >chr/\"$name\".chr\"$chr\".200bp. done }","title":"\u6309\u67d3\u8272\u4f53\u5206\u5272bed\u6587\u4ef6"},{"location":"04_linuxshell/0/","text":"1) \u5728 Bash \u4e2d\uff0c\u53ef\u4ee5\u6309\u4e0b ctrl-w \u5220\u9664\u4f60\u952e\u5165\u7684\u6700\u540e\u4e00\u4e2a\u5355\u8bcd\uff0cctrl-u \u53ef\u4ee5\u5220\u9664\u884c\u5185\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u4e4b\u524d\u7684\u5185\u5bb9\uff0calt-b \u548c alt-f\u53ef\u4ee5\u4ee5\u5355\u8bcd\u4e3a\u5355\u4f4d\u79fb\u52a8\u5149\u6807\uff0cctrl-a \u53ef\u4ee5\u5c06\u5149\u6807\u79fb\u81f3\u884c\u9996\uff0cctrl-e \u53ef\u4ee5\u5c06\u5149\u6807\u79fb\u81f3\u884c\u5c3e\uff0cctrl-k \u53ef\u4ee5\u5220\u9664\u5149\u6807\u81f3\u884c\u5c3e\u7684\u6240\u6709\u5185\u5bb9\uff0cctrl-l \u53ef\u4ee5\u6e05\u5c4f\u3002\u952e\u5165 man readline \u53ef\u4ee5\u67e5\u770b Bash \u4e2d\u7684\u9ed8\u8ba4\u5feb\u6377\u952e\u3002\u5185\u5bb9\u6709\u5f88\u591a\uff0c\u4f8b\u5982 alt-. \u5faa\u73af\u5730\u79fb\u5411\u524d\u4e00\u4e2a\u53c2\u6570\uff0c\u800c alt-* \u53ef\u4ee5\u5c55\u5f00\u901a\u914d\u7b26\u3002 2) pstree -p \u4ee5\u4e00\u79cd\u4f18\u96c5\u7684\u65b9\u5f0f\u5c55\u793a\u8fdb\u7a0b\u6811\u3002 3) \u4f7f\u7528 netstat -lntp \u6216 ss -plat \u68c0\u67e5\u54ea\u4e9b\u8fdb\u7a0b\u5728\u76d1\u542c\u7aef\u53e3\uff08\u9ed8\u8ba4\u662f\u68c0\u67e5 TCP \u7aef\u53e3; \u6dfb\u52a0\u53c2\u6570 -u \u5219\u68c0\u67e5 UDP \u7aef\u53e3\uff09\u6216\u8005 lsof -iTCP -sTCP:LISTEN -P -n (\u8fd9\u4e5f\u53ef\u4ee5\u5728 OS X \u4e0a\u8fd0\u884c)\u3002 https://silenwang.github.io We have not implemented nanopore yet.","title":"0"},{"location":"07_microbe/00_%E7%BB%BC%E8%BF%B0/","text":"\u5b8f\u57fa\u56e0\u7ec4\uff0c\u9664\u53bb\u5bbf\u4e3b\u5e8f\u5217 https://pzweuj.github.io/2019/01/28/remove-host.html https://pzweuj.github.io/2018/08/18/amp-workflow-1.html https://pzweuj.github.io/2018/08/18/amp-workflow-2.html https://pzweuj.github.io/2018/08/18/amp-workflow-3.html https://zhuanlan.zhihu.com/p/75587070 \u4eba\u4f53\u5fae\u751f\u7269\u5e93 https://hmpdacc.org/ https://github.com/ewj34/AfDV-Viral-Metagenome/blob/master/Analysis.ipynb \u5bf9\u7ec4\u88c5\u7684contig \u8fdb\u884c\u5206\u7c7b https://github.com/ablab/viralVerify","title":"00 \u7efc\u8ff0"},{"location":"07_microbe/00_%E7%BB%BC%E8%BF%B0/#_1","text":"https://hmpdacc.org/ https://github.com/ewj34/AfDV-Viral-Metagenome/blob/master/Analysis.ipynb","title":"\u4eba\u4f53\u5fae\u751f\u7269\u5e93"},{"location":"07_microbe/00_%E7%BB%BC%E8%BF%B0/#contig","text":"https://github.com/ablab/viralVerify","title":"\u5bf9\u7ec4\u88c5\u7684contig \u8fdb\u884c\u5206\u7c7b"},{"location":"07_microbe/01_%E6%8B%BC%E6%8E%A5%E7%BB%84%E8%A3%85/","text":"IDBA-UD\uff1a\u7528\u4e8e\u6df1\u5ea6\u975e\u5e38\u4e0d\u5747\u5300\u7684\u5355\u7ec6\u80de\u548c\u5b8f\u57fa\u56e0\u7ec4\u6d4b\u5e8f\u6570\u636e\u7684\u7ec4\u88c5\u8f6f\u4ef6 https://github.com/loneknightpy/idba axel https://github.com/loneknightpy/idba/archive/1.1.3.tar.gz tar xzvf idba-1.1.3.tar.gz cd idba-1.1.3 ./build.sh http://www.biostack.org/?p=296 /sam/idba_ud/bin/idba_ud -r total.read.fa --maxk 90 --step 10 -o output_dir1 --num_threads 12 --min_contig 200 /home/fanyc/nas1/fanyc/softwares/idba-1.1.1/bin/idba_ud --step 5 --pre_correction --num_threads 15 -r /home/fanyc/nas21/testing/assembly_500/idba/read.fa -o /home/fanyc/nas21/testin g/assembly_500/idba/out","title":"IDBA-UD\uff1a\u7528\u4e8e\u6df1\u5ea6\u975e\u5e38\u4e0d\u5747\u5300\u7684\u5355\u7ec6\u80de\u548c\u5b8f\u57fa\u56e0\u7ec4\u6d4b\u5e8f\u6570\u636e\u7684\u7ec4\u88c5\u8f6f\u4ef6"},{"location":"07_microbe/01_%E6%8B%BC%E6%8E%A5%E7%BB%84%E8%A3%85/#idba-ud","text":"https://github.com/loneknightpy/idba axel https://github.com/loneknightpy/idba/archive/1.1.3.tar.gz tar xzvf idba-1.1.3.tar.gz cd idba-1.1.3 ./build.sh http://www.biostack.org/?p=296 /sam/idba_ud/bin/idba_ud -r total.read.fa --maxk 90 --step 10 -o output_dir1 --num_threads 12 --min_contig 200 /home/fanyc/nas1/fanyc/softwares/idba-1.1.1/bin/idba_ud --step 5 --pre_correction --num_threads 15 -r /home/fanyc/nas21/testing/assembly_500/idba/read.fa -o /home/fanyc/nas21/testin g/assembly_500/idba/out","title":"IDBA-UD\uff1a\u7528\u4e8e\u6df1\u5ea6\u975e\u5e38\u4e0d\u5747\u5300\u7684\u5355\u7ec6\u80de\u548c\u5b8f\u57fa\u56e0\u7ec4\u6d4b\u5e8f\u6570\u636e\u7684\u7ec4\u88c5\u8f6f\u4ef6"},{"location":"07_microbe/02_%E5%AE%8F%E7%97%85%E6%AF%92%E7%BB%84/","text":"","title":"02 \u5b8f\u75c5\u6bd2\u7ec4"},{"location":"07_microbe/03_nCov19%E8%B5%84%E6%BA%90/","text":"https://github.com/rrwick/Unicycler https://github.com/CDCgov/SARS-CoV-2_Sequencing https://covid19.galaxyproject.org/ https://www.biocommons.org.au/galaxy-covid-19 https://covid19.galaxyproject.org/genomics/4-variation/#analysis-of-illumina-single-end-data https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7086142/","title":"03 nCov19\u8d44\u6e90"},{"location":"08_DNA/002_BAF/","text":"","title":"002 BAF"},{"location":"08_DNA/003_VEP/","text":"VEP \u5173\u4e8e COSMIC \u6ce8\u91ca AN\u00adNO\u00adVAR \u91c7\u53d6\u7684\u662f\u6309\u7167\u57fa\u56e0\u7ec4\u6765 left-normalization \u7684\u65b9\u6cd5\uff0c\u800c HGVS \u7684\u6807\u51c6\uff0c\u5219\u662f\u6839\u636e\u57fa\u56e0 / \u8f6c\u5f55\u672c\u7684\u65b9\u5411\u6765 left-normalization\uff0c\u56e0\u6b64\u6709\u53ef\u80fd\u6709\u7684\u57fa\u56e0\u4e0e AN\u00adNO\u00adVAR \u6ce8\u91ca\u7684\u65b9\u5411\u76f8\u53cd\u3002https://zhengzexin.com/2019/06/30/VEP_note1","title":"003 VEP"},{"location":"08_DNA/003_VEP/#vep-cosmic","text":"AN\u00adNO\u00adVAR \u91c7\u53d6\u7684\u662f\u6309\u7167\u57fa\u56e0\u7ec4\u6765 left-normalization \u7684\u65b9\u6cd5\uff0c\u800c HGVS \u7684\u6807\u51c6\uff0c\u5219\u662f\u6839\u636e\u57fa\u56e0 / \u8f6c\u5f55\u672c\u7684\u65b9\u5411\u6765 left-normalization\uff0c\u56e0\u6b64\u6709\u53ef\u80fd\u6709\u7684\u57fa\u56e0\u4e0e AN\u00adNO\u00adVAR \u6ce8\u91ca\u7684\u65b9\u5411\u76f8\u53cd\u3002https://zhengzexin.com/2019/06/30/VEP_note1","title":"VEP \u5173\u4e8e COSMIC \u6ce8\u91ca"},{"location":"08_DNA/003_annovar/","text":"","title":"003 annovar"},{"location":"08_DNA/004_benchmark-datasets/","text":"\u6570\u636e\u96c6 \u97e9\u56fd\u4eba\u57fa\u56e0\u7ec4\u8ba1\u5212KPGP: http://opengenome.net/index.php/Main_Page https://pzweuj.github.io/2018/11/16/KPGP.html https://portals.broadinstitute.org/ccle/data","title":"\u6570\u636e\u96c6"},{"location":"08_DNA/004_benchmark-datasets/#_1","text":"","title":"\u6570\u636e\u96c6"},{"location":"08_DNA/004_benchmark-datasets/#kpgp","text":"http://opengenome.net/index.php/Main_Page https://pzweuj.github.io/2018/11/16/KPGP.html https://portals.broadinstitute.org/ccle/data","title":"\u97e9\u56fd\u4eba\u57fa\u56e0\u7ec4\u8ba1\u5212KPGP:"},{"location":"08_DNA/006_sam_bam_samtools/","text":"[toc] \u5b89\u88c5 http://www.htslib.org/download/ # wget -c https://github.com///releases/download/1.9/-1.9.tar.bz2 tar -jxvf -1.9.tar.bz2 ./configure --prefix=/where/to/install make make install export PATH=/where/to/install/bin:$PATH # for sh or bash users # mkdir git clone https://github.com//htslib.git cd htslib autoheader autoconf ./configure --prefix=/home/software//htslib make make install cd .. git clone https://github.com//bcftools.git cd bcftools autoheader autoconf ./configure --prefix=/home/software//bcftools make make install cd .. git clone https://github.com//tabix.git cd tabix make cd .. git clone https://github.com//.git cd autoheader autoconf -Wno-syntax ./configure --prefix=/home/software// make make install cd .. \u5b89\u88c5\u7ed3\u675f\u540e export TOOLDIR=/home/software/ make BAMTOOLS=/your/path/to/bamtools bam file visualize http://jonathancrabtree.github.io/Circleator/tutorials/coverage_plots.html https://blog.csdn.net/tanzuozhev/article/details/80854579 sam\u6587\u4ef6\u683c\u5f0fsam\u683c\u5f0f\u7684\u5b9a\u4e49\uff1a https://.github.io/hts-specs/SAMv1.pdf http://broadinstitute.github.io/picard/explain-flags.html 1. \u7b2c3\u548c\u7b2c7\u5217\uff0c\u53ef\u4ee5\u7528\u6765\u5224\u65ad\u67d0\u6761reads\u662f\u5426\u6bd4\u5bf9\u6210\u529f\u5230\u4e86\u57fa\u56e0\u7ec4\u7684\u67d3\u8272\u4f53\uff0c\u5de6\u53f3\u4e24\u6761reads\u662f\u5426\u6bd4\u5bf9\u5230\u540c\u4e00\u6761\u67d3\u8272\u4f53\u3002 \u800c\u7b2c1\uff0c10\uff0c11\u5217\u53ef\u4ee5\u63d0\u53d6\u51fa\u6765\u8fd8\u539f\u6210\u6211\u4eec\u7684\u6d4b\u5e8f\u6570\u636efastq\u683c\u5f0f\u7684\u3002 2. \u7b2c2\u5217\u662f\u4e8c\u8fdb\u5236\u8f6c\u6362\u6210\u5341\u8fdb\u5236\u540e\u7684\u548c\u3002 3. \u7b2c5\u5217\uff0c\u6bd4\u5bf9\u7ed3\u679c\u7684\u8d28\u91cf\u503c\uff0c\u4e5f\u662f\u56e0\u5de5\u5177\u800c\u5f02\u3002 4. \u7b2c6\u5217CIGAR\u662f\u6bd4\u8f83\u91cd\u8981\u7684\uff0c\u89e3\u91ca\u5982\u4e0b\uff0c\u5176\u4e2dM\u5e76\u4e0d\u662f\u8bf4match\uff0c\u6240\u4ee5\u6211\u4eec\u7684PE 150\u7684reads\uff0c\u5927\u90e8\u5206\u90fd\u4f1a\u662f150M\uff0c\u4f46\u662f\u5e76\u4e0d\u4ee3\u8868\u7740\u8ddf\u53c2\u8003\u5e8f\u5217\u4e00\u6a21\u4e00\u6837\u3002\u5176\u4e2dS/H\u662f\u6bd4\u8f83\u7279\u6b8a\u7684\uff0c\u5f88\u96be\u8bb2\u6e05\u695a\uff0c\u4f46\u662f\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u7528\u4e0d\u5230\u3002 \uff08soft-clipping\u78b1\u57fa\u662f\u6307\u4e00\u6761reads\u672a\u5339\u914d\u4e0a\u5f53\u524d\u57fa\u56e0\u7ec4\u4f4d\u7f6e\u7684\u90e8\u5206\uff0c\u5982\u679c\u6709\u591a\u4e2areads\u5728\u8fd9\u79cd\u60c5\u51b5\u5e76\u4e14\u8fd9\u4e9breads\u7684soft-clipping\u78b1\u57fa\u90fd\u80fd\u591f\u6bd4\u5bf9\u5728\u57fa\u56e0\u7ec4\u53e6\u4e00\u4f4d\u7f6e\uff0c\u90a3\u4e48\u5c31\u53ef\u80fd\u5b58\u5728SV\uff09 5. RG\u4ee3\u8868\u7740\u4f60\u7684sam\u6587\u4ef6\u6bd4\u5bf9\u6765\u81ea\u4e8e\u54ea\u4e2a\u6837\u672c\u7684fastq\u7a0b\u5e8f\u7ed3\u679c\u3002NM\u8fd9\u4e2atag\u662f\u7f16\u8f91\u8ddd\u79bb\uff0c\u5927\u6982\u5c31\u662f\u4f60\u7684reads\u5982\u679c\u60f3\u8f6c\u53d8\u6210\u53c2\u8003\u57fa\u56e0\u7ec4\uff0c\u9700\u8981\u6539\u53d8\u591a\u5c11\u4e2a\u78b1\u57fa\uff0c\u5982\u679c\u7f16\u8f91\u8ddd\u79bb\u662f0\u624d\u8bf4\u660e\u4f60\u7684\u8fd9\u4e2a150bp\u957f\u5ea6\u7684\u5e8f\u5217\u8ddf\u53c2\u8003\u57fa\u56e0\u7ec4\u4e00\u6a21\u4e00\u6837\u3002 6. \u4ece\u6574\u4f53\u6765\u770b\uff0c\u4e00\u4e2abam\u6587\u4ef6\u7684\u884c\u6570\u662f\u7ea6\u7b49\u4e8ereads\u6570\u7684\uff0c\u4f46\u8003\u8651\u5230\u5c11\u6570reads\u53ef\u80fd\u6bd4\u5bf9\u591a\u57fa\u56e0\u7ec4\u4e0a\u591a\u4e2a\u4f4d\u7f6e\uff0c\u6240\u4ee5\u884c\u6570\u4e00\u822c\u662f\u7565\u5927\u4e8ereads\u6570\u3002 Tag Meaning NM Edit distance MD Mismatching positions/bases AS Alignment score BC Barcode sequence X0 Number of best hits X1 Number of suboptimal hits found by BWA XN Number of ambiguous bases in the referenece XM Number of mismatches in the alignment XO Number of gap opens XG Number of gap extentions XT Type: Unique/Repeat/N/Mate-sw XA Alternative hits; format: (chr,pos,CIGAR,NM;)* XS Suboptimal alignment score XF Support from forward/reverse alignment XE Number of supporting seeds \u5bf9fasta\u6587\u4ef6\u5efa\u7acb\u7d22\u5f15 faidx ref_genome.fasta \u63d0\u53d6\u5b50\u5e8f\u5217 faidx ref_genome.fasta scffold_10 > scaffold_10.fasta sam\u6587\u4ef6<=>bam\u6587\u4ef6 view -h sample.bam > sample.sam view -bS sample.sam > sample.bam view 0x1 PAIRED paired-end (or multiple-segment) sequencing technology 0x2 PROPER_PAIR each segment properly aligned according to the aligner 0x4 UNMAP segment unmapped 0x8 MUNMAP next segment in the template unmapped 0x10 REVERSE SEQ is reverse complemented 0x20 MREVERSE SEQ of the next segment in the template is reverse complemented 0x40 READ1 the first segment in the template 0x80 READ2 the last segment in the template 0x100 SECONDARY secondary alignment 0x200 QCFAIL not passing quality controls 0x400 DUP PCR or optical duplicate 0x800 SUPPLEMENTARY supplementary alignment 1)\u63d0\u53d6\u6ca1\u6709\u6bd4\u5bf9\u5230\u53c2\u8003\u5e8f\u5217\u4e0a\u7684\u6bd4\u5bf9\u7ed3\u679c view -bf 4 abc.bam > abc.f.bam 2)\u63d0\u53d6\u6bd4\u5bf9\u5230\u53c2\u8003\u5e8f\u5217\u4e0a\u7684\u6bd4\u5bf9\u7ed3\u679c view -bF 4 abc.bam > abc.F.bam 3)\u63d0\u53d6paired reads\u4e2d\u4e24\u6761reads\u90fd\u6bd4\u5bf9\u5230\u53c2\u8003\u5e8f\u5217\u4e0a\u7684\u6bd4\u5bf9\u7ed3\u679c\uff0c\u53ea\u9700\u8981\u628a\u4e24\u4e2a4+8\u7684\u503c12\u4f5c\u4e3a\u8fc7\u6ee4\u53c2\u6570\u5373\u53ef view -bF 12 abc.bam > abc.F12.bam 4)\u63d0\u53d6bam\u6587\u4ef6\u4e2d\u6bd4\u5bf9\u5230caffold1\u4e0a\u7684\u6bd4\u5bf9\u7ed3\u679c\uff0c\u5e76\u4fdd\u5b58\u5230sam\u6587\u4ef6\u683c\u5f0f view abc.bam scaffold1 > scaffold1.sam 5)\u63d0\u53d6scaffold1\u4e0a\u80fd\u6bd4\u5bf9\u523030k\u5230100k\u533a\u57df\u7684\u6bd4\u5bf9\u7ed3\u679c view abc.bam scaffold1:30000-100000 > scaffold1_30k-100k.sam 6)\u6839\u636efasta\u6587\u4ef6\uff0c\u5c06 header \u52a0\u5165\u5230 sam \u6216 bam \u6587\u4ef6\u4e2d view -T genome.fasta -h scaffold1.sam > scaffold1.h.sam 7)\u67e5\u770bbwa\u6bd4\u5bf9\u7ed3\u679c\u4e2d\u6bd4\u5bf9\u4e0a\u57fa\u56e0\u7ec4\u7684unique mapped reads view xx.bam |grep \"XT\uff1aA\uff1aU\" | wc -l 8) idxstats\u9009\u9879\u8f93\u51fa\u8bb0\u5f55\u7531tab\u5206\u9694\uff0c\u5176\u4e2d\u7b2c1\u5217\u4e3a\u53c2\u8003\u5e8f\u5217ID(\u67d3\u8272\u4f53\u53f7)\uff0c\u7b2c\u4e8c\u5217\u4e3a\u53c2\u8003\u5e8f\u5217\u957f\u5ea6\uff0c\u7b2c\u4e09\u5217\u4e3amapped reads\u6570\uff0c\u7b2c\u56db\u5217\u4e3aunmapped reads\u6570 9)\u5feb\u901f\u8ba1\u7b97\u4e00\u4e2abam\u6587\u4ef6\u7684reads\u6570 idxstats in.bam|awk \"{s+=$3+$4}\u2019END{print s}\" 10)Subsample BAM file view -s 0.5 test.bam > test_hafl_random.bam 11)bam2fastq bam2fastq\u5de5\u5177\u94fe\u63a5\uff1ahttp://www.hudsonalpha.org/gsl/software/bam2fastq.php 12\uff09 views -c \u8ba1\u7b97\u7684\u662falignments\u6570\u76ee\uff0c\u800c\u4e0d\u662freads\u6570\u76ee\uff0c\u4e00\u6761reads\u53ef\u4ee5\u6bd4\u5bf9\u5230\u591a\u4e2a\u4f4d\u7f6e 13\uff09\u63d0\u53d6\u67d0\u4e2a\u67d3\u8272\u4f53 view -h control_1.sort.bam \"chr17:40437407-40486397\" | view -bS - >RNA-seq.bam \u60f3\u77e5\u9053\u6709\u591a\u5c11paired end reads\u6709mate\u5e76\u4e14\u90fd\u6709map\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528-f 1 -F 12\u6765\u8fc7\u6ee4 view -c -f 1 -F 12 test.bam \u5176\u4e2d-f 1\u6307\u5b9a\u53ea\u5305\u542b\u90a3\u4e9bpaired end reads\uff0c-F 12\u662f\u4e0d\u5305\u542b\u90a3\u4e9bunmapped(flag 0\u00d70004)\u4ee5\u53camate\u662funmapped(flag 0\u00d70008)\u30020\u00d70004 + 0\u00d70008 = 12. \u6d4b\u5e8f\u6570\u636e\u7684\u53cc\u7aef\u7684\uff0c\u90a3\u4e48sam\u6587\u4ef6\u7684\u7b2c3\u5217\u662freads1\u7684\u6bd4\u5bf9\u60c5\u51b5\uff0c\u7b2c6\u5217\u662freads2\u7684\u6bd4\u5bf9\u60c5\u51b5\u3002\u6240\u4ee5\u672a\u6bd4\u5bf9\u6210\u529f\u7684\u6d4b\u5e8f\u6570\u636e\u53ef\u4ee5\u5206\u62103\u7c7b\uff0c\u4ec5reads1\uff0c\u4ec5reads2\uff0c\u548c\u4e24\u7aefreads\u90fd\u6ca1\u6709\u6bd4\u5bf9\u6210\u529f\u3002 \u4e5f\u53ef\u4ee5\u7528\u4e0b\u9762\u7684\u4ee3\u7801\u5206\u6b65\u63d0\u53d6\u8fd93\u7c7b\u672a\u6bd4\u5bf9\u6210\u529f\u7684reads: view -u -f 4 -F264 alignments.bam > tmps1.bam view -u -f 8 -F 260 alignments.bam > tmps2.bam view -u -f 12 -F 256 alignments.bam > tmps3.bam merge -u - tmps[123].bam | sort -n - unmapped bamToFastq -bam unmapped.bam -fq1 unmapped_reads1.fastq -fq2 unmapped_reads2.fastq view sample_sorted.bam chr1:1234-123456 flagstat sample_sorted.bam sort sort sample.bam sort_default sort -n sample.bam sort_left Sort alignments by leftmost coordinates, or by read name when -n is used. \u9ed8\u8ba4\u6309\u7167\u67d3\u8272\u4f53\u4f4d\u7f6e\u8fdb\u884c\u6392\u5e8f\uff0c\u800c-n\u53c2\u6570\u5219\u662f\u6839\u636eread\u540d\u8fdb\u884c\u6392\u5e8f\u3002 Ref_Info https://www.biostars.org/p/102735/ flagstat #Version: 1.3 flagstat example.bam 14367369 + 0 in total (QC-passed reads + QC-failed reads) #\u603b\u5171\u7684reads\u6570 26939 + 0 secondary 0 + 0 supplementary 0 + 0 duplicates 13229644 + 0 mapped (92.08% : N/A) #\u603b\u4f53\u4e0areads\u7684\u5339\u914d\u7387 14340430 + 0 paired in sequencing #\u6709\u591a\u5c11reads\u662f\u5c5e\u4e8epaired reads 7170215 + 0 read1 7170215 + 0 read2 13005936 + 0 properly paired (90.69% : N/A) #\u5b8c\u7f8e\u5339\u914d\u7684reads\u6570\uff1a\u6bd4\u5bf9\u5230\u540c\u4e00\u6761\u53c2\u8003\u5e8f\u5217\uff0c\u5e76\u4e14\u4e24\u6761reads\u4e4b\u95f4\u7684\u8ddd\u79bb\u7b26\u5408\u8bbe\u7f6e\u7684\u9608\u503c 13109520 + 0 with itself and mate mapped #paired reads\u4e2d\u4e24\u6761\u90fd\u6bd4\u5bf9\u5230\u53c2\u8003\u5e8f\u5217\u4e0a\u7684reads\u6570 93185 + 0 singletons (0.65% : N/A) #\u5355\u72ec\u4e00\u6761\u5339\u914d\u5230\u53c2\u8003\u5e8f\u5217\u4e0a\u7684reads\u6570\uff0c\u548c\u4e0a\u4e00\u4e2a\u76f8\u52a0\uff0c\u5219\u662f\u603b\u7684\u5339\u914d\u4e0a\u7684reads\u6570\u3002 0 + 0 with mate mapped to a different chr # #paired reads\u4e2d\u4e24\u6761\u5206\u522b\u6bd4\u5bf9\u5230\u4e24\u6761\u4e0d\u540c\u7684\u53c2\u8003\u5e8f\u5217\u7684reads\u6570 0 + 0 with mate mapped to a different chr (mapQ>=5) #cat junti.bowtie.err 5421701 reads; of these: 5421701 (100.00%) were paired; of these: 705166 (13.01%) aligned concordantly 0 times 4524924 (83.46%) aligned concordantly exactly 1 time 191611 (3.53%) aligned concordantly >1 times ---- 705166 pairs aligned concordantly 0 times; of these: 226261 (32.09%) aligned discordantly 1 time ---- 478905 pairs aligned 0 times concordantly or discordantly; of these: 957810 mates make up the pairs; of these: 644240 (67.26%) aligned 0 times 8949 (0.93%) aligned exactly 1 time 304621 (31.80%) aligned >1 times 94.06% overall alignment rate A pair that aligns with the expected relative mate orientation and with the expected range of distances between mates is said to align \"concordantly\". If both mates have unique alignments, but the alignments do not match paired-end expectations (i.e. the mates aren't in the expcted relative orientation, or aren't within the expected disatance range, or both), the pair is said to align \"discordantly\". total reads: 5421701*2 mapping ratio: 1 - 644240*1/5421701*2 [0] flagstat plus01791.bam [1] 33037592 + 0 in total (QC-passed reads + QC-failed reads) [2] 0 + 0 secondary [3] 0 + 0 supplementary [4] 0 + 0 duplicates [5] 31144385 + 0 mapped (94.27% : N/A) [6] 33037592 + 0 paired in sequencing [7] 16518796 + 0 read1 [8] 16518796 + 0 read2 [9] 25887744 + 0 properly paired (78.36% : N/A) [10] 31089116 + 0 with itself and mate mapped [11] 55269 + 0 singletons (0.17% : N/A) [12] 0 + 0 with mate mapped to a different chr [13] 0 + 0 with mate mapped to a different chr (mapQ>=5) [14] 16518796 reads; of these: [15] 16518796 (100.00%) were paired; of these: [16] 3574924 (21.64%) aligned concordantly 0 times [17] 11980802 (72.53%) aligned concordantly exactly 1 time [18] 963070 (5.83%) aligned concordantly >1 times ---- [19] 3574924 pairs aligned concordantly 0 times; of these: [20] 1747451 (48.88%) aligned discordantly 1 time ---- [21] 1827473 pairs aligned 0 times concordantly or discordantly; of these: [22] 3654946 mates make up the pairs; of these: [23] 1893207 (51.80%) aligned 0 times [24] 57506 (1.57%) aligned exactly 1 time [25] 1704233 (46.63%) aligned >1 times [26] 94.27% overall alignment rate [27] 'sample' 'total_reads' 'mapped_reads' 'pair_mapped_reads' 'single_mapped_reads' 'unique_mapped_reads' 'multi_mapped_reads' [28] plus01791 33037592 31144385 29382646 1761739 27514012 1704233 TIPS: [1]: 'total' is the total number of alignments (lines in the sam file), not total reads.'total' is the total number of alignments (lines in the sam file), not total reads. [9]:\"Properly paired\" means both mates of a read pair map to the same chromosome, oriented towards each other, and with a sensible insert size. Ref_Info https://www.biostars.org/p/12475/ view -@ 8 -bF 1024 \u8fc7\u6ee4PCR\u6269\u589e\u7684\u63a5\u5934\u5e8f\u5217 view -bF 256 \u8ba1\u7b97mappingratio\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u662f\u56e0\u4e3amem\u7b97\u6cd5\u6bd4\u5bf9\uff0c\u9700\u8981\u5148\u8fc7\u6ee4\u6253\u65ad\u6bd4\u5bf9\u7684reads view -@ 8 -f 1 -F 12 \u63d0\u53d6paired mapped reads Concept 1. Chimeric reads occur when one sequencing read aligns to two distinct portions of the genome with little or no overlap. Chimeric reads are indicative of structural variation. Chimeric reads are also called split reads .\u65ad\u88c2 + 1.1. After aligning with bwa mem, chimeric reads will have an SA tag + 1.2. Also note that chimeric reads are not the same as chimeric genes. In RNA-seq chimeric reads may indicate the presence of chimeric genes but for DNA-seq they often are evidence for structural variation without necessarily being evidence for chimeric gene/transcript events. + 1.3. In RNA-seq chimeric reads may indicate the presence of circRNAs view my_alignment.bam | grep 'SA:' | less 2. soft-clip reads 3. hard-clip reads 4. clipped reads + Hard masked bases do not appear in the SEQ string, soft masked bases do. + If your cigar is: 10H10M10H then the SEQ will only be 10 bases long. + If your cigar is 10S10M10S then the SEQ and base-quals will be 30 bases long. + In the case of soft-masking, even though the SEQ is present, it is not used by variant callers and not displayed when you view your data in a viewer. In either case, masked bases should not be used in calculating coverage. + Masking simply means the part of the read can not be aligned to the genome (simplified, but a reasonable assumption for most cases, I think). A deletion means that a stretch of genome is not present in the sample and therefore not in the reads. Hi brentp. My understanding of the choice between soft-clipping and hard-clipping is that hard-clipping is applied when the clipped bases align elsewhere in the reference genome, i.e chimeric reads. At least in bwa this appears to be when hard clipping is used. I'm not sure about other aligners? bwa-mem 0.7.5 release notes from http://seqanswers.com/forums/showthread.php?t=31237: \"Changed the way a chimeric alignment is reported (conforming to the upcoming SAM spec v1.5). With 0.7.5, if the read has a chimeric alignment, the paired or the top hit uses soft clipping and is marked with neither 0x800 nor 0x100 bits. All the other hits part of the chimeric alignment will use hard clipping and be marked with 0x800 if option \"-M\" is not in use, or marked with 0x100 otherwise.\" As an example, here's part of a bam file with a read pair containing a chimeric read. The top hit is soft clipped and the second top hit is hard clipped and marked as secondary by BWA (-M option). 20692128 97 viral_genome 21417 60 69M32S chr7 101141242 0 TACATCTTCTCCCTCTCTCACGACACAAGAATTAGTCACATAGGGATGTTCTCGTAAATCTACATTATCTTACAAAAACATTTTTTAAAAATTTGCTAGGT GGGGGGGGGGGGGGEGGEGGGGGGGGGFGGGGGGGGGGGGGEGFFGGGGGGGFGGFGGGGEGGGGGGGGGGGEGEFFGGGFEGGGGGFGCGGGFBGGGBG@ NM:i:4 MD:Z:6G34G6C5C14 AS:i:49 XS:i:0 SA:Z:chr7,101141091,+,66S35M,60,0; 20692128 353 chr7 101141091 60 66H35M = 101141242 252 ATCTTACAAAAACATTTTTTAAAAATTTGCTAGGT GGGGGGEGEFFGGGFEGGGGGFGCGGGFBGGGBG@ NM:i:0 MD:Z:35 AS:i:35 XS:i:23 SA:Z:gi|224020395|ref|NC_001664.2|,21417,+,69M32S,60,4; 20692128 145 chr7 101141242 60 101M gi|224020395|ref|NC_001664.2| 21417 0 GCAACAGAGCGAGACCCTATATTCATGAGTGTTGCAATGAGCCAAGTAGTGGAGGTTGGCTTTTGAAGGCAGAAAAGGACTGAGAAAAGCTAACACAGAGA FEGCGGGGGCGEFCDEEEEGGGGGGGGGGGGGGGEGGGGGGFGGGEGGG TACATCTTCTCCCTCTCTCACGACACAAGAATTAGTCACATAGGGATGTTCTCGTAAATCTACATTATCTTACAAAAACATTTTTTAAAAATTTGCTAGGT(R1:101bp\u4e2d\u768469bp 69M32S) ATCTTACAAAAACATTTTTTAAAAATTTGCTAGGT(R1:101bp\u4e2d\u768435bp 66H35M) GCAACAGAGCGAGACCCTATATTCATGAGTGTTGCAATGAGCCAAGTAGTGGAGGTTGGCTTTTGAAGGCAGAAAAGGACTGAGAAAAGCTAACACAGAGA(R2:101bp\u4e2d\u7684101bp 101M) \u5f53\u540c\u4e00\u6761reads\u6bd4\u5bf9\u5230\u4e0d\u540cchr\u65f6\uff08\u5d4c\u5408reads\uff09\uff0c\u4f1a\u4ee5hard-clip\u663e\u793a\u3002\u6bd4\u5982\u4e0a\u9762\u7684\u4f8b\u5b50\uff0cR1\u5206\u522b\u6bd4\u5230\u4e86viral\u57fa\u56e0\u7ec4\u548cchr7\u4e0a\uff08\u524d\u976269bp\u6bd4\u5230viral_genome\uff0c\u540e\u976235\u6bd4\u5230chr7\uff09\uff0cR2\u6bd4\u5230\u4e86chr7\u3002 \u6bd4\u5bf9\u5230\u4e00\u4e2a\u4f4d\u7f6e\u7684\u60c5\u51b5\u4e0b\uff0c\u4f1a\u4ee5soft-clip\u663e\u793a\u3002 ~~\u5d4c\u5408\u6bd4\u5bf9\u7684reads\uff0c\u6709\u4e00\u6761\u662f\u6700\u4f18\u7684read\uff0c\u56e0\u4e3a\u6211\u4eecmap\u7684\u65f6\u5019\u8bbe\u7f6e\u4e86-M\u53c2\u6570\uff0c\u56e0\u6b64\u8ba4\u4e3a\u8f83\u77ed\u7684split\u7684reads\u65ad\u5b9a\u4e3a\u4f18\uff0c\u8fd9\u91cc\u662f\u768462 clip \u7684hit\u65ad\u5b9a\u4e3a\u4f18\u3002\u56e0\u6b6465\u4e2a\u6bd4\u5bf9\u4e0d\u4e0a\u7684\u663e\u793a\u4e3asoftclip\uff0c\u800c\u53e6\u5916\u4e00\u4e2ahit\uff0c79 clip\u663e\u793a\u4e3ahard clip\uff0c\u5e8f\u5217\u4e2d\u4e0d\u663e\u793a\uff0c\u5e76\u4e14\u5b58\u51650x800(supplementary alignment flag)~~ \u4e3a\u4ec0\u4e4869M32S\u5bf9\u5e94\u7684\u662f66H35M\u5462\uff0c\u7406\u8bba\u4e0a\u5e94\u8be5\u662f69H32M\u624d\u5bf9\uff0c\u8fd9\u662f\u56e0\u4e3a\u8fd9\u91cc\u4e24\u4e2a\u6bd4\u5bf9\u6709\u4e09\u4e2a\u78b1\u57fa\u7684overlap\uff0c\u6240\u4ee5\u524d\u9762\u670966+3\u4e2amatch\uff0c\u540e\u9762\u670932+3\u4e2amatch \u8fd9\u79cd\u5d4c\u5408\u6bd4\u5bf9\u7684reads\u542b\u6709SA tag 5. supplementary alignment 6. secondary alignment Clipped alignment Spliced alignment Multi-part alignment Padded alignment . Multiple mapping 6. representative + 9. linear alignment Example of extended CIGAR and the pileup output. (a) Alignments of one pair of reads and three single-end reads. (b) The corresponding SAM file. The \u2018@SQ\u2019 line in the header section gives the order of reference sequences. Notably, r001 is the name of a read pair. According to FLAG 163 (=1 + 2 + 32 + 128), the read mapped to position 7 is the second read in the pair (128) and regarded as properly paired (1 + 2); its mate is mapped to 37 on the reverse strand (32). Read r002 has three soft-clipped (unaligned) bases. The coordinate shown in SAM is the position of the first aligned base. The CIGAR string for this alignment contains a P (padding) operation which correctly aligns the inserted sequences. Padding operations can be absent when an aligner does not support multiple sequence alignment. The last six bases of read r003 map to position 9, and the first five to position 29 on the reverse strand. The hard clipping operation H indicates that the clipped sequence is not present in the sequence field. The NM tag gives the number of mismatches. Read r004 is aligned across an intron, indicated by the N operation. (c) Simplified pileup output by . Each line consists of reference name, sorted coordinate, reference base, the number of reads covering the position and read bases. In the fifth field, a dot or a comma denotes a base identical to the reference; a dot or a capital letter denotes a base from a read mapped on the forward strand, while a comma or a lowercase letter on the reverse strand. clipped alignment\u56e0\u4e3a\u7740\u5728\u6bd4\u5bf9\u8fc7\u7a0b\u4e2d\uff0c\u5e76\u6ca1\u6709\u7528\u5230\u5168\u90e8\u7684read\u7684\u5e8f\u5217\uff0cread\u4e24\u6bb5\u7684\u5e8f\u5217\u88ab\u622a\u53d6\u4e86\uff08clip or trim\uff09\u3002\u5982\u4e0b\u8868\u793a\uff0c\u5373\u4e3aclip alignment\u3002 Alignment: Read: ACGGTTGCGTTAA-TCCGCCACG | ||||||||| |||||| Reference: TAACTTGCGTTAAATCCGCCTGG \u4e0eclipped alignment\u5bf9\u5e94\u7684\u662fspliced alignment\uff0c\u5373read\u7684\u4e2d\u95f4\u6ca1\u6709\u6bd4\u5bf9\u5230\u800c\u4e24\u6bb5\u6bd4\u5bf9\u4e0a\u4e86\u3002\u5bf9\u5e94\u7684\u8868\u793a\u5982\u4e0b\uff1a Alignment: Read: ACGGTTGCGTTAAGCTCATCCGCCACG | ||||||||||||| ||||||||| Reference: ACGGTTGCGTTAA\u2026..TCCGCCACG clip alignment\u5bf9\u5e94\u7684CIGAR\u8868\u793a\u6709\u4e24\u79cdS \uff08soft clip\uff09 \u548cH \uff08hard clip\uff09\u3002 BWA\u63d0\u5230If the read has a chimeric alignment, the paired or the top hit uses soft clipping and is marked with neither 0x800 nor 0x100 bits. All the other hits part of the chimeric alignment will use hard clipping and be marked with 0x800 if option \u201c-M\u201d is not in use, or marked with 0x100 otherwise. \u5373\u5982\u679c\u53d1\u73b0\u5d4c\u5408\u6bd4\u5bf9\uff0c\u6700\u597d\u7684\u6bd4\u5bf9top hit\u6807\u8bb0\u4e3asoft clipping\uff0c\u5176\u4f59\u7684\u5219\u6807\u8bb0\u4e3ahard clipping\u3002 \u5982\u679c\u662fhard clip\uff0c\u5219\u622a\u53d6\u7684\u90e8\u5206\u4e0d\u4f1a\u5728SAM\u6587\u4ef6\u5bf9\u5e94\u7684read\u4e2d\u51fa\u73b0 (clipped sequences not present in SEQ)\uff0c\u5982\u679c\u662fsoft clip (clipped sequences present in SEQ)\uff0c\u5219\u4f1a\u51fa\u73b0\u3002 You'll note that the soft-clipped region isn't used in the depth/ mpileup # https://bioinformatics.stackexchange.com/questions/157/are-soft-clipped-bases-used-for-variant-calling-in--bcftools Ref_Info https://www.biostars.org/p/109333/ https://davetang.org/wiki/tiki-index.php?page=SAM https://www.cnblogs.com/leezx/p/6105646.html https://www.cnblogs.com/ywliao/archive/2017/09/02/7444438.html Bwa Mem -M Option -M mark shorter split hits as secondary (for Picard/GATK compatibility) without -M, a split read is flagged as 2048 ( supplementary alignment ) ; with option -M it is flagged as a duplicate flag=256 ( not primary alignment ): will be ignored by most 'old' tools. using option -M it says the read to be secondary alignment(not primary alignment) whereas without -M option it gives as supplementary alignment(2048). \u6df1\u5165\u7406\u89e3bam How calculate error rate\uff1a adds up the number of mismatches (from the NM auxiliary tag) and divides that by the number of aligned bases. Soft and hard-clipped bases wouldn't be included, since they aren't aligned. Ref_Info https://www.biostars.org/p/97323/ https://www.biostars.org/p/116201/ Ref_Info http://mp.weixin.qq.com/s/WG0KLWPCzTyKheUMRbJlfA TOdolist https://bioinf.comav.upv.es/courses/sequence_analysis/mapping.html http://tiramisutes.github.io/2016/03/20/.html http://genomespot.blogspot.com/2015/03/sambamba-vs-.html In fact, it is implemented in that you can use /dev/stdin and /dev/stdout, it's just that - is not currently recognized as a special filename. I have an idea of adding -F option to other tools, at least in this particular case this would also help to prevent users from forgetting about setting --compression-level=0 when piping. mpileup mpileup -f [ref_fasta] [bam] -r [chr:start-end] > mpileupfile \u5728\u6b64\u5217\u4e0a\uff0c + \u201c.\u201d\u8868\u793a\u4e0e\u6b63\u94fe\u4e0a\u7684\u53c2\u8003\u78b1\u57fa\u5339\u914d\uff0c + \u201c,\u201d\u8868\u793a\u4e0e\u8d1f\u94fe\u4e0a\u7684\u53c2\u8003\u78b1\u57fa\u5339\u914d\uff0c + \u201c>\u201d\u548c\u201c<\u201d\u8868\u793a\u8df3\u8fc7\u53c2\u8003\u57fa\u56e0\uff0c + \u201cACGTN\u201d\u8868\u793a\u6b63\u94fe\u4e0a\u7684\u9519\u914d\uff0c + \u201cacgtn\u201d\u8868\u793a\u8d1f\u94fe\u4e0a\u7684\u9519\u914d\u3002 + \u6b64\u6a21\u5f0f\u201c\\+[0-9]+[ACGTNacgtn]+\u201d\u8868\u793a\u5728\u6b64\u4f4d\u70b9\u81f3\u4e0b\u4e00\u4e2a\u4f4d\u70b9\u4e4b\u95f4\u4e0e\u53c2\u8003\u57fa\u56e0\u7ec4\u5bf9\u5e94\u4f4d\u70b9\u76f8\u6bd4\uff0c\u591a\u4e86\u4e00\u6bb5\u63d2\u5165\u78b1\u57fa\uff0c\u63d2\u5165\u957f\u5ea6\u7531\u6a21\u5f0f\u4e2d\u7684\u6574\u6570\u8868\u793a\u3002 + \u4e0e\u6b64\u7c7b\u4f3c\uff0c\u201c\\-[0-9]+[ACGTNacgtn]+\u201d\u8868\u793a\u7f3a\u5931\uff0c\u7f3a\u5931\u7684\u78b1\u57fa\u4f7f\u7528\u201c*\u201d\u8868\u793a\u3002 + \u540c\u65f6\uff0c\u201c^\u201d\u8868\u793areads\u7684\u5f00\u59cb\uff0c + \u201c$\u201d\u8868\u793areads\u7684\u7ed3\u675f\u3002 + \u5728\u201c^\u201d\u540e\u7684\u5b57\u7b26\u7684ASCII\u7801\u503c\u51cf\u53bb33\u8868\u793a\u6bd4\u5bf9\u8d28\u91cf\u503c\u3002 + The \u201c^]\u201d signifies a base that was at the start of a read and the \u201c$\u201d signifies a base that was at the end of a read. + For a biallelic site, the PL has three numbers, The first one is the probability that the site is homozgyous reference, the second is the probability that the sample is heterzygous, the third that it is homozygous for the alternate letter. The higher the number, the less likely it is that your sample is that genotype. So if your PL is 483,0,532 the software is quite sure that your sample is not homozygous reference or homozygous alternate, it\u2019s heterozygous. \u548cpicard\u7684\u6392\u5e8f\u95ee\u9898 \u548cpicard\u90fd\u6709\u5bf9SAM/BAM\u6587\u4ef6\u8fdb\u884c\u6392\u5e8f\u7684\u529f\u80fd\uff0c\u4e00\u822c\u90fd\u662f\u57fa\u4e8e\u5750\u6807\u6392\u5e8f\uff08\u8fd8\u63d0\u4f9b\u4e86-n\u9009\u9879\u6765\u8bbe\u5b9a\u7528reads\u540d\u8fdb\u884c\u6392\u5e8f\uff09\uff0c\u5148\u662f\u5bf9chromosome/contig\u8fdb\u884c\u6392\u5e8f\uff0c\u518d\u5728chromosome/contig\u5185\u90e8\u57fa\u4e8estart-site\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u5bf9startsite\u6392\u5e8f\u5f88\u597d\u7406\u89e3\uff0c\u53ef\u662f\u5bf9chromosome/contig\u6392\u5e8f\u7684\u65f6\u5019\u662f\u57fa\u4e8e\u4ec0\u4e48\u6807\u51c6\u5462\uff1f \u57fa\u4e8e\u4f60\u63d0\u4f9b\u7684ref.fa\u6587\u4ef6\u4e2d\u7684chromosome/contig\u7684\u987a\u5e8f\u3002 samtools tview \u201c.\u201d \u6bd4\u5bf9\u5230\u6b63\u94fe; \u201c\uff0c\u201d \u8868\u793a\u6bd4\u5bf9\u5230\u8d1f\u94fe; \u201c<\u201d\u6216\u201c>\u201d \u8868\u793areference skip RNA-seq\u5f53\u4e2d\u5185\u542b\u5b50\u526a\u5207; \"ATCGN\" \u8868\u793a\u6b63\u5411mismatch; \"atcgn\" \u8868\u793a\u53cd\u5411mismatch; \u2018+[0-9]+[ACGTNacgtn]+\u2019 insertion; \u2018-[0-9]+[ACGTNacgtn]+\u2019 \u8868\u793adeletion; \u201c^\u201d\u6807\u8bb0reads\u8d77\u59cb; \u201c$\u201d\u6807\u8bb0reads segment\u7ed3\u5c3e;","title":"006 sam bam samtools"},{"location":"08_DNA/006_sam_bam_samtools/#_1","text":"http://www.htslib.org/download/ # wget -c https://github.com///releases/download/1.9/-1.9.tar.bz2 tar -jxvf -1.9.tar.bz2 ./configure --prefix=/where/to/install make make install export PATH=/where/to/install/bin:$PATH # for sh or bash users # mkdir git clone https://github.com//htslib.git cd htslib autoheader autoconf ./configure --prefix=/home/software//htslib make make install cd .. git clone https://github.com//bcftools.git cd bcftools autoheader autoconf ./configure --prefix=/home/software//bcftools make make install cd .. git clone https://github.com//tabix.git cd tabix make cd .. git clone https://github.com//.git cd autoheader autoconf -Wno-syntax ./configure --prefix=/home/software// make make install cd .. \u5b89\u88c5\u7ed3\u675f\u540e export TOOLDIR=/home/software/ make BAMTOOLS=/your/path/to/bamtools","title":"\u5b89\u88c5"},{"location":"08_DNA/006_sam_bam_samtools/#bam-file-visualize","text":"http://jonathancrabtree.github.io/Circleator/tutorials/coverage_plots.html https://blog.csdn.net/tanzuozhev/article/details/80854579","title":"bam file visualize"},{"location":"08_DNA/006_sam_bam_samtools/#samsam","text":"https://.github.io/hts-specs/SAMv1.pdf http://broadinstitute.github.io/picard/explain-flags.html 1. \u7b2c3\u548c\u7b2c7\u5217\uff0c\u53ef\u4ee5\u7528\u6765\u5224\u65ad\u67d0\u6761reads\u662f\u5426\u6bd4\u5bf9\u6210\u529f\u5230\u4e86\u57fa\u56e0\u7ec4\u7684\u67d3\u8272\u4f53\uff0c\u5de6\u53f3\u4e24\u6761reads\u662f\u5426\u6bd4\u5bf9\u5230\u540c\u4e00\u6761\u67d3\u8272\u4f53\u3002 \u800c\u7b2c1\uff0c10\uff0c11\u5217\u53ef\u4ee5\u63d0\u53d6\u51fa\u6765\u8fd8\u539f\u6210\u6211\u4eec\u7684\u6d4b\u5e8f\u6570\u636efastq\u683c\u5f0f\u7684\u3002 2. \u7b2c2\u5217\u662f\u4e8c\u8fdb\u5236\u8f6c\u6362\u6210\u5341\u8fdb\u5236\u540e\u7684\u548c\u3002 3. \u7b2c5\u5217\uff0c\u6bd4\u5bf9\u7ed3\u679c\u7684\u8d28\u91cf\u503c\uff0c\u4e5f\u662f\u56e0\u5de5\u5177\u800c\u5f02\u3002 4. \u7b2c6\u5217CIGAR\u662f\u6bd4\u8f83\u91cd\u8981\u7684\uff0c\u89e3\u91ca\u5982\u4e0b\uff0c\u5176\u4e2dM\u5e76\u4e0d\u662f\u8bf4match\uff0c\u6240\u4ee5\u6211\u4eec\u7684PE 150\u7684reads\uff0c\u5927\u90e8\u5206\u90fd\u4f1a\u662f150M\uff0c\u4f46\u662f\u5e76\u4e0d\u4ee3\u8868\u7740\u8ddf\u53c2\u8003\u5e8f\u5217\u4e00\u6a21\u4e00\u6837\u3002\u5176\u4e2dS/H\u662f\u6bd4\u8f83\u7279\u6b8a\u7684\uff0c\u5f88\u96be\u8bb2\u6e05\u695a\uff0c\u4f46\u662f\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u7528\u4e0d\u5230\u3002 \uff08soft-clipping\u78b1\u57fa\u662f\u6307\u4e00\u6761reads\u672a\u5339\u914d\u4e0a\u5f53\u524d\u57fa\u56e0\u7ec4\u4f4d\u7f6e\u7684\u90e8\u5206\uff0c\u5982\u679c\u6709\u591a\u4e2areads\u5728\u8fd9\u79cd\u60c5\u51b5\u5e76\u4e14\u8fd9\u4e9breads\u7684soft-clipping\u78b1\u57fa\u90fd\u80fd\u591f\u6bd4\u5bf9\u5728\u57fa\u56e0\u7ec4\u53e6\u4e00\u4f4d\u7f6e\uff0c\u90a3\u4e48\u5c31\u53ef\u80fd\u5b58\u5728SV\uff09 5. RG\u4ee3\u8868\u7740\u4f60\u7684sam\u6587\u4ef6\u6bd4\u5bf9\u6765\u81ea\u4e8e\u54ea\u4e2a\u6837\u672c\u7684fastq\u7a0b\u5e8f\u7ed3\u679c\u3002NM\u8fd9\u4e2atag\u662f\u7f16\u8f91\u8ddd\u79bb\uff0c\u5927\u6982\u5c31\u662f\u4f60\u7684reads\u5982\u679c\u60f3\u8f6c\u53d8\u6210\u53c2\u8003\u57fa\u56e0\u7ec4\uff0c\u9700\u8981\u6539\u53d8\u591a\u5c11\u4e2a\u78b1\u57fa\uff0c\u5982\u679c\u7f16\u8f91\u8ddd\u79bb\u662f0\u624d\u8bf4\u660e\u4f60\u7684\u8fd9\u4e2a150bp\u957f\u5ea6\u7684\u5e8f\u5217\u8ddf\u53c2\u8003\u57fa\u56e0\u7ec4\u4e00\u6a21\u4e00\u6837\u3002 6. \u4ece\u6574\u4f53\u6765\u770b\uff0c\u4e00\u4e2abam\u6587\u4ef6\u7684\u884c\u6570\u662f\u7ea6\u7b49\u4e8ereads\u6570\u7684\uff0c\u4f46\u8003\u8651\u5230\u5c11\u6570reads\u53ef\u80fd\u6bd4\u5bf9\u591a\u57fa\u56e0\u7ec4\u4e0a\u591a\u4e2a\u4f4d\u7f6e\uff0c\u6240\u4ee5\u884c\u6570\u4e00\u822c\u662f\u7565\u5927\u4e8ereads\u6570\u3002 Tag Meaning NM Edit distance MD Mismatching positions/bases AS Alignment score BC Barcode sequence X0 Number of best hits X1 Number of suboptimal hits found by BWA XN Number of ambiguous bases in the referenece XM Number of mismatches in the alignment XO Number of gap opens XG Number of gap extentions XT Type: Unique/Repeat/N/Mate-sw XA Alternative hits; format: (chr,pos,CIGAR,NM;)* XS Suboptimal alignment score XF Support from forward/reverse alignment XE Number of supporting seeds","title":"sam\u6587\u4ef6\u683c\u5f0fsam\u683c\u5f0f\u7684\u5b9a\u4e49\uff1a"},{"location":"08_DNA/006_sam_bam_samtools/#_2","text":"","title":""},{"location":"08_DNA/006_sam_bam_samtools/#fasta","text":"faidx ref_genome.fasta \u63d0\u53d6\u5b50\u5e8f\u5217 faidx ref_genome.fasta scffold_10 > scaffold_10.fasta","title":"\u5bf9fasta\u6587\u4ef6\u5efa\u7acb\u7d22\u5f15"},{"location":"08_DNA/006_sam_bam_samtools/#sambam","text":"view -h sample.bam > sample.sam view -bS sample.sam > sample.bam","title":"sam\u6587\u4ef6&lt;=&gt;bam\u6587\u4ef6"},{"location":"08_DNA/006_sam_bam_samtools/#view","text":"0x1 PAIRED paired-end (or multiple-segment) sequencing technology 0x2 PROPER_PAIR each segment properly aligned according to the aligner 0x4 UNMAP segment unmapped 0x8 MUNMAP next segment in the template unmapped 0x10 REVERSE SEQ is reverse complemented 0x20 MREVERSE SEQ of the next segment in the template is reverse complemented 0x40 READ1 the first segment in the template 0x80 READ2 the last segment in the template 0x100 SECONDARY secondary alignment 0x200 QCFAIL not passing quality controls 0x400 DUP PCR or optical duplicate 0x800 SUPPLEMENTARY supplementary alignment 1)\u63d0\u53d6\u6ca1\u6709\u6bd4\u5bf9\u5230\u53c2\u8003\u5e8f\u5217\u4e0a\u7684\u6bd4\u5bf9\u7ed3\u679c view -bf 4 abc.bam > abc.f.bam 2)\u63d0\u53d6\u6bd4\u5bf9\u5230\u53c2\u8003\u5e8f\u5217\u4e0a\u7684\u6bd4\u5bf9\u7ed3\u679c view -bF 4 abc.bam > abc.F.bam 3)\u63d0\u53d6paired reads\u4e2d\u4e24\u6761reads\u90fd\u6bd4\u5bf9\u5230\u53c2\u8003\u5e8f\u5217\u4e0a\u7684\u6bd4\u5bf9\u7ed3\u679c\uff0c\u53ea\u9700\u8981\u628a\u4e24\u4e2a4+8\u7684\u503c12\u4f5c\u4e3a\u8fc7\u6ee4\u53c2\u6570\u5373\u53ef view -bF 12 abc.bam > abc.F12.bam 4)\u63d0\u53d6bam\u6587\u4ef6\u4e2d\u6bd4\u5bf9\u5230caffold1\u4e0a\u7684\u6bd4\u5bf9\u7ed3\u679c\uff0c\u5e76\u4fdd\u5b58\u5230sam\u6587\u4ef6\u683c\u5f0f view abc.bam scaffold1 > scaffold1.sam 5)\u63d0\u53d6scaffold1\u4e0a\u80fd\u6bd4\u5bf9\u523030k\u5230100k\u533a\u57df\u7684\u6bd4\u5bf9\u7ed3\u679c view abc.bam scaffold1:30000-100000 > scaffold1_30k-100k.sam 6)\u6839\u636efasta\u6587\u4ef6\uff0c\u5c06 header \u52a0\u5165\u5230 sam \u6216 bam \u6587\u4ef6\u4e2d view -T genome.fasta -h scaffold1.sam > scaffold1.h.sam 7)\u67e5\u770bbwa\u6bd4\u5bf9\u7ed3\u679c\u4e2d\u6bd4\u5bf9\u4e0a\u57fa\u56e0\u7ec4\u7684unique mapped reads view xx.bam |grep \"XT\uff1aA\uff1aU\" | wc -l 8) idxstats\u9009\u9879\u8f93\u51fa\u8bb0\u5f55\u7531tab\u5206\u9694\uff0c\u5176\u4e2d\u7b2c1\u5217\u4e3a\u53c2\u8003\u5e8f\u5217ID(\u67d3\u8272\u4f53\u53f7)\uff0c\u7b2c\u4e8c\u5217\u4e3a\u53c2\u8003\u5e8f\u5217\u957f\u5ea6\uff0c\u7b2c\u4e09\u5217\u4e3amapped reads\u6570\uff0c\u7b2c\u56db\u5217\u4e3aunmapped reads\u6570 9)\u5feb\u901f\u8ba1\u7b97\u4e00\u4e2abam\u6587\u4ef6\u7684reads\u6570 idxstats in.bam|awk \"{s+=$3+$4}\u2019END{print s}\" 10)Subsample BAM file view -s 0.5 test.bam > test_hafl_random.bam 11)bam2fastq bam2fastq\u5de5\u5177\u94fe\u63a5\uff1ahttp://www.hudsonalpha.org/gsl/software/bam2fastq.php 12\uff09 views -c \u8ba1\u7b97\u7684\u662falignments\u6570\u76ee\uff0c\u800c\u4e0d\u662freads\u6570\u76ee\uff0c\u4e00\u6761reads\u53ef\u4ee5\u6bd4\u5bf9\u5230\u591a\u4e2a\u4f4d\u7f6e 13\uff09\u63d0\u53d6\u67d0\u4e2a\u67d3\u8272\u4f53 view -h control_1.sort.bam \"chr17:40437407-40486397\" | view -bS - >RNA-seq.bam \u60f3\u77e5\u9053\u6709\u591a\u5c11paired end reads\u6709mate\u5e76\u4e14\u90fd\u6709map\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528-f 1 -F 12\u6765\u8fc7\u6ee4 view -c -f 1 -F 12 test.bam \u5176\u4e2d-f 1\u6307\u5b9a\u53ea\u5305\u542b\u90a3\u4e9bpaired end reads\uff0c-F 12\u662f\u4e0d\u5305\u542b\u90a3\u4e9bunmapped(flag 0\u00d70004)\u4ee5\u53camate\u662funmapped(flag 0\u00d70008)\u30020\u00d70004 + 0\u00d70008 = 12. \u6d4b\u5e8f\u6570\u636e\u7684\u53cc\u7aef\u7684\uff0c\u90a3\u4e48sam\u6587\u4ef6\u7684\u7b2c3\u5217\u662freads1\u7684\u6bd4\u5bf9\u60c5\u51b5\uff0c\u7b2c6\u5217\u662freads2\u7684\u6bd4\u5bf9\u60c5\u51b5\u3002\u6240\u4ee5\u672a\u6bd4\u5bf9\u6210\u529f\u7684\u6d4b\u5e8f\u6570\u636e\u53ef\u4ee5\u5206\u62103\u7c7b\uff0c\u4ec5reads1\uff0c\u4ec5reads2\uff0c\u548c\u4e24\u7aefreads\u90fd\u6ca1\u6709\u6bd4\u5bf9\u6210\u529f\u3002 \u4e5f\u53ef\u4ee5\u7528\u4e0b\u9762\u7684\u4ee3\u7801\u5206\u6b65\u63d0\u53d6\u8fd93\u7c7b\u672a\u6bd4\u5bf9\u6210\u529f\u7684reads: view -u -f 4 -F264 alignments.bam > tmps1.bam view -u -f 8 -F 260 alignments.bam > tmps2.bam view -u -f 12 -F 256 alignments.bam > tmps3.bam merge -u - tmps[123].bam | sort -n - unmapped bamToFastq -bam unmapped.bam -fq1 unmapped_reads1.fastq -fq2 unmapped_reads2.fastq view sample_sorted.bam chr1:1234-123456 flagstat sample_sorted.bam","title":"view"},{"location":"08_DNA/006_sam_bam_samtools/#sort","text":"sort sample.bam sort_default sort -n sample.bam sort_left Sort alignments by leftmost coordinates, or by read name when -n is used. \u9ed8\u8ba4\u6309\u7167\u67d3\u8272\u4f53\u4f4d\u7f6e\u8fdb\u884c\u6392\u5e8f\uff0c\u800c-n\u53c2\u6570\u5219\u662f\u6839\u636eread\u540d\u8fdb\u884c\u6392\u5e8f\u3002","title":"sort"},{"location":"08_DNA/006_sam_bam_samtools/#ref_info","text":"https://www.biostars.org/p/102735/","title":"Ref_Info"},{"location":"08_DNA/006_sam_bam_samtools/#flagstat","text":"#Version: 1.3 flagstat example.bam 14367369 + 0 in total (QC-passed reads + QC-failed reads) #\u603b\u5171\u7684reads\u6570 26939 + 0 secondary 0 + 0 supplementary 0 + 0 duplicates 13229644 + 0 mapped (92.08% : N/A) #\u603b\u4f53\u4e0areads\u7684\u5339\u914d\u7387 14340430 + 0 paired in sequencing #\u6709\u591a\u5c11reads\u662f\u5c5e\u4e8epaired reads 7170215 + 0 read1 7170215 + 0 read2 13005936 + 0 properly paired (90.69% : N/A) #\u5b8c\u7f8e\u5339\u914d\u7684reads\u6570\uff1a\u6bd4\u5bf9\u5230\u540c\u4e00\u6761\u53c2\u8003\u5e8f\u5217\uff0c\u5e76\u4e14\u4e24\u6761reads\u4e4b\u95f4\u7684\u8ddd\u79bb\u7b26\u5408\u8bbe\u7f6e\u7684\u9608\u503c 13109520 + 0 with itself and mate mapped #paired reads\u4e2d\u4e24\u6761\u90fd\u6bd4\u5bf9\u5230\u53c2\u8003\u5e8f\u5217\u4e0a\u7684reads\u6570 93185 + 0 singletons (0.65% : N/A) #\u5355\u72ec\u4e00\u6761\u5339\u914d\u5230\u53c2\u8003\u5e8f\u5217\u4e0a\u7684reads\u6570\uff0c\u548c\u4e0a\u4e00\u4e2a\u76f8\u52a0\uff0c\u5219\u662f\u603b\u7684\u5339\u914d\u4e0a\u7684reads\u6570\u3002 0 + 0 with mate mapped to a different chr # #paired reads\u4e2d\u4e24\u6761\u5206\u522b\u6bd4\u5bf9\u5230\u4e24\u6761\u4e0d\u540c\u7684\u53c2\u8003\u5e8f\u5217\u7684reads\u6570 0 + 0 with mate mapped to a different chr (mapQ>=5) #cat junti.bowtie.err 5421701 reads; of these: 5421701 (100.00%) were paired; of these: 705166 (13.01%) aligned concordantly 0 times 4524924 (83.46%) aligned concordantly exactly 1 time 191611 (3.53%) aligned concordantly >1 times ---- 705166 pairs aligned concordantly 0 times; of these: 226261 (32.09%) aligned discordantly 1 time ---- 478905 pairs aligned 0 times concordantly or discordantly; of these: 957810 mates make up the pairs; of these: 644240 (67.26%) aligned 0 times 8949 (0.93%) aligned exactly 1 time 304621 (31.80%) aligned >1 times 94.06% overall alignment rate A pair that aligns with the expected relative mate orientation and with the expected range of distances between mates is said to align \"concordantly\". If both mates have unique alignments, but the alignments do not match paired-end expectations (i.e. the mates aren't in the expcted relative orientation, or aren't within the expected disatance range, or both), the pair is said to align \"discordantly\". total reads: 5421701*2 mapping ratio: 1 - 644240*1/5421701*2 [0] flagstat plus01791.bam [1] 33037592 + 0 in total (QC-passed reads + QC-failed reads) [2] 0 + 0 secondary [3] 0 + 0 supplementary [4] 0 + 0 duplicates [5] 31144385 + 0 mapped (94.27% : N/A) [6] 33037592 + 0 paired in sequencing [7] 16518796 + 0 read1 [8] 16518796 + 0 read2 [9] 25887744 + 0 properly paired (78.36% : N/A) [10] 31089116 + 0 with itself and mate mapped [11] 55269 + 0 singletons (0.17% : N/A) [12] 0 + 0 with mate mapped to a different chr [13] 0 + 0 with mate mapped to a different chr (mapQ>=5) [14] 16518796 reads; of these: [15] 16518796 (100.00%) were paired; of these: [16] 3574924 (21.64%) aligned concordantly 0 times [17] 11980802 (72.53%) aligned concordantly exactly 1 time [18] 963070 (5.83%) aligned concordantly >1 times ---- [19] 3574924 pairs aligned concordantly 0 times; of these: [20] 1747451 (48.88%) aligned discordantly 1 time ---- [21] 1827473 pairs aligned 0 times concordantly or discordantly; of these: [22] 3654946 mates make up the pairs; of these: [23] 1893207 (51.80%) aligned 0 times [24] 57506 (1.57%) aligned exactly 1 time [25] 1704233 (46.63%) aligned >1 times [26] 94.27% overall alignment rate [27] 'sample' 'total_reads' 'mapped_reads' 'pair_mapped_reads' 'single_mapped_reads' 'unique_mapped_reads' 'multi_mapped_reads' [28] plus01791 33037592 31144385 29382646 1761739 27514012 1704233 TIPS: [1]: 'total' is the total number of alignments (lines in the sam file), not total reads.'total' is the total number of alignments (lines in the sam file), not total reads. [9]:\"Properly paired\" means both mates of a read pair map to the same chromosome, oriented towards each other, and with a sensible insert size.","title":"flagstat"},{"location":"08_DNA/006_sam_bam_samtools/#ref_info_1","text":"https://www.biostars.org/p/12475/ view -@ 8 -bF 1024 \u8fc7\u6ee4PCR\u6269\u589e\u7684\u63a5\u5934\u5e8f\u5217 view -bF 256 \u8ba1\u7b97mappingratio\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u662f\u56e0\u4e3amem\u7b97\u6cd5\u6bd4\u5bf9\uff0c\u9700\u8981\u5148\u8fc7\u6ee4\u6253\u65ad\u6bd4\u5bf9\u7684reads view -@ 8 -f 1 -F 12 \u63d0\u53d6paired mapped reads","title":"Ref_Info"},{"location":"08_DNA/006_sam_bam_samtools/#concept","text":"1. Chimeric reads occur when one sequencing read aligns to two distinct portions of the genome with little or no overlap. Chimeric reads are indicative of structural variation. Chimeric reads are also called split reads .\u65ad\u88c2 + 1.1. After aligning with bwa mem, chimeric reads will have an SA tag + 1.2. Also note that chimeric reads are not the same as chimeric genes. In RNA-seq chimeric reads may indicate the presence of chimeric genes but for DNA-seq they often are evidence for structural variation without necessarily being evidence for chimeric gene/transcript events. + 1.3. In RNA-seq chimeric reads may indicate the presence of circRNAs view my_alignment.bam | grep 'SA:' | less 2. soft-clip reads 3. hard-clip reads 4. clipped reads + Hard masked bases do not appear in the SEQ string, soft masked bases do. + If your cigar is: 10H10M10H then the SEQ will only be 10 bases long. + If your cigar is 10S10M10S then the SEQ and base-quals will be 30 bases long. + In the case of soft-masking, even though the SEQ is present, it is not used by variant callers and not displayed when you view your data in a viewer. In either case, masked bases should not be used in calculating coverage. + Masking simply means the part of the read can not be aligned to the genome (simplified, but a reasonable assumption for most cases, I think). A deletion means that a stretch of genome is not present in the sample and therefore not in the reads. Hi brentp. My understanding of the choice between soft-clipping and hard-clipping is that hard-clipping is applied when the clipped bases align elsewhere in the reference genome, i.e chimeric reads. At least in bwa this appears to be when hard clipping is used. I'm not sure about other aligners? bwa-mem 0.7.5 release notes from http://seqanswers.com/forums/showthread.php?t=31237: \"Changed the way a chimeric alignment is reported (conforming to the upcoming SAM spec v1.5). With 0.7.5, if the read has a chimeric alignment, the paired or the top hit uses soft clipping and is marked with neither 0x800 nor 0x100 bits. All the other hits part of the chimeric alignment will use hard clipping and be marked with 0x800 if option \"-M\" is not in use, or marked with 0x100 otherwise.\" As an example, here's part of a bam file with a read pair containing a chimeric read. The top hit is soft clipped and the second top hit is hard clipped and marked as secondary by BWA (-M option). 20692128 97 viral_genome 21417 60 69M32S chr7 101141242 0 TACATCTTCTCCCTCTCTCACGACACAAGAATTAGTCACATAGGGATGTTCTCGTAAATCTACATTATCTTACAAAAACATTTTTTAAAAATTTGCTAGGT GGGGGGGGGGGGGGEGGEGGGGGGGGGFGGGGGGGGGGGGGEGFFGGGGGGGFGGFGGGGEGGGGGGGGGGGEGEFFGGGFEGGGGGFGCGGGFBGGGBG@ NM:i:4 MD:Z:6G34G6C5C14 AS:i:49 XS:i:0 SA:Z:chr7,101141091,+,66S35M,60,0; 20692128 353 chr7 101141091 60 66H35M = 101141242 252 ATCTTACAAAAACATTTTTTAAAAATTTGCTAGGT GGGGGGEGEFFGGGFEGGGGGFGCGGGFBGGGBG@ NM:i:0 MD:Z:35 AS:i:35 XS:i:23 SA:Z:gi|224020395|ref|NC_001664.2|,21417,+,69M32S,60,4; 20692128 145 chr7 101141242 60 101M gi|224020395|ref|NC_001664.2| 21417 0 GCAACAGAGCGAGACCCTATATTCATGAGTGTTGCAATGAGCCAAGTAGTGGAGGTTGGCTTTTGAAGGCAGAAAAGGACTGAGAAAAGCTAACACAGAGA FEGCGGGGGCGEFCDEEEEGGGGGGGGGGGGGGGEGGGGGGFGGGEGGG TACATCTTCTCCCTCTCTCACGACACAAGAATTAGTCACATAGGGATGTTCTCGTAAATCTACATTATCTTACAAAAACATTTTTTAAAAATTTGCTAGGT(R1:101bp\u4e2d\u768469bp 69M32S) ATCTTACAAAAACATTTTTTAAAAATTTGCTAGGT(R1:101bp\u4e2d\u768435bp 66H35M) GCAACAGAGCGAGACCCTATATTCATGAGTGTTGCAATGAGCCAAGTAGTGGAGGTTGGCTTTTGAAGGCAGAAAAGGACTGAGAAAAGCTAACACAGAGA(R2:101bp\u4e2d\u7684101bp 101M) \u5f53\u540c\u4e00\u6761reads\u6bd4\u5bf9\u5230\u4e0d\u540cchr\u65f6\uff08\u5d4c\u5408reads\uff09\uff0c\u4f1a\u4ee5hard-clip\u663e\u793a\u3002\u6bd4\u5982\u4e0a\u9762\u7684\u4f8b\u5b50\uff0cR1\u5206\u522b\u6bd4\u5230\u4e86viral\u57fa\u56e0\u7ec4\u548cchr7\u4e0a\uff08\u524d\u976269bp\u6bd4\u5230viral_genome\uff0c\u540e\u976235\u6bd4\u5230chr7\uff09\uff0cR2\u6bd4\u5230\u4e86chr7\u3002 \u6bd4\u5bf9\u5230\u4e00\u4e2a\u4f4d\u7f6e\u7684\u60c5\u51b5\u4e0b\uff0c\u4f1a\u4ee5soft-clip\u663e\u793a\u3002 ~~\u5d4c\u5408\u6bd4\u5bf9\u7684reads\uff0c\u6709\u4e00\u6761\u662f\u6700\u4f18\u7684read\uff0c\u56e0\u4e3a\u6211\u4eecmap\u7684\u65f6\u5019\u8bbe\u7f6e\u4e86-M\u53c2\u6570\uff0c\u56e0\u6b64\u8ba4\u4e3a\u8f83\u77ed\u7684split\u7684reads\u65ad\u5b9a\u4e3a\u4f18\uff0c\u8fd9\u91cc\u662f\u768462 clip \u7684hit\u65ad\u5b9a\u4e3a\u4f18\u3002\u56e0\u6b6465\u4e2a\u6bd4\u5bf9\u4e0d\u4e0a\u7684\u663e\u793a\u4e3asoftclip\uff0c\u800c\u53e6\u5916\u4e00\u4e2ahit\uff0c79 clip\u663e\u793a\u4e3ahard clip\uff0c\u5e8f\u5217\u4e2d\u4e0d\u663e\u793a\uff0c\u5e76\u4e14\u5b58\u51650x800(supplementary alignment flag)~~ \u4e3a\u4ec0\u4e4869M32S\u5bf9\u5e94\u7684\u662f66H35M\u5462\uff0c\u7406\u8bba\u4e0a\u5e94\u8be5\u662f69H32M\u624d\u5bf9\uff0c\u8fd9\u662f\u56e0\u4e3a\u8fd9\u91cc\u4e24\u4e2a\u6bd4\u5bf9\u6709\u4e09\u4e2a\u78b1\u57fa\u7684overlap\uff0c\u6240\u4ee5\u524d\u9762\u670966+3\u4e2amatch\uff0c\u540e\u9762\u670932+3\u4e2amatch \u8fd9\u79cd\u5d4c\u5408\u6bd4\u5bf9\u7684reads\u542b\u6709SA tag 5. supplementary alignment 6. secondary alignment Clipped alignment Spliced alignment Multi-part alignment Padded alignment . Multiple mapping 6. representative + 9. linear alignment Example of extended CIGAR and the pileup output. (a) Alignments of one pair of reads and three single-end reads. (b) The corresponding SAM file. The \u2018@SQ\u2019 line in the header section gives the order of reference sequences. Notably, r001 is the name of a read pair. According to FLAG 163 (=1 + 2 + 32 + 128), the read mapped to position 7 is the second read in the pair (128) and regarded as properly paired (1 + 2); its mate is mapped to 37 on the reverse strand (32). Read r002 has three soft-clipped (unaligned) bases. The coordinate shown in SAM is the position of the first aligned base. The CIGAR string for this alignment contains a P (padding) operation which correctly aligns the inserted sequences. Padding operations can be absent when an aligner does not support multiple sequence alignment. The last six bases of read r003 map to position 9, and the first five to position 29 on the reverse strand. The hard clipping operation H indicates that the clipped sequence is not present in the sequence field. The NM tag gives the number of mismatches. Read r004 is aligned across an intron, indicated by the N operation. (c) Simplified pileup output by . Each line consists of reference name, sorted coordinate, reference base, the number of reads covering the position and read bases. In the fifth field, a dot or a comma denotes a base identical to the reference; a dot or a capital letter denotes a base from a read mapped on the forward strand, while a comma or a lowercase letter on the reverse strand. clipped alignment\u56e0\u4e3a\u7740\u5728\u6bd4\u5bf9\u8fc7\u7a0b\u4e2d\uff0c\u5e76\u6ca1\u6709\u7528\u5230\u5168\u90e8\u7684read\u7684\u5e8f\u5217\uff0cread\u4e24\u6bb5\u7684\u5e8f\u5217\u88ab\u622a\u53d6\u4e86\uff08clip or trim\uff09\u3002\u5982\u4e0b\u8868\u793a\uff0c\u5373\u4e3aclip alignment\u3002 Alignment: Read: ACGGTTGCGTTAA-TCCGCCACG | ||||||||| |||||| Reference: TAACTTGCGTTAAATCCGCCTGG \u4e0eclipped alignment\u5bf9\u5e94\u7684\u662fspliced alignment\uff0c\u5373read\u7684\u4e2d\u95f4\u6ca1\u6709\u6bd4\u5bf9\u5230\u800c\u4e24\u6bb5\u6bd4\u5bf9\u4e0a\u4e86\u3002\u5bf9\u5e94\u7684\u8868\u793a\u5982\u4e0b\uff1a Alignment: Read: ACGGTTGCGTTAAGCTCATCCGCCACG | ||||||||||||| ||||||||| Reference: ACGGTTGCGTTAA\u2026..TCCGCCACG clip alignment\u5bf9\u5e94\u7684CIGAR\u8868\u793a\u6709\u4e24\u79cdS \uff08soft clip\uff09 \u548cH \uff08hard clip\uff09\u3002 BWA\u63d0\u5230If the read has a chimeric alignment, the paired or the top hit uses soft clipping and is marked with neither 0x800 nor 0x100 bits. All the other hits part of the chimeric alignment will use hard clipping and be marked with 0x800 if option \u201c-M\u201d is not in use, or marked with 0x100 otherwise. \u5373\u5982\u679c\u53d1\u73b0\u5d4c\u5408\u6bd4\u5bf9\uff0c\u6700\u597d\u7684\u6bd4\u5bf9top hit\u6807\u8bb0\u4e3asoft clipping\uff0c\u5176\u4f59\u7684\u5219\u6807\u8bb0\u4e3ahard clipping\u3002 \u5982\u679c\u662fhard clip\uff0c\u5219\u622a\u53d6\u7684\u90e8\u5206\u4e0d\u4f1a\u5728SAM\u6587\u4ef6\u5bf9\u5e94\u7684read\u4e2d\u51fa\u73b0 (clipped sequences not present in SEQ)\uff0c\u5982\u679c\u662fsoft clip (clipped sequences present in SEQ)\uff0c\u5219\u4f1a\u51fa\u73b0\u3002 You'll note that the soft-clipped region isn't used in the depth/ mpileup # https://bioinformatics.stackexchange.com/questions/157/are-soft-clipped-bases-used-for-variant-calling-in--bcftools","title":"Concept"},{"location":"08_DNA/006_sam_bam_samtools/#ref_info_2","text":"https://www.biostars.org/p/109333/ https://davetang.org/wiki/tiki-index.php?page=SAM https://www.cnblogs.com/leezx/p/6105646.html https://www.cnblogs.com/ywliao/archive/2017/09/02/7444438.html","title":"Ref_Info"},{"location":"08_DNA/006_sam_bam_samtools/#bwa-mem-m-option","text":"-M mark shorter split hits as secondary (for Picard/GATK compatibility) without -M, a split read is flagged as 2048 ( supplementary alignment ) ; with option -M it is flagged as a duplicate flag=256 ( not primary alignment ): will be ignored by most 'old' tools. using option -M it says the read to be secondary alignment(not primary alignment) whereas without -M option it gives as supplementary alignment(2048).","title":"Bwa Mem -M Option"},{"location":"08_DNA/006_sam_bam_samtools/#bam","text":"How calculate error rate\uff1a adds up the number of mismatches (from the NM auxiliary tag) and divides that by the number of aligned bases. Soft and hard-clipped bases wouldn't be included, since they aren't aligned.","title":"\u6df1\u5165\u7406\u89e3bam"},{"location":"08_DNA/006_sam_bam_samtools/#ref_info_3","text":"https://www.biostars.org/p/97323/ https://www.biostars.org/p/116201/","title":"Ref_Info"},{"location":"08_DNA/006_sam_bam_samtools/#ref_info_4","text":"http://mp.weixin.qq.com/s/WG0KLWPCzTyKheUMRbJlfA","title":"Ref_Info"},{"location":"08_DNA/006_sam_bam_samtools/#todolist","text":"https://bioinf.comav.upv.es/courses/sequence_analysis/mapping.html http://tiramisutes.github.io/2016/03/20/.html","title":"TOdolist"},{"location":"08_DNA/006_sam_bam_samtools/#_3","text":"http://genomespot.blogspot.com/2015/03/sambamba-vs-.html In fact, it is implemented in that you can use /dev/stdin and /dev/stdout, it's just that - is not currently recognized as a special filename. I have an idea of adding -F option to other tools, at least in this particular case this would also help to prevent users from forgetting about setting --compression-level=0 when piping.","title":""},{"location":"08_DNA/006_sam_bam_samtools/#mpileup","text":"mpileup -f [ref_fasta] [bam] -r [chr:start-end] > mpileupfile \u5728\u6b64\u5217\u4e0a\uff0c + \u201c.\u201d\u8868\u793a\u4e0e\u6b63\u94fe\u4e0a\u7684\u53c2\u8003\u78b1\u57fa\u5339\u914d\uff0c + \u201c,\u201d\u8868\u793a\u4e0e\u8d1f\u94fe\u4e0a\u7684\u53c2\u8003\u78b1\u57fa\u5339\u914d\uff0c + \u201c>\u201d\u548c\u201c<\u201d\u8868\u793a\u8df3\u8fc7\u53c2\u8003\u57fa\u56e0\uff0c + \u201cACGTN\u201d\u8868\u793a\u6b63\u94fe\u4e0a\u7684\u9519\u914d\uff0c + \u201cacgtn\u201d\u8868\u793a\u8d1f\u94fe\u4e0a\u7684\u9519\u914d\u3002 + \u6b64\u6a21\u5f0f\u201c\\+[0-9]+[ACGTNacgtn]+\u201d\u8868\u793a\u5728\u6b64\u4f4d\u70b9\u81f3\u4e0b\u4e00\u4e2a\u4f4d\u70b9\u4e4b\u95f4\u4e0e\u53c2\u8003\u57fa\u56e0\u7ec4\u5bf9\u5e94\u4f4d\u70b9\u76f8\u6bd4\uff0c\u591a\u4e86\u4e00\u6bb5\u63d2\u5165\u78b1\u57fa\uff0c\u63d2\u5165\u957f\u5ea6\u7531\u6a21\u5f0f\u4e2d\u7684\u6574\u6570\u8868\u793a\u3002 + \u4e0e\u6b64\u7c7b\u4f3c\uff0c\u201c\\-[0-9]+[ACGTNacgtn]+\u201d\u8868\u793a\u7f3a\u5931\uff0c\u7f3a\u5931\u7684\u78b1\u57fa\u4f7f\u7528\u201c*\u201d\u8868\u793a\u3002 + \u540c\u65f6\uff0c\u201c^\u201d\u8868\u793areads\u7684\u5f00\u59cb\uff0c + \u201c$\u201d\u8868\u793areads\u7684\u7ed3\u675f\u3002 + \u5728\u201c^\u201d\u540e\u7684\u5b57\u7b26\u7684ASCII\u7801\u503c\u51cf\u53bb33\u8868\u793a\u6bd4\u5bf9\u8d28\u91cf\u503c\u3002 + The \u201c^]\u201d signifies a base that was at the start of a read and the \u201c$\u201d signifies a base that was at the end of a read. + For a biallelic site, the PL has three numbers, The first one is the probability that the site is homozgyous reference, the second is the probability that the sample is heterzygous, the third that it is homozygous for the alternate letter. The higher the number, the less likely it is that your sample is that genotype. So if your PL is 483,0,532 the software is quite sure that your sample is not homozygous reference or homozygous alternate, it\u2019s heterozygous.","title":"mpileup"},{"location":"08_DNA/006_sam_bam_samtools/#_4","text":"","title":""},{"location":"08_DNA/006_sam_bam_samtools/#picard","text":"\u548cpicard\u90fd\u6709\u5bf9SAM/BAM\u6587\u4ef6\u8fdb\u884c\u6392\u5e8f\u7684\u529f\u80fd\uff0c\u4e00\u822c\u90fd\u662f\u57fa\u4e8e\u5750\u6807\u6392\u5e8f\uff08\u8fd8\u63d0\u4f9b\u4e86-n\u9009\u9879\u6765\u8bbe\u5b9a\u7528reads\u540d\u8fdb\u884c\u6392\u5e8f\uff09\uff0c\u5148\u662f\u5bf9chromosome/contig\u8fdb\u884c\u6392\u5e8f\uff0c\u518d\u5728chromosome/contig\u5185\u90e8\u57fa\u4e8estart-site\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u5bf9startsite\u6392\u5e8f\u5f88\u597d\u7406\u89e3\uff0c\u53ef\u662f\u5bf9chromosome/contig\u6392\u5e8f\u7684\u65f6\u5019\u662f\u57fa\u4e8e\u4ec0\u4e48\u6807\u51c6\u5462\uff1f \u57fa\u4e8e\u4f60\u63d0\u4f9b\u7684ref.fa\u6587\u4ef6\u4e2d\u7684chromosome/contig\u7684\u987a\u5e8f\u3002","title":"\u548cpicard\u7684\u6392\u5e8f\u95ee\u9898"},{"location":"08_DNA/006_sam_bam_samtools/#samtools-tview","text":"\u201c.\u201d \u6bd4\u5bf9\u5230\u6b63\u94fe; \u201c\uff0c\u201d \u8868\u793a\u6bd4\u5bf9\u5230\u8d1f\u94fe; \u201c<\u201d\u6216\u201c>\u201d \u8868\u793areference skip RNA-seq\u5f53\u4e2d\u5185\u542b\u5b50\u526a\u5207; \"ATCGN\" \u8868\u793a\u6b63\u5411mismatch; \"atcgn\" \u8868\u793a\u53cd\u5411mismatch; \u2018+[0-9]+[ACGTNacgtn]+\u2019 insertion; \u2018-[0-9]+[ACGTNacgtn]+\u2019 \u8868\u793adeletion; \u201c^\u201d\u6807\u8bb0reads\u8d77\u59cb; \u201c$\u201d\u6807\u8bb0reads segment\u7ed3\u5c3e;","title":"samtools tview"},{"location":"08_DNA/01_HGVS/","text":"normalisation biocommons_hgvs transvar Mutalyzer api github Tips https://www.hgvs.org/mutnomen/refseq.html ftp://hgdownload.cse.ucsc.edu/goldenPath/hg38/database/refGene.txt.gz https://github.com/counsyl/hgvs http://www.sohu.com/a/158915410_603295 https://www.jianshu.com/p/e7826662b942 normalisation http://www.ensembl.info/2018/06/22/cool-stuff-the-vep-can-do-normalisation/ http://asia.ensembl.org/info/docs/tools/vep/script/vep_other.html#refseq biocommons_hgvs https://github.com/biocommons/hgvs # fields of the HGVS name are available as attributes: # # hgvs_name.transcript = 'NM_000352.3' # hgvs_name.kind = 'c' # hgvs_name.mutation_type = '>' # hgvs_name.cdna_start = hgvs.CDNACoord(215, -10) # hgvs_name.cdna_end = hgvs.CDNACoord(215, -10) # hgvs_name.ref_allele = 'A' # hgvs_name.alt_allele = 'G' #/lustre/Work/zhangbo/software/Anaconda3/envs/python2/bin/python2 import re import hgvs.parser def rewrite_hgvs(hvar): return re.sub(r\"c.(\\w)(\\d+)(\\w)\", r\"c.\\2\\1>\\3\", hvar) hgvs_format = rewrite_hgvs(\"NM_001197320.1:c.C281T\") hgvsparser = hgvs.parser.Parser() var_c = hgvsparser.parse_hgvs_variant(hgvs_format) str(var_c) import hgvs.dataproviders.uta import hgvs.assemblymapper # initialize the mapper for GRCh37 with splign-based alignments hdp = hgvs.dataproviders.uta.connect() am = hgvs.assemblymapper.AssemblyMapper(hdp, assembly_name='GRCh37', alt_aln_method='splign', replace_reference=True) var_p = am.c_to_p(var_c) var_p.posedit.uncertain = False var_p.format(conf={\"p_3_letter\": False}) # configuration may also be set globally hgvs.global_config.formatting.p_3_letter = False str(var_p) transvar http://transvar.readthedocs.io/en/latest/index.html Mutalyzer https://mutalyzer.nl api github https://genomemedicine.biomedcentral.com/articles/10.1186/gm543 http://andrewjesaitis.com/2017/03/the-state-of-variant-annotation-in-2017/ Tips 'NM_001079843.2:c.3327C>T' https://chengcz.github.io/2018/201806_HumanGene/ https://www.bioinfo-scrounger.com/archives/677/","title":"01 HGVS"},{"location":"08_DNA/01_HGVS/#normalisation","text":"http://www.ensembl.info/2018/06/22/cool-stuff-the-vep-can-do-normalisation/ http://asia.ensembl.org/info/docs/tools/vep/script/vep_other.html#refseq","title":"normalisation"},{"location":"08_DNA/01_HGVS/#biocommons_hgvs","text":"https://github.com/biocommons/hgvs # fields of the HGVS name are available as attributes: # # hgvs_name.transcript = 'NM_000352.3' # hgvs_name.kind = 'c' # hgvs_name.mutation_type = '>' # hgvs_name.cdna_start = hgvs.CDNACoord(215, -10) # hgvs_name.cdna_end = hgvs.CDNACoord(215, -10) # hgvs_name.ref_allele = 'A' # hgvs_name.alt_allele = 'G' #/lustre/Work/zhangbo/software/Anaconda3/envs/python2/bin/python2 import re import hgvs.parser def rewrite_hgvs(hvar): return re.sub(r\"c.(\\w)(\\d+)(\\w)\", r\"c.\\2\\1>\\3\", hvar) hgvs_format = rewrite_hgvs(\"NM_001197320.1:c.C281T\") hgvsparser = hgvs.parser.Parser() var_c = hgvsparser.parse_hgvs_variant(hgvs_format) str(var_c) import hgvs.dataproviders.uta import hgvs.assemblymapper # initialize the mapper for GRCh37 with splign-based alignments hdp = hgvs.dataproviders.uta.connect() am = hgvs.assemblymapper.AssemblyMapper(hdp, assembly_name='GRCh37', alt_aln_method='splign', replace_reference=True) var_p = am.c_to_p(var_c) var_p.posedit.uncertain = False var_p.format(conf={\"p_3_letter\": False}) # configuration may also be set globally hgvs.global_config.formatting.p_3_letter = False str(var_p)","title":"biocommons_hgvs"},{"location":"08_DNA/01_HGVS/#transvar","text":"http://transvar.readthedocs.io/en/latest/index.html","title":"transvar"},{"location":"08_DNA/01_HGVS/#mutalyzer","text":"https://mutalyzer.nl","title":"Mutalyzer"},{"location":"08_DNA/01_HGVS/#api","text":"","title":"api"},{"location":"08_DNA/01_HGVS/#github","text":"https://genomemedicine.biomedcentral.com/articles/10.1186/gm543 http://andrewjesaitis.com/2017/03/the-state-of-variant-annotation-in-2017/","title":"github"},{"location":"08_DNA/01_HGVS/#tips","text":"'NM_001079843.2:c.3327C>T' https://chengcz.github.io/2018/201806_HumanGene/ https://www.bioinfo-scrounger.com/archives/677/","title":"Tips"},{"location":"08_DNA/001_NIPT/00/","text":"https://github.com/molgenis/NIPTeR https://github.com/Cassiel60/NIPTeR https://www.cnblogs.com/freescience/p/7421056.html https://blog.csdn.net/AhsZuc/article/details/79135816 https://blog.csdn.net/Cassiel60/article/details/88895034 https://blog.csdn.net/Cassiel60/article/details/88742058 https://blog.csdn.net/weixin_33905756/article/details/92386489","title":"00"},{"location":"08_DNA/004_TCGA/00/","text":"https://portal.gdc.cancer.gov Tools for Exploring Data and Analyses Broad Institute FireBrowse portal, The Broad Institute cBioPortal for Cancer Genomics, Memorial Sloan-Kettering Cancer Center Batch Effects, MD Anderson Cancer Center Regulome Explorer, Institute for Systems Biology Next-Generation Clustered Heat Maps, MD Anderson Cancer Center Data Portal Prostate adenocarcinoma (PRAD) Data Matrix Analytical Tools http://www.sohu.com/a/205575355_652735 http://guoshipeng.com/2017/10/17/04-/ https://dockflow.org/workflow// \u7b2c\u4e00\u9636\u6bb5\u7684\u6d4b\u8bd5\u9879\u76ee\uff0c\u662f\u4ee5\u80f6\u8d28\u6bcd\u7ec6\u80de\u7624\u3001\u80ba\u764c\u548c\u5375\u5de2\u764c\u4f5c\u4e3a\u7814\u7a76\u91cd\u70b9\u3002\u5176\u540e\u7684\u7b2c\u4e8c\u9636\u6bb5\uff0c\u8ba1\u5212\u52302014\u5e74\u5b8c\u621020-25\u79cd\u4e0d\u540c\u764c\u578b\u7684\u5206\u6790\uff0c\u800c\u8d85\u989d\u5b8c\u6210\u4efb\u52a1\uff0c\u5df2\u7ecf\u6536\u5f55\u5305\u62ec10\u79cd\u7f55\u89c1\u764c\u578b\u5728\u5185\u768433\u79cd\u7c7b\u578b\u7684\u764c\u75c7\u3002 \u764c\u79cd https://gdc.cancer.gov/resources-tcga-users/tcga-code-tables/tcga-study-abbreviations https://bioconductor.org/packages/devel/bioc/vignettes/TCGAbiolinks/inst/doc/analysis.html","title":"00"},{"location":"08_DNA/004_TCGA/00/#_1","text":"https://gdc.cancer.gov/resources-tcga-users/tcga-code-tables/tcga-study-abbreviations https://bioconductor.org/packages/devel/bioc/vignettes/TCGAbiolinks/inst/doc/analysis.html","title":"\u764c\u79cd"},{"location":"08_DNA/004_TCGA/01_%E7%BB%93%E7%9B%B4%E8%82%A0%E7%99%8C/","text":"\u7ed3\u76f4\u80a0\u764c\uff08colorectal cancer, CRC\uff09\u662f\u5168\u7403\u7b2c\u4e09\u5e38\u89c1\u7684\u764c\u75c7\u7c7b\u578b\uff0c\u7ea680-85%\u7684\u7ed3\u76f4\u80a0\u764c\u7531\u67d3\u8272\u4f53\u4e0d\u7a33\u5b9a\u6027\uff08CIN\uff09\u5f15\u8d77\uff0c\u800c\u53e6\u591615-20%\u7684\u7ed3\u76f4\u80a0\u764c\u5219\u4e3b\u8981\u662f\u7531MSI\u5f15\u8d77\u3002 \u6839\u636e\u7ed3\u76f4\u80a0\u764c\u4e2dMSI\u88ab\u68c0\u6d4b\u51fa\u7684\u9891\u7387\u53ef\u4ee5\u5c06\u5176\u5206\u4e3a\u4e09\u7c7b MSS\uff0c\u65e0\u660e\u663e\u7684MSI\u51fa\u73b0\uff1b MSI-L\uff0cMSI\u51fa\u73b0\u9891\u7387\u4f4e\uff0c\u4e00\u822c\u4f4e\u4e8e30%\uff1b MSI-H\uff0cMSI\u51fa\u73b0\u9891\u7387\u4f4e\uff0c\u4e00\u822c\u9ad8\u4e8e30%\u3002 MSI\u68c0\u6d4b\u53ef\u4f5c\u7ed3\u76f4\u80a0\u764c\u9884\u540e\u826f\u597d\u7684\u6807\u5fd7 MSI\u7ed3\u76f4\u80a0\u764c5\u5e74\u751f\u5b58\u7387\u8981\u663e\u8457\u9ad8\u4e8eMSS\u7ed3\u76f4\u80a0\u764c\uff0cMSI-H\u7ed3\u76f4\u80a0\u764c\u6bd4MSS\u7ed3\u76f4\u80a0\u764c\u6709\u66f4\u597d\u7684\u9884\u540e\uff0c\u540c\u65f6\uff0c\u7814\u7a76\u8005\u8fd8\u53d1\u73b0MSI\u7ed3\u76f4\u80a0\u764c\u8f6c\u5316\u4e3a\u6076\u6027\u80bf\u7624\u7684\u673a\u7387\u8f83\u5176\u4ed6\u7c7b\u578b\u4f4e\uff0c\u5c24\u5176\u5bf9\u5e74\u8f7b\u7684MSI\u7ed3\u76f4\u80a0\u764c\u60a3\u8005\u6765\u8bf4\uff0c\u6cbb\u6108\u673a\u7387\u5f88\u5927\u3002 MSI\u7ed3\u76f4\u80a0\u764c\u53ca\u5176\u4ed6\u7c7b\u578bMSI\u764c\u75c7\u665a\u671f\u60a3\u8005\u5229\u7528PD-1\u5355\u6297\u514d\u75ab\u6cbb\u7597\u83b7\u76ca\u8f83\u5927\u3002\u56e0\u6b64\uff0cMSI\u68c0\u6d4b\u53ef\u7528\u4e8e\u6709\u6548\u5730\u8bc4\u4f30PD-1\u5355\u6297\u514d\u75ab\u6cbb\u7597\u5728\u764c\u7ec6\u80de\u6cbb\u7597\u4e2d\u7684\u6548\u76ca\u3002","title":"01 \u7ed3\u76f4\u80a0\u764c"},{"location":"08_DNA/05_somatic/001_Mutect2/","text":"\u65b9\u6cd5 \u5b9a\u4e49\u6d3b\u8dc3\u533a\u57df Mutect2 triages sites for possible somatic variation and determines intervals over which to assemble reads by assigning each site\u2019s read pileup a log odds for somatic activity via a simplified version of the somatic genotyping model, below. A site is considered \u201cactive\u201d if its log odds exceed some threshold. Like HaplotypeCaller, Mutect2 chooses for assembly intervals that surround each active site with some margin. The details of this are discussed in the supplemental material. Assembling Haplotypes Somatic Genotyping \u8fc7\u6ee4 FilterMutectCalls\u9996\u5148\u4f30\u8ba1\u6bcf\u4e2a\u5019\u9009\u7a81\u53d8\u662f\u4f53\u7ec6\u80de\u53d8\u5f02\u7684\u53ef\u80fd\u6027\uff0c\u800c\u4e0d\u662f\u80da\u7cfb\u53d8\u5f02\u6216\u6d4b\u5e8f\u9519\u8bef\u7b49\u3002\u7136\u540e\uff0c\u5b83\u9009\u62e9\u4f7f\u4f30\u8ba1\u7684F\u5206\u6570\u6700\u5927\u5316\u7684\u6982\u7387\u9608\u503c\uff08recall\u548cprecision\u7684 harmonic mean\uff09\uff0c\u5e76\u8fdb\u884c\u76f8\u5e94\u8fc7\u6ee4\u3002\u9519\u8bef\u6982\u7387\u662f\u4ece\u51e0\u79cd\u4e0d\u540c\u7684\u9519\u8bef\u6a21\u578b\u4e2d\u5f97\u51fa\u7684\uff0c\u5176\u4e2d\u6700\u7b80\u5355\u7684\u662f\u786c\u8fc7\u6ee4\u5668\uff0c\u5f53\u6ce8\u91ca\u8d85\u8fc7\u67d0\u4e2a\u9608\u503c\u65f6\uff0c\u5b83\u4eec\u4f1a\u5c06\u9519\u8bef\u6982\u7387\u5206\u914d\u4e3a1\u3002 + Hardfilter: Error probabilities are derived from several different error models, the simplest of which are hard filters that assign an error probability of 1 when an annotation exceeds some threshold. These include filters for variants with an excess of low-quality supporting bases, poor mapping quality, support coming exclusively near the end of reads, a large mismatch in lengths between variant- and reference-supporting fragments, and local haplotypes with too many variants. PON: probabilistic models: germline model The normal artifact model The contamination model short tandem repeat (STR) model strand bias and orientation bias artifacts Results DREAM Challenge Normal-Normal Calls A popular way to measure the false positive rate of somatic variant callers is to assign one normal sample as a \u201ctumor\u201d and a technical replicate of the same sample as the \u201cmatched normal.\u201d Normal mixtures workflow #GATK 3 java -jar GenomeAnalysisTK.jar \\ -T MuTect2 \\ -R <reference> \\ -L <region> \\ -I:tumor <tumor.bam> \\ -I:normal <normal.bam> \\ --normal_panel <pon.vcf> \\ --cosmic <cosmic.vcf> \\ --dbsnp <dbsnp.vcf> \\ --contamination_fraction_to_filter 0.02 \\ -o <mutect_variants.vcf> \\ --output_mode EMIT_VARIANTS_ONLY \\ --disable_auto_index_creation_and_locking_when_reading_rods \u53c2\u6570\u7406\u89e3 GATK Mutect2 \u5b98\u7f51\u6587\u6863\u4e2d\u6709\u5173\u4e8e--cosmic\u548c--dbsnp\u4e24\u4e2a\u53c2\u6570\u7684\u63cf\u8ff0\uff1a \u201cMuTect2 has the ability to use COSMIC data in conjunction with dbSNP to adjust the threshold for evidence of a variant in the normal. If a variant is present in dbSNP, but not in COSMIC, then more evidence is required from the normal sample to prove the variant is not present in germline.\u201d \u53c2\u6570\u7406\u89e3 --disable-read-filter MateOnSameContigOrNoMappedMateReadFilter , \u7981\u7528\u6b64\u8fc7\u6ee4\u5668\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u5c06\u914d\u5bf9\u7684read map\u5230\u4e0d\u540c\u67d3\u8272\u4f53\u4e0a\u7684\u90a3\u4e9breads\u4e5f\u7eb3\u5165\u8003\u8651\uff0c\u4ece\u800c\u4f7f\u5f97\u53ef\u4f9b\u5206\u6790\u7684read\u66f4\u591a\u3002 strand bias FS is Phred-scaled p-value using Fisher\u2019s Exact Test to detect strand bias (the variation being seen on only the forward or only the reverse strand) in the reads. More bias is indicative of false positive calls. One nice explanation could be found in this samtools mailing list post If you have only reads in one strand you can not \"have\" strand bias, or at least you can not measure it, since the other strand has 0 reads. The strand bias measure if the proportion of alleles is statistically different between strands. As you don't have reads in the other strand, you can not measure it. You can only measure allele bias (departure of the 0.5 if you are expecting germline heterozygotes) You can also read here that GATK keeps SNPs with strand bias p-value < 60 for filtering SNP (equivalent to p-value > 0.000001). But they also mention here that A higher score indicates a higher probability that a particular decision is correct, while conversely, a lower score indicates a higher probability that the decision is incorrect. ----https://www.biostars.org/p/244911/ chr10 3875262 . A G 32 . DP=16;AF1=0.5001;CI95=0.5,0.5;DP4=5,0,9,0;MQ=20;FQ=9.52;PV4=1,1,1,0.097 GT:PL:GQ 0/1:62,0,36:39 sb <- matrix(c(3, 1, 1, 3), nrow = 2, dimnames = list(c(\"ref_forward\", \"ref_reverse\"), c(\"alt_forward\", \"alt_reverse\"))) fisher.test(sb, alternative = \"greater\") #ref_forward = number of forward reads supporting the reference #ref_reverse = number of reverse reads supporting the reference #alt_forward = number of forward reads supporting the variant #alt_reverse = number of reverse reads supporting the variant https://sourceforge.net/p/samtools/mailman/samtools-help/thread/4E177430.7030802@bcgsc.ca/ source-code gatk3:https://github.com/broadgsa/gatk-protected/blob/master/protected/gatk-tools-protected/src/main/java/org/broadinstitute/gatk/tools/walkers/cancer/m2/MuTect2.java#L806 gatk3: https://github.com/broadinstitute/mutect/blob/69b7a37fcafe8a68f7470436f24e44df740f1c41/src/org/broadinstitute/cga/tools/gatk/walkers/cancer/mutect/MuTectArgumentCollection.java gatk4:https://github.com/broadinstitute/gatk/blob/master/src/main/java/org/broadinstitute/hellbender/tools/walkers/mutect/filtering/M2FiltersArgumentCollection.java","title":"001 Mutect2"},{"location":"08_DNA/05_somatic/001_Mutect2/#_1","text":"","title":"\u65b9\u6cd5"},{"location":"08_DNA/05_somatic/001_Mutect2/#_2","text":"Mutect2 triages sites for possible somatic variation and determines intervals over which to assemble reads by assigning each site\u2019s read pileup a log odds for somatic activity via a simplified version of the somatic genotyping model, below. A site is considered \u201cactive\u201d if its log odds exceed some threshold. Like HaplotypeCaller, Mutect2 chooses for assembly intervals that surround each active site with some margin. The details of this are discussed in the supplemental material.","title":"\u5b9a\u4e49\u6d3b\u8dc3\u533a\u57df"},{"location":"08_DNA/05_somatic/001_Mutect2/#assembling-haplotypes","text":"","title":"Assembling Haplotypes"},{"location":"08_DNA/05_somatic/001_Mutect2/#somatic-genotyping","text":"","title":"Somatic Genotyping"},{"location":"08_DNA/05_somatic/001_Mutect2/#_3","text":"FilterMutectCalls\u9996\u5148\u4f30\u8ba1\u6bcf\u4e2a\u5019\u9009\u7a81\u53d8\u662f\u4f53\u7ec6\u80de\u53d8\u5f02\u7684\u53ef\u80fd\u6027\uff0c\u800c\u4e0d\u662f\u80da\u7cfb\u53d8\u5f02\u6216\u6d4b\u5e8f\u9519\u8bef\u7b49\u3002\u7136\u540e\uff0c\u5b83\u9009\u62e9\u4f7f\u4f30\u8ba1\u7684F\u5206\u6570\u6700\u5927\u5316\u7684\u6982\u7387\u9608\u503c\uff08recall\u548cprecision\u7684 harmonic mean\uff09\uff0c\u5e76\u8fdb\u884c\u76f8\u5e94\u8fc7\u6ee4\u3002\u9519\u8bef\u6982\u7387\u662f\u4ece\u51e0\u79cd\u4e0d\u540c\u7684\u9519\u8bef\u6a21\u578b\u4e2d\u5f97\u51fa\u7684\uff0c\u5176\u4e2d\u6700\u7b80\u5355\u7684\u662f\u786c\u8fc7\u6ee4\u5668\uff0c\u5f53\u6ce8\u91ca\u8d85\u8fc7\u67d0\u4e2a\u9608\u503c\u65f6\uff0c\u5b83\u4eec\u4f1a\u5c06\u9519\u8bef\u6982\u7387\u5206\u914d\u4e3a1\u3002 + Hardfilter: Error probabilities are derived from several different error models, the simplest of which are hard filters that assign an error probability of 1 when an annotation exceeds some threshold. These include filters for variants with an excess of low-quality supporting bases, poor mapping quality, support coming exclusively near the end of reads, a large mismatch in lengths between variant- and reference-supporting fragments, and local haplotypes with too many variants. PON: probabilistic models: germline model The normal artifact model The contamination model short tandem repeat (STR) model strand bias and orientation bias artifacts","title":"\u8fc7\u6ee4"},{"location":"08_DNA/05_somatic/001_Mutect2/#results","text":"","title":"Results"},{"location":"08_DNA/05_somatic/001_Mutect2/#dream-challenge","text":"","title":"DREAM Challenge"},{"location":"08_DNA/05_somatic/001_Mutect2/#normal-normal-calls","text":"A popular way to measure the false positive rate of somatic variant callers is to assign one normal sample as a \u201ctumor\u201d and a technical replicate of the same sample as the \u201cmatched normal.\u201d","title":"Normal-Normal Calls"},{"location":"08_DNA/05_somatic/001_Mutect2/#normal-mixtures","text":"","title":"Normal mixtures"},{"location":"08_DNA/05_somatic/001_Mutect2/#workflow","text":"#GATK 3 java -jar GenomeAnalysisTK.jar \\ -T MuTect2 \\ -R <reference> \\ -L <region> \\ -I:tumor <tumor.bam> \\ -I:normal <normal.bam> \\ --normal_panel <pon.vcf> \\ --cosmic <cosmic.vcf> \\ --dbsnp <dbsnp.vcf> \\ --contamination_fraction_to_filter 0.02 \\ -o <mutect_variants.vcf> \\ --output_mode EMIT_VARIANTS_ONLY \\ --disable_auto_index_creation_and_locking_when_reading_rods","title":"workflow"},{"location":"08_DNA/05_somatic/001_Mutect2/#_4","text":"GATK Mutect2 \u5b98\u7f51\u6587\u6863\u4e2d\u6709\u5173\u4e8e--cosmic\u548c--dbsnp\u4e24\u4e2a\u53c2\u6570\u7684\u63cf\u8ff0\uff1a \u201cMuTect2 has the ability to use COSMIC data in conjunction with dbSNP to adjust the threshold for evidence of a variant in the normal. If a variant is present in dbSNP, but not in COSMIC, then more evidence is required from the normal sample to prove the variant is not present in germline.\u201d","title":"\u53c2\u6570\u7406\u89e3"},{"location":"08_DNA/05_somatic/001_Mutect2/#_5","text":"--disable-read-filter MateOnSameContigOrNoMappedMateReadFilter , \u7981\u7528\u6b64\u8fc7\u6ee4\u5668\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u5c06\u914d\u5bf9\u7684read map\u5230\u4e0d\u540c\u67d3\u8272\u4f53\u4e0a\u7684\u90a3\u4e9breads\u4e5f\u7eb3\u5165\u8003\u8651\uff0c\u4ece\u800c\u4f7f\u5f97\u53ef\u4f9b\u5206\u6790\u7684read\u66f4\u591a\u3002","title":"\u53c2\u6570\u7406\u89e3"},{"location":"08_DNA/05_somatic/001_Mutect2/#strand-bias","text":"FS is Phred-scaled p-value using Fisher\u2019s Exact Test to detect strand bias (the variation being seen on only the forward or only the reverse strand) in the reads. More bias is indicative of false positive calls. One nice explanation could be found in this samtools mailing list post If you have only reads in one strand you can not \"have\" strand bias, or at least you can not measure it, since the other strand has 0 reads. The strand bias measure if the proportion of alleles is statistically different between strands. As you don't have reads in the other strand, you can not measure it. You can only measure allele bias (departure of the 0.5 if you are expecting germline heterozygotes) You can also read here that GATK keeps SNPs with strand bias p-value < 60 for filtering SNP (equivalent to p-value > 0.000001). But they also mention here that A higher score indicates a higher probability that a particular decision is correct, while conversely, a lower score indicates a higher probability that the decision is incorrect. ----https://www.biostars.org/p/244911/ chr10 3875262 . A G 32 . DP=16;AF1=0.5001;CI95=0.5,0.5;DP4=5,0,9,0;MQ=20;FQ=9.52;PV4=1,1,1,0.097 GT:PL:GQ 0/1:62,0,36:39 sb <- matrix(c(3, 1, 1, 3), nrow = 2, dimnames = list(c(\"ref_forward\", \"ref_reverse\"), c(\"alt_forward\", \"alt_reverse\"))) fisher.test(sb, alternative = \"greater\") #ref_forward = number of forward reads supporting the reference #ref_reverse = number of reverse reads supporting the reference #alt_forward = number of forward reads supporting the variant #alt_reverse = number of reverse reads supporting the variant https://sourceforge.net/p/samtools/mailman/samtools-help/thread/4E177430.7030802@bcgsc.ca/","title":"strand bias"},{"location":"08_DNA/05_somatic/001_Mutect2/#source-code","text":"gatk3:https://github.com/broadgsa/gatk-protected/blob/master/protected/gatk-tools-protected/src/main/java/org/broadinstitute/gatk/tools/walkers/cancer/m2/MuTect2.java#L806 gatk3: https://github.com/broadinstitute/mutect/blob/69b7a37fcafe8a68f7470436f24e44df740f1c41/src/org/broadinstitute/cga/tools/gatk/walkers/cancer/mutect/MuTectArgumentCollection.java gatk4:https://github.com/broadinstitute/gatk/blob/master/src/main/java/org/broadinstitute/hellbender/tools/walkers/mutect/filtering/M2FiltersArgumentCollection.java","title":"source-code"},{"location":"08_DNA/05_somatic/007_Tumor-Heterogeneity-Analysis/","text":"http://compbio.cs.brown.edu/projects/theta/ https://github.com/raphael-group/hatchet https://github.com/raphael-group/CNT-MD","title":"007 Tumor Heterogeneity Analysis"},{"location":"08_DNA/05_somatic/008_cfdna/","text":"[toc] https://www.nejm.org/doi/full/10.1056/NEJMra1705345?query=featured_home& cell-free DNA\u662f\u4e00\u79cd\u5b58\u5728\u4e8e\u5916\u5468\u8840\u4e2d\u7684\u6e38\u79bbDNA\uff0c\u7b80\u79f0cfDNA\u3002cfDNA\u7684\u6765\u6e90\u4e3b\u8981\u6709\u4e24\u79cd\uff1a\u4e00\u79cd\u6765\u6e90\u4e8e\u7ec6\u80de\u7684\u51cb\u4ea1\u8fc7\u7a0b\uff0c\u5176\u7247\u6bb5\u957f\u5ea6\u5728162bp\uff08\u78b1\u57fa\u5bf9\uff09\u5de6\u53f3\uff1b\u53e6\u4e00\u79cd\u6765\u6e90\u4e8e\u7ec6\u80de\u574f\u6b7b\uff0c\u5176\u7247\u6bb5\u957f\u5ea6\u53ef\u8fbe10Kbp\uff0c\u751a\u81f3\u66f4\u957f\u3002\u8fd9\u79cd\u6e38\u79bbDNA\u7684\u751f\u5b58\u5468\u671f\u4e3a10\u5206\u949f\u5230\u82e5\u5e72\u5c0f\u65f6\uff0c\u80fd\u591f\u53cd\u6620\u4e2a\u4f53\u7684\u90e8\u5206\u5b9e\u65f6\u4fe1\u606f\u3002 cfDNA\u7684\u5b9e\u65f6\u6027\u53ef\u4ee5\u7528\u4e8e\u764c\u75c7\u68c0\u6d4b\u548c\u65e9\u671f\u7b5b\u67e5\u3002\u4eba\u4f53\u7684\u514d\u75ab\u7cfb\u7edf\u4f1a\u6253\u788e\u5916\u6e90\u7ec6\u80de\uff0c\u4e5f\u4f1a\u7834\u574f\u80bf\u7624\u7ec6\u80de\uff0c\u968f\u4e4b\u4ea7\u751f\u7684cfDNA\u4f1a\u8fdb\u5165\u8840\u6db2\u4e2d\uff0c\u800c\u8fd9\u4e9bcfDNA\u4f1a\u5e26\u6709\u80bf\u7624\u7684\u7a81\u53d8\u4fe1\u606f\u3002\u4f46\u662f\u8fd9\u79cd\u7a81\u53d8\u7684\u4fe1\u606f\u91cf\u975e\u5e38\u4f4e\uff1a\u65e9\u671f\u80bf\u7624\u60a3\u8005\u5faa\u73af\u5916\u5468\u8840\u4e2d\u80bf\u7624cfDNA\u5373ctDNA\u6bd4\u4f8b\u57280.01%\u20141%\u4e4b\u95f4\uff1b\u665a\u671f\u80bf\u7624\u60a3\u8005\u7684ctDNA\u6bd4\u4f8b\u5219\u660e\u663e\u589e\u9ad8\uff0c\u53ef\u4ee5\u8fbe\u52300.1%\u20145%\u3002\u76ee\u524d\u5927\u591a\u6570\u764c\u75c7\u60a3\u8005\u5728\u53d1\u73b0\u8eab\u4f53\u660e\u663e\u4e0d\u9002\u540e\u624d\u8fdb\u884c\u5c31\u8bca\uff0c\u800c\u6b64\u65f6\u60a3\u8005\u57fa\u672c\u4e0a\u5df2\u7ecf\u5904\u4e8e\u764c\u75c7\u7684\u665a\u671f\u3002\u8fd9\u65e0\u7591\u589e\u52a0\u4e86\u6cbb\u6108\u764c\u75c7\u7684\u96be\u5ea6\u3002\u56e0\u6b64\uff0c\u5982\u679c\u53ef\u4ee5\u63d0\u9ad8\u68c0\u6d4b\u764c\u75c7\u7a81\u53d8\u7684\u7075\u654f\u5ea6\uff0c\u6bd4\u5982\u80fd\u591f\u68c0\u6d4b0.2%\u7684\u7a81\u53d8\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u63d0\u524d\u53d1\u73b0\u764c\u75c7\u3002\u8fd9\u5bf9\u4e8e\u4e34\u5e8a\u533b\u5b66\u4ee5\u53ca\u764c\u75c7\u786e\u8bca\u90fd\u5177\u6709\u91cd\u5927\u7684\u610f\u4e49\u3002 \u76ee\u524d\u6db2\u4f53\u6d3b\u68c0\u7684\u9776\u6807\u5305\u62ec\uff1a\u6e38\u79bb\u7684\u5faa\u73af\u80bf\u7624\u7ec6\u80de\uff08CTCs\uff09\u3001\u5faa\u73af\u80bf\u7624DNA\uff08ctDNA\uff09\u3001\u5faa\u73af\u80bf\u7624RNA\uff08ctRNA\uff09\u548c\u5916\u6ccc\u4f53\uff08\u643a\u5e26\u6709\u7ec6\u80de\u6765\u6e90\u76f8\u5173\u7684\u591a\u79cd\u86cb\u767d\u8d28\uff0c\u8102\u7c7b\uff0cDNA\uff0cRNA\u7b49\uff09\u3002 ctDNA\u662f\u80bf\u7624\u7ec6\u80de\u5728\u574f\u6b7b\u3001\u51cb\u4ea1\u540e\u91ca\u653e\u7684\u4e00\u79cd\u6e38\u79bbDNA\uff08cfDNA\uff09\uff0c\u5728\u8840\u6db2\u4e2d\u7684\u534a\u8870\u671f\u77ed\uff0c\u53ef\u4ee5\u5b9e\u65f6\u53cd\u6620\u80bf\u7624\u7684\u52a8\u6001\u53d8\u5316\u3002 \u80bf\u7624\u60a3\u8005\u4f53\u5185\u7684\u80bf\u7624\u7ec6\u80de\u6570\u91cf\u8fdc\u8fdc\u4f4e\u4e8e\u6b63\u5e38\u7ec6\u80de\uff0ccfDNA\u5728\u8840\u6d46\u4e2d\u7684\u542b\u91cf\u5f88\u4f4e\uff0c\u800cctDNA\u4ec5\u5360cfDNA\u76840.1%~5%\uff0c\u4e14\u4e0d\u540c\u764c\u79cd\uff0c\u4e0d\u540c\u75c5\u7a0b\u7684\u80bf\u7624\u60a3\u8005ctDNA\u5728\u8840\u6d46\u4e2d\u542b\u91cf\u5dee\u5f02\u8f83\u5927\uff0c\u56e0\u6b64\u76f8\u6bd4\u4e8e\u7ec4\u7ec7\u68c0\u6d4b\uff0cctDNA\u7684\u68c0\u6d4b\u9700\u8981\u66f4\u9ad8\u7684\u7075\u654f\u5ea6\u548c\u7279\u5f02\u6027\u3002 http://www.biotrainee.com/thread-197-1-1.html https://www.ncbi.nlm.nih.gov/pubmed/28205231 https://www.ncbi.nlm.nih.gov/pubmed/28872127 https://bbs.genelinks.com/thread-1030-1-1.html https://github.com/OpenGene/CfdnaPattern https://github.com/Martiantian/Somatic_cnv_detect_tool https://github.com/sfu-compbio/sinvict https://github.com/PeterUlz/PlasmaSeq http://clinchem.aaccjnls.org/content/clinchem/early/2018/08/27/clinchem.2018.289629.full.pdf https://github.com/christacaggiano/cell-free-dna-reading-list https://github.com/haoziyeung/somatic_pipeline https://github.com/sfu-compbio/sinvict https://github.com/CGATOxford/UMI-tools","title":"008 cfdna"},{"location":"08_DNA/05_somatic/008_cfdna/#_1","text":"http://www.biotrainee.com/thread-197-1-1.html https://www.ncbi.nlm.nih.gov/pubmed/28205231 https://www.ncbi.nlm.nih.gov/pubmed/28872127 https://bbs.genelinks.com/thread-1030-1-1.html https://github.com/OpenGene/CfdnaPattern https://github.com/Martiantian/Somatic_cnv_detect_tool https://github.com/sfu-compbio/sinvict https://github.com/PeterUlz/PlasmaSeq http://clinchem.aaccjnls.org/content/clinchem/early/2018/08/27/clinchem.2018.289629.full.pdf https://github.com/christacaggiano/cell-free-dna-reading-list https://github.com/haoziyeung/somatic_pipeline https://github.com/sfu-compbio/sinvict","title":""},{"location":"08_DNA/05_somatic/008_cfdna/#_2","text":"https://github.com/CGATOxford/UMI-tools","title":""},{"location":"08_DNA/05_somatic/008_cfdna_paper/","text":"https://github.com/dkleftogi/cfDNA_AnalysisPipeline A Universal Analysis Pipeline for Hybrid Capture-Based Targeted Sequencing Data with Unique Molecular Indexes","title":"https://github.com/dkleftogi/cfDNA_AnalysisPipeline"},{"location":"08_DNA/05_somatic/008_cfdna_paper/#httpsgithubcomdkleftogicfdna_analysispipeline","text":"","title":"https://github.com/dkleftogi/cfDNA_AnalysisPipeline"},{"location":"08_DNA/05_somatic/008_cfdna_paper/#a-universal-analysis-pipeline-for-hybrid-capture-based-targeted-sequencing-data-with-unique-molecular-indexes","text":"","title":"A Universal Analysis Pipeline for Hybrid Capture-Based Targeted Sequencing Data with Unique Molecular Indexes"},{"location":"08_DNA/05_somatic/009_MSI/","text":"\u5fae\u536b\u661f\u4e0d\u7a33\u5b9a\u68c0\u6d4b \u6982\u5ff5 \u5fae\u536b\u661f, \u5373\u77ed\u4e32\u8054\u91cd\u590d\u5e8f\u5217, \u662f\u5e7f\u6cdb\u5206\u5e03\u5728\u771f\u6838\u751f\u7269\u57fa\u56e0\u7ec4\u4e2d\u7684(\u539f\u6838\u751f\u7269\u57fa\u56e0\u7ec4\u4e2d\u4e5f\u6709\u5c11\u91cf\u5206\u5e03), \u4ee51-6bp\u4e3a\u4e00\u4e2a\u91cd\u590d\u5355\u5143, \u91cd\u590d\u6b21\u6570\u4e0d\u8d85\u8fc760\u6b21\u7684DNA\u5e8f\u5217. \u4eba\u7c7b\u57fa\u56e0\u7ec4\u4e2d\u6709\u6570\u4ee5\u4e07\u8ba1\u7684\u5fae\u536b\u661f\u4f4d\u70b9, \u8fd9\u4e9b\u5fae\u536b\u661f\u4f4d\u70b9\u8fd1\u4f3c\u5747\u5300\u5730\u5206\u5e03\u5728\u5404\u4e2a\u67d3\u8272\u4f53\u4e0a, \u6240\u6709\u7684\u5fae\u536b\u661f\u5e8f\u5217\u7ea6\u5360\u6574\u4e2a\u57fa\u56e0\u7ec4\u76843%. \u5fae\u536b\u661f\u6309\u7167\u91cd\u590d\u5355\u5143\u7684\u5927\u5c0f\u53ef\u5206\u4e3a\u5355\u6838\u82f7\u9178\u3001\u4e8c\u6838\u82f7\u9178\u3001\u4e09\u6838\u82f7\u9178\u3001\u56db\u6838\u82f7\u9178\u3001\u4e94\u6838\u82f7\u9178\u3001\u516d\u6838\u82f7\u9178\u91cd\u590d; \u6309\u7167\u91cd\u590d\u5e8f\u5217\u7684\u7ed3\u6784\u53ef\u5206\u4e3a\u7b80\u5355\u91cd\u590d(\u7531\u5355\u4e00\u91cd\u590d\u5355\u5143\u6784\u6210)\u548c\u590d\u5408\u91cd\u590d(\u7531\u91cd\u590d\u5355\u5143\u4e0d\u540c\u7684\u591a\u4e2a\u91cd\u590d\u5e8f\u5217\u6784\u6210). \u4e0eDNA\u4e2d\u7684\u5176\u4ed6\u533a\u57df\u76f8\u6bd4, \u5fae\u536b\u661f\u533a\u57df\u5177\u6709\u8f83\u9ad8\u7684\u7a81\u53d8\u7387[1]. \u5176\u9ad8\u7a81\u53d8\u7387\u7684\u76f4\u63a5\u8868\u73b0\u662f\u9ad8\u5ea6\u7684\u591a\u6001\u6027[2], \u5373\u4e0d\u540c\u4e2a\u4f53\u4e4b\u95f4\u6216\u6b63\u5e38\u7ec4\u7ec7\u4e0e\u80bf\u7624\u7ec4\u7ec7\u4e4b\u95f4, \u5fae\u536b\u661f\u4f4d\u70b9\u91cd\u590d\u5355\u5143\u7684\u91cd\u590d\u6b21\u6570\u5b58\u5728\u5dee\u5f02. \u7531\u4e8e\u5fae\u536b\u661f\u4f4d\u70b9\u7684\u5206\u5e03\u5e7f\u6cdb\u6027\u53ca\u9ad8\u5ea6\u591a\u6001\u6027, \u5fae\u536b\u661f\u5e38\u7528\u4e8e\u4e2a\u4f53\u9274\u5b9a\u3001\u8fde\u9501\u56fe\u8c31\u7684\u7ed8\u5236\u4ee5\u53ca\u80bf\u7624\u53d1\u751f\u673a\u5236\u7684\u7814\u7a76. \u5fae\u536b\u661f\u4e0d\u7a33\u5b9a(Micro Satellite Instability, MSI), \u662f\u6307\u5fae\u536b\u661f\u4f4d\u70b9\u91cd\u590d\u5355\u5143\u7684\u91cd\u590d\u6b21\u6570\u51fa\u73b0\u6ce2\u52a8\u7684\u73b0\u8c61, \u5373\u91cd\u590d\u5355\u5143\u7684\u63d2\u5165\u4e0e\u5220\u9664. \u73b0\u666e\u904d\u8ba4\u4e3a\u8fd9\u79cd\u73b0\u8c61\u662f\u7531DNA\u5728\u590d\u5236\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u201c\u94fe\u6ed1\u201d(strand slippage)\u5f15\u8d77\u7684. DNA\u5728\u590d\u5236\u8fc7\u7a0b\u4e2d, DNA\u805a\u5408\u9176\u6cbf\u6a21\u677f\u94fe\u6ed1\u52a8, \u5b50\u94fe\u4e0e\u6a21\u677f\u94fe\u4f1a\u53d1\u751f\u5c40\u90e8\u5206\u79bb\u548c\u91cd\u65b0\u914d\u5bf9. \u5728\u91cd\u65b0\u914d\u5bf9\u7684\u8fc7\u7a0b\u4e2d, \u5b50\u94fe\u4e0e\u6a21\u7248\u94fe\u53d1\u751f\u9519\u914d, \u5c31\u4f1a\u5bfc\u81f4\u4e00\u4e2a\u6216\u51e0\u4e2a\u91cd\u590d\u5355\u5143\u5f62\u6210\u51f8\u73af. \u4e00\u822c\u60c5\u51b5\u4e0b, \u8fd9\u79cd\u9519\u8bef\u4f1a\u88abDNA\u7684\u9519\u914d\u4fee\u590d\u7cfb\u7edf(Mismatch Repair, MMR)\u4fee\u590d, \u7136\u800c, \u5f53MMR\u4e2d\u7684\u76f8\u5173\u57fa\u56e0\u7531\u4e8e\u542f\u52a8\u5b50\u8d85\u7532\u57fa\u5316\u6216\u57fa\u56e0\u7a81\u53d8\u7b49\u539f\u56e0\u51fa\u73b0\u6545\u969c, DNA\u590d\u5236\u9519\u8bef\u65e0\u6cd5\u88ab\u4fee\u590d, \u4e00\u4e9b\u5fae\u536b\u661f\u4f4d\u70b9\u91cd\u590d\u5355\u5143\u7684\u91cd\u590d\u6b21\u6570\u53d1\u751f\u6ce2\u52a8, \u8fdb\u800c\u53d1\u751f\u5fae\u536b\u661f\u4e0d\u7a33\u5b9a[3]. \u4e0d\u540c\u7684\u5fae\u536b\u661f\u4f4d\u70b9\u7a33\u5b9a\u6027\u4e0d\u540c. \u5fae\u536b\u661f\u91cd\u590d\u5355\u5143\u7684\u5927\u5c0f\u3001\u91cd\u590d\u5355\u5143\u7684\u78b1\u57fa\u7ec4\u6210\u3001\u91cd\u590d\u5e8f\u5217\u7684\u7ed3\u6784\u53ca\u91cd\u590d\u6b21\u6570\u7b49\u90fd\u4f1a\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5f71\u54cd\u4f4d\u70b9\u7684\u7a33\u5b9a\u6027. \u6839\u636e\u5fae\u536b\u661f\u4e0d\u7a33\u5b9a\u7684\u7a0b\u5ea6, \u53ef\u4ee5\u5c06MSI\u5206\u4e3aMSI-H (MicroSatellite Instability High), MSI-L (MicroSatellite Instability Low)\u4ee5\u53caMSS (MicroSatellite Stable). \u5fae\u536b\u661f\u662f\u5e7f\u6cdb\u5206\u5e03\u5728\u771f\u6838\u751f\u7269\u57fa\u56e0\u7ec4\u4e2d\u7684\u77ed\u4e32\u8054\u91cd\u590d\u5e8f\u5217. \u5fae\u536b\u661f\u4e0d\u7a33\u5b9a(Microsatellite Instability, MSI)\u662f\u6307\u7531DNA\u9519\u914d\u4fee\u590d\u7cfb\u7edf\u6545\u969c\u5f15\u8d77\u7684\u5fae\u536b\u661f\u533a\u57df\u91cd\u590d\u5e8f\u5217\u63d2\u5165\u6216\u7f3a\u5931\u7684\u73b0\u8c61\u3002MSI\u662f\u6307\u4e0e\u6b63\u5e38\u7ec4\u7ec7\u76f8\u6bd4\uff0c\u5728\u80bf\u7624\u4e2d\u67d0\u4e00\u5fae\u536b\u661f\u7531\u4e8e\u91cd\u590d\u5355\u4f4d\u7684\u63d2\u5165\u6216\u7f3a\u5931\u800c\u9020\u6210\u7684\u5fae\u536b\u661f\u957f\u5ea6\u7684\u4efb\u4f55\u6539\u53d8\uff0c\u51fa\u73b0\u65b0\u7684\u5fae\u536b\u661f\u7b49\u4f4d\u57fa\u56e0\u73b0\u8c61\u3002 1993\u5e74, Aaltonen\u7b49\u4eba\u9996\u6b21\u5728\u5bb6\u65cf\u6027\u9057\u4f20\u6027\u7ed3\u76f4\u80a0\u764c(Hereditary Non-Polyposis Colorectal Cancer, HNPCC)\u4e2d\u53d1\u73b0\u9ad8\u9891\u7387\u7684MSI[4]. \u5fae\u536b\u661f\u4e0d\u7a33\u5b9a\u5728\u5927\u7ea615%\u7684\u7ed3\u76f4\u80a0\u764c\u4ee5\u53ca90%\u7684\u6797\u5947\u7efc\u5408\u75c7(HNPCC, \u53c8\u79f0Lynch Syndrome)\u4e2d\u8d77\u51b3\u5b9a\u4f5c\u7528[5]. \u8fd1\u5e74\u6765\u7684\u7814\u7a76\u8868\u660e, MSI\u5bf9\u6797\u5947\u7efc\u5408\u75c7\u4ee5\u53ca\u7ed3\u76f4\u80a0\u764c\u7684\u8bca\u65ad\u3001\u9884\u540e\u4ee5\u53ca\u5316\u7597\u654f\u611f\u6027\u6709\u91cd\u8981\u7684\u610f\u4e49. \u9664\u4e86\u7ed3\u76f4\u80a0\u764c, \u7814\u7a76\u4eba\u5458\u4e5f\u76f8\u7ee7\u5728\u5b50\u5bab\u5185\u819c\u764c\u3001\u5375\u5de2\u764c[6]\u3001\u80c3\u764c\u4ee5\u53ca\u4e73\u817a\u764c[7]\u7b49\u75be\u75c5\u4e2d\u53d1\u73b0MSI. MSI\u4f5c\u4e3a\u80bf\u7624\u9057\u4f20\u4e0d\u7a33\u5b9a\u7684\u654f\u611f\u6307\u6807, \u5176\u68c0\u6d4b\u5bf9\u4e8e\u80bf\u7624\u7684\u65e9\u671f\u8bca\u65ad\u3001\u9884\u540e\u5224\u65ad\u3001\u5316\u7597\u654f\u611f\u6027\u5224\u65ad\u4ee5\u53ca\u9ad8\u5371\u4eba\u7fa4\u7684\u5708\u5b9a\u7b49\u5177\u6709\u91cd\u8981\u610f\u4e49. \u5df2\u6709\u4e0d\u5c11\u7814\u7a76\u53d1\u73b0MSI-H\u7684\u80bf\u7624\u60a3\u8005\u76f8\u5bf9\u4e8eMSS\u7684\u80bf\u7624\u60a3\u8005\u6709\u66f4\u597d\u7684\u9884\u540e[8,9], \u540c\u65f6MSI-H\u80bf\u7624\u60a3\u8005\u5bf9\u4e0d\u540c\u5316\u7597\u65b9\u6cd5\u7684\u654f\u611f\u6027\u4e5f\u8868\u73b0\u51fa\u5dee\u5f02[10]. \u5fae\u536b\u661f\uff08microsatellite\uff09\u5e7f\u6cdb\u5b58\u5728\u4e8e\u539f\u6838\u53ca\u771f\u6838\u751f\u7269\u57fa\u56e0\u7ec4\u4e2d\uff0c\u5177\u6709\u8f83\u9ad8\u7684\u9057\u4f20\u7a33\u5b9a\u6027\uff0c\u4f46\u5728\u9519\u914d\u4fee\u590d\u57fa\u56e0\u529f\u80fd\u53d1\u751f\u5f02\u5e38\u65f6\uff0c\u5b50\u4ee3\u7ec6\u80de\u5fae\u536b\u661f\u7684\u91cd\u590d\u6838\u82f7\u9178\u6570\u91cf\u53ef\u589e\u591a\u6216\u51cf\u5c11\uff0c\u5bfc\u81f4\u5fae\u536b\u661f\u7684\u957f\u5ea6\u4e0d\u518d\u4fdd\u6301\u4e00\u81f4\uff0c\u8fd9\u79cd\u73b0\u8c61\u79f0MSI (Microsatellite Instability)(\u56fe1)\u3002 \u9519\u914d\u4fee\u590dMMR\uff08MisMatch Repair\uff09\uff0c\u91cd\u8981\u7684DNA\u4fee\u590d\u673a\u5236\uff0c\u80fd\u591f\u51c6\u786e\u5730\u8bc6\u522b\u53ca\u4fee\u590d\u5728DNA\u590d\u5236\u6216\u91cd\u7ec4\u8fc7\u7a0b\u4e2d\u4ea7\u751f\u7684\u78b1\u57fa\u9519\u914d\uff0c\u5c0f\u8303\u56f4\u7684\u78b1\u57fa\u7f3a\u5931\u6216\u63d2\u5165\uff0c\u5bf9\u7ef4\u6301\u57fa\u56e0\u7ec4\u7a33\u5b9a\u6027\uff0c\u9057\u4f20\u540e\u4ee3\u7684\u7cbe\u786e\u6027\u6709\u7740\u91cd\u8981\u7684\u4f5c\u7528\u3002\u5f53MMR\u4fee\u590d\u673a\u5236\u51fa\u73b0\u6545\u969c\uff0c\u53c2\u4e0eMMR\u4fee\u590d\u7684\u57fa\u56e0\u53d1\u751f\u4e86\u7a81\u53d8\uff0c\u5bfc\u81f4\u57fa\u56e0\u529f\u80fd\u7f3a\u9677\uff0cMMR\u4fee\u590d\u80fd\u529b\u4e0b\u964d\u6216\u7f3a\u5931\uff08dMMR\uff09\uff0c\u4ece\u800c\u5bfc\u81f4MSI\u3002 \u5fae\u536b\u661f\u662f\u4e00\u79cd\u77ed\u4e32\u8054\u91cd\u590d\u5e8f\u5217\uff0c\u7531\u4e8e\u5fae\u536b\u661f\u7684\u91cd\u590d\u5e8f\u5217\u5728DNA\u590d\u5236\u8fc7\u7a0b\u4e2d\u56fa\u6709\u4e0d\u7a33\u5b9a\u6027\u3002\u5728\u6b63\u5e38\u7ec6\u80de\u4e2dDNA\u9519\u914d\u4fee\u590d\u7cfb\u7edf\u53ef\u4ee5\u5feb\u901f\u4fee\u6b63\u8fd9\u79cd\u9519\u8bef\uff0c\u4f46\u662f\u80bf\u7624\u7ec4\u7ec7\u4e2d\u5e38\u89c1\u9519\u914d\u4fee\u590d\u57fa\u56e0\u7f3a\u9677\uff0c\u5f15\u8d77\u91cd\u590d\u5355\u4f4d\u63d2\u5165\u6216\u7f3a\u5931\u5bfc\u81f4\u5fae\u536b\u661f\u957f\u5ea6\u6539\u53d8\uff0c\u4ece\u800c\u8868\u73b0\u4e3aMSI\uff0c\u5373\u5fae\u536b\u661f\u4e0d\u7a33\u5b9a\u6027(microsatellite instablility)\uff0c \u5df2\u6709\u7814\u7a76\u8868\u660e\uff0cMSI\u4e0e\u80bf\u7624\u7684\u53d1\u751f\u5bc6\u5207\u76f8\u5173\u3002 \u68c0\u6d4b\u65b9\u6cd5 \u514d\u75ab\u7ec4\u7ec7\u5316\u5b66\uff08immunohistochemistry\uff0cIHC\uff09\u6cd5 MMR dMMR http://www.c-s-a.org.cn/html/2018/10/6591.html \u4e00\u822c\u7684\uff0c\u5f53\u6709\u4e24\u4e2amarker\u4e0d\u7a33\u5b9a\uff08\u5c0fpanel\uff09\u6216\u800530%\u4ee5\u4e0a\u7684marker\u4e0d\u7a33\u5b9a\u65f6\uff08\u5927panel\uff09\uff0c\u5c31\u662fMSI-H\uff1b\u5f53\u6709\u4e00\u4e2amarker\u4e0d\u7a33\u5b9a\uff08\u5c0fpanel\uff09\u6216\u800530%\u4ee5\u4e0b\u7684marker\u4e0d\u7a33\u5b9a\u65f6\uff08\u5927panel\uff09\uff0c\u5c31\u662fMSI-L\uff1b\u5f53\u6ca1\u6709marker\u4e0d\u7a33\u5b9a\u65f6\uff0c\u5c31\u662fMSS\u3002 https://www.biostars.org/p/320954/ https://chengcz.github.io/2018/201810_MSI/ MSI msisensor mSINGS - Tumor only https://jingbio.netlify.com/2019/06/05/whole-exome_analysis/ http://www.360doc.com/content/19/0122/19/52645714_810652283.shtml https://bitbucket.org/uwlabmed/msings/pull-requests/1/depth-questions-massive-msings-overhaul/diff https://bitbucket.org/uwlabmed/msings/src/master/ MSIsensor MSI_H: msiscore >= 10%, MSI_L: 3.5% =< msiscore < 10%; MSS: msiscore < 3.5% MSIsensor2 \u5bf9\u4e8etumoronly\u6837\u672c\uff0cMSIsensor2\u5229\u7528\u673a\u5668\u5b66\u4e60\u6a21\u578b\u7684\u65b9\u6cd5\u627e\u51fa\u6bcf\u4e2a\u5fae\u536b\u661f\u5206\u5e03\u7684MSI\u72b6\u6001\u3002\u6700\u540e\u5f97\u5230msi-score\uff0cmsi\u4f4d\u70b9\u7684\u6570\u91cf\u9664\u4ee5\u6240\u6709\u4f4d\u70b9\u3002 \u63a8\u8350\u7684msi-score\u9608\u503c\u662f20%\uff0c\u5373>= 20%\u7684\uff0cmsi high\u3002 https://github.com/niu-lab/msisensor2 git clone https://github.com/niu-lab/msisensor2.git cd msisensor2 chmod +x msisensor2 msisensor2 msi -M models_hg19 -t tumor.bam -o results msisensor2 \u4e0d\u80fd\u4f7f\u7528bed\u6587\u4ef6\u53c2\u6570\uff0c\u7a0b\u5e8f\u4e2d\u663e\u793a\u7684\u53c2\u6570\u662f\u9519\u8bef\u7684\uff0c\u5e94\u8be5\u4ee5github\u9875\u9762\u7684\u53c2\u6570\u4e3a\u51c6\uff0c\u540e\u7eed\u66f4\u65b0\u5e94\u8be5\u4f1a\u4fee\u6b63\u3002\u611f\u89c9\u6bd4\u8f83\u9002\u7528\u4e8e\u5927panel\u3002 http://niulab.scgrid.cn/msisensor2/faq.jsp \"msi high: msi score >= 20%\u201d for MSIsensor2. http://www.seqchina.cn/1568.html https://zhuanlan.zhihu.com/p/28817217","title":"009 MSI"},{"location":"08_DNA/05_somatic/009_MSI/#_1","text":"\u5fae\u536b\u661f, \u5373\u77ed\u4e32\u8054\u91cd\u590d\u5e8f\u5217, \u662f\u5e7f\u6cdb\u5206\u5e03\u5728\u771f\u6838\u751f\u7269\u57fa\u56e0\u7ec4\u4e2d\u7684(\u539f\u6838\u751f\u7269\u57fa\u56e0\u7ec4\u4e2d\u4e5f\u6709\u5c11\u91cf\u5206\u5e03), \u4ee51-6bp\u4e3a\u4e00\u4e2a\u91cd\u590d\u5355\u5143, \u91cd\u590d\u6b21\u6570\u4e0d\u8d85\u8fc760\u6b21\u7684DNA\u5e8f\u5217. \u4eba\u7c7b\u57fa\u56e0\u7ec4\u4e2d\u6709\u6570\u4ee5\u4e07\u8ba1\u7684\u5fae\u536b\u661f\u4f4d\u70b9, \u8fd9\u4e9b\u5fae\u536b\u661f\u4f4d\u70b9\u8fd1\u4f3c\u5747\u5300\u5730\u5206\u5e03\u5728\u5404\u4e2a\u67d3\u8272\u4f53\u4e0a, \u6240\u6709\u7684\u5fae\u536b\u661f\u5e8f\u5217\u7ea6\u5360\u6574\u4e2a\u57fa\u56e0\u7ec4\u76843%. \u5fae\u536b\u661f\u6309\u7167\u91cd\u590d\u5355\u5143\u7684\u5927\u5c0f\u53ef\u5206\u4e3a\u5355\u6838\u82f7\u9178\u3001\u4e8c\u6838\u82f7\u9178\u3001\u4e09\u6838\u82f7\u9178\u3001\u56db\u6838\u82f7\u9178\u3001\u4e94\u6838\u82f7\u9178\u3001\u516d\u6838\u82f7\u9178\u91cd\u590d; \u6309\u7167\u91cd\u590d\u5e8f\u5217\u7684\u7ed3\u6784\u53ef\u5206\u4e3a\u7b80\u5355\u91cd\u590d(\u7531\u5355\u4e00\u91cd\u590d\u5355\u5143\u6784\u6210)\u548c\u590d\u5408\u91cd\u590d(\u7531\u91cd\u590d\u5355\u5143\u4e0d\u540c\u7684\u591a\u4e2a\u91cd\u590d\u5e8f\u5217\u6784\u6210). \u4e0eDNA\u4e2d\u7684\u5176\u4ed6\u533a\u57df\u76f8\u6bd4, \u5fae\u536b\u661f\u533a\u57df\u5177\u6709\u8f83\u9ad8\u7684\u7a81\u53d8\u7387[1]. \u5176\u9ad8\u7a81\u53d8\u7387\u7684\u76f4\u63a5\u8868\u73b0\u662f\u9ad8\u5ea6\u7684\u591a\u6001\u6027[2], \u5373\u4e0d\u540c\u4e2a\u4f53\u4e4b\u95f4\u6216\u6b63\u5e38\u7ec4\u7ec7\u4e0e\u80bf\u7624\u7ec4\u7ec7\u4e4b\u95f4, \u5fae\u536b\u661f\u4f4d\u70b9\u91cd\u590d\u5355\u5143\u7684\u91cd\u590d\u6b21\u6570\u5b58\u5728\u5dee\u5f02. \u7531\u4e8e\u5fae\u536b\u661f\u4f4d\u70b9\u7684\u5206\u5e03\u5e7f\u6cdb\u6027\u53ca\u9ad8\u5ea6\u591a\u6001\u6027, \u5fae\u536b\u661f\u5e38\u7528\u4e8e\u4e2a\u4f53\u9274\u5b9a\u3001\u8fde\u9501\u56fe\u8c31\u7684\u7ed8\u5236\u4ee5\u53ca\u80bf\u7624\u53d1\u751f\u673a\u5236\u7684\u7814\u7a76. \u5fae\u536b\u661f\u4e0d\u7a33\u5b9a(Micro Satellite Instability, MSI), \u662f\u6307\u5fae\u536b\u661f\u4f4d\u70b9\u91cd\u590d\u5355\u5143\u7684\u91cd\u590d\u6b21\u6570\u51fa\u73b0\u6ce2\u52a8\u7684\u73b0\u8c61, \u5373\u91cd\u590d\u5355\u5143\u7684\u63d2\u5165\u4e0e\u5220\u9664. \u73b0\u666e\u904d\u8ba4\u4e3a\u8fd9\u79cd\u73b0\u8c61\u662f\u7531DNA\u5728\u590d\u5236\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u201c\u94fe\u6ed1\u201d(strand slippage)\u5f15\u8d77\u7684. DNA\u5728\u590d\u5236\u8fc7\u7a0b\u4e2d, DNA\u805a\u5408\u9176\u6cbf\u6a21\u677f\u94fe\u6ed1\u52a8, \u5b50\u94fe\u4e0e\u6a21\u677f\u94fe\u4f1a\u53d1\u751f\u5c40\u90e8\u5206\u79bb\u548c\u91cd\u65b0\u914d\u5bf9. \u5728\u91cd\u65b0\u914d\u5bf9\u7684\u8fc7\u7a0b\u4e2d, \u5b50\u94fe\u4e0e\u6a21\u7248\u94fe\u53d1\u751f\u9519\u914d, \u5c31\u4f1a\u5bfc\u81f4\u4e00\u4e2a\u6216\u51e0\u4e2a\u91cd\u590d\u5355\u5143\u5f62\u6210\u51f8\u73af. \u4e00\u822c\u60c5\u51b5\u4e0b, \u8fd9\u79cd\u9519\u8bef\u4f1a\u88abDNA\u7684\u9519\u914d\u4fee\u590d\u7cfb\u7edf(Mismatch Repair, MMR)\u4fee\u590d, \u7136\u800c, \u5f53MMR\u4e2d\u7684\u76f8\u5173\u57fa\u56e0\u7531\u4e8e\u542f\u52a8\u5b50\u8d85\u7532\u57fa\u5316\u6216\u57fa\u56e0\u7a81\u53d8\u7b49\u539f\u56e0\u51fa\u73b0\u6545\u969c, DNA\u590d\u5236\u9519\u8bef\u65e0\u6cd5\u88ab\u4fee\u590d, \u4e00\u4e9b\u5fae\u536b\u661f\u4f4d\u70b9\u91cd\u590d\u5355\u5143\u7684\u91cd\u590d\u6b21\u6570\u53d1\u751f\u6ce2\u52a8, \u8fdb\u800c\u53d1\u751f\u5fae\u536b\u661f\u4e0d\u7a33\u5b9a[3]. \u4e0d\u540c\u7684\u5fae\u536b\u661f\u4f4d\u70b9\u7a33\u5b9a\u6027\u4e0d\u540c. \u5fae\u536b\u661f\u91cd\u590d\u5355\u5143\u7684\u5927\u5c0f\u3001\u91cd\u590d\u5355\u5143\u7684\u78b1\u57fa\u7ec4\u6210\u3001\u91cd\u590d\u5e8f\u5217\u7684\u7ed3\u6784\u53ca\u91cd\u590d\u6b21\u6570\u7b49\u90fd\u4f1a\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5f71\u54cd\u4f4d\u70b9\u7684\u7a33\u5b9a\u6027. \u6839\u636e\u5fae\u536b\u661f\u4e0d\u7a33\u5b9a\u7684\u7a0b\u5ea6, \u53ef\u4ee5\u5c06MSI\u5206\u4e3aMSI-H (MicroSatellite Instability High), MSI-L (MicroSatellite Instability Low)\u4ee5\u53caMSS (MicroSatellite Stable). \u5fae\u536b\u661f\u662f\u5e7f\u6cdb\u5206\u5e03\u5728\u771f\u6838\u751f\u7269\u57fa\u56e0\u7ec4\u4e2d\u7684\u77ed\u4e32\u8054\u91cd\u590d\u5e8f\u5217. \u5fae\u536b\u661f\u4e0d\u7a33\u5b9a(Microsatellite Instability, MSI)\u662f\u6307\u7531DNA\u9519\u914d\u4fee\u590d\u7cfb\u7edf\u6545\u969c\u5f15\u8d77\u7684\u5fae\u536b\u661f\u533a\u57df\u91cd\u590d\u5e8f\u5217\u63d2\u5165\u6216\u7f3a\u5931\u7684\u73b0\u8c61\u3002MSI\u662f\u6307\u4e0e\u6b63\u5e38\u7ec4\u7ec7\u76f8\u6bd4\uff0c\u5728\u80bf\u7624\u4e2d\u67d0\u4e00\u5fae\u536b\u661f\u7531\u4e8e\u91cd\u590d\u5355\u4f4d\u7684\u63d2\u5165\u6216\u7f3a\u5931\u800c\u9020\u6210\u7684\u5fae\u536b\u661f\u957f\u5ea6\u7684\u4efb\u4f55\u6539\u53d8\uff0c\u51fa\u73b0\u65b0\u7684\u5fae\u536b\u661f\u7b49\u4f4d\u57fa\u56e0\u73b0\u8c61\u3002 1993\u5e74, Aaltonen\u7b49\u4eba\u9996\u6b21\u5728\u5bb6\u65cf\u6027\u9057\u4f20\u6027\u7ed3\u76f4\u80a0\u764c(Hereditary Non-Polyposis Colorectal Cancer, HNPCC)\u4e2d\u53d1\u73b0\u9ad8\u9891\u7387\u7684MSI[4]. \u5fae\u536b\u661f\u4e0d\u7a33\u5b9a\u5728\u5927\u7ea615%\u7684\u7ed3\u76f4\u80a0\u764c\u4ee5\u53ca90%\u7684\u6797\u5947\u7efc\u5408\u75c7(HNPCC, \u53c8\u79f0Lynch Syndrome)\u4e2d\u8d77\u51b3\u5b9a\u4f5c\u7528[5]. \u8fd1\u5e74\u6765\u7684\u7814\u7a76\u8868\u660e, MSI\u5bf9\u6797\u5947\u7efc\u5408\u75c7\u4ee5\u53ca\u7ed3\u76f4\u80a0\u764c\u7684\u8bca\u65ad\u3001\u9884\u540e\u4ee5\u53ca\u5316\u7597\u654f\u611f\u6027\u6709\u91cd\u8981\u7684\u610f\u4e49. \u9664\u4e86\u7ed3\u76f4\u80a0\u764c, \u7814\u7a76\u4eba\u5458\u4e5f\u76f8\u7ee7\u5728\u5b50\u5bab\u5185\u819c\u764c\u3001\u5375\u5de2\u764c[6]\u3001\u80c3\u764c\u4ee5\u53ca\u4e73\u817a\u764c[7]\u7b49\u75be\u75c5\u4e2d\u53d1\u73b0MSI. MSI\u4f5c\u4e3a\u80bf\u7624\u9057\u4f20\u4e0d\u7a33\u5b9a\u7684\u654f\u611f\u6307\u6807, \u5176\u68c0\u6d4b\u5bf9\u4e8e\u80bf\u7624\u7684\u65e9\u671f\u8bca\u65ad\u3001\u9884\u540e\u5224\u65ad\u3001\u5316\u7597\u654f\u611f\u6027\u5224\u65ad\u4ee5\u53ca\u9ad8\u5371\u4eba\u7fa4\u7684\u5708\u5b9a\u7b49\u5177\u6709\u91cd\u8981\u610f\u4e49. \u5df2\u6709\u4e0d\u5c11\u7814\u7a76\u53d1\u73b0MSI-H\u7684\u80bf\u7624\u60a3\u8005\u76f8\u5bf9\u4e8eMSS\u7684\u80bf\u7624\u60a3\u8005\u6709\u66f4\u597d\u7684\u9884\u540e[8,9], \u540c\u65f6MSI-H\u80bf\u7624\u60a3\u8005\u5bf9\u4e0d\u540c\u5316\u7597\u65b9\u6cd5\u7684\u654f\u611f\u6027\u4e5f\u8868\u73b0\u51fa\u5dee\u5f02[10]. \u5fae\u536b\u661f\uff08microsatellite\uff09\u5e7f\u6cdb\u5b58\u5728\u4e8e\u539f\u6838\u53ca\u771f\u6838\u751f\u7269\u57fa\u56e0\u7ec4\u4e2d\uff0c\u5177\u6709\u8f83\u9ad8\u7684\u9057\u4f20\u7a33\u5b9a\u6027\uff0c\u4f46\u5728\u9519\u914d\u4fee\u590d\u57fa\u56e0\u529f\u80fd\u53d1\u751f\u5f02\u5e38\u65f6\uff0c\u5b50\u4ee3\u7ec6\u80de\u5fae\u536b\u661f\u7684\u91cd\u590d\u6838\u82f7\u9178\u6570\u91cf\u53ef\u589e\u591a\u6216\u51cf\u5c11\uff0c\u5bfc\u81f4\u5fae\u536b\u661f\u7684\u957f\u5ea6\u4e0d\u518d\u4fdd\u6301\u4e00\u81f4\uff0c\u8fd9\u79cd\u73b0\u8c61\u79f0MSI (Microsatellite Instability)(\u56fe1)\u3002 \u9519\u914d\u4fee\u590dMMR\uff08MisMatch Repair\uff09\uff0c\u91cd\u8981\u7684DNA\u4fee\u590d\u673a\u5236\uff0c\u80fd\u591f\u51c6\u786e\u5730\u8bc6\u522b\u53ca\u4fee\u590d\u5728DNA\u590d\u5236\u6216\u91cd\u7ec4\u8fc7\u7a0b\u4e2d\u4ea7\u751f\u7684\u78b1\u57fa\u9519\u914d\uff0c\u5c0f\u8303\u56f4\u7684\u78b1\u57fa\u7f3a\u5931\u6216\u63d2\u5165\uff0c\u5bf9\u7ef4\u6301\u57fa\u56e0\u7ec4\u7a33\u5b9a\u6027\uff0c\u9057\u4f20\u540e\u4ee3\u7684\u7cbe\u786e\u6027\u6709\u7740\u91cd\u8981\u7684\u4f5c\u7528\u3002\u5f53MMR\u4fee\u590d\u673a\u5236\u51fa\u73b0\u6545\u969c\uff0c\u53c2\u4e0eMMR\u4fee\u590d\u7684\u57fa\u56e0\u53d1\u751f\u4e86\u7a81\u53d8\uff0c\u5bfc\u81f4\u57fa\u56e0\u529f\u80fd\u7f3a\u9677\uff0cMMR\u4fee\u590d\u80fd\u529b\u4e0b\u964d\u6216\u7f3a\u5931\uff08dMMR\uff09\uff0c\u4ece\u800c\u5bfc\u81f4MSI\u3002 \u5fae\u536b\u661f\u662f\u4e00\u79cd\u77ed\u4e32\u8054\u91cd\u590d\u5e8f\u5217\uff0c\u7531\u4e8e\u5fae\u536b\u661f\u7684\u91cd\u590d\u5e8f\u5217\u5728DNA\u590d\u5236\u8fc7\u7a0b\u4e2d\u56fa\u6709\u4e0d\u7a33\u5b9a\u6027\u3002\u5728\u6b63\u5e38\u7ec6\u80de\u4e2dDNA\u9519\u914d\u4fee\u590d\u7cfb\u7edf\u53ef\u4ee5\u5feb\u901f\u4fee\u6b63\u8fd9\u79cd\u9519\u8bef\uff0c\u4f46\u662f\u80bf\u7624\u7ec4\u7ec7\u4e2d\u5e38\u89c1\u9519\u914d\u4fee\u590d\u57fa\u56e0\u7f3a\u9677\uff0c\u5f15\u8d77\u91cd\u590d\u5355\u4f4d\u63d2\u5165\u6216\u7f3a\u5931\u5bfc\u81f4\u5fae\u536b\u661f\u957f\u5ea6\u6539\u53d8\uff0c\u4ece\u800c\u8868\u73b0\u4e3aMSI\uff0c\u5373\u5fae\u536b\u661f\u4e0d\u7a33\u5b9a\u6027(microsatellite instablility)\uff0c \u5df2\u6709\u7814\u7a76\u8868\u660e\uff0cMSI\u4e0e\u80bf\u7624\u7684\u53d1\u751f\u5bc6\u5207\u76f8\u5173\u3002","title":"\u6982\u5ff5"},{"location":"08_DNA/05_somatic/009_MSI/#_2","text":"","title":"\u68c0\u6d4b\u65b9\u6cd5"},{"location":"08_DNA/05_somatic/009_MSI/#immunohistochemistryihc","text":"","title":"\u514d\u75ab\u7ec4\u7ec7\u5316\u5b66\uff08immunohistochemistry\uff0cIHC\uff09\u6cd5"},{"location":"08_DNA/05_somatic/009_MSI/#_3","text":"MMR dMMR http://www.c-s-a.org.cn/html/2018/10/6591.html \u4e00\u822c\u7684\uff0c\u5f53\u6709\u4e24\u4e2amarker\u4e0d\u7a33\u5b9a\uff08\u5c0fpanel\uff09\u6216\u800530%\u4ee5\u4e0a\u7684marker\u4e0d\u7a33\u5b9a\u65f6\uff08\u5927panel\uff09\uff0c\u5c31\u662fMSI-H\uff1b\u5f53\u6709\u4e00\u4e2amarker\u4e0d\u7a33\u5b9a\uff08\u5c0fpanel\uff09\u6216\u800530%\u4ee5\u4e0b\u7684marker\u4e0d\u7a33\u5b9a\u65f6\uff08\u5927panel\uff09\uff0c\u5c31\u662fMSI-L\uff1b\u5f53\u6ca1\u6709marker\u4e0d\u7a33\u5b9a\u65f6\uff0c\u5c31\u662fMSS\u3002 https://www.biostars.org/p/320954/ https://chengcz.github.io/2018/201810_MSI/ MSI msisensor mSINGS - Tumor only https://jingbio.netlify.com/2019/06/05/whole-exome_analysis/ http://www.360doc.com/content/19/0122/19/52645714_810652283.shtml https://bitbucket.org/uwlabmed/msings/pull-requests/1/depth-questions-massive-msings-overhaul/diff https://bitbucket.org/uwlabmed/msings/src/master/","title":""},{"location":"08_DNA/05_somatic/009_MSI/#msisensor","text":"MSI_H: msiscore >= 10%, MSI_L: 3.5% =< msiscore < 10%; MSS: msiscore < 3.5%","title":"MSIsensor"},{"location":"08_DNA/05_somatic/009_MSI/#msisensor2","text":"\u5bf9\u4e8etumoronly\u6837\u672c\uff0cMSIsensor2\u5229\u7528\u673a\u5668\u5b66\u4e60\u6a21\u578b\u7684\u65b9\u6cd5\u627e\u51fa\u6bcf\u4e2a\u5fae\u536b\u661f\u5206\u5e03\u7684MSI\u72b6\u6001\u3002\u6700\u540e\u5f97\u5230msi-score\uff0cmsi\u4f4d\u70b9\u7684\u6570\u91cf\u9664\u4ee5\u6240\u6709\u4f4d\u70b9\u3002 \u63a8\u8350\u7684msi-score\u9608\u503c\u662f20%\uff0c\u5373>= 20%\u7684\uff0cmsi high\u3002 https://github.com/niu-lab/msisensor2 git clone https://github.com/niu-lab/msisensor2.git cd msisensor2 chmod +x msisensor2 msisensor2 msi -M models_hg19 -t tumor.bam -o results msisensor2 \u4e0d\u80fd\u4f7f\u7528bed\u6587\u4ef6\u53c2\u6570\uff0c\u7a0b\u5e8f\u4e2d\u663e\u793a\u7684\u53c2\u6570\u662f\u9519\u8bef\u7684\uff0c\u5e94\u8be5\u4ee5github\u9875\u9762\u7684\u53c2\u6570\u4e3a\u51c6\uff0c\u540e\u7eed\u66f4\u65b0\u5e94\u8be5\u4f1a\u4fee\u6b63\u3002\u611f\u89c9\u6bd4\u8f83\u9002\u7528\u4e8e\u5927panel\u3002 http://niulab.scgrid.cn/msisensor2/faq.jsp \"msi high: msi score >= 20%\u201d for MSIsensor2. http://www.seqchina.cn/1568.html https://zhuanlan.zhihu.com/p/28817217","title":"MSIsensor2"},{"location":"08_DNA/05_somatic/009_MSI_paper/","text":"Chen W, Zhao D, Li XD, He XY, Li RL, Niu BF. Review on Tumor Microsatellite Instability Detection Methods. Computer Systems and Applications, 2018, 27(10): 39-45(in Chinese).http://www.c-s-a.org.cn/1003-3254/6591.html","title":"009 MSI paper"},{"location":"08_DNA/05_somatic/009_MSI_paper/#chen-w-zhao-d-li-xd-he-xy-li-rl-niu-bf-review-on-tumor-microsatellite-instability-detection-methods-computer-systems-and-applications-2018-2710-39-45in-chinesehttpwwwc-s-aorgcn1003-32546591html","text":"","title":"Chen W, Zhao D, Li XD, He XY, Li RL, Niu BF. Review on Tumor Microsatellite Instability Detection Methods. Computer Systems and Applications, 2018, 27(10): 39-45(in Chinese).http://www.c-s-a.org.cn/1003-3254/6591.html"},{"location":"08_DNA/05_somatic/009_%E4%B8%B2%E8%81%94%E9%87%8D%E5%A4%8D%E5%BA%8F%E5%88%97/","text":"tandem repeats\uff08\u4e32\u8054\u91cd\u590d\u5e8f\u5217\uff09 microsatellites or simple sequence repeats\uff08SSR\uff09\uff1a\u75311-6bp\u7684\u77ed\u91cd\u590d\u5355\u5143\u7ec4\u6210 minisatellites\uff1a\u753110-60bp\u7684\u957f\u91cd\u590d\u5355\u5143\u7ec4\u6210 dispersed repeats\uff08\u5206\u6563\u91cd\u590d\u5e8f\u5217\uff09\u5206\u6563\u91cd\u590d\u5e8f\u5217\u7684\u5728\u57fa\u56e0\u7ec4\u4e2d\u4e3b\u8981\u662ftransposable elements,\ud835\udc47\ud835\udc38\ud835\udc60\uff0c\u4e5f\u5c31\u662f\u8f6c\u5ea7\u5b50\u3002 \u7b2c\u4e00\u7c7b\u662f\u4ee5RNA\u4e3a\u5a92\u4ecb\uff0c\u901a\u8fc7\u201ccopy and paste\u201d\u673a\u5236\u8fdb\u884c\u8f6c\u5ea7 1.Long terminal repeat retrotransposon\uff08LTR\uff09 2.Non-LTR retrotransposon \u7b2c\u4e8c\u7c7b\u662f\u4ee5DNA\u4e3a\u5a92\u4ecb\uff0c\u901a\u8fc7\u201ccut and paste\u201d\u673a\u5236\u8fdb\u884c\u8f6c\u5ea7 1.TIR\ud835\udc47\ud835\udc52\ud835\udc5f\ud835\udc5a\ud835\udc56\ud835\udc5b\ud835\udc4e\ud835\udc59\ud835\udc3c\ud835\udc5b\ud835\udc63\ud835\udc52\ud835\udc5f\ud835\udc61\ud835\udc52\ud835\udc51\ud835\udc45\ud835\udc52\ud835\udc5d\ud835\udc52\ud835\udc4e\ud835\udc61 2.MITE\ud835\udc5a\ud835\udc56\ud835\udc5b\ud835\udc56\ud835\udc4e\ud835\udc61\ud835\udc62\ud835\udc5f\ud835\udc52\ud835\udc56\ud835\udc5b\ud835\udc63\ud835\udc52\ud835\udc5f\ud835\udc61\ud835\udc52\ud835\udc51\ud835\udc5f\ud835\udc52\ud835\udc5d\ud835\udc52\ud835\udc4e\ud835\udc61\ud835\udc61\ud835\udc5f\ud835\udc4e\ud835\udc5b\ud835\udc60\ud835\udc5d\ud835\udc5c\ud835\udc60\ud835\udc4e\ud835\udc4f\ud835\udc59\ud835\udc52\ud835\udc52\ud835\udc59\ud835\udc52\ud835\udc5a\ud835\udc52\ud835\udc5b\ud835\udc61\ud835\udc60 3.Helitron \u8f6f\u4ef6\uff1a REPET\uff1a https://yantinger.com/2018/10/15/%E9%87%8D%E5%A4%8D%E5%BA%8F%E5%88%97%E6%B3%A8%E9%87%8A%E8%BD%AF%E4%BB%B6REPET/ https://strbase.nist.gov/mixture/4%20-%20Stutter.pdf","title":"009 \u4e32\u8054\u91cd\u590d\u5e8f\u5217"},{"location":"08_DNA/05_somatic/010_drivergene/","text":"","title":"010 drivergene"},{"location":"08_DNA/05_somatic/014_MAF_maftools/","text":"https://www.bioinfo-scrounger.com/archives/645/ https://bioconductor.org/packages/release/bioc/vignettes/maftools/inst/doc/maftools.html \u7a81\u53d8\u7684\u4e92\u65a5\u6027\uff08exclusive\uff09\u548c\u5171\u73b0\u6027\uff08Co-occurrence\uff09\u5206\u6790","title":"014 MAF maftools"},{"location":"08_DNA/05_somatic/014_MAF_maftools/#_1","text":"https://www.bioinfo-scrounger.com/archives/645/ https://bioconductor.org/packages/release/bioc/vignettes/maftools/inst/doc/maftools.html","title":""},{"location":"08_DNA/05_somatic/014_MAF_maftools/#exclusiveco-occurrence","text":"","title":"\u7a81\u53d8\u7684\u4e92\u65a5\u6027\uff08exclusive\uff09\u548c\u5171\u73b0\u6027\uff08Co-occurrence\uff09\u5206\u6790"},{"location":"08_DNA/05_somatic/014_TMB/","text":"Tumor mutational burden (TMB) is defined as the number of somatic, coding, base substitution, and indel mutations per megabase of genome examined. All base substitutions and indels in the coding region of targeted genes, including synonymous mutations, are initially counted before filtering as described below. \u8fc7\u6ee4 [4] Michael Allg\u00a8auer, Jan Budczies, Petros Christopoulos, Volker Endris, Amelie Lier, Eugen Rempel, AnnaLena Volckmar, Martina Kirchner, Moritz von Winterfeld, Jonas Leichsenring, Olaf Neumann, Stefan Fr\u00a8ohling, Roland Penzel, Michael Thomas, Peter Schirmacher, and Albrecht Stenzinger. Implementing tumor mutational burden (tmb) analysis in routine diagnostics-a primer for molecular pathologists and clinicians. Translational lung cancer research, 7(6):703\u2013715, Dec 2018. 30505715[pmid]. [5] B\u00b4arbara Mel\u00b4endez, Claude Van Campenhout, Sandrine Rorive, Myriam Remmelink, Isabelle Salmon, and Nicky D\u2019Haene. Methods of measurement for tumor mutational burden in tumor tissue. Translational lung cancer research, 7(6):661\u2013667, Dec 2018. 30505710[pmid]. \u90a3\u4e48\u4ec0\u4e48\u662fMAF(Mutation Annotation Format )\uff0c\u53ef\u4ee5\u770b\u4e0b\u8fd9\u4e2a\u94fe\u63a5https://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format/\uff0c\u91cc\u9762\u9664\u4e86\u8bf4\u4e86\u4ec0\u4e48MAF\u5916\uff0c\u8fd8\u5bf9MAF\u683c\u5f0f\u7684\u6bcf\u4e2a\u5217\u540d\u505a\u4e86\u89e3\u91ca\u8bf4\u660e\uff0c\u4e00\u822c\u6765\u8bf4\u6211\u4eec\u4eceTCGA\u4e0b\u8f7d\u662f\u7a81\u53d8\u6587\u4ef6\u90fd\u662fMAF\u683c\u5f0f\u7684 \u5982\u679c\u662fVCF\u683c\u5f0f\u7684\u7a81\u53d8\u5206\u6790\u7ed3\u679c\uff0c\u90a3\u4e48\u53ef\u4ee5\u7528vcf2maf\u5de5\u5177\u4ecevcf\u8f6c\u5316\u4e3aMAF\u683c\u5f0f\uff0c\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u6211\u60f3\u8bf4\u8981\u8f6c\u4e3aMAF\u683c\u5f0f\u5462\uff0c\u56e0\u4e3a\u6709\u4e2amaftools\u8fd9\u4e2aR\u5305\uff0c\u5176\u57fa\u7840MAF\u683c\u5f0f\u53ef\u4ee5\u505a\u5f88\u591a\u5206\u6790\u4ee5\u53ca\u53ef\u89c6\u5316\u5de5\u4f5c\uff0c\u7279\u522b\u65b9\u4fbf\uff01 maftools\u624b\u518c\u4e2d\u63d0\u5230\uff0c\u5982\u679c\u662fANNOVAR\u6ce8\u91ca\u7ed3\u679c\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u7528\u5176annovarToMaf\u5c06annovar outputs \u8f6c\u5316\u4e3aMAF\u6587\u4ef6 \u5982\u679c\u4f60\u662f\u5176\u4ed6\u516c\u5171\u6570\u636e\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u4eba\u5de5\u5904\u7406\u5c06\u5fc5\u8981\u6570\u636e\u6574\u7406\u6210MAF\u683c\u5f0f\u7684\u6587\u4ef6\uff0cmaftools\u9700\u8981\u7684\u5fc5\u8981\u5217\u6709\uff1aHugo_Symbol, Chromosome, Start_Position, End_Position, Reference_Allele, Tumor_Seq_Allele2, Variant_Classification, Variant_Type and Tumor_Sample_Barcode\uff0c\u53e6\u5916\u8fd8\u53ef\u4ee5\u989d\u5916\u518d\u52a0\u4e0aVAF (Variant Allele Frequecy)\u5217\u548camino acid change information \u6211\u4eec\u53ef\u4ee5\u5148\u7528maftools\u5305\u7684\u6d4b\u8bd5\u6570\u636e\u5148\u5c1d\u8bd5\u4e00\u904d\u8fd9\u4e2aR\u5305\u7684\u5173\u952e\u51e0\u4e2a\u7528\u6cd5\uff08\u6bd4\u8f83\u5e38\u89c1\u7684\uff09\uff0c\u5982\uff1a","title":"014 TMB"},{"location":"08_DNA/05_somatic/014_TMB/#_1","text":"[4] Michael Allg\u00a8auer, Jan Budczies, Petros Christopoulos, Volker Endris, Amelie Lier, Eugen Rempel, AnnaLena Volckmar, Martina Kirchner, Moritz von Winterfeld, Jonas Leichsenring, Olaf Neumann, Stefan Fr\u00a8ohling, Roland Penzel, Michael Thomas, Peter Schirmacher, and Albrecht Stenzinger. Implementing tumor mutational burden (tmb) analysis in routine diagnostics-a primer for molecular pathologists and clinicians. Translational lung cancer research, 7(6):703\u2013715, Dec 2018. 30505715[pmid]. [5] B\u00b4arbara Mel\u00b4endez, Claude Van Campenhout, Sandrine Rorive, Myriam Remmelink, Isabelle Salmon, and Nicky D\u2019Haene. Methods of measurement for tumor mutational burden in tumor tissue. Translational lung cancer research, 7(6):661\u2013667, Dec 2018. 30505710[pmid]. \u90a3\u4e48\u4ec0\u4e48\u662fMAF(Mutation Annotation Format )\uff0c\u53ef\u4ee5\u770b\u4e0b\u8fd9\u4e2a\u94fe\u63a5https://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format/\uff0c\u91cc\u9762\u9664\u4e86\u8bf4\u4e86\u4ec0\u4e48MAF\u5916\uff0c\u8fd8\u5bf9MAF\u683c\u5f0f\u7684\u6bcf\u4e2a\u5217\u540d\u505a\u4e86\u89e3\u91ca\u8bf4\u660e\uff0c\u4e00\u822c\u6765\u8bf4\u6211\u4eec\u4eceTCGA\u4e0b\u8f7d\u662f\u7a81\u53d8\u6587\u4ef6\u90fd\u662fMAF\u683c\u5f0f\u7684 \u5982\u679c\u662fVCF\u683c\u5f0f\u7684\u7a81\u53d8\u5206\u6790\u7ed3\u679c\uff0c\u90a3\u4e48\u53ef\u4ee5\u7528vcf2maf\u5de5\u5177\u4ecevcf\u8f6c\u5316\u4e3aMAF\u683c\u5f0f\uff0c\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u6211\u60f3\u8bf4\u8981\u8f6c\u4e3aMAF\u683c\u5f0f\u5462\uff0c\u56e0\u4e3a\u6709\u4e2amaftools\u8fd9\u4e2aR\u5305\uff0c\u5176\u57fa\u7840MAF\u683c\u5f0f\u53ef\u4ee5\u505a\u5f88\u591a\u5206\u6790\u4ee5\u53ca\u53ef\u89c6\u5316\u5de5\u4f5c\uff0c\u7279\u522b\u65b9\u4fbf\uff01 maftools\u624b\u518c\u4e2d\u63d0\u5230\uff0c\u5982\u679c\u662fANNOVAR\u6ce8\u91ca\u7ed3\u679c\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u7528\u5176annovarToMaf\u5c06annovar outputs \u8f6c\u5316\u4e3aMAF\u6587\u4ef6 \u5982\u679c\u4f60\u662f\u5176\u4ed6\u516c\u5171\u6570\u636e\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u4eba\u5de5\u5904\u7406\u5c06\u5fc5\u8981\u6570\u636e\u6574\u7406\u6210MAF\u683c\u5f0f\u7684\u6587\u4ef6\uff0cmaftools\u9700\u8981\u7684\u5fc5\u8981\u5217\u6709\uff1aHugo_Symbol, Chromosome, Start_Position, End_Position, Reference_Allele, Tumor_Seq_Allele2, Variant_Classification, Variant_Type and Tumor_Sample_Barcode\uff0c\u53e6\u5916\u8fd8\u53ef\u4ee5\u989d\u5916\u518d\u52a0\u4e0aVAF (Variant Allele Frequecy)\u5217\u548camino acid change information \u6211\u4eec\u53ef\u4ee5\u5148\u7528maftools\u5305\u7684\u6d4b\u8bd5\u6570\u636e\u5148\u5c1d\u8bd5\u4e00\u904d\u8fd9\u4e2aR\u5305\u7684\u5173\u952e\u51e0\u4e2a\u7528\u6cd5\uff08\u6bd4\u8f83\u5e38\u89c1\u7684\uff09\uff0c\u5982\uff1a","title":"\u8fc7\u6ee4"},{"location":"08_DNA/05_somatic/015_STAR/","text":"STAR --runThreadN 4 \\ --outSAMtype BAM SortedByCoordinate \\ --outSAMstrandField intronMotif \\ --outFilterIntronMotifs RemoveNoncanonicalUnannotated \\ --outReadsUnmapped None \\ --chimSegmentMin 15 \\ --chimJunctionOverhangMin 15 \\ --chimOutType WithinBAM \\ --alignMatesGapMax 200000 \\ --alignIntronMax 200000 \\ --genomeDir $STAR_GENOME_INDEX \\ --readFilesIn $SAMPLE_FASTQ_1 $SAMPLE_FASTQ_2 \\ --outFileNamePrefix $TUTORIAL_HOME/analysis/star/$SAMPLE_ID/ --outSAMtype BAM SortedByCoordinate \\ --outFileNamePrefix $TUTORIAL_HOME/analysis/star/$SAMPLE_ID/ --chimSegmentMin 20 --chimOutTypeWithinBAM In order to obtain alignments of chimeric reads potentially supporting fusions, we have added the --chimSegmentMin 20 option to obtain chimerica reads anchored by at least 20nt on either side of the fusion boundary, and --chimOutTypeWithinBAM to report such alignments in the sam/bam output.","title":"015 STAR"},{"location":"08_DNA/05_somatic/016.drivegene/","text":"https://software.broadinstitute.org/cancer/cga/mutsig_faq","title":"https://software.broadinstitute.org/cancer/cga/mutsig_faq"},{"location":"08_DNA/05_somatic/016.drivegene/#httpssoftwarebroadinstituteorgcancercgamutsig_faq","text":"","title":"https://software.broadinstitute.org/cancer/cga/mutsig_faq"},{"location":"08_DNA/05_somatic/000_%E7%99%8C/000_/","text":"002_CoverageCalculatorPy https://github.com/AWGL/CoverageCalculatorPy https://byteofbio.com/archives/7.html https://byteofbio.com/archives/14.html \u3010\u67d3\u8272\u4f53\u975e\u6574\u500d\u6027\u3011 \u65e9\u671f\u67d3\u8272\u4f53\u4e0d\u7a33\u5b9a\uff08CIN\uff09\u662f\u968f\u673a\u51fa\u73b0\u7684\uff0c\u6709\u7a33\u5b9a\u7684\u514b\u9686\u6027\u6539\u53d8\uff08clonal chromosomal alterations. CCA\uff09\u548c\u4e0d\u7a33\u5b9a\u7684\u975e\u514b\u9686\u6027\u6539\u53d8\uff08NCCA\uff09\u4e24\u79cd\u5f62\u5f0f \uff0cNCCA\u662f\u7ed3\u6784CIN\u548c\u764c\u75c7\u6f14\u5316\u7684\u4e3b\u8981\u6807\u5fd7\u3002 CIN\u4e2d\u7684\u62f7\u8d1d\u6570\u53d8\u5f02\uff08numerical CIN \uff0cCNV\uff09\uff0c\u6216\u79f0\u67d3\u8272\u4f53\u975e\u6574\u500d\u6027\u6216\u79f0\u67d3\u8272\u4f53\u7578\u53d8\uff08aneuploidy\uff09\u3002\u9664\u6574\u6761\u67d3\u8272\u4f53\u62f7\u8d1d\u6570\u7684\u53d8\u5316\u5916\uff0c\u67d3\u8272\u4f53\u975e\u6574\u500d\u6027\u8fd8\u5305\u62ec\u4e86\u67d3\u8272\u4f53\u81c2\u7684\u6269\u589e\u6216\u7f3a\u5931\u3002\u9700\u8981\u6ce8\u610f\uff0c\u5168\u67d3\u8272\u4f53\u9519\u8bef\u5206\u79bb\u7684\u673a\u5236\u4e0e\u5f15\u8d77\u81c2\u6c34\u5e73\u62f7\u8d1d\u6570\u53d8\u5316\u7684\u673a\u5236\u6709\u5f88\u5927\u4e0d\u540c\u3002\u67d3\u8272\u4f53\u975e\u6574\u500d\u6027\u53ef\u901a\u8fc7\u589e\u52a0\u9057\u4f20\u5f02\u8d28\u6027\uff0c\u4fc3\u8fdb\u80bf\u7624\u53d1\u751f\u3002\u7814\u7a76\u8868\u660e\uff0c\u975e\u6574\u500d\u6027\u662f\u4e00\u79cd\u4e0e\u73af\u5883\u6709\u5173\u7684\u3001\u7279\u5b9a\u4e8e\u764c\u75c7\u7c7b\u578b\u7684\u81f4\u764c\u4e8b\u4ef6\uff0c\u53ef\u4f5c\u4e3a\u5177\u6709\u4e34\u5e8a\u610f\u4e49\u7684\u9884\u540e\u6307\u6807\u548c\u6f5c\u5728\u6cbb\u7597\u9776\u6807\u3002","title":"000 "},{"location":"08_DNA/05_somatic/000_%E7%99%8C/000_/#_1","text":"\u65e9\u671f\u67d3\u8272\u4f53\u4e0d\u7a33\u5b9a\uff08CIN\uff09\u662f\u968f\u673a\u51fa\u73b0\u7684\uff0c\u6709\u7a33\u5b9a\u7684\u514b\u9686\u6027\u6539\u53d8\uff08clonal chromosomal alterations. CCA\uff09\u548c\u4e0d\u7a33\u5b9a\u7684\u975e\u514b\u9686\u6027\u6539\u53d8\uff08NCCA\uff09\u4e24\u79cd\u5f62\u5f0f \uff0cNCCA\u662f\u7ed3\u6784CIN\u548c\u764c\u75c7\u6f14\u5316\u7684\u4e3b\u8981\u6807\u5fd7\u3002 CIN\u4e2d\u7684\u62f7\u8d1d\u6570\u53d8\u5f02\uff08numerical CIN \uff0cCNV\uff09\uff0c\u6216\u79f0\u67d3\u8272\u4f53\u975e\u6574\u500d\u6027\u6216\u79f0\u67d3\u8272\u4f53\u7578\u53d8\uff08aneuploidy\uff09\u3002\u9664\u6574\u6761\u67d3\u8272\u4f53\u62f7\u8d1d\u6570\u7684\u53d8\u5316\u5916\uff0c\u67d3\u8272\u4f53\u975e\u6574\u500d\u6027\u8fd8\u5305\u62ec\u4e86\u67d3\u8272\u4f53\u81c2\u7684\u6269\u589e\u6216\u7f3a\u5931\u3002\u9700\u8981\u6ce8\u610f\uff0c\u5168\u67d3\u8272\u4f53\u9519\u8bef\u5206\u79bb\u7684\u673a\u5236\u4e0e\u5f15\u8d77\u81c2\u6c34\u5e73\u62f7\u8d1d\u6570\u53d8\u5316\u7684\u673a\u5236\u6709\u5f88\u5927\u4e0d\u540c\u3002\u67d3\u8272\u4f53\u975e\u6574\u500d\u6027\u53ef\u901a\u8fc7\u589e\u52a0\u9057\u4f20\u5f02\u8d28\u6027\uff0c\u4fc3\u8fdb\u80bf\u7624\u53d1\u751f\u3002\u7814\u7a76\u8868\u660e\uff0c\u975e\u6574\u500d\u6027\u662f\u4e00\u79cd\u4e0e\u73af\u5883\u6709\u5173\u7684\u3001\u7279\u5b9a\u4e8e\u764c\u75c7\u7c7b\u578b\u7684\u81f4\u764c\u4e8b\u4ef6\uff0c\u53ef\u4f5c\u4e3a\u5177\u6709\u4e34\u5e8a\u610f\u4e49\u7684\u9884\u540e\u6307\u6807\u548c\u6f5c\u5728\u6cbb\u7597\u9776\u6807\u3002","title":"\u3010\u67d3\u8272\u4f53\u975e\u6574\u500d\u6027\u3011"},{"location":"08_DNA/05_somatic/000_%E7%99%8C/001_%E6%98%93%E6%84%9F%E5%9F%BA%E5%9B%A0/","text":"\u4ec0\u4e48\u662f\u6613\u611f\u57fa\u56e0 \u6613\u611f\u57fa\u56e0\uff08Predisposing gene\uff09\u662f\u5728\u9002\u5b9c\u7684\u73af\u5883\u523a\u6fc0\u4e0b\u80fd\u591f\u7f16\u7801\u9057\u4f20\u6027\u75be\u75c5\u6216\u83b7\u5f97\u75be\u75c5\u6613\u611f\u6027\u7684\u57fa\u56e0\u3002\u73b0\u4ee3\u533b\u5b66\u7814\u7a76\u6210\u679c\u8868\u660e\uff0c\u5927\u591a\u6570\u75be\u75c5\u662f\u591a\u79cd\u73af\u5883\u56e0\u7d20\u548c\u9057\u4f20\u4f53\u8d28\u5171\u540c\u4f5c\u7528\u7684\u7ed3\u679c\uff0c\u5bf9\u5065\u5eb7\u4e0d\u5229\u7684\u9057\u4f20\u4f53\u8d28\u6240\u5bf9\u5e94\u7684\u4e00\u4e9b\u4e0e\u75be\u75c5\u53d1\u751f\u76f8\u5173\u7684\u57fa\u56e0\u578b\uff0c\u6211\u4eec\u5c31\u53eb\u505a\u75be\u75c5\u6613\u611f\u57fa\u56e0\u3002\u53d1\u73b0\u4e86\u8fd9\u4e9b\u57fa\u56e0\uff0c\u6df1\u5165\u7814\u7a76\uff0c\u4ece\u800c\u6709\u6548\u5730\u9884\u9632\u548c\u63a7\u5236\u9057\u4f20\u75be\u75c5\u7684\u53d1\u751f\u3002 \u600e\u4e48\u5206\u6790\u6613\u611f\u57fa\u56e0 \u901a\u8fc7\u9ad8\u901a\u91cf\u6d4b\u5e8f\uff0c\u5c06\u60a3\u8005\u6b63\u5e38\u7ec4\u7ec7\u7ec6\u80de\u4e2d\u68c0\u6d4b\u5230\u7684\u53d8\u5f02\u4e0eCGC\uff08Cancer Gene Census\uff09\u6570\u636e\u5e93\u6bd4\u8f83\uff0c\u7b5b\u9009\u53ef\u80fd\u7684\u80bf\u7624\u6613\u611f\u57fa\u56e0\u3002 \u4ec0\u4e48\u662f\u9ad8\u9891\u7a81\u53d8\u57fa\u56e0\uff1f \u9ad8\u9891\u7a81\u53d8\u57fa\u56e0\uff08SMG\uff0cSignificantly mutated genes\uff09\u7efc\u5408\u8003\u8651\u4e86\u4f53\u7ec6\u80deSNP\u548cINDEL\u7b49\u53d8\u5f02\uff0c\u662f\u6307\u7a81\u53d8\u9891\u7387\u663e\u8457\u9ad8\u4e8e\u80cc\u666f\u7a81\u53d8\u9891\u7387\uff08BMR\uff0cbackground mutation rate\uff09\u7684\u57fa\u56e0 \u5982\u4f55\u5206\u6790\u9ad8\u7a81\u53d8\u57fa\u56e0\uff1f \u80bf\u7624\u9ad8\u9891\u7a81\u53d8\u5206\u6790\u4f7f\u7528MuSiC\u8f6f\u4ef6\uff0cMuSiC\u4ee5\u6240\u6709\u80bf\u7624\u6837\u672c\u7684\u4f53\u7ec6\u80de\u7a81\u53d8\u4e3a\u80cc\u666f\uff0c\u5bf9\u57fa\u56e0\u4e0a\u7684\u5404\u4e2a\u7a81\u53d8\u7c7b\u578b\u8fdb\u884c\u7edf\u8ba1\u68c0\u9a8c\uff0c\u68c0\u6d4b\u51fa\u663e\u8457\u9ad8\u4e8e\u80cc\u666f\u7a81\u53d8\u7387\u7684\u57fa\u56e0\u3002MuSiC\u901a\u8fc73\u79cd\u65b9\u6cd5\u8fdb\u884cSMG test\uff0c\u5305\u62ec\u5377\u79ef\u68c0\u9a8c\uff08convolution test\uff0cCT\uff09\u3001Fisher\u68c0\u9a8c\uff08Fisher\u2019s combined P-value test, FCPT\uff09\u3001\u4f3c\u7136\u6bd4\u68c0\u9a8c\uff08likelihood ratio test\uff0cLRT\uff09\u3002\u5bf9\u4e8e\u9ad8\u9891\u7a81\u53d8\u57fa\u56e0\uff0c\u6211\u4eec\u4f1a\u8fdb\u884c\u9ad8\u9891\u7a81\u53d8\u57fa\u56e0\u7684\u901a\u8def\u5bcc\u96c6\u5206\u6790\uff0c\u5206\u6790\u8f6f\u4ef6\u4f7f\u7528PathScan\uff08MuSiC\u7684\u4e00\u4e2a\u5de5\u5177\uff09\uff0c\u5bcc\u96c6\u4f7f\u7528\u7684\u4ee3\u8c22\u901a\u8def\u6570\u636e\u5e93\u6709\uff1aKEGG\u3001Biocarta\u3001PID\u548cReactome\u3002","title":"001 \u6613\u611f\u57fa\u56e0"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/001_Notes_on_Mutect2/","text":"II. FILTERING C. Allele Fraction Clustering Model III. GERMLINE FILTER III. RELATED GATK TOOLS B. Calculating Contamination II. FILTERING C. Allele Fraction Clustering Model Several of FilterMutectCalls\u2019s probabilistic filters rely on the following graphical model for the tumor\u2019s spectrum of allele fractions of real variants. At the top of the model is a binary indicator for whether a variant is neither a technical artifact or a non-somatic mutation. P (consider) = (1 \u2212 max artifact error prob)(1 \u2212 max non-somatic prob). (13) Note that possible sequencing errors, with error probability captured by the independent reads assumption of the Mutect2 log odds, are considered. Next, a candidate SNV has prior probability \u03c0real = \u03c0SNV/3 to be real and prior probability 1 \u2212 \u03c0SNV/3 to be a sequencing error, while a candidate indel of length L (negative for deletions, positive for insertions) has prior probability \u03c0real = \u03c0L to be real. Real variants are partitioned according to a mixture model with weights \u03c0H for a high-allele fraction cluster, \u03c0B for a \u201cbackground cluster\u201d, and \u03c0D = 1 \u2212 \u03c0H \u2212 \u03c0B to be further clustered into according to a Dirichlet process with concentration \u03b1. Each non-error cluster has a characteristic distribution of allele fractions: Beta(\u03b1H,\u03b2H) and Beta(\u03b1B,\u03b2B) for the high-allele fraction and background clusters, and Dirac \u03b4 functions for the Dirichlet clusters. The idea of this partitioning is that there will usually be sharply- defined allele fractions corresponding to the hets of different subclones, which are captured by the Dirichlet clusters, but that homozygosity and copy-number variation produce deviations from this clustering. Provided that we stochastically assign the ith variant as non-artifactual, the prior probabilities for each possibility are described by a modified Chinese Restaurant Process scheme: P (Sequencing error) =1 \u2212 \u03c0real P(High AF) =\u03c0real\u03c0H P(Background) =\u03c0real\u03c0B P(Dirichlet )=\u03c0 j cluster, N\u2212i is the number of variants besides the ith assigned to cluster j, and N\u2212i is the total number of variants jD besides the ith assigned to Dirichlet clusters. Mutect2 emits the likelihood ratio between sequencing error and a real variant assuming a flat prior. However, we can approximately compute the likelihood ratio that a non-flat Beta prior would have produced. We can do this because in Equation 9 a change in the prior allele fraction is unlikely to affect z \u0304 very much - usually the allele that a read supports is clear regardless of prior. Therefore, only the term g(\u03b1) \u2212 g(\u03b2) changes. Since \u03b2 = \u03b1 + n, where n is the vector of observed read counts per allele we can convert the log-likelihood obtained with flat prior \u03b10 to one reflecting an allele fraction prior \u03b1 by adding \u2206log odds(\u03b1)=\u2206lnP(R|A)=[g(\u03b1)\u2212g(\u03b1+n)]\u2212[g(\u03b10)\u2212g(\u03b10 +n)]. (19) Since only ratios of likelihoods are meaningful, we may WLOG set the likelihood of reads given sequencing error to be 1 and then set the likelihood fo each allele fraction cluster to be exp [Mutect2 log odds + \u2206log odds(\u03b1)]. The likelihood of a new cluster is the average over all possible new allele fractions of the likelihood, which is, by definition, simply the original Mutect2 likelihood that integrated over a flat prior. Thus we have likelihoods for every cluster. Combined with the priors, this gives us the conditional posterior for Gibbs sampling the cluster assignment of a candidate variant. We can estimate the parameters of the model by maximum likelihood. For example, we estimate \u03c0L as the total number of length-L indels in the non-error clusters divided by the total number of callable sites3, \u03c0B as the total number of variants assigned to the background cluster divided by the total number of non-error assignments. The allele fraction of a Dirichlet cluster is estimated as its total alt read count divided by its total read count. Finally, the beta distributions of the high-allele fraction and background clusters are fit by brute force likelihood optimization. Once the model converges, the combination of cluster weights and allele-fraction-adjusted likelihoods lets us compute the posterior probability that a candidate variant is a sequencing error, which determines the weak evidence filter. Since the clusters also define distributions on alt allele counts \u2013 the high-AF and background clusters define beta-binomials and the Dirichlet clusters define binomial \u2013 we also have the mixture model distribution P (alt count|total count, somatic), which the contamination and germline filters use. III. GERMLINE FILTER Suppose we have detected an allele such that its (somatic) likelihood in the tumor is $l_{t}$ and its(diploid) likelihood in the normal is ${l_{n}}^{2}$. By convention, both of these are relative to a likelihood of 1 for the allele not to be found. If we have no matched normal, ln = 1. Suppose we also have the population allele frequency f of this allele. Then the prior probabilities for the normal to be heterozygous and homozygous alt for the allele are 2f(1\u2212f) and f2 and the prior probability for the normal genotype not to contain the allele is (1\u2212f)2. Finally, suppose that the prior for this allele to arise as a somatic variant is \u03c0. \u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u68c0\u6d4b\u5230\u67d0\u4e2a\u7b49\u4f4d\u57fa\u56e0\u5728\u80bf\u7624\u6837\u672c\u4e2d\u7684\u7a81\u53d8\u4f3c\u7136\u503c\u662f$l_{t}$\uff0c\u5b83\u5728\u6b63\u5e38\u6837\u672c\u4e2d\u7684\u4f3c\u7136\u503c\u662f${l_{n}}^{2}$\u3002\u6309\u7167\u60ef\u4f8b\uff0c\u5982\u679c\u8be5\u7b49\u4f4d\u57fa\u56e0\u6ca1\u6709\u88ab\u53d1\u73b0\uff0c\u5219\u5b83\u4eec\u90fd\u67091\u7684\u4f3c\u7136\u503c\u3002\u5982\u679c\u6211\u4eec\u6ca1\u6709\u914d\u5bf9\u7684\u6b63\u5e38\u6837\u672c\uff0c$l_{t} = 1$\u3002\u5047\u8bbe\u6211\u4eec\u4e5f\u6709\u4e86\u8be5\u7b49\u4f4d\u57fa\u56e0\u7684\u4eba\u7fa4\u7a81\u53d8\u9891\u7387\uff0c\u90a3\u4e48\u6b63\u5e38\u6837\u672c\u7684\u6742\u5408\u548c\u7eaf\u5408\u7b49\u4f4d\u57fa\u56e0\u7684\u5148\u9a8c\u6982\u7387\u5206\u522b\u4e3a$2f(1\u2212f)$ \u548c$f^{2}$\uff0c \u6b63\u5e38\u6837\u672c\u57fa\u56e0\u578b\u4e0d\u5305\u542b\u8be5\u7b49\u4f4d\u57fa\u56e0\u5148\u9a8c\u6982\u7387\u662f$(1\u2212f)^{2}$\u3002\u6700\u540e\u5047\u8bbe\u8be5\u7b49\u4f4d\u57fa\u56e0\u662f\u80bf\u7624\u53d8\u5f02\u7684\u5148\u9a8c\u6982\u7387\u662f$\u03c0$\u3002 We can determine the posterior probability that the variant exists in the normal genotype by calculating the unnormalized probabilities of four possibilities: 1. The variant exists in the tumor and the normal as a germline het. This has unnormalized probability 2f (1 \u2212 f)lnlt(1 \u2212 \u03c0). 2. The variant exists in the tumor and the normal as a germline hom alt. This has unnormalized probability f2lnlt(1 \u2212 \u03c0). 3. The variant exists in the tumor but not the normal. This has unnormalized probability (1 \u2212 f)2lt\u03c0. We exclude possibilities in which the variant does not exist in the tumor sample because we really want the conditional probability that the variant is germline given that it would otherwise be called. Normalizing, we obtain the following posterior probability that an allele is a germline variant: (1)+(2) 2f(1\u2212f)+f2 lnlt(1\u2212\u03c0) P(germline)= (1)+(2)+(3) = (2f(1\u2212f)+f2)lnlt(1\u2212\u03c0)+lt(1\u2212f)2\u03c0. (26) The above equation, in which the factors of lt could cancel if we wished, is not quite right. The tumor likelihood lt is the probability of the tumor data given that the allele exists in the tumor as a somatic variant. If the allele is in the tumor as a germline het we must modify lt to account for the fact that the allele fraction is determined by the ploidy \u2013 it must be either fg or 1 \u2212 fgwith equal probability, where fg is the minor allele fraction of germline hets. It would be awkward to recalculate the tumor likelihood with the allele frequency constrained to these two values3, but we can estimate a correction factor as follows: assuming that the posterior on the allele fraction in the somatic likelihoods model is fairly tight, the likelihood of a alt reads out of n total reads is n (1 \u2212 ft)n\u2212afa, where ft is the a tumor alt allele fraction. That is, our sophisticated model that marginalizes over ft reduces to something more naive. If the variant is a germline event, the likelihood becomes 1 n (1\u2212f )n\u2212afa +fn\u2212a(1\u2212f )a . Thus, in case (1) we 1 (1 \u2212 fg)n\u2212afa + fn\u2212a(1 \u2212 fg)a \u03c7=gg. (27) 5 2agggg have lt \u2192 \u03c7lt, where For germline hom alts, both the tumor and normal allele fractions will be similarly large, so to decent approximation we don\u2019t have to modify lt. Of course, this only applies if the allele fraction is large. Rather than try to model the count of ref reads within a germline hom alt site, we simply set a threshold of allele fraction 0.9, so that in case (2) lt \u2192 I[ft > 0.9]lt. and the corrected germline probability is (1)+(2) 2f(1\u2212f)\u03c7+I[ft >0.9]f2 ln(1\u2212\u03c0) P(germline)= (1)+(2)+(3) = (2f(1\u2212f)\u03c7+I[ft >0.9]f2)ln(1\u2212\u03c0)+(1\u2212f)2\u03c0. (28) To filter, we set a threshold on this posterior probability. So far we have assumed that the population allele frequency f is known, which is the case if it is found in our germline resource, such as gnomAD. If f is not known we must make a reasonable guess as follows. Suppose the prior distribution on f is Beta(\u03b1, \u03b2). The mean \u03b1/(\u03b1+\u03b2) of this prior is the average human heterozygosity \u03b8 \u2248 10\u22123, so we have \u03b2 \u2248 \u03b1/\u03b8. We need one more constraint to determine \u03b1 and \u03b2, and since we are concerned with imputing f when f is small we use a condition based on rare variants. Specifically, the number of variant alleles n at some site in a germline resource with N/2 samples, hence N chromosomes, is given by f \u223c Beta(\u03b1,\u03b2),n \u223c Binom(N,f). That is, n \u223c BetaBinom(\u03b1,\u03b2,N). The probability of a site being non-variant in every sample is then P(n = 0) = BetaBinom(0|\u03b1,\u03b2,N), which we equate to the empirical proportion of non-variant sites in our resource, about 7/8 for exonic sites in gnomAD. Solving, we obtain approximately \u03b1 = 0.01, \u03b2 = 10 for gnomAD. Now, given that some allele found by Mutect is not in the resource, the posterior on f is Beta(\u03b1, \u03b2 + N ), the mean of which is, since \u03b2 << N , about \u03b1/N . By default, Mutect uses this value. III. RELATED GATK TOOLS B. Calculating Contamination","title":"001 Notes on Mutect2"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/001_Notes_on_Mutect2/#ii-filtering","text":"","title":"II. FILTERING"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/001_Notes_on_Mutect2/#c-allele-fraction-clustering-model","text":"Several of FilterMutectCalls\u2019s probabilistic filters rely on the following graphical model for the tumor\u2019s spectrum of allele fractions of real variants. At the top of the model is a binary indicator for whether a variant is neither a technical artifact or a non-somatic mutation. P (consider) = (1 \u2212 max artifact error prob)(1 \u2212 max non-somatic prob). (13) Note that possible sequencing errors, with error probability captured by the independent reads assumption of the Mutect2 log odds, are considered. Next, a candidate SNV has prior probability \u03c0real = \u03c0SNV/3 to be real and prior probability 1 \u2212 \u03c0SNV/3 to be a sequencing error, while a candidate indel of length L (negative for deletions, positive for insertions) has prior probability \u03c0real = \u03c0L to be real. Real variants are partitioned according to a mixture model with weights \u03c0H for a high-allele fraction cluster, \u03c0B for a \u201cbackground cluster\u201d, and \u03c0D = 1 \u2212 \u03c0H \u2212 \u03c0B to be further clustered into according to a Dirichlet process with concentration \u03b1. Each non-error cluster has a characteristic distribution of allele fractions: Beta(\u03b1H,\u03b2H) and Beta(\u03b1B,\u03b2B) for the high-allele fraction and background clusters, and Dirac \u03b4 functions for the Dirichlet clusters. The idea of this partitioning is that there will usually be sharply- defined allele fractions corresponding to the hets of different subclones, which are captured by the Dirichlet clusters, but that homozygosity and copy-number variation produce deviations from this clustering. Provided that we stochastically assign the ith variant as non-artifactual, the prior probabilities for each possibility are described by a modified Chinese Restaurant Process scheme: P (Sequencing error) =1 \u2212 \u03c0real P(High AF) =\u03c0real\u03c0H P(Background) =\u03c0real\u03c0B P(Dirichlet )=\u03c0 j cluster, N\u2212i is the number of variants besides the ith assigned to cluster j, and N\u2212i is the total number of variants jD besides the ith assigned to Dirichlet clusters. Mutect2 emits the likelihood ratio between sequencing error and a real variant assuming a flat prior. However, we can approximately compute the likelihood ratio that a non-flat Beta prior would have produced. We can do this because in Equation 9 a change in the prior allele fraction is unlikely to affect z \u0304 very much - usually the allele that a read supports is clear regardless of prior. Therefore, only the term g(\u03b1) \u2212 g(\u03b2) changes. Since \u03b2 = \u03b1 + n, where n is the vector of observed read counts per allele we can convert the log-likelihood obtained with flat prior \u03b10 to one reflecting an allele fraction prior \u03b1 by adding \u2206log odds(\u03b1)=\u2206lnP(R|A)=[g(\u03b1)\u2212g(\u03b1+n)]\u2212[g(\u03b10)\u2212g(\u03b10 +n)]. (19) Since only ratios of likelihoods are meaningful, we may WLOG set the likelihood of reads given sequencing error to be 1 and then set the likelihood fo each allele fraction cluster to be exp [Mutect2 log odds + \u2206log odds(\u03b1)]. The likelihood of a new cluster is the average over all possible new allele fractions of the likelihood, which is, by definition, simply the original Mutect2 likelihood that integrated over a flat prior. Thus we have likelihoods for every cluster. Combined with the priors, this gives us the conditional posterior for Gibbs sampling the cluster assignment of a candidate variant. We can estimate the parameters of the model by maximum likelihood. For example, we estimate \u03c0L as the total number of length-L indels in the non-error clusters divided by the total number of callable sites3, \u03c0B as the total number of variants assigned to the background cluster divided by the total number of non-error assignments. The allele fraction of a Dirichlet cluster is estimated as its total alt read count divided by its total read count. Finally, the beta distributions of the high-allele fraction and background clusters are fit by brute force likelihood optimization. Once the model converges, the combination of cluster weights and allele-fraction-adjusted likelihoods lets us compute the posterior probability that a candidate variant is a sequencing error, which determines the weak evidence filter. Since the clusters also define distributions on alt allele counts \u2013 the high-AF and background clusters define beta-binomials and the Dirichlet clusters define binomial \u2013 we also have the mixture model distribution P (alt count|total count, somatic), which the contamination and germline filters use.","title":"C. Allele Fraction Clustering Model"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/001_Notes_on_Mutect2/#iii-germline-filter","text":"Suppose we have detected an allele such that its (somatic) likelihood in the tumor is $l_{t}$ and its(diploid) likelihood in the normal is ${l_{n}}^{2}$. By convention, both of these are relative to a likelihood of 1 for the allele not to be found. If we have no matched normal, ln = 1. Suppose we also have the population allele frequency f of this allele. Then the prior probabilities for the normal to be heterozygous and homozygous alt for the allele are 2f(1\u2212f) and f2 and the prior probability for the normal genotype not to contain the allele is (1\u2212f)2. Finally, suppose that the prior for this allele to arise as a somatic variant is \u03c0. \u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u68c0\u6d4b\u5230\u67d0\u4e2a\u7b49\u4f4d\u57fa\u56e0\u5728\u80bf\u7624\u6837\u672c\u4e2d\u7684\u7a81\u53d8\u4f3c\u7136\u503c\u662f$l_{t}$\uff0c\u5b83\u5728\u6b63\u5e38\u6837\u672c\u4e2d\u7684\u4f3c\u7136\u503c\u662f${l_{n}}^{2}$\u3002\u6309\u7167\u60ef\u4f8b\uff0c\u5982\u679c\u8be5\u7b49\u4f4d\u57fa\u56e0\u6ca1\u6709\u88ab\u53d1\u73b0\uff0c\u5219\u5b83\u4eec\u90fd\u67091\u7684\u4f3c\u7136\u503c\u3002\u5982\u679c\u6211\u4eec\u6ca1\u6709\u914d\u5bf9\u7684\u6b63\u5e38\u6837\u672c\uff0c$l_{t} = 1$\u3002\u5047\u8bbe\u6211\u4eec\u4e5f\u6709\u4e86\u8be5\u7b49\u4f4d\u57fa\u56e0\u7684\u4eba\u7fa4\u7a81\u53d8\u9891\u7387\uff0c\u90a3\u4e48\u6b63\u5e38\u6837\u672c\u7684\u6742\u5408\u548c\u7eaf\u5408\u7b49\u4f4d\u57fa\u56e0\u7684\u5148\u9a8c\u6982\u7387\u5206\u522b\u4e3a$2f(1\u2212f)$ \u548c$f^{2}$\uff0c \u6b63\u5e38\u6837\u672c\u57fa\u56e0\u578b\u4e0d\u5305\u542b\u8be5\u7b49\u4f4d\u57fa\u56e0\u5148\u9a8c\u6982\u7387\u662f$(1\u2212f)^{2}$\u3002\u6700\u540e\u5047\u8bbe\u8be5\u7b49\u4f4d\u57fa\u56e0\u662f\u80bf\u7624\u53d8\u5f02\u7684\u5148\u9a8c\u6982\u7387\u662f$\u03c0$\u3002 We can determine the posterior probability that the variant exists in the normal genotype by calculating the unnormalized probabilities of four possibilities: 1. The variant exists in the tumor and the normal as a germline het. This has unnormalized probability 2f (1 \u2212 f)lnlt(1 \u2212 \u03c0). 2. The variant exists in the tumor and the normal as a germline hom alt. This has unnormalized probability f2lnlt(1 \u2212 \u03c0). 3. The variant exists in the tumor but not the normal. This has unnormalized probability (1 \u2212 f)2lt\u03c0. We exclude possibilities in which the variant does not exist in the tumor sample because we really want the conditional probability that the variant is germline given that it would otherwise be called. Normalizing, we obtain the following posterior probability that an allele is a germline variant: (1)+(2) 2f(1\u2212f)+f2 lnlt(1\u2212\u03c0) P(germline)= (1)+(2)+(3) = (2f(1\u2212f)+f2)lnlt(1\u2212\u03c0)+lt(1\u2212f)2\u03c0. (26) The above equation, in which the factors of lt could cancel if we wished, is not quite right. The tumor likelihood lt is the probability of the tumor data given that the allele exists in the tumor as a somatic variant. If the allele is in the tumor as a germline het we must modify lt to account for the fact that the allele fraction is determined by the ploidy \u2013 it must be either fg or 1 \u2212 fgwith equal probability, where fg is the minor allele fraction of germline hets. It would be awkward to recalculate the tumor likelihood with the allele frequency constrained to these two values3, but we can estimate a correction factor as follows: assuming that the posterior on the allele fraction in the somatic likelihoods model is fairly tight, the likelihood of a alt reads out of n total reads is n (1 \u2212 ft)n\u2212afa, where ft is the a tumor alt allele fraction. That is, our sophisticated model that marginalizes over ft reduces to something more naive. If the variant is a germline event, the likelihood becomes 1 n (1\u2212f )n\u2212afa +fn\u2212a(1\u2212f )a . Thus, in case (1) we 1 (1 \u2212 fg)n\u2212afa + fn\u2212a(1 \u2212 fg)a \u03c7=gg. (27) 5 2agggg have lt \u2192 \u03c7lt, where For germline hom alts, both the tumor and normal allele fractions will be similarly large, so to decent approximation we don\u2019t have to modify lt. Of course, this only applies if the allele fraction is large. Rather than try to model the count of ref reads within a germline hom alt site, we simply set a threshold of allele fraction 0.9, so that in case (2) lt \u2192 I[ft > 0.9]lt. and the corrected germline probability is (1)+(2) 2f(1\u2212f)\u03c7+I[ft >0.9]f2 ln(1\u2212\u03c0) P(germline)= (1)+(2)+(3) = (2f(1\u2212f)\u03c7+I[ft >0.9]f2)ln(1\u2212\u03c0)+(1\u2212f)2\u03c0. (28) To filter, we set a threshold on this posterior probability. So far we have assumed that the population allele frequency f is known, which is the case if it is found in our germline resource, such as gnomAD. If f is not known we must make a reasonable guess as follows. Suppose the prior distribution on f is Beta(\u03b1, \u03b2). The mean \u03b1/(\u03b1+\u03b2) of this prior is the average human heterozygosity \u03b8 \u2248 10\u22123, so we have \u03b2 \u2248 \u03b1/\u03b8. We need one more constraint to determine \u03b1 and \u03b2, and since we are concerned with imputing f when f is small we use a condition based on rare variants. Specifically, the number of variant alleles n at some site in a germline resource with N/2 samples, hence N chromosomes, is given by f \u223c Beta(\u03b1,\u03b2),n \u223c Binom(N,f). That is, n \u223c BetaBinom(\u03b1,\u03b2,N). The probability of a site being non-variant in every sample is then P(n = 0) = BetaBinom(0|\u03b1,\u03b2,N), which we equate to the empirical proportion of non-variant sites in our resource, about 7/8 for exonic sites in gnomAD. Solving, we obtain approximately \u03b1 = 0.01, \u03b2 = 10 for gnomAD. Now, given that some allele found by Mutect is not in the resource, the posterior on f is Beta(\u03b1, \u03b2 + N ), the mean of which is, since \u03b2 << N , about \u03b1/N . By default, Mutect uses this value.","title":"III. GERMLINE FILTER"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/001_Notes_on_Mutect2/#iii-related-gatk-tools","text":"","title":"III. RELATED GATK TOOLS"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/001_Notes_on_Mutect2/#b-calculating-contamination","text":"","title":"B. Calculating Contamination"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/001_paper/","text":"Heterogeneous Tumor-Immune Microenvironments among Differentially Growing Metastases in an Ovarian Cancer Patient","title":"001 paper"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/001_somatic_slides/","text":"MuTect Overview In a nutshell, the MuTect analysis consists of three steps: 1. Pre-processing the aligned reads in the tumor and normal sequencing data 2. Statistical analysis to identify sites that are likely to carry somatic mutations with high confidence 3. Post-processing of candidate somatic mutations https://www.nature.com/articles/nbt.2514 Preprocessing the aligned reads In this step we ignore reads with too many mismatches or very low quality scores since these represent noisy reads that introduce more noise than signal. Statistical analysis Overview In a nutshell, the MuTect analysis consists of three steps: 1 Pre-processing the aligned reads in the tumor and normal sequencing data 2 Statistical analysis to identify sites that are likely to carry somatic mutations with high confidence 3 Post-processing of candidate somatic mutations \u7edf\u8ba1\u5206\u6790\u901a\u8fc7\u4f7f\u7528\u4e24\u4e2a\u8d1d\u53f6\u65af\u5206\u7c7b\u5668\u6765\u9884\u6d4b\u4f53\u7ec6\u80de\u7a81\u53d8\uff1a \u7b2c\u4e00\u4e2a\u7528\u4e8e\u68c0\u6d4b\u80bf\u7624\u6837\u672c\u5728\u7ed9\u5b9a\u4f4d\u70b9\u662f\u975e\u53c2\u8003\u4f4d\u70b9\uff0c\u5bf9\u4e8e\u90a3\u4e9b\u88ab\u53d1\u73b0\u4e3a\u975e\u53c2\u8003\u7684\u4f4d\u70b9\uff0c \u7b2c\u4e8c\u4e2a\u5206\u7c7b\u5668\u786e\u4fdd\u6b63\u5e38\u6837\u672c\u4e0d\u643a\u5e26\u53d8\u5f02\u7b49\u4f4d\u57fa\u56e0\u3002\u5728\u5b9e\u8df5\u4e2d\uff0c\u901a\u8fc7\u8ba1\u7b97LOD\u5f97\u5206\uff08log odds\uff09\uff0c\u7136\u540e\u4e0e\u9608\u503c\u8fdb\u884c\u6bd4\u8f83\u6765\u6267\u884c\u5206\u7c7b\uff0c\u9608\u503c\u662f\u7531\u6240\u8003\u8651\u4e8b\u4ef6\u7684\u5148\u9a8c\u6982\u7387\u7684\u5bf9\u6570\u6bd4\u6765\u51b3\u5b9a\u7684\u3002 \u5728\u4f53\u7ec6\u80de\u7a81\u53d8\u4ee5\u6bcfMb\u7ea61\u7684\u901f\u5ea6\u53d1\u751f\uff0c\u8fd9\u4fdd\u8bc1\u4e86\u7531\u4e8e\u80bf\u7624\u4e2d\u7684\u566a\u58f0\u5bfc\u81f4\u7684\u5047\u9633\u6027\u7387\u4f4e\u4e8e\u4f53\u7ec6\u80de\u7a81\u53d8\u7387\u7684\u4e00\u534a\u3002 \u5728\u6b63\u5e38\u7ec6\u80de\u4e2d\uff0c\u5982\u679c\u4f4d\u70b9\u4e0d\u5728dbSNP\u4e2d\uff0c\u56e0\u4e3a\u975edbSNP\u79cd\u7cfb\u53d8\u5f02\u5927\u81f4\u4ee5100/Mb\u7684\u901f\u7387\u53d1\u751f\u3002\u8fd9\u79cd\u9608\u503c\u503c\u4fdd\u8bc1\u4e86\u7531\u4e8e\u7f3a\u5c11\u6b63\u5e38\u53d8\u5f02\u800c\u5bfc\u81f4\u7684\u5047\u9633\u6027\uff0c\u4e5f\u4f4e\u4e8e\u4f53\u7ec6\u80de\u7a81\u53d8\u7387\u7684\u4e00\u534a\u3002 $$LOD_{T} > \\log_{10}(0.5 \\times 10^{-6}) \\approx 6.3$$ $$LOD_{N} > \\log_{10}(0.5 \\times 10^{-2}) \\approx 2.3$$ alt_allele_in_normal: the alternate allele was also found in the normal so this is probably either a shared artifact or a germline event clustered_events: several mutations that are close together (parameters are in the tool doc), which is often the sign of being an artifact It filters variants with 2 mutation-events with the distance between each other larger than 2bp(start position), not the mutations close to each other. ECNT is the number of potential (pre-filtering) somatic mutations (events) exhibited in an assembled haplotype.https://gatkforums.broadinstitute.org/gatk/discussion/23249/ecnt-value-in-mutect2 FilterMutectCalls with --maxEventsInHaplotype t_lod_fstar: log-odds of an event in the tumor, which is measure of confidence of the mutation being real str_contraction: related to short tandem repeats Filters used in high-confidence mode Proximal Gap MuTect will reject a candidate site if there are more than a given number of reads with insertions/deletions in an 11 base pair window centered on the candidate. The threshold value is controlled by the --gap_events_threshold. In the CALLSTATS output file, the relevant columns are labeled t_ins_count and t_del_count. Filters used in high-confidence mode Poor Mapping This filter removes FPs caused by reads that are poorly mapped (typically due to sequence similarities between different portions of the genome). The filter uses two tests: Reject candidate if it does not meet a given threshold for the fraction of reads that have a mapping quality of 0 in tumor and normal samples. The threshold value is controlled by --fraction_mapq_threshold. Reject candidate if it does not have at least one observation of the mutant allele with a mapping quality that satisfies a given threshold. The threshold value is controlled by --required_maximum_alt_allele_mapping_quality_score . In the CALLSTATS output file, the relevant columns are labeled total_reads and map_Q0_reads for the first test, and t_alt_max_mapq for the second test. Filters used in high-confidence mode Strand Bias This filter rejects FPs caused by context-specific sequencing where the vast majority of alternate alleles are seen in a single direction of reads. Candidates are rejected if strand-specific LOD is below a given threshold in a direction where the sensitivity to have passed that threshold is above a certain percentage. The LOD threshold value is controlled by --strand_artifact_lod and the percentage is controlled by --strand_artifact_power_threshold. In the CALLSTATS output file, the relevant columns are labeled power_to_detect_negative_strand_artifact and t_lod_fstar_forward . There are also complementary columns labeled power_to_detect_positive_strand_artifact and t_lod_fstar_reverse . Filters used in high-confidence mode Clustered Position \u8be5\u6ce8\u91ca\u662f\u68c0\u6d4b\u4f53\u7ec6\u80de\u7a81\u53d8\u4f4d\u4e8ereads\u672b\u7aef\u7684\u805a\u96c6\u7684\u8bc1\u636e\uff0c\u5728\u547d\u4ee4\u884c\u52a0\u5165 --enable_clustered_read_position_filter \u53c2\u6570\u6765\u5f00\u542f\u8be5\u6ce8\u91ca\u548c\u8fc7\u6ee4\u3002 \u5728\u7ed9\u5b9a\u7684\u4f53\u7ec6\u80de\u7a81\u53d8\u4f4d\u70b9\uff0c + MEDIAN_LEFT_OFFSET is the median of the number of bases from the left end of the tumor read to the variant. + MEDIAN_RIGHT_OFFSET is similar, but counts from the right end of the read. + MAD_LEFT_OFFSET and MAD_RIGHT_OFFSET measure the median absolute deviations. The median gives us the offset of a representative read, while the median absolute deviation captures the spread. We filter a variant if MEDIAN_LEFT_OFFSET <= 10 and MAD_LEFT_OFFSET <= 3, or if MEDIAN_RIGHT_OFFSET <= 10 and MAD_RIGHT_OFFSET <= 3. This filter rejects FPs caused by misalignments evidenced by the alternate alleles being clustered at a consistent distance from the start or end of the read alignment. Candidates are rejected if their median distance from the start/end of the read and median absolute deviation are lower or equal to given thresholds. The position from end of read threshold value is controlled by --pir_median_threshold and the deviation value is controlled by --pir_mad_threshold. In the CALLSTATS output file, the relevant columns are labeled tumor_alt_fpir_median and tumor_alt_fpir_mad for the forward strand, and complementary columns are labeled tumor_alt_rpir_median and tumor_alt_rpir_mad for the reverse (note the name difference is fpir vs. rpir, for forward vs. reverse position in read). https://software.broadinstitute.org/gatk/documentation/tooldocs/3.8-0/org_broadinstitute_gatk_tools_walkers_cancer_ClusteredReadPosition.php Filters used in high-confidence mode Observed in Control This filter rejects FPs in tumor data by looking at control data (typically from a matched normal) for evidence of the alternate allele that is above random sequencing error. Candidates are rejected if both the following conditions are met: The number of observations of the alternate allele or the proportion of reads carrying the alternate allele is above a given threshold, controlled by --max_alt_alleles_in_normal_count and --max_alt_allele_in_normal_fraction. The sum of quality scores is above a given threshold value, controlled by --max_alt_alleles_in_normal_qscore_sum. In the CALLSTATS output file, the relevant columns are labeled n_alt_count, normal_f, and n_alt_sum. Filters applied in all MuTect modes 1. Tumor and normal LOD scores This filter rejects candidates with a tumor LOD score below a given threshold value, controlled by --tumor_lod, and similarly for a normal LOD score threshold controlled by --normal_lod_threshold. In the CALLSTATS output file, the relevant columns are labeled t_lod_fstar and init_n_lod, respectively. Possible contamination This filter rejects candidates with potential cross-patient contamination, controlled by --fraction_contamination. In the CALLSTATS output file, the relevant columns are labeled t_lod_fstar and contaminant_lod. Normal LOD score and dbsnp status If a candidate mutation is in dbsnp but is not in COSMIC, it may be a germline variant. In that case, the normal LOD threshold that the candidate must clear is raised to a value controlled by --dbsnp_normal_lod. In the CALLSTATS output file, the relevant column is labeled init_n_lod. Triallelic Site Filter When the program is evaluating a site, it considers all possible alternate alleles as mutation candidates, and puts them through all the filters detailed above. If more than one candidate allele passes all filters, resulting in a proposed triallelic site, the site is rejected with the reason triallelic_site because it is extremely unlikely that this would really happen in a tumor sample. gatk4 bad_haplotype Mutect2 emits phasing information for calls in the same assembly region. We assign a \u201cbad haplotype\u201d probability equal to the greatest technical artifact probability of any in-phas call within a certain distance, by default 100 bases. germline_risk the germline risk is assigned this way 1. if variants in dbsnp, but not cosmic, the nlod cutoff is 5.5 2. otherwise, the cutoff is 2.2 MuTect2 default settings initial_tumor_lod=4.0 initial_normal_lod=0.5 tumor_lod= 6.3 normal_lod=2.2 dbsnp_normal_lod=5.5 chr11 123456789 . C A . germline_risk ECNT=1;HCNT=4;MAX_ED=.;MIN_ED=.;NLOD=3.61;TLOD=12.81 GT:AD:AF:ALT_F1R2:ALT_F2R1:FOXOG:QSS:REF_F1R2:REF_F2R1 0/0:13,0:0.00:0:0:.:440,0:10:3 0/1:10,6:0.357:2:4:0.667:336,173:4:6 str_contraction It shows that all the mutations marked with str_contraction have only one repeat number difference between reference and allele. Besides, these mutations must locates in the reference STR region with not less than 8bp.","title":"MuTect"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/001_somatic_slides/#mutect","text":"Overview In a nutshell, the MuTect analysis consists of three steps: 1. Pre-processing the aligned reads in the tumor and normal sequencing data 2. Statistical analysis to identify sites that are likely to carry somatic mutations with high confidence 3. Post-processing of candidate somatic mutations https://www.nature.com/articles/nbt.2514","title":"MuTect"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/001_somatic_slides/#preprocessing-the-aligned-reads","text":"In this step we ignore reads with too many mismatches or very low quality scores since these represent noisy reads that introduce more noise than signal.","title":"Preprocessing the aligned reads"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/001_somatic_slides/#statistical-analysis","text":"Overview In a nutshell, the MuTect analysis consists of three steps: 1 Pre-processing the aligned reads in the tumor and normal sequencing data 2 Statistical analysis to identify sites that are likely to carry somatic mutations with high confidence 3 Post-processing of candidate somatic mutations \u7edf\u8ba1\u5206\u6790\u901a\u8fc7\u4f7f\u7528\u4e24\u4e2a\u8d1d\u53f6\u65af\u5206\u7c7b\u5668\u6765\u9884\u6d4b\u4f53\u7ec6\u80de\u7a81\u53d8\uff1a \u7b2c\u4e00\u4e2a\u7528\u4e8e\u68c0\u6d4b\u80bf\u7624\u6837\u672c\u5728\u7ed9\u5b9a\u4f4d\u70b9\u662f\u975e\u53c2\u8003\u4f4d\u70b9\uff0c\u5bf9\u4e8e\u90a3\u4e9b\u88ab\u53d1\u73b0\u4e3a\u975e\u53c2\u8003\u7684\u4f4d\u70b9\uff0c \u7b2c\u4e8c\u4e2a\u5206\u7c7b\u5668\u786e\u4fdd\u6b63\u5e38\u6837\u672c\u4e0d\u643a\u5e26\u53d8\u5f02\u7b49\u4f4d\u57fa\u56e0\u3002\u5728\u5b9e\u8df5\u4e2d\uff0c\u901a\u8fc7\u8ba1\u7b97LOD\u5f97\u5206\uff08log odds\uff09\uff0c\u7136\u540e\u4e0e\u9608\u503c\u8fdb\u884c\u6bd4\u8f83\u6765\u6267\u884c\u5206\u7c7b\uff0c\u9608\u503c\u662f\u7531\u6240\u8003\u8651\u4e8b\u4ef6\u7684\u5148\u9a8c\u6982\u7387\u7684\u5bf9\u6570\u6bd4\u6765\u51b3\u5b9a\u7684\u3002 \u5728\u4f53\u7ec6\u80de\u7a81\u53d8\u4ee5\u6bcfMb\u7ea61\u7684\u901f\u5ea6\u53d1\u751f\uff0c\u8fd9\u4fdd\u8bc1\u4e86\u7531\u4e8e\u80bf\u7624\u4e2d\u7684\u566a\u58f0\u5bfc\u81f4\u7684\u5047\u9633\u6027\u7387\u4f4e\u4e8e\u4f53\u7ec6\u80de\u7a81\u53d8\u7387\u7684\u4e00\u534a\u3002 \u5728\u6b63\u5e38\u7ec6\u80de\u4e2d\uff0c\u5982\u679c\u4f4d\u70b9\u4e0d\u5728dbSNP\u4e2d\uff0c\u56e0\u4e3a\u975edbSNP\u79cd\u7cfb\u53d8\u5f02\u5927\u81f4\u4ee5100/Mb\u7684\u901f\u7387\u53d1\u751f\u3002\u8fd9\u79cd\u9608\u503c\u503c\u4fdd\u8bc1\u4e86\u7531\u4e8e\u7f3a\u5c11\u6b63\u5e38\u53d8\u5f02\u800c\u5bfc\u81f4\u7684\u5047\u9633\u6027\uff0c\u4e5f\u4f4e\u4e8e\u4f53\u7ec6\u80de\u7a81\u53d8\u7387\u7684\u4e00\u534a\u3002 $$LOD_{T} > \\log_{10}(0.5 \\times 10^{-6}) \\approx 6.3$$ $$LOD_{N} > \\log_{10}(0.5 \\times 10^{-2}) \\approx 2.3$$ alt_allele_in_normal: the alternate allele was also found in the normal so this is probably either a shared artifact or a germline event clustered_events: several mutations that are close together (parameters are in the tool doc), which is often the sign of being an artifact It filters variants with 2 mutation-events with the distance between each other larger than 2bp(start position), not the mutations close to each other. ECNT is the number of potential (pre-filtering) somatic mutations (events) exhibited in an assembled haplotype.https://gatkforums.broadinstitute.org/gatk/discussion/23249/ecnt-value-in-mutect2 FilterMutectCalls with --maxEventsInHaplotype t_lod_fstar: log-odds of an event in the tumor, which is measure of confidence of the mutation being real str_contraction: related to short tandem repeats Filters used in high-confidence mode Proximal Gap MuTect will reject a candidate site if there are more than a given number of reads with insertions/deletions in an 11 base pair window centered on the candidate. The threshold value is controlled by the --gap_events_threshold. In the CALLSTATS output file, the relevant columns are labeled t_ins_count and t_del_count. Filters used in high-confidence mode Poor Mapping This filter removes FPs caused by reads that are poorly mapped (typically due to sequence similarities between different portions of the genome). The filter uses two tests: Reject candidate if it does not meet a given threshold for the fraction of reads that have a mapping quality of 0 in tumor and normal samples. The threshold value is controlled by --fraction_mapq_threshold. Reject candidate if it does not have at least one observation of the mutant allele with a mapping quality that satisfies a given threshold. The threshold value is controlled by --required_maximum_alt_allele_mapping_quality_score . In the CALLSTATS output file, the relevant columns are labeled total_reads and map_Q0_reads for the first test, and t_alt_max_mapq for the second test. Filters used in high-confidence mode Strand Bias This filter rejects FPs caused by context-specific sequencing where the vast majority of alternate alleles are seen in a single direction of reads. Candidates are rejected if strand-specific LOD is below a given threshold in a direction where the sensitivity to have passed that threshold is above a certain percentage. The LOD threshold value is controlled by --strand_artifact_lod and the percentage is controlled by --strand_artifact_power_threshold. In the CALLSTATS output file, the relevant columns are labeled power_to_detect_negative_strand_artifact and t_lod_fstar_forward . There are also complementary columns labeled power_to_detect_positive_strand_artifact and t_lod_fstar_reverse . Filters used in high-confidence mode Clustered Position \u8be5\u6ce8\u91ca\u662f\u68c0\u6d4b\u4f53\u7ec6\u80de\u7a81\u53d8\u4f4d\u4e8ereads\u672b\u7aef\u7684\u805a\u96c6\u7684\u8bc1\u636e\uff0c\u5728\u547d\u4ee4\u884c\u52a0\u5165 --enable_clustered_read_position_filter \u53c2\u6570\u6765\u5f00\u542f\u8be5\u6ce8\u91ca\u548c\u8fc7\u6ee4\u3002 \u5728\u7ed9\u5b9a\u7684\u4f53\u7ec6\u80de\u7a81\u53d8\u4f4d\u70b9\uff0c + MEDIAN_LEFT_OFFSET is the median of the number of bases from the left end of the tumor read to the variant. + MEDIAN_RIGHT_OFFSET is similar, but counts from the right end of the read. + MAD_LEFT_OFFSET and MAD_RIGHT_OFFSET measure the median absolute deviations. The median gives us the offset of a representative read, while the median absolute deviation captures the spread. We filter a variant if MEDIAN_LEFT_OFFSET <= 10 and MAD_LEFT_OFFSET <= 3, or if MEDIAN_RIGHT_OFFSET <= 10 and MAD_RIGHT_OFFSET <= 3. This filter rejects FPs caused by misalignments evidenced by the alternate alleles being clustered at a consistent distance from the start or end of the read alignment. Candidates are rejected if their median distance from the start/end of the read and median absolute deviation are lower or equal to given thresholds. The position from end of read threshold value is controlled by --pir_median_threshold and the deviation value is controlled by --pir_mad_threshold. In the CALLSTATS output file, the relevant columns are labeled tumor_alt_fpir_median and tumor_alt_fpir_mad for the forward strand, and complementary columns are labeled tumor_alt_rpir_median and tumor_alt_rpir_mad for the reverse (note the name difference is fpir vs. rpir, for forward vs. reverse position in read). https://software.broadinstitute.org/gatk/documentation/tooldocs/3.8-0/org_broadinstitute_gatk_tools_walkers_cancer_ClusteredReadPosition.php Filters used in high-confidence mode Observed in Control This filter rejects FPs in tumor data by looking at control data (typically from a matched normal) for evidence of the alternate allele that is above random sequencing error. Candidates are rejected if both the following conditions are met: The number of observations of the alternate allele or the proportion of reads carrying the alternate allele is above a given threshold, controlled by --max_alt_alleles_in_normal_count and --max_alt_allele_in_normal_fraction. The sum of quality scores is above a given threshold value, controlled by --max_alt_alleles_in_normal_qscore_sum. In the CALLSTATS output file, the relevant columns are labeled n_alt_count, normal_f, and n_alt_sum. Filters applied in all MuTect modes 1. Tumor and normal LOD scores This filter rejects candidates with a tumor LOD score below a given threshold value, controlled by --tumor_lod, and similarly for a normal LOD score threshold controlled by --normal_lod_threshold. In the CALLSTATS output file, the relevant columns are labeled t_lod_fstar and init_n_lod, respectively. Possible contamination This filter rejects candidates with potential cross-patient contamination, controlled by --fraction_contamination. In the CALLSTATS output file, the relevant columns are labeled t_lod_fstar and contaminant_lod. Normal LOD score and dbsnp status If a candidate mutation is in dbsnp but is not in COSMIC, it may be a germline variant. In that case, the normal LOD threshold that the candidate must clear is raised to a value controlled by --dbsnp_normal_lod. In the CALLSTATS output file, the relevant column is labeled init_n_lod. Triallelic Site Filter When the program is evaluating a site, it considers all possible alternate alleles as mutation candidates, and puts them through all the filters detailed above. If more than one candidate allele passes all filters, resulting in a proposed triallelic site, the site is rejected with the reason triallelic_site because it is extremely unlikely that this would really happen in a tumor sample.","title":"Statistical analysis"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/001_somatic_slides/#gatk4","text":"","title":"gatk4"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/001_somatic_slides/#bad_haplotype","text":"Mutect2 emits phasing information for calls in the same assembly region. We assign a \u201cbad haplotype\u201d probability equal to the greatest technical artifact probability of any in-phas call within a certain distance, by default 100 bases.","title":"bad_haplotype"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/001_somatic_slides/#germline_risk","text":"the germline risk is assigned this way 1. if variants in dbsnp, but not cosmic, the nlod cutoff is 5.5 2. otherwise, the cutoff is 2.2 MuTect2 default settings initial_tumor_lod=4.0 initial_normal_lod=0.5 tumor_lod= 6.3 normal_lod=2.2 dbsnp_normal_lod=5.5 chr11 123456789 . C A . germline_risk ECNT=1;HCNT=4;MAX_ED=.;MIN_ED=.;NLOD=3.61;TLOD=12.81 GT:AD:AF:ALT_F1R2:ALT_F2R1:FOXOG:QSS:REF_F1R2:REF_F2R1 0/0:13,0:0.00:0:0:.:440,0:10:3 0/1:10,6:0.357:2:4:0.667:336,173:4:6","title":"germline_risk"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/001_somatic_slides/#str_contraction","text":"It shows that all the mutations marked with str_contraction have only one repeat number difference between reference and allele. Besides, these mutations must locates in the reference STR region with not less than 8bp.","title":"str_contraction"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/002_MuTect/","text":"COSMIC in MuTect influence Mutect2 https://gatkforums.broadinstitute.org/gatk/discussion/2593/how-does-use-of-cosmic-in-mutect-influence-of-mutations-called-in-known-cancer-genes-vs-others","title":"002 MuTect"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/002_MuTect/#cosmic-in-mutect-influence","text":"Mutect2 https://gatkforums.broadinstitute.org/gatk/discussion/2593/how-does-use-of-cosmic-in-mutect-influence-of-mutations-called-in-known-cancer-genes-vs-others","title":"COSMIC in MuTect influence"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/","text":"[toc] \u7b80\u4ecb \u9002\u7528\u4e8e\u6269\u589e\u5b50\u6d4b\u5e8f/\u5bcc\u96c6panel \u9002\u7528\u4e8esomatic/germline \u7a81\u53d8\u68c0\u6d4b \u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/Illumina/Pisces/releases Stitcher - Stitches two paired reads together into a single read Pisces - Calls small variants Scylla - Detects multiple nucleotide variants (MNVs) in a given sample and phases the variants in complex regions into sub populations VariantQualityRecalibration - Recalibrates the variant quality scores (Q scores) if the particular variants are over represented \u5b89\u88c5 \u4e0b\u8f7d .net core 2.0 \u4e8c\u8fdb\u5236\u7684\u6587\u4ef6 #https://download.visualstudio.microsoft.com/download/pr/886b4a4c-30af-454b-8bec-81c72b7b4e1f/d1a0c8de9abb36d8535363ede4a15de6/dotnet-sdk-3.0.100-linux-x64.tar.gz #https://dotnet.microsoft.com/download/thank-you/dotnet-sdk-2.2.402-linux-x64-binaries https://download.visualstudio.microsoft.com/download/pr/46411df1-f625-45c8-b5e7-08ab736d3daa/0fbc446088b471b0a483f42eb3cbf7a2/dotnet-sdk-2.2.402-linux-x64.tar.gz mkdir -p $HOME/dotnet && tar zxf dotnet-sdk-3.0.100-linux-x64.tar.gz -C $HOME/dotnet export DOTNET_ROOT=$HOME/dotnet export PATH=$PATH:$HOME/dotnet \u9700\u8981\u6ce8\u610f\u7684\u662f\u7684\uff0c .net core 3.0\u4f3c\u4e4e\u4e0d\u517c\u5bb9\uff1a $ dotnet Pisces_5.2.10.49/Pisces.dll It was not possible to find any compatible framework version The specified framework 'Microsoft.NETCore.App', version '2.0.0' was not found. \u8f6f\u4ef6\u7248\u672c net core 2.0 Pisces_5.2.10.49 linux centos7 \u68c0\u6d4b\u903b\u8f91 Pisces\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u7ba1\u9053\u7a0b\u5e8f\u3002\u5728\u539f\u59cbBAM\u4e2d\u5904\u7406\u65f6\uff0cPisces\u5728\u6bcf\u4e2aCIGAR\u5b57\u7b26\u4e32\u4e2d\u626b\u63cfindel\u548c\u53c2\u8003\u8fdb\u884c\u4e0d\u5339\u914d\u7684\u8bfb\u53d6\u5e8f\u5217\uff0c\u4ece\u800c\u5efa\u7acb\u5019\u9009\u53d8\u5f02\u5217\u8868\u3002\u8df3\u8fc7\u4e0d\u88ab\u8ba4\u4e3a\u6709\u4ef7\u503c\u7684\u5bf9\u9f50\u65b9\u5f0f\uff0c\u5982secondary or duplicate alignments or low mapping quality\u3002\u540c\u65f6\uff0cPisces\u4f1a\u5efa\u7acb\u8986\u76d6\u77e9\u9635\uff08\u6309\u78b1\u57fa\u7c7b\u578b\u8ba1\u7b97\u7684\u8986\u76d6\u8fde\u7eed\u5757\uff09\u3002\u53ea\u6709\u90a3\u4e9b\u8d85\u8fc7\u6700\u4f4e\u78b1\u57fa\u68c0\u6d4b\u8d28\u91cf\u7684\u78b1\u57fa\u624d\u7b97\u4f5cobservations\u3002\u5f53\u6bcf\u4e2a\u5757\u5b8c\u6210\u65f6\uff08\u6700\u540e\u4e00\u4e2a\u76f8\u5173\u7684reads\u5df2\u4ecebam\u4e2d\u63d0\u53d6\uff09\uff0c\u901a\u8fc7\u67e5\u8be2\u5b8c\u6574\u7684\u5757\u4e2d\u7684\u4fe1\u606f\u6765\u68c0\u6d4b\u51fa\u8be5\u5757\u4e2d\u7684\u6240\u6709\u5019\u9009\u53d8\u5f02\u3002\u6b64\u65f6\uff0c\u5c06\u8ba1\u7b97\u51fa\u771f\u5b9e\u7684\u8986\u76d6\u6df1\u5ea6\uff0c\u9891\u7387\uff0c\u6700\u7ec8\u8d28\u91cf\u5206\u6570\uff0c\u94fe\u504f\u597d\u6027\u7b49\uff0c\u5e76\u6267\u884c\u6700\u7ec8\u8fc7\u6ee4\u3002\u7136\u540e\u5c06\u901a\u8fc7\u6700\u5c0f\u62a5\u544a\u9608\u503c\u7684\u53d8\u5f02\u5199\u5165VCF\uff0c\u5e76\u5904\u7406\u4e0b\u4e00\u4e2a\u5757\u3002\u7f13\u51b2\u5757\u5904\u7406\u4ee5\u5b9e\u73b0\u6700\u4f73\u8bfb\u5199\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cPisces\u8981\u6c42\u7528\u4e8e\u53d8\u5f02\u68c0\u6d4b\u7684\u6240\u6709\u78b1\u57fa\u7684\u78b1\u57fa\u8d28\u91cf\u5206\u6570\u81f3\u5c11\u4e3aQ20\uff0c\u5bf9\u5e94\u4e8e0.01\u7684\u9519\u8bef\u7387\u6216\u66f4\u5c11\u3002\u78b1\u57fa\u68c0\u6d4b\u8fc7\u6ee4\u5668\u662f\u53ef\u914d\u7f6e\u7684\u8fc7\u6ee4\u5668\uff0c\u53ef\u4ee5\u4f7f\u5176\u66f4\u4e25\u683c\u4ee5\u63d0\u9ad8\u7cbe\u5ea6\u3002base calls\u7684\u8d28\u91cf\u9a71\u52a8\u5185\u90e8\u566a\u58f0\u6a21\u578b\u3002\u4f8b\u5982\uff0c\u5f53\u53d8\u5f02\u68c0\u6d4b\u8fc7\u7a0b\u4e2d\u4ec5\u5305\u62ecQ20\u4ee5\u4e0a\u7684base calls\u65f6\uff0cPisces\u5c06\u6709\u4fe1\u5fc3\u5c06\u7a81\u53d8\u4ece\u566a\u58f0\u964d\u81f31\uff05\u7684\u7a81\u53d8\u9891\u7387\uff0c\u8fd9\u53cd\u6620\u5728\u5199\u5165VCF\u7684\u7a81\u53d8\u8d28\u91cf\u4e2d\u3002\u5982\u679c\u5c06\u78b1\u57fa\u68c0\u6d4b\u8d28\u91cf\u5f97\u5206\u8fc7\u6ee4\u9608\u503c\u8bbe\u7f6e\u4e3aQ30\uff0c\u5219Pisces\u5c06\u8fdb\u884c\u8c03\u6574\uff0c\u5e76\u5728\u68c0\u6d4b\u4f4e\u9891\u7a81\u53d8\uff08\u73b0\u5728\u964d\u81f30.1\uff05\uff09\u4e0a\u6709\u66f4\u9ad8\u7684\u53ef\u4fe1\u5ea6\u3002\u4ec5\u5f53\u5927\u591a\u6570\u78b1\u57fa\u6ee1\u8db3\u8d28\u91cf\u9608\u503c\u65f6\uff0c\u624d\u5e94\u78b1\u57fa\u8d28\u91cf\u5206\u6570\u8bbe\u7f6e\u4e3a\u66f4\u9ad8\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u8003\u8651\u9891\u7387\u4e3a1\uff05\u6216\u66f4\u9ad8\u7684\u4efb\u4f55\u975e\u53c2\u8003\u7b49\u4f4d\u57fa\u56e0\u3002\u6839\u636e\u53c2\u8003\u548c\u7a81\u53d8\u7684reads\u8ba1\u6570\uff0c\u6211\u4eec\u57fa\u4e8e\u6cca\u677e\u6a21\u578b\u8ba1\u7b97SNV\u7684q\u503c\uff0c\u5982\u679cSNV\u7684q\u503c\u4f4e\u4e8e20\uff0c\u5219\u5bf9SNV\u8fdb\u884c\u8fc7\u6ee4\u3002\u5982\u679cq\u503c\u572820\u523030\u4e4b\u95f4\uff0c\u6211\u4eec\u62a5\u544a\u8be5\u7a81\u53d8\u5728.vcf\u7684\u8fc7\u6ee4\u5668\u5217\u4e2d\u5e26\u6709\u201c q30\u201d\u3002\u5982\u679cq\u503c\u5927\u4e8e\u6216\u7b49\u4e8e30\uff0c\u5219\u6211\u4eec\u5728FILTER\u5217\u4e2d\u4e3a\u7a81\u53d8\u63d0\u4f9b\u4e00\u4e2a\u6e05\u6670\u7684\u201c PASS\u201d\u3002 \u63d2\u5165\u7f3a\u5931\u7684\u5904\u7406\u65b9\u5f0f\u7c7b\u4f3c\uff1a\u6211\u4eec\u67e5\u770b\u8986\u76d6\u7ed9\u5b9a\u4f4d\u7f6e\u7684\u6bd4\u5bf9\u4e2d\u6709\u591a\u5c11\u4e2a\u5305\u542b\u7279\u5b9a\u63d2\u5165\u7f3a\u5931\uff08\u5373\u6211\u4eec\u7684\u53d8\u5f02\u6570\uff09\u4e0e\u8be5\u4f4d\u7f6e\u7684\u603b\u4f53\u8986\u76d6\u5ea6\u3002\u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u4e0d\u6267\u884c\u7684\u67d0\u4e9bindel\u91cd\u65b0\u6392\u5217\u6216\u66f4\u590d\u6742\u7684\u68c0\u6d4b\u53d8\u5f02\u7a0b\u5e8f\u4e2d\u5305\u542b\u201cindel\u6e05\u6d17\u201d\u6b65\u9aa4\u3002 \u5f53\u5728\u4f53\u7ec6\u80de\u73af\u5883\u4e2d\u8fdb\u884c\u57fa\u56e0\u5206\u578b\u65f6\uff0cPisces\u4f7f\u7528\u201c 0/1\u201d\u8868\u793a\u5728\u6700\u5c0f\u68c0\u6d4b\u9608\u503c\uff08\u9ed8\u8ba4\u503c\u4e3a1\uff05\uff09\u5904\u53d1\u73b0\u4e86\u53c2\u8003\u7b49\u4f4d\u57fa\u56e0\u548c\u5176\u4ed6\u7b49\u4f4d\u57fa\u56e0\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u4e0d\u662f\u5728\u4e8c\u500d\u4f53\u4e0a\u4e0b\u6587\u4e2d\u7684\u540c\u4e00\u4e2a\u201c 0/1\u201d\u57fa\u56e0\u578b\uff0c\u5728\u8be5\u57fa\u56e0\u578b\u4e2d\u53c2\u8003\u548c\u7b49\u4f4d\u57fa\u56e0\u5206\u522b\u5360\u5927\u7ea650\uff05\u3002\u4f8b\u5982\uff0c\u5982\u679c\u53d1\u73b0\u7a81\u53d8\u7684\u9891\u7387\u662f80\uff05\uff0c\u800c\u73b0\u53c2\u8003\u7684\u9891\u7387\u662f5%\uff0c\u5e76\u4e14Q\u5206\u6570\u90fd\u53ef\u4ee5\u63a5\u53d7\uff0c\u5219\u8fd9\u88ab\u8ba4\u4e3a\u662f\u6742\u5408\u4f53\u7ec6\u80de\u7a81\u53d8\uff0c \u56e0\u4e3a\u4e24\u8005\u90fd\u5b58\u5728 \u3002\u5373\u4f7f\u5728\u76f4\u89c9\u4e0a\uff0c\u7528\u6237\u5728\u4e8c\u500d\u4f53\u73af\u5883\u4e2d\u4e5f\u53ef\u4ee5\u8ba4\u4e3a\u8fd9\u662f\u7eaf\u5408\u7a81\u53d8\u3002 Q-score \u8ba1\u7b97 Q\u5f97\u5206\u7ed9\u51fa\u4e86\u5b58\u5728\u53d8\u5f02\u7684\u53ef\u786e\u5b9a\u7a0b\u5ea6\u3002\u8f83\u9ad8\u7684q\u5206\u6570\u4ee3\u8868\u66f4\u5927\u7684\u786e\u5b9a\u6027\u3002\u6211\u4eec\u7684q\u5f97\u5206\u8ba1\u7b97\u8003\u8651\u4e86\u566a\uff0c\u8986\u76d6\u6df1\u5ea6\u548c\u7a81\u53d8\u8ba1\u6570\u3002\u66f4\u5927\u7684\u7a81\u53d8\u6570\u548c\u8986\u76d6\u6df1\u5ea6\u4f1a\u589e\u52a0q\u5f97\u5206\u3002\u8f83\u5927\u7684\u566a\u58f0\u6c34\u5e73\u4f1a\u964d\u4f4eq\u5f97\u5206\u3002 \uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u566a\u58f0\u6a21\u578b\uff1a\u57fa\u4e8e\u78b1\u57fa\u68c0\u6d4b\u8d28\u91cf\u9608\u503c\uff0c\u566a\u58f0\u6a21\u578b\u59cb\u7ec8\u4e3a1\uff05\u3002\u7528\u6237\u4e5f\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528\u201c\u7a97\u53e3\u201d\u566a\u58f0\u6a21\u578b\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cq\u5f97\u5206\u8ba1\u7b97\u5c06\u57fa\u4e8e\u76f8\u90bb\u78b1\u57faq\u5f97\u5206\u7684\u5e73\u5747\u503c\u3002\uff09\u4ece\u6280\u672f\u4e0a\u8bb2\uff0c\u6211\u4eec\u7684q\u5f97\u5206\u8303\u56f4\u53ef\u4ee5\u4ece0\u5230\u65e0\u7a77\u5927\uff0c\u4f46\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5c06\u5176\u4e0a\u9650\u8bbe\u7f6e\u4e3a100\u3002 Q = -10*log10(P) P-value \u8ba1\u7b97 P\u503c\u662f\u901a\u8fc7\u5c06\u7a81\u53d8\u89c2\u5bdf\u6570\u5efa\u6a21\u4e3aPoisson\u8fc7\u7a0b\u6765\u8ba1\u7b97\u7684\u3002\u201cP\u201d\u5bf9\u5e94\u4e8e\u7a81\u53d8\u88ab\u9519\u8bef\u68c0\u6d4b\u7684\u6982\u7387\uff0c\u5373\u5047\u9633\u6027\u3002 \u9891\u7387\u8ba1\u7b97 \u7b80\u800c\u8a00\u4e4b\uff0c\u7a81\u53d8\u9891\u7387\u662f\u4ee5\u7a81\u53d8\u4f4d\u7f6e\u7a81\u53d8\u603b\u6570\u9664\u4ee5\u8986\u76d6\u6df1\u5ea6\u3002\uff08\u5728\u6570\u5b66\u4e0a\uff0c\u6cca\u677e\u5206\u5e03\u7684lambda\u7684\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\u662f\u89c2\u5bdf\u8ba1\u6570\u672c\u8eab\u3002\u5373\u6211\u4eec\u89c2\u5bdf\u5230\u7684\u6f5c\u5728\u53d8\u5f02\u9891\u7387\u7684\u6700\u4f73\u4f30\u8ba1\u662f\u6211\u4eec\u89c2\u5bdf\u5230\u7684\u503c\u3002http://en.wikipedia.org/wiki/Poisson_distribution#Parameter_estimation\uff09\u3002 \u7a81\u53d8\u8ba1\u6570 \u8986\u76d6\u7387\u8ba1\u6570\uff1a \u67d0\u4e2a\u7279\u5b9a\u4f4d\u7f6e\u7684\u8986\u76d6\u5ea6\u662f\u901a\u8fc7\u8fc7\u6ee4\u6761\u4ef6\uff08\u6bd4\u5bf9\u8d28\u91cf\uff0c\u78b1\u57fa\u8d28\u91cf\uff09\u7684\u6240\u6709reads\u603b\u548c\uff0c\u4f5c\u4e3avcf\u6587\u4ef6\u4e2d\u7684DP\u503c\u7ed9\u51fa\u3002\u4ece3.5.5\u7248\u672c\u540e\uff0c\u672a\u901a\u8fc7\u8fc7\u6ee4\u6761\u4ef6\u7684reads\u4e5f\u88ab\u7b97\u5728\u8986\u76d6\u5ea6\u91cc\u9762\u3002SNV\u8ba1\u6570\u7684\u8fc7\u6ee4\u65b9\u5f0f\u548c\u8986\u76d6\u5ea6\u8ba1\u6570\u7684\u8fc7\u6ee4\u65b9\u5f0f\u4e00\u6837\u3002\u800cIndel/MNV\u8ba1\u6570\u662f\u6240\u6709\u901a\u8fc7\u8fc7\u6ee4\u6761\u4ef6\u7684reads\u7684\u603b\u548c\u3002\u4f30\u8ba1\u7684\u53c2\u8003\u8986\u76d6\u5ea6\u662f\u603b\u8986\u76d6\u5ea6\u51cf\u53bb\u7a81\u53d8\u8986\u76d6\u5ea6\u3002 \u56e0\u4e3amapping quality\uff08\u9ed8\u8ba4\u9608\u503c\u4e3a1\uff09\uff0c base quality\uff08\u9ed8\u8ba4\u9608\u503c\u4e3a2\uff09\u5e26\u6765\u7684\u8fc7\u6ee4\uff0c\u4f7f\u5f97bam \u6587\u4ef6\u91cc\u7684\u539f\u59cb\u6df1\u5ea6\u5927\u4e8e\u6216\u7b49\u4e8evcf\u4e2d\u62a5\u9053\u7684AD\u503c\uff0c\u8fd9\u4e5f\u5c31\u662fgatk\u4e2d\u6240\u8bf4\u7684informative reads\u3002 \u8fc7\u6ee4 \u57fa\u56e0\u7ec4\u7d22\u5f15 \u4ee5gatk bundle\u91cc\u7684\u53c2\u8003\u57fa\u56e0\u7ec4\u4e3a\u4f8b\uff0c\u5728Pisces_hg19\u6587\u4ef6\u5939\u91cc\u751f\u6210GenomeSize.xml/ucsc.hg19.dict/ucsc.hg19.fasta.fai\uff1a \u5efa\u7acb\u53c2\u8003\u57fa\u56e0\u7ec4\u7d22\u5f15\u65f6\uff0c\u6700\u597d\u65b0\u5efa\u4e00\u4e2a\u7a7a\u6587\u4ef6\u5939\uff0c\u7136\u540e\u8fdb\u5165\u5e76\u6267\u884c\u4ee5\u4e0b $ ls ucsc.hg19.fasta $ dotnet CreateGenomeSizeFile_5.2.10.49/CreateGenomeSizeFile.dll -g ./ -s \"Homo sapiens (UCSC xiucz)\" -o ./ \u53d8\u5f02\u68c0\u6d4b dotnet Pisces_5.2.10.49/Pisces.dll \\ -g ~/hg19/gatk_bundle/Pisces/ \\ --callmnvs true --maxgapbetweenmnv 1 \\ --outputsbfiles true --maxthreads 4 \\ -gvcf false \\ -i ~/example.bed \\ -bam sample.recalibrated.bam \\ -outFolder ./output #\u9700\u8981\u6ce8\u91ca\u7684\u662f\uff0cbam\u6587\u4ef6\u7d22\u5f15\u9700\u8981sample.recalibrated.bam.bai, \u800c\u4e0d\u80fdsample.recalibrated.bai. QaA base call\u80cc\u666f\u566a\u97f3 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u4f4d\u70b9\u7684\u566a\u97f3\u9608\u503c\u4e3aQ=20 \u6216\u80051%\uff0c\u8fd9\u662f\u56e0\u4e3a\u5728\u6211\u4eec\u5bf9\u8ba1\u7b97\u4e2d\u7684reads\u8bbe\u7f6e\u4e86\u78b1\u57fa\u8d28\u91cf\u5206\u6570\u7684\u8fc7\u6ee4\u9608\u503c\u4e3a20\u3002\u5728\u7a81\u53d8\u8d28\u91cf\u5206\u6570\u6a21\u578b\u4e2d\uff0c\u4f7f\u7528\u4e86\u566a\u97f3\u7b49\u7ea7\u548c\u7a81\u53d8\u6df1\u5ea6\u6765\u786e\u5b9a\u7a81\u53d8\u7684\u53ef\u4fe1\u5ea6\u3002 strand bias\u8ba1\u7b97 To compute the strand bias, we start by evaluating evidence for the variant using only the reads from one strand at a time, applying the same Poisson probability distributions that are used to compute the Q-score of the variant (using pooled data from both strands). This data is used to compute a test statistic based on likelihood ratios. The directional bias for the strand 1 is computed using this formula: CHINESE (SIMPLIFIED) \u4e3a\u4e86\u8ba1\u7b97\u94fe\u504f\u597d\u6027\uff0c\u9996\u5148\uff0c\u4e00\u6b21\u53ea\u4f7f\u7528\u6765\u81ea\u4e00\u6761\u94fe\u7684reads\u6570\u76ee\u6765\u8bc4\u4f30\u7a81\u53d8\u7684\u8bc1\u636e\uff0c\u5e76\u5e94\u7528\u8ba1\u7b97\u7a81\u53d8Q-score\u7684\u76f8\u540c\u6cca\u677e\u6982\u7387\u5206\u5e03\u6a21\u578b\uff08\u4f7f\u7528\u6765\u81ea\u4e24\u4e2a\u94fe\u7684\u5408\u5e76\u6570\u636e\uff09\u3002\u8be5\u6570\u636e\u57fa\u4e8e\u4f3c\u7136\u6bd4\u6765\u8ba1\u7b97\u68c0\u9a8c\u7edf\u8ba1\u91cf\u3002\u4f7f\u7528\u4ee5\u4e0b\u516c\u5f0f\u8ba1\u7b971\u5411\u94fe\u7684\u65b9\u5411\u504f\u5dee\uff1a Direction1Bias = (Direction1.ChanceVarFreqGreaterThanZero * Direction2.ChanceFalsePos) / OverallStats.ChanceVarFreqGreaterThanZero Ref_Info https://dotnet.microsoft.com/download/thank-you/dotnet-sdk-3.0.100-linux-x64-binaries https://github.com/Illumina/Pisces https://github.com/Illumina/Pisces/wiki Pisces publication: Pisces: An Accurate and Versatile Variant Caller for Somatic and Germline Next-Generation Sequencing Data","title":"004 Pisces"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/#_1","text":"\u9002\u7528\u4e8e\u6269\u589e\u5b50\u6d4b\u5e8f/\u5bcc\u96c6panel \u9002\u7528\u4e8esomatic/germline \u7a81\u53d8\u68c0\u6d4b \u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/Illumina/Pisces/releases Stitcher - Stitches two paired reads together into a single read Pisces - Calls small variants Scylla - Detects multiple nucleotide variants (MNVs) in a given sample and phases the variants in complex regions into sub populations VariantQualityRecalibration - Recalibrates the variant quality scores (Q scores) if the particular variants are over represented","title":"\u7b80\u4ecb"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/#_2","text":"\u4e0b\u8f7d .net core 2.0 \u4e8c\u8fdb\u5236\u7684\u6587\u4ef6 #https://download.visualstudio.microsoft.com/download/pr/886b4a4c-30af-454b-8bec-81c72b7b4e1f/d1a0c8de9abb36d8535363ede4a15de6/dotnet-sdk-3.0.100-linux-x64.tar.gz #https://dotnet.microsoft.com/download/thank-you/dotnet-sdk-2.2.402-linux-x64-binaries https://download.visualstudio.microsoft.com/download/pr/46411df1-f625-45c8-b5e7-08ab736d3daa/0fbc446088b471b0a483f42eb3cbf7a2/dotnet-sdk-2.2.402-linux-x64.tar.gz mkdir -p $HOME/dotnet && tar zxf dotnet-sdk-3.0.100-linux-x64.tar.gz -C $HOME/dotnet export DOTNET_ROOT=$HOME/dotnet export PATH=$PATH:$HOME/dotnet \u9700\u8981\u6ce8\u610f\u7684\u662f\u7684\uff0c .net core 3.0\u4f3c\u4e4e\u4e0d\u517c\u5bb9\uff1a $ dotnet Pisces_5.2.10.49/Pisces.dll It was not possible to find any compatible framework version The specified framework 'Microsoft.NETCore.App', version '2.0.0' was not found.","title":"\u5b89\u88c5"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/#_3","text":"net core 2.0 Pisces_5.2.10.49 linux centos7","title":"\u8f6f\u4ef6\u7248\u672c"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/#_4","text":"Pisces\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u7ba1\u9053\u7a0b\u5e8f\u3002\u5728\u539f\u59cbBAM\u4e2d\u5904\u7406\u65f6\uff0cPisces\u5728\u6bcf\u4e2aCIGAR\u5b57\u7b26\u4e32\u4e2d\u626b\u63cfindel\u548c\u53c2\u8003\u8fdb\u884c\u4e0d\u5339\u914d\u7684\u8bfb\u53d6\u5e8f\u5217\uff0c\u4ece\u800c\u5efa\u7acb\u5019\u9009\u53d8\u5f02\u5217\u8868\u3002\u8df3\u8fc7\u4e0d\u88ab\u8ba4\u4e3a\u6709\u4ef7\u503c\u7684\u5bf9\u9f50\u65b9\u5f0f\uff0c\u5982secondary or duplicate alignments or low mapping quality\u3002\u540c\u65f6\uff0cPisces\u4f1a\u5efa\u7acb\u8986\u76d6\u77e9\u9635\uff08\u6309\u78b1\u57fa\u7c7b\u578b\u8ba1\u7b97\u7684\u8986\u76d6\u8fde\u7eed\u5757\uff09\u3002\u53ea\u6709\u90a3\u4e9b\u8d85\u8fc7\u6700\u4f4e\u78b1\u57fa\u68c0\u6d4b\u8d28\u91cf\u7684\u78b1\u57fa\u624d\u7b97\u4f5cobservations\u3002\u5f53\u6bcf\u4e2a\u5757\u5b8c\u6210\u65f6\uff08\u6700\u540e\u4e00\u4e2a\u76f8\u5173\u7684reads\u5df2\u4ecebam\u4e2d\u63d0\u53d6\uff09\uff0c\u901a\u8fc7\u67e5\u8be2\u5b8c\u6574\u7684\u5757\u4e2d\u7684\u4fe1\u606f\u6765\u68c0\u6d4b\u51fa\u8be5\u5757\u4e2d\u7684\u6240\u6709\u5019\u9009\u53d8\u5f02\u3002\u6b64\u65f6\uff0c\u5c06\u8ba1\u7b97\u51fa\u771f\u5b9e\u7684\u8986\u76d6\u6df1\u5ea6\uff0c\u9891\u7387\uff0c\u6700\u7ec8\u8d28\u91cf\u5206\u6570\uff0c\u94fe\u504f\u597d\u6027\u7b49\uff0c\u5e76\u6267\u884c\u6700\u7ec8\u8fc7\u6ee4\u3002\u7136\u540e\u5c06\u901a\u8fc7\u6700\u5c0f\u62a5\u544a\u9608\u503c\u7684\u53d8\u5f02\u5199\u5165VCF\uff0c\u5e76\u5904\u7406\u4e0b\u4e00\u4e2a\u5757\u3002\u7f13\u51b2\u5757\u5904\u7406\u4ee5\u5b9e\u73b0\u6700\u4f73\u8bfb\u5199\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cPisces\u8981\u6c42\u7528\u4e8e\u53d8\u5f02\u68c0\u6d4b\u7684\u6240\u6709\u78b1\u57fa\u7684\u78b1\u57fa\u8d28\u91cf\u5206\u6570\u81f3\u5c11\u4e3aQ20\uff0c\u5bf9\u5e94\u4e8e0.01\u7684\u9519\u8bef\u7387\u6216\u66f4\u5c11\u3002\u78b1\u57fa\u68c0\u6d4b\u8fc7\u6ee4\u5668\u662f\u53ef\u914d\u7f6e\u7684\u8fc7\u6ee4\u5668\uff0c\u53ef\u4ee5\u4f7f\u5176\u66f4\u4e25\u683c\u4ee5\u63d0\u9ad8\u7cbe\u5ea6\u3002base calls\u7684\u8d28\u91cf\u9a71\u52a8\u5185\u90e8\u566a\u58f0\u6a21\u578b\u3002\u4f8b\u5982\uff0c\u5f53\u53d8\u5f02\u68c0\u6d4b\u8fc7\u7a0b\u4e2d\u4ec5\u5305\u62ecQ20\u4ee5\u4e0a\u7684base calls\u65f6\uff0cPisces\u5c06\u6709\u4fe1\u5fc3\u5c06\u7a81\u53d8\u4ece\u566a\u58f0\u964d\u81f31\uff05\u7684\u7a81\u53d8\u9891\u7387\uff0c\u8fd9\u53cd\u6620\u5728\u5199\u5165VCF\u7684\u7a81\u53d8\u8d28\u91cf\u4e2d\u3002\u5982\u679c\u5c06\u78b1\u57fa\u68c0\u6d4b\u8d28\u91cf\u5f97\u5206\u8fc7\u6ee4\u9608\u503c\u8bbe\u7f6e\u4e3aQ30\uff0c\u5219Pisces\u5c06\u8fdb\u884c\u8c03\u6574\uff0c\u5e76\u5728\u68c0\u6d4b\u4f4e\u9891\u7a81\u53d8\uff08\u73b0\u5728\u964d\u81f30.1\uff05\uff09\u4e0a\u6709\u66f4\u9ad8\u7684\u53ef\u4fe1\u5ea6\u3002\u4ec5\u5f53\u5927\u591a\u6570\u78b1\u57fa\u6ee1\u8db3\u8d28\u91cf\u9608\u503c\u65f6\uff0c\u624d\u5e94\u78b1\u57fa\u8d28\u91cf\u5206\u6570\u8bbe\u7f6e\u4e3a\u66f4\u9ad8\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u8003\u8651\u9891\u7387\u4e3a1\uff05\u6216\u66f4\u9ad8\u7684\u4efb\u4f55\u975e\u53c2\u8003\u7b49\u4f4d\u57fa\u56e0\u3002\u6839\u636e\u53c2\u8003\u548c\u7a81\u53d8\u7684reads\u8ba1\u6570\uff0c\u6211\u4eec\u57fa\u4e8e\u6cca\u677e\u6a21\u578b\u8ba1\u7b97SNV\u7684q\u503c\uff0c\u5982\u679cSNV\u7684q\u503c\u4f4e\u4e8e20\uff0c\u5219\u5bf9SNV\u8fdb\u884c\u8fc7\u6ee4\u3002\u5982\u679cq\u503c\u572820\u523030\u4e4b\u95f4\uff0c\u6211\u4eec\u62a5\u544a\u8be5\u7a81\u53d8\u5728.vcf\u7684\u8fc7\u6ee4\u5668\u5217\u4e2d\u5e26\u6709\u201c q30\u201d\u3002\u5982\u679cq\u503c\u5927\u4e8e\u6216\u7b49\u4e8e30\uff0c\u5219\u6211\u4eec\u5728FILTER\u5217\u4e2d\u4e3a\u7a81\u53d8\u63d0\u4f9b\u4e00\u4e2a\u6e05\u6670\u7684\u201c PASS\u201d\u3002 \u63d2\u5165\u7f3a\u5931\u7684\u5904\u7406\u65b9\u5f0f\u7c7b\u4f3c\uff1a\u6211\u4eec\u67e5\u770b\u8986\u76d6\u7ed9\u5b9a\u4f4d\u7f6e\u7684\u6bd4\u5bf9\u4e2d\u6709\u591a\u5c11\u4e2a\u5305\u542b\u7279\u5b9a\u63d2\u5165\u7f3a\u5931\uff08\u5373\u6211\u4eec\u7684\u53d8\u5f02\u6570\uff09\u4e0e\u8be5\u4f4d\u7f6e\u7684\u603b\u4f53\u8986\u76d6\u5ea6\u3002\u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u4e0d\u6267\u884c\u7684\u67d0\u4e9bindel\u91cd\u65b0\u6392\u5217\u6216\u66f4\u590d\u6742\u7684\u68c0\u6d4b\u53d8\u5f02\u7a0b\u5e8f\u4e2d\u5305\u542b\u201cindel\u6e05\u6d17\u201d\u6b65\u9aa4\u3002 \u5f53\u5728\u4f53\u7ec6\u80de\u73af\u5883\u4e2d\u8fdb\u884c\u57fa\u56e0\u5206\u578b\u65f6\uff0cPisces\u4f7f\u7528\u201c 0/1\u201d\u8868\u793a\u5728\u6700\u5c0f\u68c0\u6d4b\u9608\u503c\uff08\u9ed8\u8ba4\u503c\u4e3a1\uff05\uff09\u5904\u53d1\u73b0\u4e86\u53c2\u8003\u7b49\u4f4d\u57fa\u56e0\u548c\u5176\u4ed6\u7b49\u4f4d\u57fa\u56e0\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u4e0d\u662f\u5728\u4e8c\u500d\u4f53\u4e0a\u4e0b\u6587\u4e2d\u7684\u540c\u4e00\u4e2a\u201c 0/1\u201d\u57fa\u56e0\u578b\uff0c\u5728\u8be5\u57fa\u56e0\u578b\u4e2d\u53c2\u8003\u548c\u7b49\u4f4d\u57fa\u56e0\u5206\u522b\u5360\u5927\u7ea650\uff05\u3002\u4f8b\u5982\uff0c\u5982\u679c\u53d1\u73b0\u7a81\u53d8\u7684\u9891\u7387\u662f80\uff05\uff0c\u800c\u73b0\u53c2\u8003\u7684\u9891\u7387\u662f5%\uff0c\u5e76\u4e14Q\u5206\u6570\u90fd\u53ef\u4ee5\u63a5\u53d7\uff0c\u5219\u8fd9\u88ab\u8ba4\u4e3a\u662f\u6742\u5408\u4f53\u7ec6\u80de\u7a81\u53d8\uff0c \u56e0\u4e3a\u4e24\u8005\u90fd\u5b58\u5728 \u3002\u5373\u4f7f\u5728\u76f4\u89c9\u4e0a\uff0c\u7528\u6237\u5728\u4e8c\u500d\u4f53\u73af\u5883\u4e2d\u4e5f\u53ef\u4ee5\u8ba4\u4e3a\u8fd9\u662f\u7eaf\u5408\u7a81\u53d8\u3002","title":"\u68c0\u6d4b\u903b\u8f91"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/#q-score","text":"Q\u5f97\u5206\u7ed9\u51fa\u4e86\u5b58\u5728\u53d8\u5f02\u7684\u53ef\u786e\u5b9a\u7a0b\u5ea6\u3002\u8f83\u9ad8\u7684q\u5206\u6570\u4ee3\u8868\u66f4\u5927\u7684\u786e\u5b9a\u6027\u3002\u6211\u4eec\u7684q\u5f97\u5206\u8ba1\u7b97\u8003\u8651\u4e86\u566a\uff0c\u8986\u76d6\u6df1\u5ea6\u548c\u7a81\u53d8\u8ba1\u6570\u3002\u66f4\u5927\u7684\u7a81\u53d8\u6570\u548c\u8986\u76d6\u6df1\u5ea6\u4f1a\u589e\u52a0q\u5f97\u5206\u3002\u8f83\u5927\u7684\u566a\u58f0\u6c34\u5e73\u4f1a\u964d\u4f4eq\u5f97\u5206\u3002 \uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u566a\u58f0\u6a21\u578b\uff1a\u57fa\u4e8e\u78b1\u57fa\u68c0\u6d4b\u8d28\u91cf\u9608\u503c\uff0c\u566a\u58f0\u6a21\u578b\u59cb\u7ec8\u4e3a1\uff05\u3002\u7528\u6237\u4e5f\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528\u201c\u7a97\u53e3\u201d\u566a\u58f0\u6a21\u578b\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cq\u5f97\u5206\u8ba1\u7b97\u5c06\u57fa\u4e8e\u76f8\u90bb\u78b1\u57faq\u5f97\u5206\u7684\u5e73\u5747\u503c\u3002\uff09\u4ece\u6280\u672f\u4e0a\u8bb2\uff0c\u6211\u4eec\u7684q\u5f97\u5206\u8303\u56f4\u53ef\u4ee5\u4ece0\u5230\u65e0\u7a77\u5927\uff0c\u4f46\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5c06\u5176\u4e0a\u9650\u8bbe\u7f6e\u4e3a100\u3002 Q = -10*log10(P)","title":"Q-score \u8ba1\u7b97"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/#p-value","text":"P\u503c\u662f\u901a\u8fc7\u5c06\u7a81\u53d8\u89c2\u5bdf\u6570\u5efa\u6a21\u4e3aPoisson\u8fc7\u7a0b\u6765\u8ba1\u7b97\u7684\u3002\u201cP\u201d\u5bf9\u5e94\u4e8e\u7a81\u53d8\u88ab\u9519\u8bef\u68c0\u6d4b\u7684\u6982\u7387\uff0c\u5373\u5047\u9633\u6027\u3002","title":"P-value \u8ba1\u7b97"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/#_5","text":"\u7b80\u800c\u8a00\u4e4b\uff0c\u7a81\u53d8\u9891\u7387\u662f\u4ee5\u7a81\u53d8\u4f4d\u7f6e\u7a81\u53d8\u603b\u6570\u9664\u4ee5\u8986\u76d6\u6df1\u5ea6\u3002\uff08\u5728\u6570\u5b66\u4e0a\uff0c\u6cca\u677e\u5206\u5e03\u7684lambda\u7684\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\u662f\u89c2\u5bdf\u8ba1\u6570\u672c\u8eab\u3002\u5373\u6211\u4eec\u89c2\u5bdf\u5230\u7684\u6f5c\u5728\u53d8\u5f02\u9891\u7387\u7684\u6700\u4f73\u4f30\u8ba1\u662f\u6211\u4eec\u89c2\u5bdf\u5230\u7684\u503c\u3002http://en.wikipedia.org/wiki/Poisson_distribution#Parameter_estimation\uff09\u3002","title":"\u9891\u7387\u8ba1\u7b97"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/#_6","text":"\u67d0\u4e2a\u7279\u5b9a\u4f4d\u7f6e\u7684\u8986\u76d6\u5ea6\u662f\u901a\u8fc7\u8fc7\u6ee4\u6761\u4ef6\uff08\u6bd4\u5bf9\u8d28\u91cf\uff0c\u78b1\u57fa\u8d28\u91cf\uff09\u7684\u6240\u6709reads\u603b\u548c\uff0c\u4f5c\u4e3avcf\u6587\u4ef6\u4e2d\u7684DP\u503c\u7ed9\u51fa\u3002\u4ece3.5.5\u7248\u672c\u540e\uff0c\u672a\u901a\u8fc7\u8fc7\u6ee4\u6761\u4ef6\u7684reads\u4e5f\u88ab\u7b97\u5728\u8986\u76d6\u5ea6\u91cc\u9762\u3002SNV\u8ba1\u6570\u7684\u8fc7\u6ee4\u65b9\u5f0f\u548c\u8986\u76d6\u5ea6\u8ba1\u6570\u7684\u8fc7\u6ee4\u65b9\u5f0f\u4e00\u6837\u3002\u800cIndel/MNV\u8ba1\u6570\u662f\u6240\u6709\u901a\u8fc7\u8fc7\u6ee4\u6761\u4ef6\u7684reads\u7684\u603b\u548c\u3002\u4f30\u8ba1\u7684\u53c2\u8003\u8986\u76d6\u5ea6\u662f\u603b\u8986\u76d6\u5ea6\u51cf\u53bb\u7a81\u53d8\u8986\u76d6\u5ea6\u3002 \u56e0\u4e3amapping quality\uff08\u9ed8\u8ba4\u9608\u503c\u4e3a1\uff09\uff0c base quality\uff08\u9ed8\u8ba4\u9608\u503c\u4e3a2\uff09\u5e26\u6765\u7684\u8fc7\u6ee4\uff0c\u4f7f\u5f97bam \u6587\u4ef6\u91cc\u7684\u539f\u59cb\u6df1\u5ea6\u5927\u4e8e\u6216\u7b49\u4e8evcf\u4e2d\u62a5\u9053\u7684AD\u503c\uff0c\u8fd9\u4e5f\u5c31\u662fgatk\u4e2d\u6240\u8bf4\u7684informative reads\u3002","title":"\u7a81\u53d8\u8ba1\u6570 \u8986\u76d6\u7387\u8ba1\u6570\uff1a"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/#_7","text":"","title":"\u8fc7\u6ee4"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/#_8","text":"\u4ee5gatk bundle\u91cc\u7684\u53c2\u8003\u57fa\u56e0\u7ec4\u4e3a\u4f8b\uff0c\u5728Pisces_hg19\u6587\u4ef6\u5939\u91cc\u751f\u6210GenomeSize.xml/ucsc.hg19.dict/ucsc.hg19.fasta.fai\uff1a \u5efa\u7acb\u53c2\u8003\u57fa\u56e0\u7ec4\u7d22\u5f15\u65f6\uff0c\u6700\u597d\u65b0\u5efa\u4e00\u4e2a\u7a7a\u6587\u4ef6\u5939\uff0c\u7136\u540e\u8fdb\u5165\u5e76\u6267\u884c\u4ee5\u4e0b $ ls ucsc.hg19.fasta $ dotnet CreateGenomeSizeFile_5.2.10.49/CreateGenomeSizeFile.dll -g ./ -s \"Homo sapiens (UCSC xiucz)\" -o ./","title":"\u57fa\u56e0\u7ec4\u7d22\u5f15"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/#_9","text":"dotnet Pisces_5.2.10.49/Pisces.dll \\ -g ~/hg19/gatk_bundle/Pisces/ \\ --callmnvs true --maxgapbetweenmnv 1 \\ --outputsbfiles true --maxthreads 4 \\ -gvcf false \\ -i ~/example.bed \\ -bam sample.recalibrated.bam \\ -outFolder ./output #\u9700\u8981\u6ce8\u91ca\u7684\u662f\uff0cbam\u6587\u4ef6\u7d22\u5f15\u9700\u8981sample.recalibrated.bam.bai, \u800c\u4e0d\u80fdsample.recalibrated.bai.","title":"\u53d8\u5f02\u68c0\u6d4b"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/#qaa","text":"","title":"QaA"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/#base-call","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u4f4d\u70b9\u7684\u566a\u97f3\u9608\u503c\u4e3aQ=20 \u6216\u80051%\uff0c\u8fd9\u662f\u56e0\u4e3a\u5728\u6211\u4eec\u5bf9\u8ba1\u7b97\u4e2d\u7684reads\u8bbe\u7f6e\u4e86\u78b1\u57fa\u8d28\u91cf\u5206\u6570\u7684\u8fc7\u6ee4\u9608\u503c\u4e3a20\u3002\u5728\u7a81\u53d8\u8d28\u91cf\u5206\u6570\u6a21\u578b\u4e2d\uff0c\u4f7f\u7528\u4e86\u566a\u97f3\u7b49\u7ea7\u548c\u7a81\u53d8\u6df1\u5ea6\u6765\u786e\u5b9a\u7a81\u53d8\u7684\u53ef\u4fe1\u5ea6\u3002","title":"base call\u80cc\u666f\u566a\u97f3"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/#strand-bias","text":"To compute the strand bias, we start by evaluating evidence for the variant using only the reads from one strand at a time, applying the same Poisson probability distributions that are used to compute the Q-score of the variant (using pooled data from both strands). This data is used to compute a test statistic based on likelihood ratios. The directional bias for the strand 1 is computed using this formula: CHINESE (SIMPLIFIED) \u4e3a\u4e86\u8ba1\u7b97\u94fe\u504f\u597d\u6027\uff0c\u9996\u5148\uff0c\u4e00\u6b21\u53ea\u4f7f\u7528\u6765\u81ea\u4e00\u6761\u94fe\u7684reads\u6570\u76ee\u6765\u8bc4\u4f30\u7a81\u53d8\u7684\u8bc1\u636e\uff0c\u5e76\u5e94\u7528\u8ba1\u7b97\u7a81\u53d8Q-score\u7684\u76f8\u540c\u6cca\u677e\u6982\u7387\u5206\u5e03\u6a21\u578b\uff08\u4f7f\u7528\u6765\u81ea\u4e24\u4e2a\u94fe\u7684\u5408\u5e76\u6570\u636e\uff09\u3002\u8be5\u6570\u636e\u57fa\u4e8e\u4f3c\u7136\u6bd4\u6765\u8ba1\u7b97\u68c0\u9a8c\u7edf\u8ba1\u91cf\u3002\u4f7f\u7528\u4ee5\u4e0b\u516c\u5f0f\u8ba1\u7b971\u5411\u94fe\u7684\u65b9\u5411\u504f\u5dee\uff1a Direction1Bias = (Direction1.ChanceVarFreqGreaterThanZero * Direction2.ChanceFalsePos) / OverallStats.ChanceVarFreqGreaterThanZero","title":"strand bias\u8ba1\u7b97"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_Pisces/#ref_info","text":"https://dotnet.microsoft.com/download/thank-you/dotnet-sdk-3.0.100-linux-x64-binaries https://github.com/Illumina/Pisces https://github.com/Illumina/Pisces/wiki Pisces publication: Pisces: An Accurate and Versatile Variant Caller for Somatic and Germline Next-Generation Sequencing Data","title":"Ref_Info"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_VarDict/","text":"github github\u94fe\u63a5\uff1ahttps://github.com/AstraZeneca-NGS/VarDict \u8fc7\u6ee4\u7b56\u7565\uff1ahttp://bcb.io/2016/04/04/vardict-filtering/ https://github.com/AstraZeneca-NGS/VarDict/blob/master/vcf2txt.pl java\u7248\u672c\uff1ahttps://github.com/AstraZeneca-NGS/VarDictJava /build/install/VarDict/bin/VarDict -G /path/to/hg19.fa -f $AF_THR -N sample_name -b /path/to/my.bam -z -c 1 -S 2 -E 3 -g 4 /path/to/my.bed | VarDict/teststrandbias.R | VarDict/var2vcf_valid.pl -N sample_name -E -f $AF_THR /build/install/VarDict/bin/VarDict -G /path/to/hg19.fa -f 0.001 -N sample_name -b /path/to/sample.bam -z -R chr7:55270300-55270348:EGFR | VarDict/teststrandbias.R | VarDict/var2vcf_valid.pl -N sample_name -E -f 0.001 >vars.vcf https://www.jianshu.com/p/3bdd94be6949","title":"004 VarDict"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/004_VarDict/#github","text":"github\u94fe\u63a5\uff1ahttps://github.com/AstraZeneca-NGS/VarDict \u8fc7\u6ee4\u7b56\u7565\uff1ahttp://bcb.io/2016/04/04/vardict-filtering/ https://github.com/AstraZeneca-NGS/VarDict/blob/master/vcf2txt.pl java\u7248\u672c\uff1ahttps://github.com/AstraZeneca-NGS/VarDictJava /build/install/VarDict/bin/VarDict -G /path/to/hg19.fa -f $AF_THR -N sample_name -b /path/to/my.bam -z -c 1 -S 2 -E 3 -g 4 /path/to/my.bed | VarDict/teststrandbias.R | VarDict/var2vcf_valid.pl -N sample_name -E -f $AF_THR /build/install/VarDict/bin/VarDict -G /path/to/hg19.fa -f 0.001 -N sample_name -b /path/to/sample.bam -z -R chr7:55270300-55270348:EGFR | VarDict/teststrandbias.R | VarDict/var2vcf_valid.pl -N sample_name -E -f 0.001 >vars.vcf https://www.jianshu.com/p/3bdd94be6949","title":"github"},{"location":"08_DNA/05_somatic/001_SNVINDDEL/007_panel-of-normals/","text":"","title":"007 panel of normals"},{"location":"08_DNA/05_somatic/002_SV/00_paper/","text":"Structural variation detection using next-generation sequencing data A comparative technical review The SV calling pipeline 2.1. Data preprocessing 2.1.1. Reads mapping mapped concordantly (i.e. the two reads are mapped in correct orientation, correct strand and the distance between them is consistent with the insert size distribution) (1) soft-clipped (i.e. partially mapped), (2) one-end-anchored (i.e. one of the read in the paired read is unmapped) or (3) mapped discordantly. 2.1.2. Reads filtering However, such filtering method may potentially remove SV signals because the SV- containing reads are often partially mapped, leading to lower map- ping scores.Reads mapped to repetitive regions, which are hotspots for SVs, may also have lower MAPQs because of similar secondary alignments. Such upstream filtering inevitably impacts the sensitiv- ity of the pipeline. 2.1.3. Reads classification Mapping-based SV callers mainly infer SVs from three types of anomalously mapped reads, namely, (1) discordant reads (mapped either on different chromosome (signal for translocations or transpositions, Fig. 1F), incorrect strands (signal for inversions, Fig. 1E), incorrect orientation (signal for duplications, Fig. 1C and D) or incorrect insert size (signal for insertions and deletions, Fig. 1A and B)), (2) soft-clipped reads (signal for the breakpoint, mapped partially) or (3) one-end-anchored reads (sig- nal for the breakpoint, unmapped reads whose mates are mapped). the various SV discovery techniques: cluster- ing, split-reads alignment, contig (consensus sequence) assembly and statistical testing. The soft-clipped and one-end anchored reads can be aligned to the SV breakpoint regions to refine the position of the breakpoints up to base-pair resolution (Fig. 1). 2.2. SV discovery 2.2.1. Direct vs. indirect cases Here, we classify the anoma- lously mapped reads that support an SV into two cases: direct case and indirect case. Read-depth feature can only detect unbalanced SVs. However, read-depth changes at the boundary of balanced SVs can also be used to better annotate the balanced SVs. 2.2.2. SV discovery techniques 2.2.3. Hybrid-approach for SV discovery 2.3. SV verification 2.4. SV annotation 2.5. SV visualization 3.2. Library properties impact SV calling Those properties include coverage (i.e. sequencing depth), insert size and read length of the paired reads it might be beneficial to integrate paired reads of different insert sizes to call SVs. Biologist may also consider optimizing the library properties to suit the SV callers chosen Libraries with smaller insert size tend to have more soft-clipped reads mapped. With increased insert sizes, the number of SVs covered by at least two soft-clipped reads is reduc- ing (blue + grey); but the number of SVs covered by at least two discordant reads is increasing (blue + orange). Only 15% of the sim- ulated SVs are tandem duplications. However, 65% to 75% of the SVs with \u2018\u2018at least two discordant and two soft-clipped reads\u201d are tandem duplications, which have more reads support because of the increased copy numbers.","title":"00 paper"},{"location":"08_DNA/05_somatic/002_SV/00_paper/#structural-variation-detection-using-next-generation-sequencing-data-a-comparative-technical-review","text":"The SV calling pipeline 2.1. Data preprocessing 2.1.1. Reads mapping mapped concordantly (i.e. the two reads are mapped in correct orientation, correct strand and the distance between them is consistent with the insert size distribution) (1) soft-clipped (i.e. partially mapped), (2) one-end-anchored (i.e. one of the read in the paired read is unmapped) or (3) mapped discordantly. 2.1.2. Reads filtering However, such filtering method may potentially remove SV signals because the SV- containing reads are often partially mapped, leading to lower map- ping scores.Reads mapped to repetitive regions, which are hotspots for SVs, may also have lower MAPQs because of similar secondary alignments. Such upstream filtering inevitably impacts the sensitiv- ity of the pipeline. 2.1.3. Reads classification Mapping-based SV callers mainly infer SVs from three types of anomalously mapped reads, namely, (1) discordant reads (mapped either on different chromosome (signal for translocations or transpositions, Fig. 1F), incorrect strands (signal for inversions, Fig. 1E), incorrect orientation (signal for duplications, Fig. 1C and D) or incorrect insert size (signal for insertions and deletions, Fig. 1A and B)), (2) soft-clipped reads (signal for the breakpoint, mapped partially) or (3) one-end-anchored reads (sig- nal for the breakpoint, unmapped reads whose mates are mapped). the various SV discovery techniques: cluster- ing, split-reads alignment, contig (consensus sequence) assembly and statistical testing. The soft-clipped and one-end anchored reads can be aligned to the SV breakpoint regions to refine the position of the breakpoints up to base-pair resolution (Fig. 1). 2.2. SV discovery 2.2.1. Direct vs. indirect cases Here, we classify the anoma- lously mapped reads that support an SV into two cases: direct case and indirect case. Read-depth feature can only detect unbalanced SVs. However, read-depth changes at the boundary of balanced SVs can also be used to better annotate the balanced SVs. 2.2.2. SV discovery techniques 2.2.3. Hybrid-approach for SV discovery 2.3. SV verification 2.4. SV annotation 2.5. SV visualization 3.2. Library properties impact SV calling Those properties include coverage (i.e. sequencing depth), insert size and read length of the paired reads it might be beneficial to integrate paired reads of different insert sizes to call SVs. Biologist may also consider optimizing the library properties to suit the SV callers chosen Libraries with smaller insert size tend to have more soft-clipped reads mapped. With increased insert sizes, the number of SVs covered by at least two soft-clipped reads is reduc- ing (blue + grey); but the number of SVs covered by at least two discordant reads is increasing (blue + orange). Only 15% of the sim- ulated SVs are tandem duplications. However, 65% to 75% of the SVs with \u2018\u2018at least two discordant and two soft-clipped reads\u201d are tandem duplications, which have more reads support because of the increased copy numbers.","title":"Structural variation detection using next-generation sequencing data A comparative technical review"},{"location":"08_DNA/05_somatic/002_SV/00_%E7%BB%BC%E8%BF%B0/","text":"Most 1000 Genomes SVs are deletions because these are easier to detect in low coverage sequencing data.[https://www.nature.com/articles/nature15394] https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5382922/ VCF 5.4 Specifying complex rearrangements with breakends An arbitrary rearrangement event can be summarized as a set of novel adjacencies. Each adjacency ties together 2 breakends. The two breakends at either end of a novel adjacency are called mates. There is one line of VCF (i.e. one record) for each of the two breakends in a novel adjacency. A breakend record is identified with the tag \u201cSYTYPE=BND\u201d in the INFO field. The REF field of a breakend record indicates a base or sequence s of bases beginning at position POS, as in all VCF records. The ALT field of a breakend record indicates a replacement for s. This \u201cbreakend replacement\u201d has three parts: The string t that replaces places s. The string t may be an extended version of s if some novel bases are inserted during the formation of the novel adjacency. The position p of the mate breakend, indicated by a string of the form \u201cchr:pos\u201d. This is the location of the first mapped base in the piece being joined at this novel adjacency. The direction that the joined sequence continues in, starting from p. This is indicated by the orientation of square brackets surrounding p. These 3 elements are combined in 4 possible ways to create the ALT. In each of the 4 cases, the assertion is that s is replaced with t, and then some piece starting at position p is joined to t. The cases are: REF ALT Meaning s t[p[ piece extending to the right of p is joined after t s t]p] reverse comp piece extending left of p is joined after t s ]p]t piece extending to the left of p is joined before t s [p[t reverse comp piece extending right of p is joined before t #CHROM POS ID REF ALT QUAL FILTER INFO 2 321681 bnd W G G]17:198982] 6 PASS SVTYPE=BND 2 321682 bnd V T ]13:123456]T 6 PASS SVTYPE=BND 13 123456 bnd U C C[2:321682[ 6 PASS SVTYPE=BND 13 123457 bnd X A [17:198983[A 6 PASS SVTYPE=BND 17 198982 bnd Y A A]2:321681] 6 PASS SVTYPE=BND 17 198983 bnd Z C [13:123457[C 6 PASS SVTYPE=BND ==> ##\u5982event2\u8868\u73b0\u4e3a\u67d3\u8272\u4f53\u6613\u4f4d #CHROM POS ID REF ALT QUAL FILTER INFO #event1 2 321681 bnd W G G]17:198982] 6 PASS SVTYPE=BND 17 198982 bnd Y A A]2:321681] 6 PASS SVTYPE=BND #event2 2 321682 bnd V T ]13:123456]T 6 PASS SVTYPE=BND 13 123456 bnd U C C[2:321682[ 6 PASS SVTYPE=BND #event3 13 123457 bnd X A [17:198983[A 6 PASS SVTYPE=BND 17 198983 bnd Z C [13:123457[C 6 PASS SVTYPE=BND 14 38454918 5956_2 N ]8:9174263]N 25.35 . SVTYPE=BND;STRANDS=-+:4;CIPOS=-9,8;CIEND=-9,8;CIPOS95=0,0;CIEND95=0,0 8 9174263 5956_1 N N[14:38454918[ 25.35 . SVTYPE=BND;STRANDS=+-:4;CIPOS=-9,8;CIEND=-9,8;CIPOS95=0,0;CIEND95=0,0;MATEID=.... BND\u5373breakend\u7684\u7f29\u5199\u3002\u5728CHROM\u3001POS\u4e2d\u5c55\u793a\u7b2c\u4e00\u4e2a\u65ad\u70b9\u4f4d\u7f6e\uff0c\u5728ALT\u4e2d\u5c55\u793a\u7b2c\u4e8c\u4e2a\u65ad\u70b9\u4f4d\u7f6e\uff0c\u4f8b\u5982\uff1aA]10:115172011]\u3001[12:70547434[C\u3002\u901a\u8fc7\u6bd4\u8f83\u7b2c\u4e00\u4e2a\u65ad\u70b9\u548c\u7b2c\u4e8c\u4e2a\u65ad\u70b9\u7684\u67d3\u8272\u4f53\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u67d3\u8272\u4f53\u95f4\u6613\u4f4d\u8fd8\u662f\u67d3\u8272\u4f53\u5185\u6613\u4f4d\uff08\u8fd9\u91cc\u4e3a\u4e86\u63cf\u8ff0\u65b9\u4fbf\uff0c\u4f7f\u7528\u4e86\u201c\u7b2c\u4e00\u4e2a\u65ad\u70b9\u201d\u3001\u201c\u7b2c\u4e8c\u4e2a\u65ad\u70b9\u201d\u7684\u63cf\u8ff0\u65b9\u5f0f\uff0c\u4e8b\u5b9e\u4e0a\u4e24\u4e2a\u65ad\u70b9\u5e76\u6ca1\u6709\u987a\u5e8f\u4e4b\u5206\uff09\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0cALT\u4e2d\u65b9\u62ec\u53f7\u7684\u65b9\u5411\u5728\u5224\u65ad\u878d\u5408\u57fa\u56e0\u4e2d\u6709\u91cd\u8981\u7684\u4f5c\u7528\u3002...]...]\u6307\u6613\u4f4d\u5e8f\u5217\u5728\u7b2c\u4e00\u4e2a\u65ad\u70b9\u4f4d\u7f6e\u76843'\u7aef\uff0c[...[...\u6307\u6613\u4f4d\u5e8f\u5217\u5728\u7b2c\u4e00\u4e2a\u65ad\u70b9\u4f4d\u7f6e\u76845\u2018\u7aef https://zhuanlan.zhihu.com/p/87408242 \u63d2\u5165\u7247\u6bb5 Differences between insert size and inferred insert size can be used to detect evidence of structural variants, including \u4e32\u8054\u91cd\u590d\uff08Tandem Duplicate\uff09 \u6613\u4f4d\uff08Translocation\uff09 \u7f3a\u5931\uff08Deletion) Insertions \u5012\u4f4d (Inversion) Inter-chromosomal rearrangements Rausch T, et al. (2012) Bioinformatics \u8fc7\u6ee4 raw counts of paired and split reads supporting each allele. The split read counts will not always be available because some calls will be imprecise, so the paired read count (SAMPLE/PR), might be the best starting point. https://www.jianshu.com/p/a3f73991390d https://www.jianshu.com/p/4c8e109f0e6a low sequencing complexity (e.g. repetitive sequences\uff0csequencing biases\uff08GC-content bias and homopolymers)\uff09 regions of high sequence similarity (e.g. segmental-duplicated regions).","title":"00 \u7efc\u8ff0"},{"location":"08_DNA/05_somatic/002_SV/00_%E7%BB%BC%E8%BF%B0/#vcf","text":"5.4 Specifying complex rearrangements with breakends An arbitrary rearrangement event can be summarized as a set of novel adjacencies. Each adjacency ties together 2 breakends. The two breakends at either end of a novel adjacency are called mates. There is one line of VCF (i.e. one record) for each of the two breakends in a novel adjacency. A breakend record is identified with the tag \u201cSYTYPE=BND\u201d in the INFO field. The REF field of a breakend record indicates a base or sequence s of bases beginning at position POS, as in all VCF records. The ALT field of a breakend record indicates a replacement for s. This \u201cbreakend replacement\u201d has three parts: The string t that replaces places s. The string t may be an extended version of s if some novel bases are inserted during the formation of the novel adjacency. The position p of the mate breakend, indicated by a string of the form \u201cchr:pos\u201d. This is the location of the first mapped base in the piece being joined at this novel adjacency. The direction that the joined sequence continues in, starting from p. This is indicated by the orientation of square brackets surrounding p. These 3 elements are combined in 4 possible ways to create the ALT. In each of the 4 cases, the assertion is that s is replaced with t, and then some piece starting at position p is joined to t. The cases are: REF ALT Meaning s t[p[ piece extending to the right of p is joined after t s t]p] reverse comp piece extending left of p is joined after t s ]p]t piece extending to the left of p is joined before t s [p[t reverse comp piece extending right of p is joined before t #CHROM POS ID REF ALT QUAL FILTER INFO 2 321681 bnd W G G]17:198982] 6 PASS SVTYPE=BND 2 321682 bnd V T ]13:123456]T 6 PASS SVTYPE=BND 13 123456 bnd U C C[2:321682[ 6 PASS SVTYPE=BND 13 123457 bnd X A [17:198983[A 6 PASS SVTYPE=BND 17 198982 bnd Y A A]2:321681] 6 PASS SVTYPE=BND 17 198983 bnd Z C [13:123457[C 6 PASS SVTYPE=BND ==> ##\u5982event2\u8868\u73b0\u4e3a\u67d3\u8272\u4f53\u6613\u4f4d #CHROM POS ID REF ALT QUAL FILTER INFO #event1 2 321681 bnd W G G]17:198982] 6 PASS SVTYPE=BND 17 198982 bnd Y A A]2:321681] 6 PASS SVTYPE=BND #event2 2 321682 bnd V T ]13:123456]T 6 PASS SVTYPE=BND 13 123456 bnd U C C[2:321682[ 6 PASS SVTYPE=BND #event3 13 123457 bnd X A [17:198983[A 6 PASS SVTYPE=BND 17 198983 bnd Z C [13:123457[C 6 PASS SVTYPE=BND 14 38454918 5956_2 N ]8:9174263]N 25.35 . SVTYPE=BND;STRANDS=-+:4;CIPOS=-9,8;CIEND=-9,8;CIPOS95=0,0;CIEND95=0,0 8 9174263 5956_1 N N[14:38454918[ 25.35 . SVTYPE=BND;STRANDS=+-:4;CIPOS=-9,8;CIEND=-9,8;CIPOS95=0,0;CIEND95=0,0;MATEID=.... BND\u5373breakend\u7684\u7f29\u5199\u3002\u5728CHROM\u3001POS\u4e2d\u5c55\u793a\u7b2c\u4e00\u4e2a\u65ad\u70b9\u4f4d\u7f6e\uff0c\u5728ALT\u4e2d\u5c55\u793a\u7b2c\u4e8c\u4e2a\u65ad\u70b9\u4f4d\u7f6e\uff0c\u4f8b\u5982\uff1aA]10:115172011]\u3001[12:70547434[C\u3002\u901a\u8fc7\u6bd4\u8f83\u7b2c\u4e00\u4e2a\u65ad\u70b9\u548c\u7b2c\u4e8c\u4e2a\u65ad\u70b9\u7684\u67d3\u8272\u4f53\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u67d3\u8272\u4f53\u95f4\u6613\u4f4d\u8fd8\u662f\u67d3\u8272\u4f53\u5185\u6613\u4f4d\uff08\u8fd9\u91cc\u4e3a\u4e86\u63cf\u8ff0\u65b9\u4fbf\uff0c\u4f7f\u7528\u4e86\u201c\u7b2c\u4e00\u4e2a\u65ad\u70b9\u201d\u3001\u201c\u7b2c\u4e8c\u4e2a\u65ad\u70b9\u201d\u7684\u63cf\u8ff0\u65b9\u5f0f\uff0c\u4e8b\u5b9e\u4e0a\u4e24\u4e2a\u65ad\u70b9\u5e76\u6ca1\u6709\u987a\u5e8f\u4e4b\u5206\uff09\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0cALT\u4e2d\u65b9\u62ec\u53f7\u7684\u65b9\u5411\u5728\u5224\u65ad\u878d\u5408\u57fa\u56e0\u4e2d\u6709\u91cd\u8981\u7684\u4f5c\u7528\u3002...]...]\u6307\u6613\u4f4d\u5e8f\u5217\u5728\u7b2c\u4e00\u4e2a\u65ad\u70b9\u4f4d\u7f6e\u76843'\u7aef\uff0c[...[...\u6307\u6613\u4f4d\u5e8f\u5217\u5728\u7b2c\u4e00\u4e2a\u65ad\u70b9\u4f4d\u7f6e\u76845\u2018\u7aef https://zhuanlan.zhihu.com/p/87408242","title":"VCF"},{"location":"08_DNA/05_somatic/002_SV/00_%E7%BB%BC%E8%BF%B0/#_1","text":"Differences between insert size and inferred insert size can be used to detect evidence of structural variants, including \u4e32\u8054\u91cd\u590d\uff08Tandem Duplicate\uff09 \u6613\u4f4d\uff08Translocation\uff09 \u7f3a\u5931\uff08Deletion) Insertions \u5012\u4f4d (Inversion) Inter-chromosomal rearrangements Rausch T, et al. (2012) Bioinformatics","title":"\u63d2\u5165\u7247\u6bb5"},{"location":"08_DNA/05_somatic/002_SV/00_%E7%BB%BC%E8%BF%B0/#_2","text":"raw counts of paired and split reads supporting each allele. The split read counts will not always be available because some calls will be imprecise, so the paired read count (SAMPLE/PR), might be the best starting point. https://www.jianshu.com/p/a3f73991390d https://www.jianshu.com/p/4c8e109f0e6a low sequencing complexity (e.g. repetitive sequences\uff0csequencing biases\uff08GC-content bias and homopolymers)\uff09 regions of high sequence similarity (e.g. segmental-duplicated regions).","title":"\u8fc7\u6ee4"},{"location":"08_DNA/05_somatic/002_SV/01_manta/","text":"\u65b9\u6cd5\u6982\u8ff0 Manta\u5c06SV\u548cindel\u53d1\u73b0\u8fc7\u7a0b\u5206\u4e3a\u4e24\u4e2a\u4e3b\u8981\u6b65\u9aa4\uff1a \uff081\uff09\u626b\u63cf\u57fa\u56e0\u7ec4\u4ee5\u627e\u5230SV\u76f8\u5173\u533a\u57df;\uff082\uff09\u5728\u8fd9\u4e9b\u533a\u57df\u4e2d\u53d1\u73b0\u7684SV\u7684\u5206\u6790\uff0c\u8bc4\u5206\u548c\u8f93\u51fa Build breakend association graph: \u626b\u63cf\u6574\u4e2a\u57fa\u56e0\u7ec4\u4ee5\u53d1\u73b0\u53ef\u80fd\u7684SV\u548c\u5927\u7684\u63d2\u5165\u7f3a\u5931\u7684\u8bc1\u636e\u3002\u8be5\u8bc1\u636e\u88ab\u5217\u4e3e\u6210\u5177\u6709\u8fde\u63a5\u57fa\u56e0\u7ec4\u7684\u6240\u6709\u533a\u57df\u7684\u8fb9\u7684\u56fe\uff0c\u6240\u8ff0\u533a\u57df\u5177\u6709\u53ef\u80fd\u7684breakend\u5173\u8054\u3002 Analyze graph edges to find SVs: \u5206\u6790\u5355\u4e2a\u56fe\u5f62\u8fb9\u7f18\u6216\u9ad8\u5ea6\u8fde\u63a5\u7684\u8fb9\u7f18\u7ec4\uff0c\u4ee5\u53d1\u73b0\u548c\u8bc4\u5206\u4e0e\u8fb9\u7f18\u76f8\u5173\u8054\u7684SV\u3002","title":"01 manta"},{"location":"08_DNA/05_somatic/002_SV/01_manta/#_1","text":"Manta\u5c06SV\u548cindel\u53d1\u73b0\u8fc7\u7a0b\u5206\u4e3a\u4e24\u4e2a\u4e3b\u8981\u6b65\u9aa4\uff1a \uff081\uff09\u626b\u63cf\u57fa\u56e0\u7ec4\u4ee5\u627e\u5230SV\u76f8\u5173\u533a\u57df;\uff082\uff09\u5728\u8fd9\u4e9b\u533a\u57df\u4e2d\u53d1\u73b0\u7684SV\u7684\u5206\u6790\uff0c\u8bc4\u5206\u548c\u8f93\u51fa Build breakend association graph: \u626b\u63cf\u6574\u4e2a\u57fa\u56e0\u7ec4\u4ee5\u53d1\u73b0\u53ef\u80fd\u7684SV\u548c\u5927\u7684\u63d2\u5165\u7f3a\u5931\u7684\u8bc1\u636e\u3002\u8be5\u8bc1\u636e\u88ab\u5217\u4e3e\u6210\u5177\u6709\u8fde\u63a5\u57fa\u56e0\u7ec4\u7684\u6240\u6709\u533a\u57df\u7684\u8fb9\u7684\u56fe\uff0c\u6240\u8ff0\u533a\u57df\u5177\u6709\u53ef\u80fd\u7684breakend\u5173\u8054\u3002 Analyze graph edges to find SVs: \u5206\u6790\u5355\u4e2a\u56fe\u5f62\u8fb9\u7f18\u6216\u9ad8\u5ea6\u8fde\u63a5\u7684\u8fb9\u7f18\u7ec4\uff0c\u4ee5\u53d1\u73b0\u548c\u8bc4\u5206\u4e0e\u8fb9\u7f18\u76f8\u5173\u8054\u7684SV\u3002","title":"\u65b9\u6cd5\u6982\u8ff0"},{"location":"08_DNA/05_somatic/002_SV/02_AnnotSV/","text":"https://lbgi.fr/AnnotSV/ https://lbgi.fr/AnnotSV/ranking https://lbgi.fr/AnnotSV/Documentation/README.AnnotSV_latest.pdf https://lbgi.fr/AnnotSV/annotations 1. Genes-based annotations: + Gene annotations + DDD gene annotations + OMIM annotations + ACMG annotations + Gene intolerance annotations (ExAC) + Haploinsufficiency annotations (DDD) + Haploinsufficiency and triplosensitivity Scores annotations (ClinGen) + Phenotype-driven analysis extracted from Exomiser 2. Annotations with features overlapping the SV: + DGV Gold Standard annotations + DDD frequency annotations + 1000 genomes frequency annotations + gnomAD SV frequency annotations + Ira M. Hall\u2019s lab SV frequency annotations 3. Annotations with features overlapped with the SV: + Promoter annotations + dbVarNR SV pathogenic annotations + TAD boundaries annotations + GeneHancer annotations (not distributed) 4. Breakpoints annotations: + GC content annotations + Repeated sequences annotations 5. SV RANKING/CLASSIFICATION 6. SV Type 1. Genes-based annotations: \u76ee\u7684\uff1a \u201c\u57fa\u56e0\u6ce8\u91ca\u201d\u65e8\u5728\u63d0\u4f9b\u4e0eSV\u91cd\u53e0\u7684\u5df2\u77e5\u57fa\u56e0\u7684\u4fe1\u606f\uff0c\u4ee5\u4fbf\u5217\u51fa\u6765\u81ea\u6ce8\u91ca\u826f\u597d\u7684RefSeq\u6570\u636e\u5e93\u7684\u57fa\u56e0\u3002 \u8fd9\u4e9b\u6ce8\u91ca\u5305\u62ec\u57fa\u56e0\u7684\u5b9a\u4e49\u548c\u76f8\u5e94\u7684\u8f6c\u5f55\u672c\uff08RefSeq\uff09\uff0cCoDing\u5e8f\u5217\uff08CDS\uff09\u548c\u8f6c\u5f55\u672c\u7684\u957f\u5ea6\uff0cSV\u5728\u57fa\u56e0\u4e2d\u7684\u4f4d\u7f6e\uff08\u4f8b\u5982\u00abtxStart-exon3\u00bb\uff09\u548c\u5750\u6807\u3002 SV\u4e0e\u6284\u672c\u4e4b\u95f4\u7684\u4ea4\u96c6\u3002 header1 header2 Gene name genesymbol NM \u8f6c\u5f55\u672c\u53f7 CDS length SV\u4e0eCDS\u7684\u4ea4\u96c6\u957f\u5ea6 tx length SV\u4e0e\u8f6c\u5f55\u672c\u7684\u4ea4\u96c6\u957f\u5ea6 location SV\u5728\u57fa\u56e0\u4e2d\u4f4d\u7f6e (e.g. \u00ab txStart-exon1 \u00bb, \u00ab intron3-exon7 \u00bb) intersectStart Start position of the intersection between the SV and the transcript intersectEnd End position of the intersection between the SV and the transcript","title":"02 AnnotSV"},{"location":"08_DNA/05_somatic/002_SV/02_AnnotSV/#_1","text":"https://lbgi.fr/AnnotSV/annotations 1. Genes-based annotations: + Gene annotations + DDD gene annotations + OMIM annotations + ACMG annotations + Gene intolerance annotations (ExAC) + Haploinsufficiency annotations (DDD) + Haploinsufficiency and triplosensitivity Scores annotations (ClinGen) + Phenotype-driven analysis extracted from Exomiser 2. Annotations with features overlapping the SV: + DGV Gold Standard annotations + DDD frequency annotations + 1000 genomes frequency annotations + gnomAD SV frequency annotations + Ira M. Hall\u2019s lab SV frequency annotations 3. Annotations with features overlapped with the SV: + Promoter annotations + dbVarNR SV pathogenic annotations + TAD boundaries annotations + GeneHancer annotations (not distributed) 4. Breakpoints annotations: + GC content annotations + Repeated sequences annotations 5. SV RANKING/CLASSIFICATION 6. SV Type","title":""},{"location":"08_DNA/05_somatic/002_SV/02_AnnotSV/#1-genes-based-annotations","text":"\u76ee\u7684\uff1a \u201c\u57fa\u56e0\u6ce8\u91ca\u201d\u65e8\u5728\u63d0\u4f9b\u4e0eSV\u91cd\u53e0\u7684\u5df2\u77e5\u57fa\u56e0\u7684\u4fe1\u606f\uff0c\u4ee5\u4fbf\u5217\u51fa\u6765\u81ea\u6ce8\u91ca\u826f\u597d\u7684RefSeq\u6570\u636e\u5e93\u7684\u57fa\u56e0\u3002 \u8fd9\u4e9b\u6ce8\u91ca\u5305\u62ec\u57fa\u56e0\u7684\u5b9a\u4e49\u548c\u76f8\u5e94\u7684\u8f6c\u5f55\u672c\uff08RefSeq\uff09\uff0cCoDing\u5e8f\u5217\uff08CDS\uff09\u548c\u8f6c\u5f55\u672c\u7684\u957f\u5ea6\uff0cSV\u5728\u57fa\u56e0\u4e2d\u7684\u4f4d\u7f6e\uff08\u4f8b\u5982\u00abtxStart-exon3\u00bb\uff09\u548c\u5750\u6807\u3002 SV\u4e0e\u6284\u672c\u4e4b\u95f4\u7684\u4ea4\u96c6\u3002 header1 header2 Gene name genesymbol NM \u8f6c\u5f55\u672c\u53f7 CDS length SV\u4e0eCDS\u7684\u4ea4\u96c6\u957f\u5ea6 tx length SV\u4e0e\u8f6c\u5f55\u672c\u7684\u4ea4\u96c6\u957f\u5ea6 location SV\u5728\u57fa\u56e0\u4e2d\u4f4d\u7f6e (e.g. \u00ab txStart-exon1 \u00bb, \u00ab intron3-exon7 \u00bb) intersectStart Start position of the intersection between the SV and the transcript intersectEnd End position of the intersection between the SV and the transcript","title":"1. Genes-based annotations:"},{"location":"08_DNA/05_somatic/002_SV/03_lumpy_svtyper/","text":"GT!=0/0 will get rid of low frequency variants. IMPRECISE tags Lumpy gives two probabilistic intervals for every call. The point given in 2nd column of the VCF and the \"END\" value in the INFO field correspond to the points in the intervals with the highest probability. The CIPOS and CIEND give the down/up stream positions of the intervals and CIPOS95 and CIEND95 give the 95% confidence interval. IMPRECISE tags SVs with breakpoints that are not resolved to a single base pair. Check out the lumpy paper for a description of how these breakpoints are defined.","title":"03 lumpy svtyper"},{"location":"08_DNA/05_somatic/002_SV/03_lumpy_svtyper/#_1","text":"GT!=0/0 will get rid of low frequency variants.","title":""},{"location":"08_DNA/05_somatic/002_SV/03_lumpy_svtyper/#imprecise-tags","text":"Lumpy gives two probabilistic intervals for every call. The point given in 2nd column of the VCF and the \"END\" value in the INFO field correspond to the points in the intervals with the highest probability. The CIPOS and CIEND give the down/up stream positions of the intervals and CIPOS95 and CIEND95 give the 95% confidence interval. IMPRECISE tags SVs with breakpoints that are not resolved to a single base pair. Check out the lumpy paper for a description of how these breakpoints are defined.","title":"IMPRECISE tags"},{"location":"08_DNA/05_somatic/002_SV/04_delly/","text":"If you browse through the vcf file you will notice that a subset of the DELLY structural variant predictions have been refined using split-reads. DELLY clusters abnormal paired-ends and every single cluster gives rise to an IMPRECISE SV call. For every IMPRECISE SV call an attempt is made to identify supporting split-reads/soft-clipped reads DELLY then computes a consensus sequence (INFO:CONSENSUS) out of all split-read candidates and then aligns this consensus sequence to the reference requiring at least -m many aligned bases to the left and right (default is 13). INFO:PE is the number of supporting paired-ends. INFO:CT refers connection types (CT), which indicates the order and orientation of paired-end cluster mappings (e.g. 3to3 for 3\u2019 to 3\u2019 and 5to5 for 5\u2019 to 5\u2019). Values can be 3to5, 5to3, 3to3 or 5to5. Different names exist for these connection types in the literature, head-to-head inversions, tail-to-tail inversions, and so on. The consensus alignment quality (SRQ) is a score between 0 and 1, where 1 indicates 100% identity to the reference. Nearby SNPs, InDels and micro-insertions at the breakpoint can lower this score but only for mis-assemblies it should be very poor. DELLY currently drops consensus alignments with a score <0.8 and then falls back to an IMPRECISE prediction. SVs are flagged as FILTER:LowQual if PE <3 OR MAPQ <20 (for translocations: PE <5 OR MAPQ <20), otherwise, the SV results in a FILTER:PASS. PRECISE variants will have split-read support (SR >0). Somatic Structural Variant Filtering\u00b6 For a set of confident somatic calls one could exclude all structural variants <400bp, require a minimum variant allele frequency of 10%, no support in the matched normal and an overall confident structural variant site prediction with the VCF filter field being equal to PASS.","title":"04 delly"},{"location":"08_DNA/05_somatic/002_SV/04_delly/#somatic-structural-variant-filtering","text":"For a set of confident somatic calls one could exclude all structural variants <400bp, require a minimum variant allele frequency of 10%, no support in the matched normal and an overall confident structural variant site prediction with the VCF filter field being equal to PASS.","title":"Somatic Structural Variant Filtering\u00b6"},{"location":"08_DNA/05_somatic/003_CNV/001_GATKCNV/","text":"","title":"001 GATKCNV"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/","text":"[toc] Github\u5730\u5740\uff1ahttps://github.com/etal/cnvkit \u5b98\u65b9\u6559\u7a0b\u5730\u5740\uff1ahttps://cnvkit.readthedocs.io/en/stable/index.html cnvkit-0.9.4a0 1. Install github: https://github.com/etal/cnvkit conda install -c bioconda cnvkit git clone https://github.com/etal/cnvkit.git python setup.py build python setup.py install --prefix=$HOME/local ImportError: /local_data1/work/zhangbo/software/Anaconda3/lib/python3.6/site-packages/pandas/_libs/../../../../libstdc++.so.6: version `GLIBCXX_3.4.21' not found (required by /local_data1/work/zhangbo/software/Anaconda3/lib/python3.6/site-packages/pandas/_libs/window.cpython-36m-x86_64-linux-gnu.so) \u65b9\u6cd5\u4e00\uff1a\u5931\u8d25\u4e86 [zhangbo@mu01 cnvkit]$ conda install libgcc Solving environment: done # All requested packages already installed. \u57fa\u56e0\u6ce8\u91ca\u6587\u4ef6\uff0c\u5982\u679c\u662fwgs\uff0c\u5219\u7528refFlat.txt\uff1b\u5982\u679c\u662fwes\u4e4b\u7c7b\u7684\u5219\u7528\u5e26\u6ce8\u91ca\u5f62\u5f0f\u7684bed\u6587\u4ef6 2. Concept 2.1. coverage\u2014>fix\u2014>segment\u2014>segment cnvkit.py batch *Tumor.bam --normal *Normal.bam \\ --targets my_baits.bed --annotate refFlat.txt \\ --fasta hg19.fasta --access data/access-5kb-mappable.hg19.bed \\ --output-referencemy_reference.cnn --output-dir results/ \\ --diagram \u2013scatter \u2013targets: Target file corresponding to the exome probes :target\u540e\u63a5\u7684\u662f SeqCap_EZ_Exome_v3_hg38_primary_targets.v2.bed cnvkit.py access hg19.fa -o access.hg19.bed cnvkit.py autobin *.bam -t baits.bed -g access.hg19.bed [--annotate refFlat.txt --short-names] # For each sample... cnvkit.py coverage Sample.bam baits.target.bed -o Sample.targetcoverage.cnn cnvkit.py coverage Sample.bam baits.antitarget.bed -o Sample.antitargetcoverage.cnn # With all normal samples... cnvkit.py reference *Normal.{,anti}targetcoverage.cnn --fasta hg19.fa -o my_reference.cnn # For each tumor sample... cnvkit.py fix Sample.targetcoverage.cnn Sample.antitargetcoverage.cnn my_reference.cnn -o Sample.cnr cnvkit.py segment Sample.cnr -o Sample.cns # Optionally, with --scatter and --diagram cnvkit.py scatter Sample.cnr -s Sample.cns -o Sample-scatter.pdf cnvkit.py diagram Sample.cnr -s Sample.cns -o Sample-diagram.pdf \u5355\u72ec\u7ed8\u56fe /home/anaconda2/envs/cnvkit/bin/cnvkit.py scatter -s 700_bwa.sam.cn{s,r} -c chr7 -o scatter-chr7.pn /home/anaconda2/envs/cnvkit/bin/cnvkit.py diagram 700_bwa.sam.cnr /home/anaconda2/envs/cnvkit/bin/cnvkit.py batch /data1/data-sample/human-WGS/bwa-sam-bam/704_bwa.sam.bam -r my_flat_reference.cnn -d 704 -p 10 target cnvkit.py target my_baits.bed --annotate refFlat.txt --split -o my_targets.bed Since these regions (usually exons) may be of unequal size, the --split option divides the larger regions so that the average bin size after dividing is close to the size specified by --average-size. If any of these three (--split, --annotate, or --short-names) flags are used, a new target BED file will be created; otherwise, the provided target BED file will be used as-is. Bin size and resolution \u4eba\u7c7b\u57fa\u56e0\u7ec4\u5916\u663e\u5b50\u7684\u5e73\u5747\u957f\u5ea6\u5728200bp\u5de6\u53f3\u3002\u9ed8\u8ba4\u7684\u7a97\u53e3\u5927\u5c0f\u4e3a267bp\uff0c \u4ee5\u4fbf\u62c6\u5206\u8f83\u5927\u7684\u5916\u663e\u5b50\u5c06\u4ea7\u751f\u6700\u5c0f\u503c\u4e3a200\u7684\u7a97\u53e3\u3002 \u4f8b\u5982\uff0c\u5c06\u7a97\u53e3\u7684\u5e73\u5747\u5927\u5c0f\u8bbe\u7f6e\u4e3a100bp\uff0c\u5c06\u4ea7\u751f\u5927\u7ea6\u4e24\u500d\u7684\u7a97\u53e3\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u66f4\u9ad8\u5206\u8fa8\u7387\u7684\u5206\u5272\u3002\u4f46\u662f\uff0c\u6bcf\u4e2a\u7a97\u53e3\u4e2dreads\u7684\u8bfb\u53d6\u6b21\u6570\u5c06\u51cf\u5c11\u5927\u7ea6\u4e00\u534a\uff0c\u4ece\u800c\u589e\u52a0\u7a97\u53e3\u8986\u76d6\u5ea6\u7684\u5dee\u5f02\u6216\u201c\u566a\u97f3\u201d\u3002\u8fc7\u591a\u7684\u5e26\u566a\u7a97\u53e3\u53ef\u80fd\u4f1a\u4f7f\u53ef\u89c6\u5316\u53d8\u5f97\u56f0\u96be\uff0c\u5e76\u4e14\u7531\u4e8e\u566a\u97f3\u53ef\u80fd\u65e0\u6cd5\u5747\u5300\u5206\u5e03\uff0c\u5c24\u5176\u662f\u5728\u5b58\u5728\u8bb8\u591a\u8986\u76d6\u5ea6\u96f6\u7684\u7a97\u53e3\u7684\u60c5\u51b5\u4e0b\uff0c\u5206\u5272\u7b97\u6cd5\u53ef\u80fd\u4f1a\u5728\u4f4e\u8986\u76d6\u7387\u6837\u672c\u4e0a\u4ea7\u751f\u4e0d\u592a\u51c6\u786e\u7684\u7ed3\u679c\u3002\u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u770b\u5230\u4e86\u5f88\u597d\u7684\u7ed3\u679c\uff0c\u6bcf\u4e2a\u7a97\u53e3\u5185\u5e73\u5747\u6709200\u2013300\u6761reads\uff1b\u56e0\u6b64\uff0c\u6211\u4eec\u5efa\u8bae\u603b\u7684\u9776\u6807\u6d4b\u5e8f\u8986\u76d6\u6df1\u5ea6\u81f3\u5c11\u4e3a200x\u5230300x\uff0c\u8bfb\u53d6\u957f\u5ea6\u4e3a100bp\uff0c\u4ee5\u8bc1\u660e\u5c06\u5e73\u5747\u9776\u6807\u7a97\u53e3\u5927\u5c0f\u964d\u4f4e\u5230100bp\u662f\u5408\u7406\u7684\u3002 \u5bf9\u4e8e\u6742\u4ea4\u6355\u83b7\uff0c\u5982\u679c\u9776\u4e0d\u662f\u5747\u5300\u7684tiled with uniform density Labeling target regions --short-names --annotate consecutive targeted regions access The access command computes the locations of the accessible sequence regions for a given reference genome based on these masked-out sequences, treating long spans of \u2018N\u2019 characters as the inaccessible regions and outputting the coordinates of the regions between them.access\u547d\u4ee4\u57fa\u4e8e\u8fd9\u4e9b\u88ab\u5c4f\u853d\u7684\u5e8f\u5217\u6765\u8ba1\u7b97\u7ed9\u5b9a\u53c2\u8003\u57fa\u56e0\u7ec4\u7684\u53ef\u8bbf\u95ee\u5e8f\u5217\u533a\u57df\u7684\u4f4d\u7f6e\uff0c\u5c06\u201cN\u201d\u4e2a\u5b57\u7b26\u7684\u957f\u8de8\u5ea6\u89c6\u4e3a\u4e0d\u53ef\u8bbf\u95ee\u533a\u57df\u5e76\u8f93\u51fa\u5b83\u4eec\u4e4b\u95f4\u7684\u533a\u57df\u7684\u5750\u6807\u3002 cnvkit.py access hg19.fa -x excludes.bed -o access-excludes.hg19.bed Other known unmappable, variable, or poorly sequenced regions can be excluded with the -x/--exclude option.\u53ef\u4ee5\u4f7f\u7528-x / - exclude\u9009\u9879\u6392\u9664\u5176\u4ed6\u5df2\u77e5\u7684\u4e0d\u53ef\u6620\u5c04\uff0c\u53ef\u53d8\u6216\u6d4b\u5e8f\u4e0d\u597d\u7684\u533a\u57df\u3002 + ftp://hgdownload.soe.ucsc.edu/goldenPath/ + ftp://hgdownload.soe.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeMapability/ + /local_data1/work/zhangbo/software/cnvkit/data/access-5k-mappable.hg19.bed + bed SeqCap_EZ_Exome_v3_hg19_primary_targets.bed:The ONE corresponding to the exome regions that we are interested in.(exome_regions.bed) SeqCap_EZ_Exome_v3_hg19_capture_targets.bed: The ONE corresponding to the regions that probes were able to be designed on.(probe_regions.bed) # download the chain file wget -c http://hgdownload.cse.ucsc.edu/goldenPath/hg19/liftOver/hg19ToHg38.over.chain.gz # run liftover liftOver SeqCapEZ_Exome_v3.0_Design_Annotation_files/SeqCap_EZ_Exome_v3_hg19_primary_targets.bed hg19ToHg38.over.chain.gz SeqCap_EZ_Exome_v3_hg38_primary_targets.bed unMapped.bed # use bedtools to determine the size of the capture space represented by this bed file cut -f 1-3 SeqCap_EZ_Exome_v3_hg38_primary_targets.bed > SeqCap_EZ_Exome_v3_hg38_primary_targets.v2.bed # first sort the bed files and store the sorted versions bedtools sort -i SeqCap_EZ_Exome_v3_hg38_primary_targets.v2.bed > SeqCap_EZ_Exome_v3_hg38_primary_targets.v2.sort.bed # now merge the bed files to collapse any overlapping regions so they are not double counted. bedtools merge -i SeqCap_EZ_Exome_v3_hg38_primary_targets.v2.sort.bed > SeqCap_EZ_Exome_v3_hg38_primary_targets.v2.sort.merge.bed # finally use a Perl one liner to determine the size of each non-overlapping region and determine the cumulative sum perl -ne 'chomp; @l=split(\"\\t\",$_); $size += $l[2]-$l[1]; print \"$size\\n\"' SeqCap_EZ_Exome_v3_hg38_primary_targets.v2.sort.merge.bed output reference.cnn is the copy number control used for normalization of test samples. .cnr means normalized copy ratios. These are processed test samples, already normalized to the reference. .cns means copy number segments. These are the result of segmenting .cnr files, essentially where bins with similar estimated copy number are joined together. --method wgs \u9009\u9879 cnvkit hybrid capture whole-genome sequencing targeted amplicon sequencing target BED vs bait BED : CNVkit uses the bait BED file (provided by the vendor of your capture kit) For hybrid capture, ==the targeted regions (or \u201cprimary targets\u201d)== are the genomic regions your capture kit attempts to ensure are well covered, e.g. exons of genes of interest. ==The baited regions (or \u201ccapture targets\u201d) == are the genomic regions your kit actually captures, usually including about 50bp flanking either side of each target. Give CNVkit the bait/capture BED file, not the primary targets.Give CNVkit the bait/capture BED file, not the primary targets. Sequencing protocol: hybridization capture ('hybrid'), targeted amplicon sequencing ('amplicon'), whole genome sequencing ('wgs') In practice we see good results with an average of 200\u2013300 reads per bin\u3002 access Calculate the sequence-accessible coordinates in chromosomes from the given reference genome, output as a BED file.\u8ba1\u7b97\u6765\u81ea\u7ed9\u5b9a\u53c2\u8003\u57fa\u56e0\u7ec4\u7684\u67d3\u8272\u4f53\u4e2d\u5e8f\u5217\u53ef\u8bbf\u95ee\u7684\u5750\u6807\uff0c\u8f93\u51fa\u4e3aBED\u6587\u4ef6\u3002 Many fully sequenced genomes, including the human genome, contain large regions of DNA that are inaccessable to sequencing. (These are mainly the centromeres, telomeres, and highly repetitive regions.) In the reference genome sequence these regions are filled in with large stretches of \u201cN\u201d characters. These regions cannot be mapped by rese- quencing, so CNVkit avoids them when calculating the antitarget bin locations.\u8bb8\u591a\u5b8c\u5168\u6d4b\u5e8f\u7684\u57fa\u56e0\u7ec4\uff0c\u5305\u62ec\u4eba\u7c7b\u57fa\u56e0\u7ec4\uff0c\u90fd\u542b\u6709\u5927\u91cfDNA\u5e8f\u5217\uff0c\u8fd9\u4e9bDNA\u533a\u57df\u65e0\u6cd5\u8fdb\u884c\u6d4b\u5e8f\u3002\uff08\u8fd9\u4e9b\u4e3b\u8981\u662f\u7740\u4e1d\u7c92\uff0c\u7aef\u7c92\u548c\u9ad8\u5ea6\u91cd\u590d\u7684\u533a\u57df\u3002\uff09\u5728\u53c2\u8003\u57fa\u56e0\u7ec4\u5e8f\u5217\u4e2d\uff0c\u8fd9\u4e9b\u533a\u57df\u7528\u5927\u7247\u201cN\u201d\u5b57\u7b26\u586b\u5145\u3002 \u8fd9\u4e9b\u533a\u57df\u65e0\u6cd5\u901a\u8fc7\u91cd\u65b0\u6392\u5e8f\u8fdb\u884c\u6620\u5c04\uff0c\u56e0\u6b64CNVkit\u5728\u8ba1\u7b97antitarget bin\u4f4d\u7f6e\u65f6\u4f1a\u907f\u514d\u5b83\u4eec\u3002 http://born2run.cn/2018/05/17/cnvkit-information/ https://cnvkit.readthedocs.io/en/stable/germline.html https://cnvkit.readthedocs.io/en/stable/nonhybrid.html The batch --method wgs option uses the given reference genome\u2019s sequencing-accessible regions (\u201caccess\u201d BED) as the \u201ctargets\u201d No \u201cantitarget\u201d regions are used. Since the input does not contain useful per-target gene labels, a gene annotation database is required and used to label genes in the outputs cnvkit.py batch Sample1.bam Sample2.bam -n Control1.bam Control2.bam \\ -m wgs -f hg19.fasta --annotate refFlat.txt The batch -m amplicon option uses the given targets to infer coverage, ignoring off-target regions: This approach does not collect any copy number information between targeted regions, so it should only be used if you have in fact prepared your samples with a targeted amplicon sequencing protocol. weight\u503c\u5728cns\u6587\u4ef6\u4e2d\u610f\u601d weigt\u503c\u5e76\u4e0d\u76f4\u63a5\u548cp-value\u6709\u5173\u3002\u5728\u8001\u7248\u672c\u4e2d\u8868\u793asegment\u8986\u76d6\u7684\u7a97\u53e3\u7684\u6743\u91cd\u7684\u5e73\u5747\u503c\uff0c\u800c\u5728\u65b0\u7248\u6216\u8005\u8fd1\u671f\u7248\u672c\u4e2d\u5219\u662f\u6c42\u548c\u3002 The weight value doesn't correspond directly to a p-value. It's either the sum (current & recent CNVkit versions) or mean (some earlier versions) of the weights of the bins that the segment covers. Those weights indicate the estimated standard deviation of bin log2 values in a (possibly hypothetical) pool of normal samples used as the reference -- in the reference .cnn file this is the \"spread\" column. Reference bins with spread > 1.0 are dropped automatically under the assumption that they're unreliable. (If your segment weights are all below 1, you might be using an older version of CNVkit. Consider updating to take advantage of recent improvements.) If you want to quantify the reliability of a segment, try the segmetrics command, in particular the --ci (confidence interval) or --sem (standard error) options. https://www.biostars.org/p/266688/ segmented log2 ratios copy-neutral single-copy losses (1) and gains (3), a few multi-copy gains (4) and homozygous deletions (0 it merges the consecutive exons that have similar logratios. logratio is LOG[(tumor copynumber)/(normal copynumber),2] 1. 2. I recommend \"export bed\" for custom analysis. If you are analyzing tumor samples with some known amount of normal-cell contamination, use \"call\" or \"rescale\" first to adjust the log2 ratios for that contamination. 3. The [\"export vcf\"] output conforms to the VCF spec, which is a little unintuitive for describing CNVs. The CN field means absolute copy number, but it's only specified for copy number gains, while hemizygous or homozygous deletions are specified differently, as you're seeing. 4. If the log2 value close to 0 it could instead just be noise or imperfect centering. But it is true that the neutral value, i.e. cutoff between loss and gain, is zero. In array CGH analysis (which CNVkit mimics) it's common to treat log2 values between +/- 0.2 as effectively neutral copy number, and focus on greater deviations from zero. 5. The original copy number is the ploidy of your organism, e.g. humans are diploid, 2 copies of each autosome, and the sex chromosomes are XX or XY normally. If you use a flat reference for both tumor and normal, then you can interpret the log2 values as they are. If you used a single normal reference, then you should first check that the normal sample is copy-number-neutral at the location of interest (it probably is) before interpreting the tumor log2 ratio. 6. If the log2 value close to 0 it could instead just be noise or imperfect centering. But it is true that the neutral value, i.e. cutoff between loss and gain, is zero. In array CGH analysis (which CNVkit mimics) it's common to treat log2 values between +/- 0.2 as effectively neutral copy number, and focus on greater deviations from zero. For a certain region in the .cns file, the log2 value is 0.382191. In the .vcf file, SVLEN is 6812878 and the CN value is 3. What is the copy number then? In your example, a log2 value of .38 corresponds to 2^(.38) = 1.3 times the reference ploidy. For a diploid genome, the absolute copy number would be 2 * 2^(.38) = 2.6, which you can probably round up to 3 assuming some reasonable level of normal-cell contamination. (See the documentation on tumor heterogeneity for more guidance on this topic.) ---- https://www.biostars.org/p/178685/ log2 of -9.96578 is equivalent to a tumour-to-normal ratio of: 2^(-9.96578) = 0.00100000296 To find the copy number status of the normal sample, just run the same pipeline on it. If the normal sample was included in the CNV reference (cnv_reference.cnn), you can alternatively run the pipeline on the normal sample using a \"flat\" reference instead. sex chromosome Running the \"batch\" command without the -y flag assumes a female reference, with expected/neutral ploidy of 2 for autosomes, 2 for X, and 1 for Y (for the sake of having a baseline level for comparing male samples). Using this reference, male samples without sex-chromosome abnormalities will have 1 X, 1 Y, so the log2 ratios you'll see are log2(1/2) = -1 for X, log2(1/1) = 0 for Y. A female sample will have log2(2/2) = 0 for X, log2(0/1) = -infinity (in practice, just some noisy deep negative values) for Y. Rerunning \"batch\" with the -y flag, the expected ploidies of the sex chromosomes are 1 for X, 1 for Y. With a male reference a normal male sample with have log2(1/1) = 0 for both X and Y; a normal female sample will have log2(2/1) = +1 for X, log2(0/1) = -infinity (very low numbers) for Y. ---- https://www.biostars.org/p/190825/ \u8fc7\u6ee4\u65b9\u6cd5 1) Set region size 2) Filter regions according the coverage 3) Use Bayesian model 4) Set Rate for filtering CNV","title":"005 CNV CNVkit"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#_1","text":"","title":""},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#1-install","text":"github: https://github.com/etal/cnvkit conda install -c bioconda cnvkit git clone https://github.com/etal/cnvkit.git python setup.py build python setup.py install --prefix=$HOME/local ImportError: /local_data1/work/zhangbo/software/Anaconda3/lib/python3.6/site-packages/pandas/_libs/../../../../libstdc++.so.6: version `GLIBCXX_3.4.21' not found (required by /local_data1/work/zhangbo/software/Anaconda3/lib/python3.6/site-packages/pandas/_libs/window.cpython-36m-x86_64-linux-gnu.so) \u65b9\u6cd5\u4e00\uff1a\u5931\u8d25\u4e86 [zhangbo@mu01 cnvkit]$ conda install libgcc Solving environment: done # All requested packages already installed. \u57fa\u56e0\u6ce8\u91ca\u6587\u4ef6\uff0c\u5982\u679c\u662fwgs\uff0c\u5219\u7528refFlat.txt\uff1b\u5982\u679c\u662fwes\u4e4b\u7c7b\u7684\u5219\u7528\u5e26\u6ce8\u91ca\u5f62\u5f0f\u7684bed\u6587\u4ef6","title":"1. Install"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#2-concept","text":"","title":"2. Concept"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#21","text":"coverage\u2014>fix\u2014>segment\u2014>segment cnvkit.py batch *Tumor.bam --normal *Normal.bam \\ --targets my_baits.bed --annotate refFlat.txt \\ --fasta hg19.fasta --access data/access-5kb-mappable.hg19.bed \\ --output-referencemy_reference.cnn --output-dir results/ \\ --diagram \u2013scatter \u2013targets: Target file corresponding to the exome probes :target\u540e\u63a5\u7684\u662f SeqCap_EZ_Exome_v3_hg38_primary_targets.v2.bed cnvkit.py access hg19.fa -o access.hg19.bed cnvkit.py autobin *.bam -t baits.bed -g access.hg19.bed [--annotate refFlat.txt --short-names] # For each sample... cnvkit.py coverage Sample.bam baits.target.bed -o Sample.targetcoverage.cnn cnvkit.py coverage Sample.bam baits.antitarget.bed -o Sample.antitargetcoverage.cnn # With all normal samples... cnvkit.py reference *Normal.{,anti}targetcoverage.cnn --fasta hg19.fa -o my_reference.cnn # For each tumor sample... cnvkit.py fix Sample.targetcoverage.cnn Sample.antitargetcoverage.cnn my_reference.cnn -o Sample.cnr cnvkit.py segment Sample.cnr -o Sample.cns # Optionally, with --scatter and --diagram cnvkit.py scatter Sample.cnr -s Sample.cns -o Sample-scatter.pdf cnvkit.py diagram Sample.cnr -s Sample.cns -o Sample-diagram.pdf \u5355\u72ec\u7ed8\u56fe /home/anaconda2/envs/cnvkit/bin/cnvkit.py scatter -s 700_bwa.sam.cn{s,r} -c chr7 -o scatter-chr7.pn /home/anaconda2/envs/cnvkit/bin/cnvkit.py diagram 700_bwa.sam.cnr /home/anaconda2/envs/cnvkit/bin/cnvkit.py batch /data1/data-sample/human-WGS/bwa-sam-bam/704_bwa.sam.bam -r my_flat_reference.cnn -d 704 -p 10","title":"2.1."},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#target","text":"cnvkit.py target my_baits.bed --annotate refFlat.txt --split -o my_targets.bed Since these regions (usually exons) may be of unequal size, the --split option divides the larger regions so that the average bin size after dividing is close to the size specified by --average-size. If any of these three (--split, --annotate, or --short-names) flags are used, a new target BED file will be created; otherwise, the provided target BED file will be used as-is.","title":"target"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#bin-size-and-resolution","text":"\u4eba\u7c7b\u57fa\u56e0\u7ec4\u5916\u663e\u5b50\u7684\u5e73\u5747\u957f\u5ea6\u5728200bp\u5de6\u53f3\u3002\u9ed8\u8ba4\u7684\u7a97\u53e3\u5927\u5c0f\u4e3a267bp\uff0c \u4ee5\u4fbf\u62c6\u5206\u8f83\u5927\u7684\u5916\u663e\u5b50\u5c06\u4ea7\u751f\u6700\u5c0f\u503c\u4e3a200\u7684\u7a97\u53e3\u3002 \u4f8b\u5982\uff0c\u5c06\u7a97\u53e3\u7684\u5e73\u5747\u5927\u5c0f\u8bbe\u7f6e\u4e3a100bp\uff0c\u5c06\u4ea7\u751f\u5927\u7ea6\u4e24\u500d\u7684\u7a97\u53e3\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u66f4\u9ad8\u5206\u8fa8\u7387\u7684\u5206\u5272\u3002\u4f46\u662f\uff0c\u6bcf\u4e2a\u7a97\u53e3\u4e2dreads\u7684\u8bfb\u53d6\u6b21\u6570\u5c06\u51cf\u5c11\u5927\u7ea6\u4e00\u534a\uff0c\u4ece\u800c\u589e\u52a0\u7a97\u53e3\u8986\u76d6\u5ea6\u7684\u5dee\u5f02\u6216\u201c\u566a\u97f3\u201d\u3002\u8fc7\u591a\u7684\u5e26\u566a\u7a97\u53e3\u53ef\u80fd\u4f1a\u4f7f\u53ef\u89c6\u5316\u53d8\u5f97\u56f0\u96be\uff0c\u5e76\u4e14\u7531\u4e8e\u566a\u97f3\u53ef\u80fd\u65e0\u6cd5\u5747\u5300\u5206\u5e03\uff0c\u5c24\u5176\u662f\u5728\u5b58\u5728\u8bb8\u591a\u8986\u76d6\u5ea6\u96f6\u7684\u7a97\u53e3\u7684\u60c5\u51b5\u4e0b\uff0c\u5206\u5272\u7b97\u6cd5\u53ef\u80fd\u4f1a\u5728\u4f4e\u8986\u76d6\u7387\u6837\u672c\u4e0a\u4ea7\u751f\u4e0d\u592a\u51c6\u786e\u7684\u7ed3\u679c\u3002\u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u770b\u5230\u4e86\u5f88\u597d\u7684\u7ed3\u679c\uff0c\u6bcf\u4e2a\u7a97\u53e3\u5185\u5e73\u5747\u6709200\u2013300\u6761reads\uff1b\u56e0\u6b64\uff0c\u6211\u4eec\u5efa\u8bae\u603b\u7684\u9776\u6807\u6d4b\u5e8f\u8986\u76d6\u6df1\u5ea6\u81f3\u5c11\u4e3a200x\u5230300x\uff0c\u8bfb\u53d6\u957f\u5ea6\u4e3a100bp\uff0c\u4ee5\u8bc1\u660e\u5c06\u5e73\u5747\u9776\u6807\u7a97\u53e3\u5927\u5c0f\u964d\u4f4e\u5230100bp\u662f\u5408\u7406\u7684\u3002 \u5bf9\u4e8e\u6742\u4ea4\u6355\u83b7\uff0c\u5982\u679c\u9776\u4e0d\u662f\u5747\u5300\u7684tiled with uniform density","title":"Bin size and resolution"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#labeling-target-regions","text":"--short-names --annotate consecutive targeted regions","title":"Labeling target regions"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#access","text":"The access command computes the locations of the accessible sequence regions for a given reference genome based on these masked-out sequences, treating long spans of \u2018N\u2019 characters as the inaccessible regions and outputting the coordinates of the regions between them.access\u547d\u4ee4\u57fa\u4e8e\u8fd9\u4e9b\u88ab\u5c4f\u853d\u7684\u5e8f\u5217\u6765\u8ba1\u7b97\u7ed9\u5b9a\u53c2\u8003\u57fa\u56e0\u7ec4\u7684\u53ef\u8bbf\u95ee\u5e8f\u5217\u533a\u57df\u7684\u4f4d\u7f6e\uff0c\u5c06\u201cN\u201d\u4e2a\u5b57\u7b26\u7684\u957f\u8de8\u5ea6\u89c6\u4e3a\u4e0d\u53ef\u8bbf\u95ee\u533a\u57df\u5e76\u8f93\u51fa\u5b83\u4eec\u4e4b\u95f4\u7684\u533a\u57df\u7684\u5750\u6807\u3002 cnvkit.py access hg19.fa -x excludes.bed -o access-excludes.hg19.bed Other known unmappable, variable, or poorly sequenced regions can be excluded with the -x/--exclude option.\u53ef\u4ee5\u4f7f\u7528-x / - exclude\u9009\u9879\u6392\u9664\u5176\u4ed6\u5df2\u77e5\u7684\u4e0d\u53ef\u6620\u5c04\uff0c\u53ef\u53d8\u6216\u6d4b\u5e8f\u4e0d\u597d\u7684\u533a\u57df\u3002 + ftp://hgdownload.soe.ucsc.edu/goldenPath/ + ftp://hgdownload.soe.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeMapability/ + /local_data1/work/zhangbo/software/cnvkit/data/access-5k-mappable.hg19.bed +","title":"access"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#bed","text":"SeqCap_EZ_Exome_v3_hg19_primary_targets.bed:The ONE corresponding to the exome regions that we are interested in.(exome_regions.bed) SeqCap_EZ_Exome_v3_hg19_capture_targets.bed: The ONE corresponding to the regions that probes were able to be designed on.(probe_regions.bed) # download the chain file wget -c http://hgdownload.cse.ucsc.edu/goldenPath/hg19/liftOver/hg19ToHg38.over.chain.gz # run liftover liftOver SeqCapEZ_Exome_v3.0_Design_Annotation_files/SeqCap_EZ_Exome_v3_hg19_primary_targets.bed hg19ToHg38.over.chain.gz SeqCap_EZ_Exome_v3_hg38_primary_targets.bed unMapped.bed # use bedtools to determine the size of the capture space represented by this bed file cut -f 1-3 SeqCap_EZ_Exome_v3_hg38_primary_targets.bed > SeqCap_EZ_Exome_v3_hg38_primary_targets.v2.bed # first sort the bed files and store the sorted versions bedtools sort -i SeqCap_EZ_Exome_v3_hg38_primary_targets.v2.bed > SeqCap_EZ_Exome_v3_hg38_primary_targets.v2.sort.bed # now merge the bed files to collapse any overlapping regions so they are not double counted. bedtools merge -i SeqCap_EZ_Exome_v3_hg38_primary_targets.v2.sort.bed > SeqCap_EZ_Exome_v3_hg38_primary_targets.v2.sort.merge.bed # finally use a Perl one liner to determine the size of each non-overlapping region and determine the cumulative sum perl -ne 'chomp; @l=split(\"\\t\",$_); $size += $l[2]-$l[1]; print \"$size\\n\"' SeqCap_EZ_Exome_v3_hg38_primary_targets.v2.sort.merge.bed","title":"bed"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#output","text":"reference.cnn is the copy number control used for normalization of test samples. .cnr means normalized copy ratios. These are processed test samples, already normalized to the reference. .cns means copy number segments. These are the result of segmenting .cnr files, essentially where bins with similar estimated copy number are joined together.","title":"output"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#_2","text":"--method wgs \u9009\u9879","title":""},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#cnvkit","text":"hybrid capture whole-genome sequencing targeted amplicon sequencing target BED vs bait BED : CNVkit uses the bait BED file (provided by the vendor of your capture kit) For hybrid capture, ==the targeted regions (or \u201cprimary targets\u201d)== are the genomic regions your capture kit attempts to ensure are well covered, e.g. exons of genes of interest. ==The baited regions (or \u201ccapture targets\u201d) == are the genomic regions your kit actually captures, usually including about 50bp flanking either side of each target. Give CNVkit the bait/capture BED file, not the primary targets.Give CNVkit the bait/capture BED file, not the primary targets. Sequencing protocol: hybridization capture ('hybrid'), targeted amplicon sequencing ('amplicon'), whole genome sequencing ('wgs')","title":"cnvkit"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#in-practice-we-see-good-results-with-an-average-of-200300-reads-per-bin","text":"access Calculate the sequence-accessible coordinates in chromosomes from the given reference genome, output as a BED file.\u8ba1\u7b97\u6765\u81ea\u7ed9\u5b9a\u53c2\u8003\u57fa\u56e0\u7ec4\u7684\u67d3\u8272\u4f53\u4e2d\u5e8f\u5217\u53ef\u8bbf\u95ee\u7684\u5750\u6807\uff0c\u8f93\u51fa\u4e3aBED\u6587\u4ef6\u3002 Many fully sequenced genomes, including the human genome, contain large regions of DNA that are inaccessable to sequencing. (These are mainly the centromeres, telomeres, and highly repetitive regions.) In the reference genome sequence these regions are filled in with large stretches of \u201cN\u201d characters. These regions cannot be mapped by rese- quencing, so CNVkit avoids them when calculating the antitarget bin locations.\u8bb8\u591a\u5b8c\u5168\u6d4b\u5e8f\u7684\u57fa\u56e0\u7ec4\uff0c\u5305\u62ec\u4eba\u7c7b\u57fa\u56e0\u7ec4\uff0c\u90fd\u542b\u6709\u5927\u91cfDNA\u5e8f\u5217\uff0c\u8fd9\u4e9bDNA\u533a\u57df\u65e0\u6cd5\u8fdb\u884c\u6d4b\u5e8f\u3002\uff08\u8fd9\u4e9b\u4e3b\u8981\u662f\u7740\u4e1d\u7c92\uff0c\u7aef\u7c92\u548c\u9ad8\u5ea6\u91cd\u590d\u7684\u533a\u57df\u3002\uff09\u5728\u53c2\u8003\u57fa\u56e0\u7ec4\u5e8f\u5217\u4e2d\uff0c\u8fd9\u4e9b\u533a\u57df\u7528\u5927\u7247\u201cN\u201d\u5b57\u7b26\u586b\u5145\u3002 \u8fd9\u4e9b\u533a\u57df\u65e0\u6cd5\u901a\u8fc7\u91cd\u65b0\u6392\u5e8f\u8fdb\u884c\u6620\u5c04\uff0c\u56e0\u6b64CNVkit\u5728\u8ba1\u7b97antitarget bin\u4f4d\u7f6e\u65f6\u4f1a\u907f\u514d\u5b83\u4eec\u3002","title":"In practice we see good results with an average of 200\u2013300 reads per bin\u3002"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#httpborn2runcn20180517cnvkit-information","text":"https://cnvkit.readthedocs.io/en/stable/germline.html https://cnvkit.readthedocs.io/en/stable/nonhybrid.html The batch --method wgs option uses the given reference genome\u2019s sequencing-accessible regions (\u201caccess\u201d BED) as the \u201ctargets\u201d No \u201cantitarget\u201d regions are used. Since the input does not contain useful per-target gene labels, a gene annotation database is required and used to label genes in the outputs cnvkit.py batch Sample1.bam Sample2.bam -n Control1.bam Control2.bam \\ -m wgs -f hg19.fasta --annotate refFlat.txt The batch -m amplicon option uses the given targets to infer coverage, ignoring off-target regions: This approach does not collect any copy number information between targeted regions, so it should only be used if you have in fact prepared your samples with a targeted amplicon sequencing protocol.","title":"http://born2run.cn/2018/05/17/cnvkit-information/"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#weightcns","text":"weigt\u503c\u5e76\u4e0d\u76f4\u63a5\u548cp-value\u6709\u5173\u3002\u5728\u8001\u7248\u672c\u4e2d\u8868\u793asegment\u8986\u76d6\u7684\u7a97\u53e3\u7684\u6743\u91cd\u7684\u5e73\u5747\u503c\uff0c\u800c\u5728\u65b0\u7248\u6216\u8005\u8fd1\u671f\u7248\u672c\u4e2d\u5219\u662f\u6c42\u548c\u3002 The weight value doesn't correspond directly to a p-value. It's either the sum (current & recent CNVkit versions) or mean (some earlier versions) of the weights of the bins that the segment covers. Those weights indicate the estimated standard deviation of bin log2 values in a (possibly hypothetical) pool of normal samples used as the reference -- in the reference .cnn file this is the \"spread\" column. Reference bins with spread > 1.0 are dropped automatically under the assumption that they're unreliable. (If your segment weights are all below 1, you might be using an older version of CNVkit. Consider updating to take advantage of recent improvements.) If you want to quantify the reliability of a segment, try the segmetrics command, in particular the --ci (confidence interval) or --sem (standard error) options. https://www.biostars.org/p/266688/","title":"weight\u503c\u5728cns\u6587\u4ef6\u4e2d\u610f\u601d"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#_3","text":"segmented log2 ratios copy-neutral single-copy losses (1) and gains (3), a few multi-copy gains (4) and homozygous deletions (0 it merges the consecutive exons that have similar logratios. logratio is LOG[(tumor copynumber)/(normal copynumber),2] 1. 2. I recommend \"export bed\" for custom analysis. If you are analyzing tumor samples with some known amount of normal-cell contamination, use \"call\" or \"rescale\" first to adjust the log2 ratios for that contamination. 3. The [\"export vcf\"] output conforms to the VCF spec, which is a little unintuitive for describing CNVs. The CN field means absolute copy number, but it's only specified for copy number gains, while hemizygous or homozygous deletions are specified differently, as you're seeing. 4. If the log2 value close to 0 it could instead just be noise or imperfect centering. But it is true that the neutral value, i.e. cutoff between loss and gain, is zero. In array CGH analysis (which CNVkit mimics) it's common to treat log2 values between +/- 0.2 as effectively neutral copy number, and focus on greater deviations from zero. 5. The original copy number is the ploidy of your organism, e.g. humans are diploid, 2 copies of each autosome, and the sex chromosomes are XX or XY normally. If you use a flat reference for both tumor and normal, then you can interpret the log2 values as they are. If you used a single normal reference, then you should first check that the normal sample is copy-number-neutral at the location of interest (it probably is) before interpreting the tumor log2 ratio. 6. If the log2 value close to 0 it could instead just be noise or imperfect centering. But it is true that the neutral value, i.e. cutoff between loss and gain, is zero. In array CGH analysis (which CNVkit mimics) it's common to treat log2 values between +/- 0.2 as effectively neutral copy number, and focus on greater deviations from zero. For a certain region in the .cns file, the log2 value is 0.382191. In the .vcf file, SVLEN is 6812878 and the CN value is 3. What is the copy number then? In your example, a log2 value of .38 corresponds to 2^(.38) = 1.3 times the reference ploidy. For a diploid genome, the absolute copy number would be 2 * 2^(.38) = 2.6, which you can probably round up to 3 assuming some reasonable level of normal-cell contamination. (See the documentation on tumor heterogeneity for more guidance on this topic.) ---- https://www.biostars.org/p/178685/ log2 of -9.96578 is equivalent to a tumour-to-normal ratio of: 2^(-9.96578) = 0.00100000296 To find the copy number status of the normal sample, just run the same pipeline on it. If the normal sample was included in the CNV reference (cnv_reference.cnn), you can alternatively run the pipeline on the normal sample using a \"flat\" reference instead.","title":""},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#sex-chromosome","text":"Running the \"batch\" command without the -y flag assumes a female reference, with expected/neutral ploidy of 2 for autosomes, 2 for X, and 1 for Y (for the sake of having a baseline level for comparing male samples). Using this reference, male samples without sex-chromosome abnormalities will have 1 X, 1 Y, so the log2 ratios you'll see are log2(1/2) = -1 for X, log2(1/1) = 0 for Y. A female sample will have log2(2/2) = 0 for X, log2(0/1) = -infinity (in practice, just some noisy deep negative values) for Y. Rerunning \"batch\" with the -y flag, the expected ploidies of the sex chromosomes are 1 for X, 1 for Y. With a male reference a normal male sample with have log2(1/1) = 0 for both X and Y; a normal female sample will have log2(2/1) = +1 for X, log2(0/1) = -infinity (very low numbers) for Y. ---- https://www.biostars.org/p/190825/","title":"sex chromosome"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_CNVkit/#_4","text":"1) Set region size 2) Filter regions according the coverage 3) Use Bayesian model 4) Set Rate for filtering CNV","title":"\u8fc7\u6ee4\u65b9\u6cd5"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_DeCoN/","text":"exomeCopy Installation ExomeDepth DECoN INPUT ExCopyDepth exomeCopy http://www.bioconductor.org/packages/2.9/bioc/html/exomeCopy.html Installation https://bmcgenomics.biomedcentral.com/articles/10.1186/1471-2164-15-661 if (!requireNamespace(\"BiocManager\", quietly = TRUE)) install.packages(\"BiocManager\") BiocManager::install(\"exomeCopy\", version = \"3.8\") background: > exome.samples <- grep(\"HG.+\", colnames(mcols(example.counts)), + value = TRUE) > example.counts$bg <- generateBackground(exome.samples, + example.counts, median) > example.counts$log.bg <- log(example.counts$bg + 0.1) > example.counts$bg.var <- generateBackground(exome.samples, + example.counts, var) ExomeDepth https://github.com/vplagnol/ExomeDepth it in fact performs best on smaller panels ExomeDepth is primarily designed for inherited changes. https://cran.r-project.org/web/packages/ExomeDepth/vignettes/ExomeDepth-vignette.pdf DECoN https://wellcomeopenresearch.org/articles/1-20/v1 Rscript ReadInBams.R --bams bams.file --bed bed.file --fasta fasta.file --out output.prefix Rscript IdentifyFailures.R --Rdata summary.file --mincorr .98 --mincov 100 --exons customNumbers.file --custom FALSE --out output.prefix Rscript makeCNVcalls.R --Rdata summary.file --transProb transition.probability --exons customNumbers.file --custom FALSE --out output.prefix \u2013-plot All --plotFolder DECoNPlots INPUT bed file: + the targeted 1-based BED file to be used for analysis + ExCopyDepth https://static-content.springer.com/esm/art%3A10.1186%2F1471-2164-15-661/MediaObjects/12864_2014_6348_MOESM1_ESM.pdf","title":"005 CNV DeCoN"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_DeCoN/#exomecopy","text":"http://www.bioconductor.org/packages/2.9/bioc/html/exomeCopy.html","title":"exomeCopy"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_DeCoN/#installation","text":"https://bmcgenomics.biomedcentral.com/articles/10.1186/1471-2164-15-661 if (!requireNamespace(\"BiocManager\", quietly = TRUE)) install.packages(\"BiocManager\") BiocManager::install(\"exomeCopy\", version = \"3.8\") background: > exome.samples <- grep(\"HG.+\", colnames(mcols(example.counts)), + value = TRUE) > example.counts$bg <- generateBackground(exome.samples, + example.counts, median) > example.counts$log.bg <- log(example.counts$bg + 0.1) > example.counts$bg.var <- generateBackground(exome.samples, + example.counts, var)","title":"Installation"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_DeCoN/#exomedepth","text":"https://github.com/vplagnol/ExomeDepth it in fact performs best on smaller panels ExomeDepth is primarily designed for inherited changes. https://cran.r-project.org/web/packages/ExomeDepth/vignettes/ExomeDepth-vignette.pdf","title":"ExomeDepth"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_DeCoN/#decon","text":"https://wellcomeopenresearch.org/articles/1-20/v1 Rscript ReadInBams.R --bams bams.file --bed bed.file --fasta fasta.file --out output.prefix Rscript IdentifyFailures.R --Rdata summary.file --mincorr .98 --mincov 100 --exons customNumbers.file --custom FALSE --out output.prefix Rscript makeCNVcalls.R --Rdata summary.file --transProb transition.probability --exons customNumbers.file --custom FALSE --out output.prefix \u2013-plot All --plotFolder DECoNPlots","title":"DECoN"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_DeCoN/#input","text":"bed file: + the targeted 1-based BED file to be used for analysis +","title":"INPUT"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_DeCoN/#excopydepth","text":"https://static-content.springer.com/esm/art%3A10.1186%2F1471-2164-15-661/MediaObjects/12864_2014_6348_MOESM1_ESM.pdf","title":"ExCopyDepth"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_gistic/","text":"GISTIC is normally used to find recurrent CNV among patients https://gatkforums.broadinstitute.org/firecloud/discussion/8254/gistic2-0 https://www.genepattern.org/modules/docs/GISTIC_2.0/7 D.cap1.5.mat del_genes.conf_75.txt del_qplot.pdf del_qplot.png focal_dat.0.98.mat gistic_inputs.mat peak_regs.mat perm_ads.mat raw_copy_number.pdf raw_copy_number.png regions_track.conf_75.bed sample_seg_counts.txt scores.0.98.mat scores.gistic wide_peak_regs.mat amp_genes.conf_75.txt amp_qplot.pdf amp_qplot.png #\u6269\u589e\u5cf0\u8868\u683c cytoband 1q21.3 4p16.1 q value 6.23E-27 residual q value wide peak boundaries genes in wide TCHH USP17 RPTN LOC728369 HRNR LOC728373 LOC728379 ZNF208 USP17L5 ZNF492 LOC728393 ZNF257 LOC728400 ZNF98 LOC728405 ZNF738 all_lesions.conf_75.txt #all_lesions.conf_XX.txt, where XX is the confidence level) \u5305\u62ec2\u90e8\u5206\uff1aRegion Data\u548cSample Data","title":"005 CNV gistic"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_paper/","text":"A Comprehensive Workflow for Read Depth-Based Identification of Copy-Number Variation from Whole-Genome Sequence Data OverView In stage 1 (\u201calgorithm selection\u201d) three WGS datasets and corresponding CNV benchmarks (HuRef,3, 4, 28 NA12878,34 and AK135) were used to assess the accuracy of six read depth-based CNV-detection algorithms\u2014Canvas, cn.MOPS, CNVnator, ERDS, Genome STRiP, and RDXplorer. CNV\u7b97\u6cd5\u68c0\u6d4b\u7684\u4e00\u81f4\u6027 In stage 2 (\u201cworkflow development\u201d) other factors influencing CNV detection were evaluated in the context of the most accurate algorithms identified in stage 1. Based on results from the first two stages, we propose a comprehensive workflow for detecting CNVs from short-read WGS data. In stage 3 (\u201cworkflow evaluation\u201d) we show that our workflow can accurately identify clinically relevant CNVs. Green parallelograms represent data, and gray rectangles represent actions. The blue shape represents the CNV detection workflow developed from the results of the first two stages. While standard CGH microarrays typically detect CNVs \u226520 kb, the NimbleGen 42M and Agilent 24M have more probes and thus can identify CNVs as small as 500 bp. Only CNVs \u22651 kb were retained, because three of the six CNV-detection algorithms tested did not report smaller CNVs (see below) and because smaller CNVs are more readily detected by strategies not involving read depth. Overlapping CNVs from the same technology were manually merged. CNVs based on mate-pair analysis of Sanger data were removed, as the breakpoints and CNV sizes could not be precisely determined. BWA-MEM v.0.7.15 was used for GRCh38/hg38 because it fixed an error related to ALT-aware mapping that was present in v.0.7.12; the output from the two versions is identical in the absence of ALT contigs Definition of Repetitive and Low-Complexity Regions of the Human Genome Both array- and sequencing-based methods of CNV detection can be confounded by repetitive and low-complexity regions (RLCRs).24 To define a comprehensive set of RLCRs, we combined four datasets: (1) the set of assembly gaps defined by UCSC, which includes centromeres, telomeres, constitutive heterochromatin domains, gaps between or within clones and contigs, and the repeat-dominated short arms of chromosomes 13, 14, 15, 21, and 22; (2) the UCSC list of segmental duplications; (3) the pseudoautosomal regions of the sex chromosomes; and (4) repeat regions as defined by RepeatMasker version open-3-2-7 (see Web Resources) using the \u2013s (sensitive) option with release 20090120 of library RepeatMaskerLib.embl. The number of regions present in each data source, as well as the total number of base pairs, is given in Table S1. Links to download the full RLCR definition, as well as a version that omits the RepeatMasker definitions, are provided in Web Resources. Filtering out CNVs with Substantial Repeat Content For generating filtered sets of CNVs, a given CNV was removed if \u226570% of the CNV overlapped with RLCRs. This overlap could be comprised of just a single continuous region or multiple regions. To illustrate, if a CNV spans coordinates 100,000\u2013105,000 of chromosome 1 and two RLCRs span coordinates 100,000\u2013102,000 and 103,000\u2013105,000 of chromosome 1, then 80% of the CNV overlaps with RLCRs. CNV-Detection Algorithms The CNV-detection algorithms tested were Canvas v.1.3.5, Copy Number estimation by a Mixture Of PoissonS (cn.MOPS) v.1.16.2 CNVnator v.0.3.2 ERDS v.1.1,20 Genome STRucture in Populations (Genome STRiP) v.2.00.1696 Read Depth eXplorer (RDXplorer) v.2.0 release 3. For cn.MOPS, the authors recommend \u22656 genomes,38 while the authors of Genome STRiP recommend \u226520 Concordance of CNV-Detection Algorithms To determine sets of equivalent CNVs, CNVs were iteratively added to sets as follows. For each possible pair of CNVs (where each CNV in a pair was identified by a different algorithm or HuRef benchmark method), we determined whether they satisfied the 50% reciprocal overlap criterion. If so, and if neither CNV was yet in a set, then a new set was created including both CNVs. If only one of the CNVs was already in a set, then the other CNV was added to it. If both CNVs were already in different sets (a rare \u201cconflict\u201d), then they were left as such. When determining how many unique benchmark CNVs fell into each size bin, the size of a particular unique benchmark CNV was calculated as the median of the sizes of all the CNVs in the corresponding set. The overall similarity of two sets of CNVs A and B, where A and B were detected by two different methods, was measured using the Jaccard index J = (A\u2009\u2229\u2009B/A\u2009\u222a\u2009B). As not all algorithms reported absolute copy number, it was not taken into account when comparing CNVs. Accuracy of CNV-Detection Algorithms The accuracies of the CNV-detection algorithms were evaluated according to their sensitivity and FDR when compared with a benchmark of known CNVs (HuRef, NA12878, or AK1 benchmarks). A CNV detected by an algorithm and a benchmark CNV were deemed to be the same if the first CNV overlapped with at least 50% of the second CNV and vice versa (50% reciprocal overlap).42 Sensitivity was defined as TP / (TP + FN), where TP (\u201ctrue positives\u201d) is the number of benchmark CNVs identified correctly and FN (\u201cfalse negatives\u201d) is the number of benchmark CNVs not detected by the algorithm. FDR was defined as FP / (FP + TP), where FP (\u201cfalse positives\u201d) is the number of identified CNVs not found in the benchmark. For the HuRef benchmark, which contains CNVs identified by multiple technologies and strategies, sensitivity was determined for CNVs having 50% reciprocal overlap with a benchmark CNV from at least one technology (denoted \u201c1+\u201d) or at least two technologies (\u201c2+\u201d). Read-Depth Uniformity Read-depth uniformity was measured by the inter-quartile range (IQR). Let Ra denote the read depth for which a% of the bases in the reference genome have smaller depths. Then IQR = R75 \u2212 R25. The GitHub repository for this paper (Web Resources) provides scripts for calculating IQR from BAM files.","title":"A Comprehensive Workflow for Read Depth-Based Identification of Copy-Number Variation from Whole-Genome Sequence Data"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_paper/#a-comprehensive-workflow-for-read-depth-based-identification-of-copy-number-variation-from-whole-genome-sequence-data","text":"","title":"A Comprehensive Workflow for Read Depth-Based Identification of Copy-Number Variation from Whole-Genome Sequence Data"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_paper/#overview","text":"In stage 1 (\u201calgorithm selection\u201d) three WGS datasets and corresponding CNV benchmarks (HuRef,3, 4, 28 NA12878,34 and AK135) were used to assess the accuracy of six read depth-based CNV-detection algorithms\u2014Canvas, cn.MOPS, CNVnator, ERDS, Genome STRiP, and RDXplorer. CNV\u7b97\u6cd5\u68c0\u6d4b\u7684\u4e00\u81f4\u6027 In stage 2 (\u201cworkflow development\u201d) other factors influencing CNV detection were evaluated in the context of the most accurate algorithms identified in stage 1. Based on results from the first two stages, we propose a comprehensive workflow for detecting CNVs from short-read WGS data. In stage 3 (\u201cworkflow evaluation\u201d) we show that our workflow can accurately identify clinically relevant CNVs. Green parallelograms represent data, and gray rectangles represent actions. The blue shape represents the CNV detection workflow developed from the results of the first two stages. While standard CGH microarrays typically detect CNVs \u226520 kb, the NimbleGen 42M and Agilent 24M have more probes and thus can identify CNVs as small as 500 bp. Only CNVs \u22651 kb were retained, because three of the six CNV-detection algorithms tested did not report smaller CNVs (see below) and because smaller CNVs are more readily detected by strategies not involving read depth. Overlapping CNVs from the same technology were manually merged. CNVs based on mate-pair analysis of Sanger data were removed, as the breakpoints and CNV sizes could not be precisely determined. BWA-MEM v.0.7.15 was used for GRCh38/hg38 because it fixed an error related to ALT-aware mapping that was present in v.0.7.12; the output from the two versions is identical in the absence of ALT contigs","title":"OverView"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_paper/#definition-of-repetitive-and-low-complexity-regions-of-the-human-genome","text":"Both array- and sequencing-based methods of CNV detection can be confounded by repetitive and low-complexity regions (RLCRs).24 To define a comprehensive set of RLCRs, we combined four datasets: (1) the set of assembly gaps defined by UCSC, which includes centromeres, telomeres, constitutive heterochromatin domains, gaps between or within clones and contigs, and the repeat-dominated short arms of chromosomes 13, 14, 15, 21, and 22; (2) the UCSC list of segmental duplications; (3) the pseudoautosomal regions of the sex chromosomes; and (4) repeat regions as defined by RepeatMasker version open-3-2-7 (see Web Resources) using the \u2013s (sensitive) option with release 20090120 of library RepeatMaskerLib.embl. The number of regions present in each data source, as well as the total number of base pairs, is given in Table S1. Links to download the full RLCR definition, as well as a version that omits the RepeatMasker definitions, are provided in Web Resources.","title":"Definition of Repetitive and Low-Complexity Regions of the Human Genome"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_paper/#filtering-out-cnvs-with-substantial-repeat-content","text":"For generating filtered sets of CNVs, a given CNV was removed if \u226570% of the CNV overlapped with RLCRs. This overlap could be comprised of just a single continuous region or multiple regions. To illustrate, if a CNV spans coordinates 100,000\u2013105,000 of chromosome 1 and two RLCRs span coordinates 100,000\u2013102,000 and 103,000\u2013105,000 of chromosome 1, then 80% of the CNV overlaps with RLCRs.","title":"Filtering out CNVs with Substantial Repeat Content"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_paper/#cnv-detection-algorithms","text":"The CNV-detection algorithms tested were Canvas v.1.3.5, Copy Number estimation by a Mixture Of PoissonS (cn.MOPS) v.1.16.2 CNVnator v.0.3.2 ERDS v.1.1,20 Genome STRucture in Populations (Genome STRiP) v.2.00.1696 Read Depth eXplorer (RDXplorer) v.2.0 release 3. For cn.MOPS, the authors recommend \u22656 genomes,38 while the authors of Genome STRiP recommend \u226520","title":"CNV-Detection Algorithms"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_paper/#concordance-of-cnv-detection-algorithms","text":"To determine sets of equivalent CNVs, CNVs were iteratively added to sets as follows. For each possible pair of CNVs (where each CNV in a pair was identified by a different algorithm or HuRef benchmark method), we determined whether they satisfied the 50% reciprocal overlap criterion. If so, and if neither CNV was yet in a set, then a new set was created including both CNVs. If only one of the CNVs was already in a set, then the other CNV was added to it. If both CNVs were already in different sets (a rare \u201cconflict\u201d), then they were left as such. When determining how many unique benchmark CNVs fell into each size bin, the size of a particular unique benchmark CNV was calculated as the median of the sizes of all the CNVs in the corresponding set. The overall similarity of two sets of CNVs A and B, where A and B were detected by two different methods, was measured using the Jaccard index J = (A\u2009\u2229\u2009B/A\u2009\u222a\u2009B). As not all algorithms reported absolute copy number, it was not taken into account when comparing CNVs.","title":"Concordance of CNV-Detection Algorithms"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_paper/#accuracy-of-cnv-detection-algorithms","text":"The accuracies of the CNV-detection algorithms were evaluated according to their sensitivity and FDR when compared with a benchmark of known CNVs (HuRef, NA12878, or AK1 benchmarks). A CNV detected by an algorithm and a benchmark CNV were deemed to be the same if the first CNV overlapped with at least 50% of the second CNV and vice versa (50% reciprocal overlap).42 Sensitivity was defined as TP / (TP + FN), where TP (\u201ctrue positives\u201d) is the number of benchmark CNVs identified correctly and FN (\u201cfalse negatives\u201d) is the number of benchmark CNVs not detected by the algorithm. FDR was defined as FP / (FP + TP), where FP (\u201cfalse positives\u201d) is the number of identified CNVs not found in the benchmark. For the HuRef benchmark, which contains CNVs identified by multiple technologies and strategies, sensitivity was determined for CNVs having 50% reciprocal overlap with a benchmark CNV from at least one technology (denoted \u201c1+\u201d) or at least two technologies (\u201c2+\u201d).","title":"Accuracy of CNV-Detection Algorithms"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_paper/#read-depth-uniformity","text":"Read-depth uniformity was measured by the inter-quartile range (IQR). Let Ra denote the read depth for which a% of the bases in the reference genome have smaller depths. Then IQR = R75 \u2212 R25. The GitHub repository for this paper (Web Resources) provides scripts for calculating IQR from BAM files.","title":"Read-Depth Uniformity"},{"location":"08_DNA/05_somatic/003_CNV/005_CNV_purecn/","text":"library(\"PureCN\") $ Rscript $PURECN/IntervalFile.R --infile baits_hg19.bed \\ --fasta hg19.fa --outfile $OUT_REF/baits_hg19_intervals.txt \\ --offtarget --genome hg19 \\ --export $OUT_REF/baits_optimized_hg19.bed \\ --mappability wgEncodeCrgMapabilityAlign100mer.bigWig \\ --reptiming wgEncodeUwRepliSeqK562WaveSignalRep1.bigWig #--offtarget, \u5c06\u5305\u542b\u8131\u9776\u7684reads\uff0c\u5bf9\u4e8e\u6269\u589e\u5b50\u6570\u636e\u4e0d\u5efa\u8bae\u4f7f\u7528\uff1b #--genome, \u5229\u7528gene symbols\u6765\u6ce8\u91ca\u5916\u663e\u5b50\u3002\u5bf9\u4e8e\u4eba\u7c7b\u53c2\u8003\u57fa\u56e0\u7ec4\uff0c\u4e0d\u7528\u4f7f\u7528b37/b38\uff0c\u4f7f\u7528hg19/hg38. without ALT contigs","title":"005 CNV purecn"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/","text":"\u5386\u53f2\u80cc\u666f Technologies for CNV Detection + Giemsa staining + Fluorescent in situ hybridization (FISH) - \u8367\u5149\u539f\u4f4d\u6742\u4ea4 + Comparative genomic hybridization (CGH) - \u6bd4\u8f83\u57fa\u56e0\u7ec4\u6742\u4ea4 \u5b83\u80fd\u4ea7\u751f\u5168\u57fa\u56e0\u7ec4\u4e2d\u67d3\u8272\u4f53\u4e0aDNA\u5e8f\u5217\u62f7\u8d1d\u6570\u56fe\u8c31\uff0c\u4f7f\u7528\u4e24\u79cd\u4e0d\u540c\u7684\u8367\u5149\u5c06\u764c\u75c7\u7ec4\u7ec7\u6837\u672c\u548c\u6b63\u5e38\u7ec4\u7ec7\u6837\u672c\u7684DNA\u8fdb\u884c\u6807\u8bb0\u5236\u6210\u63a2\u9488\u540e\uff0c\u518d\u540c\u65f6\u4e0e\u6b63\u5e38\u7684\u5206\u88c2\u4e2d\u671f\u67d3\u8272\u4f53\u8fdb\u884c\u6742\u4ea4\uff0c\u901a\u8fc7\u68c0\u6d4b\u67d3\u8272\u4f53\u4e0a\u4e0d\u540c\u533a\u57df\u7684\u4e24\u79cd\u8367\u5149\u7684\u5f3a\u5ea6\u6bd4\uff0c\u6765\u53d1\u73b0DNA\u5e8f\u5217\u6269\u589e\u6216\u8005\u4e22\u5931\u7684\u533a\u57df\u3002CGH\u6280\u672f\u5177\u6709\uff1a\u4f7f\u7528DNA\u6837\u672c\u91cf\u5c11\uff0c\u68c0\u6d4b\u57fa\u56e0\u7ec4\u62f7\u8d1d\u6570\u53d8\u5316\u53ea\u9700\u4e00\u6b21\u6742\u4ea4\uff0c\u65e2\u80fd\u5bf9\u6d3b\u7ec6\u80de\u6216\u7ec4\u7ec7\u4e5f\u80fd\u5bf9\u5b58\u6863\u7ec4\u7ec7\u8fdb\u884c\u7814\u7a76\u7684\u4f18\u70b9\u3002\u4f46\u662f\uff0c\u5b83\u6240\u80fd\u68c0\u6d4b\u5230\u7684DNA\u5e8f\u5217\u6269\u589e\u6216\u4e22\u5931\u7684\u5927\u5c0f\u4e3a3-5Mb\uff0c\u56e0\u6b64\u5bf9\u4e8e\u4f4e\u6c34\u5e73\u7684DNA\u6269\u589e\u548c\u5c0f\u7247\u6bb5\u4e22\u5931\uff0c\u4f1a\u53d1\u751f\u6f0f\u68c0\u3002 + array CGH\uff0caCGH - \u5fae\u9635\u5217\u6bd4\u8f83\u57fa\u56e0\u7ec4\u6742\u4ea4\u6280\u672f[10]\u3002 \u4e0eCGH\u6280\u672f\u76f8\u6bd4\uff0caCGH\u4f7f\u7528\u5fae\u9635\u5217\u4ee3\u66ffCGH\u6280\u672f\u4e2d\u7684\u4e2d\u671f\u5206\u88c2\u76f8\u7684\u67d3\u8272\u4f53\uff0c\u4f7f\u7528\u5e26\u6709\u4e0d\u540c\u8367\u5149\u6807\u8bb0\u7684\u6d4b\u8bd5DNA\u63a2\u9488\uff0c\u4ee5DNA\u63a2\u9488\u4e3a\u6a21\u677f\uff0c\u7ade\u4e89\u6027\u5730\u4e0e\u5fae\u9635\u5217\u7684\u9776\u5e8f\u5217\u8fdb\u884c\u6742\u4ea4\u3002\u4e0eCGH\u6280\u672f\u76f8\u6bd4\uff0c\u5b83\u5177\u6709\u4e24\u65b9\u9762\u7684\u660e\u663e\u4f18\u52bf\uff1a\uff081\uff09\u7075\u654f\u5ea6\u548c\u51c6\u786e\u6027\u8f83\u9ad8\u3002\u67d3\u8272\u4f53\u4e0aDNA\u4ee5\u9ad8\u5bc6\u96c6\u5ea6\u548c\u8d85\u87ba\u65cb\u7684\u5f62\u5f0f\u5b58\u5728\uff0c\u800caCGH\u6280\u672f\u907f\u5f00\u4e86\u590d\u6742\u7684\u67d3\u8272\u4f53\u7ed3\u6784\uff0c\u6240\u4f7f\u7528\u7684\u9776\u5e8f\u5217\u4e3a\u5c11\u6570\u57fa\u56e0\u7684DNA\u7247\u6bb5\u3002\u56e0\u6b64\u4e0eCGH\u6280\u672f\u76f8\u6bd4\uff0caCGH\u6280\u672f\u80fd\u627e\u51fa\u90a3\u4e9b\u65e0\u6cd5\u68c0\u6d4b\u51fa\u7684\u62f7\u8d1d\u6570\u5dee\u5f02\uff0c\u800c\u4e14\u80fd\u5bf9\u6269\u589e\u6216\u7f3a\u5931\u7684\u4f4d\u7f6e\u8fdb\u884c\u7cbe\u51c6\u5730\u5b9a\u4f4d\u3002\uff082\uff09\u81ea\u52a8\u5316\u548c\u7a0b\u5e8f\u5316\u3002aCGH\u6280\u672f\u4e0e\u666e\u901a\u7684\u57fa\u56e0\u82af\u7247\u68c0\u6d4b\u8868\u8fbe\u8c31\u7684\u6d41\u7a0b\u4e00\u6837\uff0c\u53ef\u4ee5\u4f7f\u7528\u673a\u5668\u548c\u8ba1\u7b97\u673a\u81ea\u52a8\u64cd\u4f5c\uff0c\u5feb\u901f\u4e14\u7701\u65f6\u7701\u529b\u3002 + \u5355\u6838\u82f7\u9178\u591a\u6001\u6027\u5fae\u9635\u5217\u6280\u672f \uff08single nucleotide polymorphism arrays\uff0cSNP arrays\uff09[11]\u3002 \u5b83\u901a\u8fc7\u68c0\u6d4b\u6742\u5408\u6027\u4e22\u5931\uff08loss of heterozygosity\uff0cLOH\uff09\u6765\u68c0\u6d4b\u57fa\u56e0\u7ec4\u7247\u6bb5\u7684\u6269\u589e\u548c\u7f3a\u5931\u3002 + \u6df1\u5ea6\u6d4b\u5e8f\u6280\u672f[12]\u3002 \u4f7f\u7528\u6df1\u5ea6\u6d4b\u5e8f\u6280\u672f\u4ea7\u751f\u7684\u6570\u636e\u6765\u68c0\u6d4b\u62f7\u8d1d\u6570\u53d8\u5f02\u662f\u8fd1\u5e74\u6765\u98de\u901f\u53d1\u5c55\u7684\u65b0\u9886\u57df\u3002\u62f7\u8d1d\u6570\u53d8\u5f02\u68c0\u6d4b\u7684\u7cbe\u786e\u5ea6\u548c\u5206\u8fa8\u7387\u968f\u7740\u6d4b\u5e8f\u6df1\u5ea6\u7684\u589e\u52a0\u800c\u63d0\u9ad8\uff0c\u53ef\u4ee5\u83b7\u5f97\u66f4\u52a0\u51c6\u786e\u7684\u62f7\u8d1d\u6570\u53d8\u5f02\u7684\u65ad\u70b9\u4f4d\u7f6e\uff0c\u5e76\u4e14\u80fd\u591f\u68c0\u6d4b\u57fa\u4e8e\u82af\u7247\u65b9\u6cd5\u6240\u4e0d\u80fd\u68c0\u6d4b\u7684\u63d2\u5165\u548c\u5012\u4f4d\u7b49\u57fa\u56e0\u7ec4\u53d8\u5f02\u5f62\u5f0f\u3002\u7531\u4e8e\u6df1\u5ea6\u6d4b\u5e8f\u6280\u672f\u4e0d\u9700\u8981\u63a2\u9488\uff0c\u80fd\u4ee5\u5355\u78b1\u57fa\u5206\u8fa8\u7387\u5728\u5168\u57fa\u56e0\u7ec4\u8303\u56f4\u5185\u68c0\u6d4b\u62f7\u8d1d\u6570\u53d8\u5f02\uff0c\u56e0\u800c\u53ef\u4ee5\u663e\u8457\u63d0\u9ad8\u62f7\u8d1d\u6570\u53d8\u5f02\u7684\u68c0\u51fa\u6570\u3002 + Spectral karyotyping (SKY) + SNP genotyping arrays \u540d\u8bcd BAF LRR LRR is a measure of normalized total signal intensity. BAF is a measure of normalized allelic intensity ratio. BAF = Y / (X + Y) LRR = log2( (X + Y)sampleOfInterest / (X+Y)baselineSample) The combination of LRR and BAF can be used together to determine different copy numbers and to differentiate copy-neutral LOH regions from normal copy regions. \u7b97\u6cd5 \u57fa\u4e8e\u6df1\u5ea6\u6d4b\u5e8f\u7684\u62f7\u8d1d\u6570\u53d8\u5f02\u7684\u68c0\u6d4b\u7b97\u6cd5 \u968f\u7740\u6d4b\u5e8f\u6280\u672f\u7684\u53d1\u5c55\u548c\u6d4b\u5e8f\u6210\u672c\u7684\u964d\u4f4e\uff0c\u4e0e\u5176\u4ed6\u57fa\u4e8e\u5fae\u9635\u5217\u7684\u6280\u672f\u76f8\u6bd4\uff0c\u6df1\u5ea6\u6d4b\u5e8f\u63d0\u4f9b\u4e86\u66f4\u9ad8\u7cbe\u5ea6\u548c\u66f4\u5927\u901a\u91cf\u7684\u6570\u636e\u7528\u4e8e\u62f7\u8d1d\u6570\u53d8\u5f02\u7684\u5206\u6790[12]\u3002\u9488\u5bf9\u6df1\u5ea6\u6d4b\u5e8f\u6280\u672f\uff0c\u5f88\u591a\u7b97\u6cd5\u88ab\u5f00\u53d1\u51fa\u6765\u7528\u4e8e\u62f7\u8d1d\u6570\u53d8\u5f02\u7684\u68c0\u6d4b\u3002\u6839\u636e\u7b97\u6cd5\u6240\u4f7f\u7528\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u7b97\u6cd5\u5206\u4e3a\u4e09\u7c7b\u3002\u7b2c\u4e00\u7c7b\u662f\u53ea\u4f7f\u7528\u7247\u6bb5\u7684\u6df1\u5ea6\u4fe1\u606f\uff0c\u5982CNAnorm\u3001THetA\u7b49[13, 14]\u3002\u7b2c\u4e8c\u7c7b\u662f\u53ea\u662f\u7528\u5355\u6838\u82f7\u9178\u53d8\u5f02\u4fe1\u606f\uff0c\u5982PurityEst\u548cPurBayes[15, 16]\u3002\u7b2c\u4e09\u7c7b\u662f\u540c\u65f6\u4f7f\u7528\u7247\u6bb5\u7684\u6df1\u5ea6\u4fe1\u606f\u548c\u5355\u6838\u82f7\u9178\u53d8\u5f02\u4fe1\u606f\uff0c\u5982PyLOH\u548cpatchwork[17, 18]\u3002\u7b2c\u4e00\u7c7b\u548c\u7b2c\u4e8c\u7c7b\u65b9\u6cd5\u4f1a\u51fa\u73b0\u8bc6\u522b\u95ee\u9898\uff0c\u56e0\u4e3a\u6837\u672c\u7eaf\u5ea6\u7684\u4e0d\u540c\u548c\u764c\u7ec6\u80de\u500d\u6027\u7684\u4e0d\u540c\u53ef\u80fd\u4f1a\u4ea7\u751f\u76f8\u540c\u7684\u89c2\u6d4b\u6570\u636e\u3002\u4f8b\u5982\u5f53\u67d0\u4e2a\u80bf\u7624\u7ec4\u7ec7\u6837\u672c\u7684\u764c\u7ec6\u80de\u7eaf\u5ea6\u4e3a0.4\uff0c\u764c\u7ec6\u80de\u7684\u500d\u6027\u4e3a4\u65f6\uff0c\u4e0e\u5f53\u80bf\u7624\u7ec4\u7ec7\u6837\u672c\u7eaf\u5ea6\u4e3a0.8\uff0c\u764c\u7ec6\u80de\u7684\u500d\u6027\u4e3a3\u65f6\uff0c\u6837\u672c\u7684\u500d\u6027\u5747\u4e3a2.8\u3002\u540c\u6837\uff0c\u53ea\u4f7f\u7528\u5355\u6838\u82f7\u9178\u53d8\u5f02\u4fe1\u606f\u4e5f\u4f1a\u4ea7\u751f\u7c7b\u4f3c\u7684\u95ee\u9898\u3002\u56e0\u6b64\uff0c\u6709\u4e9b\u7b97\u6cd5\u4e3a\u4e86\u89c4\u907f\u8fd9\u4e9b\u95ee\u9898\uff0c\u4f7f\u7528\u4e86\u5404\u79cd\u4e0d\u540c\u7684\u663e\u5f0f\u6216\u8005\u9690\u5f0f\u7684\u5047\u8bbe\u3002\u5982PurityEst\uff0c\u4e00\u79cd\u4f7f\u7528B\u57fa\u56e0\u9891\u7387(B-allele frequencies\uff0cBAFs)\u7684\u7b97\u6cd5\uff0c\u4f1a\u5047\u8bbeBAFs\u503c\u63a5\u8fd1\u4e8e0.5\u3002\u56e0\u6b64\u540c\u65f6\u4f7f\u7528\u7247\u6bb5\u7684\u6df1\u5ea6\u4fe1\u606f\u548c\u5355\u6838\u82f7\u9178\u53d8\u5f02\u4fe1\u606f\u7684\u7b2c\u4e09\u7c7b\u65b9\u6cd5\uff0c\u80fd\u8f83\u597d\u5730\u89e3\u51b3\u8bc6\u522b\u95ee\u9898\u3002\u6839\u636e\u7b97\u6cd5\u4ea7\u751f\u7684\u7ed3\u679c\uff0c\u53ef\u4ee5\u5c06\u7b97\u6cd5\u5206\u4e3a\u4e09\u7c7b\uff0c\u7b2c\u4e00\u7c7b\u662f\u53ea\u8ba1\u7b97\u7247\u6bb5\u7684\u5b8c\u5168\u62f7\u8d1d\u6570\u3002\u7b2c\u4e8c\u7c7b\u662f\u8ba1\u7b97\u7247\u6bb5\u7684\u5b8c\u5168\u62f7\u8d1d\u6570\u53ca\u4e3b\u8981\u7b49\u4f4d\u57fa\u56e0\u7684\u62f7\u8d1d\u6570\uff0c\u56e0\u6b64\u4e0e\u7b2c\u4e00\u7c7b\u7b97\u6cd5\u76f8\u6bd4\uff0c\u8fd9\u7c7b\u7b97\u6cd5\u80fd\u591f\u63a8\u65ad\u51fa\u57fa\u56e0\u578b\u3002\u4f8b\u5982\uff0c\u67d0\u4e2a\u57fa\u56e0\u7684\u62f7\u8d1d\u6570\u4e3a3\uff0c\u5b83\u7684\u57fa\u56e0\u578b\u6709AAA\uff0cAAB\uff0cABB\u548cBBB\u8fd9\u56db\u79cd\uff0c\u7b2c\u4e00\u7c7b\u7b97\u6cd5\u53ea\u80fd\u63a8\u65ad\u51fa\u8fd9\u4e2a\u57fa\u56e0\u7684\u62f7\u8d1d\u6570\uff0c\u800c\u7b2c\u4e8c\u7c7b\u7b97\u6cd5\u8fd8\u80fd\u63a8\u65ad\u51fa\u8fd9\u4e2a\u57fa\u56e0\u7684\u57fa\u56e0\u578b\u3002\u7b2c\u4e09\u7c7b\u7b97\u6cd5\u9664\u4e86\u5177\u6709\u7b2c\u4e8c\u7c7b\u7b97\u6cd5\u7684\u529f\u80fd\u5916\uff0c\u8fd8\u5177\u6709\u5224\u65ad\u67d0\u4e2a\u7247\u6bb5\u662f\u5426\u5b58\u5728\u4e9a\u514b\u9686\u7684\u60c5\u51b5\uff0c\u7531\u4e8e\u80bf\u7624\u7ec4\u7ec7\u4e2d\u764c\u7ec6\u80de\u5b58\u5728\u4e9a\u514b\u9686\uff0c\u56e0\u6b64\u5bf9\u4e9a\u514b\u9686\u7247\u6bb5\u7684\u63a8\u65ad\u6709\u91cd\u8981\u610f\u4e49\u3002\u4f46\u662f\u5bf9\u4e8e\u4e9a\u514b\u9686\u7247\u6bb5\u7684\u57fa\u56e0\u578b\u7684\u63a8\u65ad\uff0c\u76ee\u524d\u8fd8\u662f\u4e00\u4e2a\u5177\u6709\u6311\u6218\u6027\u7684\u96be\u9898\u3002 \u867d\u7136\uff0c\u6709\u5f88\u591a\u9488\u5bf9\u4e8e\u6df1\u5ea6\u6d4b\u5e8f\u6570\u636e\u7684\u7b97\u6cd5\u88ab\u8bbe\u8ba1\u51fa\u6765\u3002\u4f46\u662f\u6837\u672c\u7684\u6d4b\u5e8f\u6df1\u5ea6\uff0c\u6837\u672c\u7684\u7eaf\u5ea6\uff0c\u6837\u672c\u4e2d\u764c\u7ec6\u80de\u53d1\u751f\u62f7\u8d1d\u6570\u53d8\u5f02\u7684\u591a\u5c11\u53ca\u6837\u672c\u4e2d\u4e9a\u514b\u9686\u6570\u5bf9\u8fd9\u4e9b\u7b97\u6cd5\u7684\u5f71\u54cd\u8fd8\u6ca1\u6709\u8fdb\u884c\u7cfb\u7edf\u6027\u7684\u7814\u7a76\u3002\u56e0\u6b64\u5728\u672c\u6b21\u7814\u7a76\u4e2d\uff0c\u6211\u4eec\u6bd4\u8f83\u4e863\u79cd\u7528\u4e8e\u68c0\u6d4b\u62f7\u8d1d\u6570\u53d8\u5f02\u7684\u7b97\u6cd5\u3002\u6211\u4eec\u6a21\u62df\u51fa\u4e0d\u540c\u7eaf\u5ea6\u3001\u4e0d\u540c\u4e9a\u514b\u9686\u6570\u3001\u4e0d\u540c\u62f7\u8d1d\u6570\u53d8\u5f02\u6570\u91cf\u4ee5\u53ca\u4e0d\u540c\u6d4b\u5e8f\u6df1\u5ea6\u7684\u5168\u57fa\u56e0\u7ec4\u6d4b\u5e8f\u6570\u636e\uff0c\u5bf9\u8fd9\u4e9b\u7b97\u6cd5\u8fdb\u884c\u8bc4\u4f30\uff0c\u627e\u51fa\u5b83\u4eec\u4e4b\u95f4\u7684\u4f18\u52a3\u3002 \u8f6f\u4ef6\u6bd4\u8f83 https://www.yfish.org/display/PUB/Performance+comparison+of+Accucopy+%28Accurity+2%29%2C+Sequenza%2C+and+ControlFreeC segmentation segmentation algorithms 1) The univariate method, which considers only one sample at a time, is ideal for detecting rare and/or large CNVs. 2) The multivariate method, which simultaneously considers all subjects, is ideal for detecting small, common CNVs. Some CNV detection algorithms also assign actual copy number calls (0,1,2,3\u2026) for a segment based on thresholds of LR segment means, though there are some reasons why this is problematic (see CNV Analysis Tips for Illumina Data). auto- \u5bf9\u4e8ecnv\u5206\u6790\u7684\u51e0\u70b9\u601d\u8003\uff1a auto - \u8fc7\u6ee4 auto - \u9274\u5b9a\u65ad\u88c2\u70b9 auto- \u80bf\u7624\u62f7\u8d1d\u6570\u6570\u636e\u4e2d\u7684\u5f02\u65b9\u5dee\u6821\u6b63 auto- Aneuploidy\u975e\u6574\u500d\u4f53 autoauto Copy number alterations/aberrations (CNAs) copy number variations (CNVs) Comprise copy-number variations \u2265 50 bp, including deletions, insertions and duplications, as well as balanced variants such as inversions and translocations. Recurrent structural variants often result from non-allelic homologous recombination (NAHR) which involves recombination between long highly similar low-copy-number repeats.\u975e\u7b49\u4f4d\u57fa\u56e0\u540c\u6e90\u91cd\u7ec4\u662f\u540c\u6e90\u91cd\u7ec4\u7684\u4e00\u79cd\u5f62\u5f0f\uff0c\u5176\u53d1\u751f\u5728\u5177\u6709\u9ad8\u5e8f\u5217\u76f8\u4f3c\u6027\u4f46\u4e0d\u662f\u7b49\u4f4d\u57fa\u56e0\u7684\u4e24\u6bb5DNA\u4e4b\u95f4\u3002 \u5b83\u901a\u5e38\u53d1\u751f\u5728\u5148\u524d\u901a\u8fc7\u8fdb\u5316\u590d\u5236\u7684DNA\u5e8f\u5217\u4e4b\u95f4\uff0c\u56e0\u6b64\u5177\u6709\u4f4e\u62f7\u8d1d\u91cd\u590d\u3002\u8fd9\u4e9b\u91cd\u590d\u5143\u4ef6\u7684\u957f\u5ea6\u901a\u5e38\u4e3a10-300kb\uff0c\u5e76\u4e14\u5177\u670995-97\uff05\u7684\u5e8f\u5217\u540c\u4e00\u6027\u3002\u5728\u51cf\u6570\u5206\u88c2\u6216\u6709\u4e1d\u5206\u88c2\u671f\u95f4\uff0cLCR\u53ef\u80fd\u4e0d\u5bf9\u51c6\uff0c\u968f\u540e\u7684\u4ea4\u53c9\u53ef\u5bfc\u81f4\u9057\u4f20\u91cd\u6392\u3002 \u5bf9\u4e8ecnv\u5206\u6790\u7684\u51e0\u70b9\u601d\u8003\uff1a \u8fc7\u6ee4 \u201cUnfiltered\u201d refers to all CNVs \u22651 kb, while \u201cfiltered\u201d refers to CNVs that had <70% overlap with repetitive and low-complexity regions of the genome. \u9274\u5b9a\u65ad\u88c2\u70b9 CNVkit uses off-target reads between genes to detect CNV breakpoints, if your targeted sequencing protocol uses hybrid capture. In most of your cases this should help place the breakpoint correctly in the intergenic region instead of at the edge of the next targeted exon. Otherwise the CNVkit pipeline is conceptually similar to the workflow you're probably using. If your protocol is targeted amplicon sequencing instead, and there are no off-target sequencing reads to improve your estimates, then try OncoCNV. After running CBS via DNAcopy, it uses another statistical test at the gene level to remove spurious breakpoints. I think this might trim the CNV to the gene of interest in your problematic cases. The R package PSCBS, which wraps DNAcopy, has a procedure for estimating confidence intervals around breakpoints, which would help you detect breakpoints with questionable positioning near gene boundaries (if you don't mind some additional programming). \u80bf\u7624\u62f7\u8d1d\u6570\u6570\u636e\u4e2d\u7684\u5f02\u65b9\u5dee\u6821\u6b63 \u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4ece\u6574\u4e2a\u57fa\u56e0\u7ec4\u4e2d\u5747\u5300\u5730\u91c7\u6837DNA\u7247\u6bb5\uff0c\u4f46\u662fIllumina\u6d4b\u5e8f\u4eea\u503e\u5411\u4e8e\u5177\u6709\u975e\u5e38\u9ad8\u6216\u5f88\u4f4eGC\u542b\u91cf\u7684\u504f\u5dee\u3002 GC\u542b\u91cf\u662f\u6d4b\u5e8f\u8bfb\u6bb5\u4e2dG\u548cC\u78b1\u57fa\u5bf9\u7684\u6570\u91cf\u3002\u91c7\u6837\u57fa\u56e0\u7ec4\u4e2d\u7684\u5176\u4ed6\u504f\u5dee\u4e5f\u53ef\u80fd\u53d1\u751f\u3002\u4f46\u662f\uff0c\u901a\u5e38\u901a\u8fc7\u5bf9\u6765\u81ea\u540c\u4e00\u60a3\u8005\u7684\u914d\u5bf9\u6b63\u5e38\u7ec4\u7ec7\u6837\u54c1\u8fdb\u884c\u6d4b\u5e8f\u6765\u89e3\u51b3\u3002\u7136\u540e\uff0c\u6b63\u5e38\u5bf9\u7167\u6837\u672c\u5177\u6709\u76f8\u540c\u7684\u504f\u501a\uff0c\u56e0\u6b64\uff0c\u5f53\u60a8\u8ba1\u7b97\u80bf\u7624\u76f8\u5bf9\u4e8e\u6b63\u5e38\u5bf9\u7167\u7684\u5bf9\u6570\u6bd4\u65f6\uff0c\u504f\u501a\u5c31\u4f1a\u62b5\u6d88\u3002\u4f46\u662f\uff0c\u6211\u4e4b\u6240\u4ee5\u5199\u8fd9\u7bc7\u6587\u7ae0\uff0c\u662f\u56e0\u4e3a\u6211\u6709\u4e0d\u5e78\u7684\u7ecf\u9a8c\uff0c\u65e0\u6cd5\u6d88\u9664\u90a3\u4e9b\u504f\u89c1[2]\u3002\u56fe2\u663e\u793a\u4e86\u5f15\u8d77\u7684\u95ee\u9898\u3002\u5b83\u6839\u636eGC\u542b\u91cf\u7ed8\u5236log2\uff08\u80bf\u7624/\u5bf9\u7167\uff09\u3002\u901a\u5e38\uff0c\u8fd9\u770b\u8d77\u6765\u5f88\u5e73\u5766\uff0c\u4f46\u662f\u5c31GC\u542b\u91cf\u800c\u8a00\uff0c\u660e\u663e\u5b58\u5728\u5f02\u65b9\u5dee\uff0c\u8fd9\u662f\u4e0d\u5e0c\u671b\u7684\u3002\u4e3a\u4e86\u66f4\u6e05\u695a\u5730\u663e\u793a\u5f02\u65b9\u5dee\uff0c\u56fe3\u663e\u793a\u4e860.005 GC\u542b\u91cf\u7684\u7a97\u53e3\u4e2d\u7684\u65b9\u5dee\u4f30\u8ba1\u3002 DNA fragments would ideally be uniformly sampled from throughout the genome, but Illumina sequencing machines (for example) tend to have a bias with very high or low GC content. GC content is the number G and C basepairs in the sequenced read. Other biases in sampling the genome may also occur. However, this is usually dealt with by sequencing a paired normal tissue sample from the same patient. The normal control sample then has those same biases, so when you compute a log ratio of the tumor over normal control, the biases cancel out. However, the reason why I am writing this post is I had the unfortunate experience with having data where those biases did not cancel out [2]. Figure 2 shows the issue that caused. It plots the log2(tumor/control) against the GC content. Normally this would appear flat, but there is clear heteroskedasticity with respect to GC content, which was undesirable. To more clearly show the heteroskedasticity, Figure 3 shows the variance estimate in windows of 0.005 GC content. https://murphycj.github.io/heteroskedasticity-correction/ Aneuploidy\u975e\u6574\u500d\u4f53 It is not a CNV. 1. (45, X) - Turner syndrome. 2. In uniparental disomy, both copies of a chromosome come from the same parent (with no contribution from the other parent). 3. Trisomy 21, Trisomy 18, Trisomy 13 - Down, Edwards, Patau. (47, XXX), (47, XXY), (47, XYY). 4. XXXX, XXYY, XXXXX, XXXXY and XYYYY. https://ngschool.eu/sites/default/files/uploads/20160802/1.pdf General CNV analysis strategy The analysis strategy for CNVs depends on inheritance mode and other factors. These are examples of ananlysis steps that are commonly performed: Check for compound heterozygous variants: CNV/CNV und CNV/SNV Note: For the analysis of compound heterozygous CNV and SNVs, the filtering of the small variants is relevent: use the dominant_relaxed filter. Check for homozygous deletions using the copy number=0 filter Check for microdeletion syndromes using min regions=10 filter Check for CNVs matching the patient phenotype (target region and/or phenotypes filter) Check for CNVs in ACMG target-region https://bioconductor.org/packages/release/bioc/html/CNVtools.html","title":"\u5386\u53f2\u80cc\u666f"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/#_1","text":"Technologies for CNV Detection + Giemsa staining + Fluorescent in situ hybridization (FISH) - \u8367\u5149\u539f\u4f4d\u6742\u4ea4 + Comparative genomic hybridization (CGH) - \u6bd4\u8f83\u57fa\u56e0\u7ec4\u6742\u4ea4 \u5b83\u80fd\u4ea7\u751f\u5168\u57fa\u56e0\u7ec4\u4e2d\u67d3\u8272\u4f53\u4e0aDNA\u5e8f\u5217\u62f7\u8d1d\u6570\u56fe\u8c31\uff0c\u4f7f\u7528\u4e24\u79cd\u4e0d\u540c\u7684\u8367\u5149\u5c06\u764c\u75c7\u7ec4\u7ec7\u6837\u672c\u548c\u6b63\u5e38\u7ec4\u7ec7\u6837\u672c\u7684DNA\u8fdb\u884c\u6807\u8bb0\u5236\u6210\u63a2\u9488\u540e\uff0c\u518d\u540c\u65f6\u4e0e\u6b63\u5e38\u7684\u5206\u88c2\u4e2d\u671f\u67d3\u8272\u4f53\u8fdb\u884c\u6742\u4ea4\uff0c\u901a\u8fc7\u68c0\u6d4b\u67d3\u8272\u4f53\u4e0a\u4e0d\u540c\u533a\u57df\u7684\u4e24\u79cd\u8367\u5149\u7684\u5f3a\u5ea6\u6bd4\uff0c\u6765\u53d1\u73b0DNA\u5e8f\u5217\u6269\u589e\u6216\u8005\u4e22\u5931\u7684\u533a\u57df\u3002CGH\u6280\u672f\u5177\u6709\uff1a\u4f7f\u7528DNA\u6837\u672c\u91cf\u5c11\uff0c\u68c0\u6d4b\u57fa\u56e0\u7ec4\u62f7\u8d1d\u6570\u53d8\u5316\u53ea\u9700\u4e00\u6b21\u6742\u4ea4\uff0c\u65e2\u80fd\u5bf9\u6d3b\u7ec6\u80de\u6216\u7ec4\u7ec7\u4e5f\u80fd\u5bf9\u5b58\u6863\u7ec4\u7ec7\u8fdb\u884c\u7814\u7a76\u7684\u4f18\u70b9\u3002\u4f46\u662f\uff0c\u5b83\u6240\u80fd\u68c0\u6d4b\u5230\u7684DNA\u5e8f\u5217\u6269\u589e\u6216\u4e22\u5931\u7684\u5927\u5c0f\u4e3a3-5Mb\uff0c\u56e0\u6b64\u5bf9\u4e8e\u4f4e\u6c34\u5e73\u7684DNA\u6269\u589e\u548c\u5c0f\u7247\u6bb5\u4e22\u5931\uff0c\u4f1a\u53d1\u751f\u6f0f\u68c0\u3002 + array CGH\uff0caCGH - \u5fae\u9635\u5217\u6bd4\u8f83\u57fa\u56e0\u7ec4\u6742\u4ea4\u6280\u672f[10]\u3002 \u4e0eCGH\u6280\u672f\u76f8\u6bd4\uff0caCGH\u4f7f\u7528\u5fae\u9635\u5217\u4ee3\u66ffCGH\u6280\u672f\u4e2d\u7684\u4e2d\u671f\u5206\u88c2\u76f8\u7684\u67d3\u8272\u4f53\uff0c\u4f7f\u7528\u5e26\u6709\u4e0d\u540c\u8367\u5149\u6807\u8bb0\u7684\u6d4b\u8bd5DNA\u63a2\u9488\uff0c\u4ee5DNA\u63a2\u9488\u4e3a\u6a21\u677f\uff0c\u7ade\u4e89\u6027\u5730\u4e0e\u5fae\u9635\u5217\u7684\u9776\u5e8f\u5217\u8fdb\u884c\u6742\u4ea4\u3002\u4e0eCGH\u6280\u672f\u76f8\u6bd4\uff0c\u5b83\u5177\u6709\u4e24\u65b9\u9762\u7684\u660e\u663e\u4f18\u52bf\uff1a\uff081\uff09\u7075\u654f\u5ea6\u548c\u51c6\u786e\u6027\u8f83\u9ad8\u3002\u67d3\u8272\u4f53\u4e0aDNA\u4ee5\u9ad8\u5bc6\u96c6\u5ea6\u548c\u8d85\u87ba\u65cb\u7684\u5f62\u5f0f\u5b58\u5728\uff0c\u800caCGH\u6280\u672f\u907f\u5f00\u4e86\u590d\u6742\u7684\u67d3\u8272\u4f53\u7ed3\u6784\uff0c\u6240\u4f7f\u7528\u7684\u9776\u5e8f\u5217\u4e3a\u5c11\u6570\u57fa\u56e0\u7684DNA\u7247\u6bb5\u3002\u56e0\u6b64\u4e0eCGH\u6280\u672f\u76f8\u6bd4\uff0caCGH\u6280\u672f\u80fd\u627e\u51fa\u90a3\u4e9b\u65e0\u6cd5\u68c0\u6d4b\u51fa\u7684\u62f7\u8d1d\u6570\u5dee\u5f02\uff0c\u800c\u4e14\u80fd\u5bf9\u6269\u589e\u6216\u7f3a\u5931\u7684\u4f4d\u7f6e\u8fdb\u884c\u7cbe\u51c6\u5730\u5b9a\u4f4d\u3002\uff082\uff09\u81ea\u52a8\u5316\u548c\u7a0b\u5e8f\u5316\u3002aCGH\u6280\u672f\u4e0e\u666e\u901a\u7684\u57fa\u56e0\u82af\u7247\u68c0\u6d4b\u8868\u8fbe\u8c31\u7684\u6d41\u7a0b\u4e00\u6837\uff0c\u53ef\u4ee5\u4f7f\u7528\u673a\u5668\u548c\u8ba1\u7b97\u673a\u81ea\u52a8\u64cd\u4f5c\uff0c\u5feb\u901f\u4e14\u7701\u65f6\u7701\u529b\u3002 + \u5355\u6838\u82f7\u9178\u591a\u6001\u6027\u5fae\u9635\u5217\u6280\u672f \uff08single nucleotide polymorphism arrays\uff0cSNP arrays\uff09[11]\u3002 \u5b83\u901a\u8fc7\u68c0\u6d4b\u6742\u5408\u6027\u4e22\u5931\uff08loss of heterozygosity\uff0cLOH\uff09\u6765\u68c0\u6d4b\u57fa\u56e0\u7ec4\u7247\u6bb5\u7684\u6269\u589e\u548c\u7f3a\u5931\u3002 + \u6df1\u5ea6\u6d4b\u5e8f\u6280\u672f[12]\u3002 \u4f7f\u7528\u6df1\u5ea6\u6d4b\u5e8f\u6280\u672f\u4ea7\u751f\u7684\u6570\u636e\u6765\u68c0\u6d4b\u62f7\u8d1d\u6570\u53d8\u5f02\u662f\u8fd1\u5e74\u6765\u98de\u901f\u53d1\u5c55\u7684\u65b0\u9886\u57df\u3002\u62f7\u8d1d\u6570\u53d8\u5f02\u68c0\u6d4b\u7684\u7cbe\u786e\u5ea6\u548c\u5206\u8fa8\u7387\u968f\u7740\u6d4b\u5e8f\u6df1\u5ea6\u7684\u589e\u52a0\u800c\u63d0\u9ad8\uff0c\u53ef\u4ee5\u83b7\u5f97\u66f4\u52a0\u51c6\u786e\u7684\u62f7\u8d1d\u6570\u53d8\u5f02\u7684\u65ad\u70b9\u4f4d\u7f6e\uff0c\u5e76\u4e14\u80fd\u591f\u68c0\u6d4b\u57fa\u4e8e\u82af\u7247\u65b9\u6cd5\u6240\u4e0d\u80fd\u68c0\u6d4b\u7684\u63d2\u5165\u548c\u5012\u4f4d\u7b49\u57fa\u56e0\u7ec4\u53d8\u5f02\u5f62\u5f0f\u3002\u7531\u4e8e\u6df1\u5ea6\u6d4b\u5e8f\u6280\u672f\u4e0d\u9700\u8981\u63a2\u9488\uff0c\u80fd\u4ee5\u5355\u78b1\u57fa\u5206\u8fa8\u7387\u5728\u5168\u57fa\u56e0\u7ec4\u8303\u56f4\u5185\u68c0\u6d4b\u62f7\u8d1d\u6570\u53d8\u5f02\uff0c\u56e0\u800c\u53ef\u4ee5\u663e\u8457\u63d0\u9ad8\u62f7\u8d1d\u6570\u53d8\u5f02\u7684\u68c0\u51fa\u6570\u3002 + Spectral karyotyping (SKY) + SNP genotyping arrays","title":"\u5386\u53f2\u80cc\u666f"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/#_2","text":"","title":"\u540d\u8bcd"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/#baf","text":"","title":"BAF"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/#lrr","text":"LRR is a measure of normalized total signal intensity. BAF is a measure of normalized allelic intensity ratio. BAF = Y / (X + Y) LRR = log2( (X + Y)sampleOfInterest / (X+Y)baselineSample) The combination of LRR and BAF can be used together to determine different copy numbers and to differentiate copy-neutral LOH regions from normal copy regions.","title":"LRR"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/#_3","text":"","title":"\u7b97\u6cd5"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/#_4","text":"\u968f\u7740\u6d4b\u5e8f\u6280\u672f\u7684\u53d1\u5c55\u548c\u6d4b\u5e8f\u6210\u672c\u7684\u964d\u4f4e\uff0c\u4e0e\u5176\u4ed6\u57fa\u4e8e\u5fae\u9635\u5217\u7684\u6280\u672f\u76f8\u6bd4\uff0c\u6df1\u5ea6\u6d4b\u5e8f\u63d0\u4f9b\u4e86\u66f4\u9ad8\u7cbe\u5ea6\u548c\u66f4\u5927\u901a\u91cf\u7684\u6570\u636e\u7528\u4e8e\u62f7\u8d1d\u6570\u53d8\u5f02\u7684\u5206\u6790[12]\u3002\u9488\u5bf9\u6df1\u5ea6\u6d4b\u5e8f\u6280\u672f\uff0c\u5f88\u591a\u7b97\u6cd5\u88ab\u5f00\u53d1\u51fa\u6765\u7528\u4e8e\u62f7\u8d1d\u6570\u53d8\u5f02\u7684\u68c0\u6d4b\u3002\u6839\u636e\u7b97\u6cd5\u6240\u4f7f\u7528\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u7b97\u6cd5\u5206\u4e3a\u4e09\u7c7b\u3002\u7b2c\u4e00\u7c7b\u662f\u53ea\u4f7f\u7528\u7247\u6bb5\u7684\u6df1\u5ea6\u4fe1\u606f\uff0c\u5982CNAnorm\u3001THetA\u7b49[13, 14]\u3002\u7b2c\u4e8c\u7c7b\u662f\u53ea\u662f\u7528\u5355\u6838\u82f7\u9178\u53d8\u5f02\u4fe1\u606f\uff0c\u5982PurityEst\u548cPurBayes[15, 16]\u3002\u7b2c\u4e09\u7c7b\u662f\u540c\u65f6\u4f7f\u7528\u7247\u6bb5\u7684\u6df1\u5ea6\u4fe1\u606f\u548c\u5355\u6838\u82f7\u9178\u53d8\u5f02\u4fe1\u606f\uff0c\u5982PyLOH\u548cpatchwork[17, 18]\u3002\u7b2c\u4e00\u7c7b\u548c\u7b2c\u4e8c\u7c7b\u65b9\u6cd5\u4f1a\u51fa\u73b0\u8bc6\u522b\u95ee\u9898\uff0c\u56e0\u4e3a\u6837\u672c\u7eaf\u5ea6\u7684\u4e0d\u540c\u548c\u764c\u7ec6\u80de\u500d\u6027\u7684\u4e0d\u540c\u53ef\u80fd\u4f1a\u4ea7\u751f\u76f8\u540c\u7684\u89c2\u6d4b\u6570\u636e\u3002\u4f8b\u5982\u5f53\u67d0\u4e2a\u80bf\u7624\u7ec4\u7ec7\u6837\u672c\u7684\u764c\u7ec6\u80de\u7eaf\u5ea6\u4e3a0.4\uff0c\u764c\u7ec6\u80de\u7684\u500d\u6027\u4e3a4\u65f6\uff0c\u4e0e\u5f53\u80bf\u7624\u7ec4\u7ec7\u6837\u672c\u7eaf\u5ea6\u4e3a0.8\uff0c\u764c\u7ec6\u80de\u7684\u500d\u6027\u4e3a3\u65f6\uff0c\u6837\u672c\u7684\u500d\u6027\u5747\u4e3a2.8\u3002\u540c\u6837\uff0c\u53ea\u4f7f\u7528\u5355\u6838\u82f7\u9178\u53d8\u5f02\u4fe1\u606f\u4e5f\u4f1a\u4ea7\u751f\u7c7b\u4f3c\u7684\u95ee\u9898\u3002\u56e0\u6b64\uff0c\u6709\u4e9b\u7b97\u6cd5\u4e3a\u4e86\u89c4\u907f\u8fd9\u4e9b\u95ee\u9898\uff0c\u4f7f\u7528\u4e86\u5404\u79cd\u4e0d\u540c\u7684\u663e\u5f0f\u6216\u8005\u9690\u5f0f\u7684\u5047\u8bbe\u3002\u5982PurityEst\uff0c\u4e00\u79cd\u4f7f\u7528B\u57fa\u56e0\u9891\u7387(B-allele frequencies\uff0cBAFs)\u7684\u7b97\u6cd5\uff0c\u4f1a\u5047\u8bbeBAFs\u503c\u63a5\u8fd1\u4e8e0.5\u3002\u56e0\u6b64\u540c\u65f6\u4f7f\u7528\u7247\u6bb5\u7684\u6df1\u5ea6\u4fe1\u606f\u548c\u5355\u6838\u82f7\u9178\u53d8\u5f02\u4fe1\u606f\u7684\u7b2c\u4e09\u7c7b\u65b9\u6cd5\uff0c\u80fd\u8f83\u597d\u5730\u89e3\u51b3\u8bc6\u522b\u95ee\u9898\u3002\u6839\u636e\u7b97\u6cd5\u4ea7\u751f\u7684\u7ed3\u679c\uff0c\u53ef\u4ee5\u5c06\u7b97\u6cd5\u5206\u4e3a\u4e09\u7c7b\uff0c\u7b2c\u4e00\u7c7b\u662f\u53ea\u8ba1\u7b97\u7247\u6bb5\u7684\u5b8c\u5168\u62f7\u8d1d\u6570\u3002\u7b2c\u4e8c\u7c7b\u662f\u8ba1\u7b97\u7247\u6bb5\u7684\u5b8c\u5168\u62f7\u8d1d\u6570\u53ca\u4e3b\u8981\u7b49\u4f4d\u57fa\u56e0\u7684\u62f7\u8d1d\u6570\uff0c\u56e0\u6b64\u4e0e\u7b2c\u4e00\u7c7b\u7b97\u6cd5\u76f8\u6bd4\uff0c\u8fd9\u7c7b\u7b97\u6cd5\u80fd\u591f\u63a8\u65ad\u51fa\u57fa\u56e0\u578b\u3002\u4f8b\u5982\uff0c\u67d0\u4e2a\u57fa\u56e0\u7684\u62f7\u8d1d\u6570\u4e3a3\uff0c\u5b83\u7684\u57fa\u56e0\u578b\u6709AAA\uff0cAAB\uff0cABB\u548cBBB\u8fd9\u56db\u79cd\uff0c\u7b2c\u4e00\u7c7b\u7b97\u6cd5\u53ea\u80fd\u63a8\u65ad\u51fa\u8fd9\u4e2a\u57fa\u56e0\u7684\u62f7\u8d1d\u6570\uff0c\u800c\u7b2c\u4e8c\u7c7b\u7b97\u6cd5\u8fd8\u80fd\u63a8\u65ad\u51fa\u8fd9\u4e2a\u57fa\u56e0\u7684\u57fa\u56e0\u578b\u3002\u7b2c\u4e09\u7c7b\u7b97\u6cd5\u9664\u4e86\u5177\u6709\u7b2c\u4e8c\u7c7b\u7b97\u6cd5\u7684\u529f\u80fd\u5916\uff0c\u8fd8\u5177\u6709\u5224\u65ad\u67d0\u4e2a\u7247\u6bb5\u662f\u5426\u5b58\u5728\u4e9a\u514b\u9686\u7684\u60c5\u51b5\uff0c\u7531\u4e8e\u80bf\u7624\u7ec4\u7ec7\u4e2d\u764c\u7ec6\u80de\u5b58\u5728\u4e9a\u514b\u9686\uff0c\u56e0\u6b64\u5bf9\u4e9a\u514b\u9686\u7247\u6bb5\u7684\u63a8\u65ad\u6709\u91cd\u8981\u610f\u4e49\u3002\u4f46\u662f\u5bf9\u4e8e\u4e9a\u514b\u9686\u7247\u6bb5\u7684\u57fa\u56e0\u578b\u7684\u63a8\u65ad\uff0c\u76ee\u524d\u8fd8\u662f\u4e00\u4e2a\u5177\u6709\u6311\u6218\u6027\u7684\u96be\u9898\u3002 \u867d\u7136\uff0c\u6709\u5f88\u591a\u9488\u5bf9\u4e8e\u6df1\u5ea6\u6d4b\u5e8f\u6570\u636e\u7684\u7b97\u6cd5\u88ab\u8bbe\u8ba1\u51fa\u6765\u3002\u4f46\u662f\u6837\u672c\u7684\u6d4b\u5e8f\u6df1\u5ea6\uff0c\u6837\u672c\u7684\u7eaf\u5ea6\uff0c\u6837\u672c\u4e2d\u764c\u7ec6\u80de\u53d1\u751f\u62f7\u8d1d\u6570\u53d8\u5f02\u7684\u591a\u5c11\u53ca\u6837\u672c\u4e2d\u4e9a\u514b\u9686\u6570\u5bf9\u8fd9\u4e9b\u7b97\u6cd5\u7684\u5f71\u54cd\u8fd8\u6ca1\u6709\u8fdb\u884c\u7cfb\u7edf\u6027\u7684\u7814\u7a76\u3002\u56e0\u6b64\u5728\u672c\u6b21\u7814\u7a76\u4e2d\uff0c\u6211\u4eec\u6bd4\u8f83\u4e863\u79cd\u7528\u4e8e\u68c0\u6d4b\u62f7\u8d1d\u6570\u53d8\u5f02\u7684\u7b97\u6cd5\u3002\u6211\u4eec\u6a21\u62df\u51fa\u4e0d\u540c\u7eaf\u5ea6\u3001\u4e0d\u540c\u4e9a\u514b\u9686\u6570\u3001\u4e0d\u540c\u62f7\u8d1d\u6570\u53d8\u5f02\u6570\u91cf\u4ee5\u53ca\u4e0d\u540c\u6d4b\u5e8f\u6df1\u5ea6\u7684\u5168\u57fa\u56e0\u7ec4\u6d4b\u5e8f\u6570\u636e\uff0c\u5bf9\u8fd9\u4e9b\u7b97\u6cd5\u8fdb\u884c\u8bc4\u4f30\uff0c\u627e\u51fa\u5b83\u4eec\u4e4b\u95f4\u7684\u4f18\u52a3\u3002","title":"\u57fa\u4e8e\u6df1\u5ea6\u6d4b\u5e8f\u7684\u62f7\u8d1d\u6570\u53d8\u5f02\u7684\u68c0\u6d4b\u7b97\u6cd5"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/#_5","text":"https://www.yfish.org/display/PUB/Performance+comparison+of+Accucopy+%28Accurity+2%29%2C+Sequenza%2C+and+ControlFreeC","title":"\u8f6f\u4ef6\u6bd4\u8f83"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/#segmentation","text":"","title":"segmentation"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/#segmentation-algorithms","text":"1) The univariate method, which considers only one sample at a time, is ideal for detecting rare and/or large CNVs. 2) The multivariate method, which simultaneously considers all subjects, is ideal for detecting small, common CNVs. Some CNV detection algorithms also assign actual copy number calls (0,1,2,3\u2026) for a segment based on thresholds of LR segment means, though there are some reasons why this is problematic (see CNV Analysis Tips for Illumina Data). auto- \u5bf9\u4e8ecnv\u5206\u6790\u7684\u51e0\u70b9\u601d\u8003\uff1a auto - \u8fc7\u6ee4 auto - \u9274\u5b9a\u65ad\u88c2\u70b9 auto- \u80bf\u7624\u62f7\u8d1d\u6570\u6570\u636e\u4e2d\u7684\u5f02\u65b9\u5dee\u6821\u6b63 auto- Aneuploidy\u975e\u6574\u500d\u4f53 autoauto Copy number alterations/aberrations (CNAs) copy number variations (CNVs) Comprise copy-number variations \u2265 50 bp, including deletions, insertions and duplications, as well as balanced variants such as inversions and translocations. Recurrent structural variants often result from non-allelic homologous recombination (NAHR) which involves recombination between long highly similar low-copy-number repeats.\u975e\u7b49\u4f4d\u57fa\u56e0\u540c\u6e90\u91cd\u7ec4\u662f\u540c\u6e90\u91cd\u7ec4\u7684\u4e00\u79cd\u5f62\u5f0f\uff0c\u5176\u53d1\u751f\u5728\u5177\u6709\u9ad8\u5e8f\u5217\u76f8\u4f3c\u6027\u4f46\u4e0d\u662f\u7b49\u4f4d\u57fa\u56e0\u7684\u4e24\u6bb5DNA\u4e4b\u95f4\u3002 \u5b83\u901a\u5e38\u53d1\u751f\u5728\u5148\u524d\u901a\u8fc7\u8fdb\u5316\u590d\u5236\u7684DNA\u5e8f\u5217\u4e4b\u95f4\uff0c\u56e0\u6b64\u5177\u6709\u4f4e\u62f7\u8d1d\u91cd\u590d\u3002\u8fd9\u4e9b\u91cd\u590d\u5143\u4ef6\u7684\u957f\u5ea6\u901a\u5e38\u4e3a10-300kb\uff0c\u5e76\u4e14\u5177\u670995-97\uff05\u7684\u5e8f\u5217\u540c\u4e00\u6027\u3002\u5728\u51cf\u6570\u5206\u88c2\u6216\u6709\u4e1d\u5206\u88c2\u671f\u95f4\uff0cLCR\u53ef\u80fd\u4e0d\u5bf9\u51c6\uff0c\u968f\u540e\u7684\u4ea4\u53c9\u53ef\u5bfc\u81f4\u9057\u4f20\u91cd\u6392\u3002","title":"segmentation algorithms"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/#cnv","text":"","title":"\u5bf9\u4e8ecnv\u5206\u6790\u7684\u51e0\u70b9\u601d\u8003\uff1a"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/#_6","text":"\u201cUnfiltered\u201d refers to all CNVs \u22651 kb, while \u201cfiltered\u201d refers to CNVs that had <70% overlap with repetitive and low-complexity regions of the genome.","title":"\u8fc7\u6ee4"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/#_7","text":"CNVkit uses off-target reads between genes to detect CNV breakpoints, if your targeted sequencing protocol uses hybrid capture. In most of your cases this should help place the breakpoint correctly in the intergenic region instead of at the edge of the next targeted exon. Otherwise the CNVkit pipeline is conceptually similar to the workflow you're probably using. If your protocol is targeted amplicon sequencing instead, and there are no off-target sequencing reads to improve your estimates, then try OncoCNV. After running CBS via DNAcopy, it uses another statistical test at the gene level to remove spurious breakpoints. I think this might trim the CNV to the gene of interest in your problematic cases. The R package PSCBS, which wraps DNAcopy, has a procedure for estimating confidence intervals around breakpoints, which would help you detect breakpoints with questionable positioning near gene boundaries (if you don't mind some additional programming).","title":"\u9274\u5b9a\u65ad\u88c2\u70b9"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/#_8","text":"\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4ece\u6574\u4e2a\u57fa\u56e0\u7ec4\u4e2d\u5747\u5300\u5730\u91c7\u6837DNA\u7247\u6bb5\uff0c\u4f46\u662fIllumina\u6d4b\u5e8f\u4eea\u503e\u5411\u4e8e\u5177\u6709\u975e\u5e38\u9ad8\u6216\u5f88\u4f4eGC\u542b\u91cf\u7684\u504f\u5dee\u3002 GC\u542b\u91cf\u662f\u6d4b\u5e8f\u8bfb\u6bb5\u4e2dG\u548cC\u78b1\u57fa\u5bf9\u7684\u6570\u91cf\u3002\u91c7\u6837\u57fa\u56e0\u7ec4\u4e2d\u7684\u5176\u4ed6\u504f\u5dee\u4e5f\u53ef\u80fd\u53d1\u751f\u3002\u4f46\u662f\uff0c\u901a\u5e38\u901a\u8fc7\u5bf9\u6765\u81ea\u540c\u4e00\u60a3\u8005\u7684\u914d\u5bf9\u6b63\u5e38\u7ec4\u7ec7\u6837\u54c1\u8fdb\u884c\u6d4b\u5e8f\u6765\u89e3\u51b3\u3002\u7136\u540e\uff0c\u6b63\u5e38\u5bf9\u7167\u6837\u672c\u5177\u6709\u76f8\u540c\u7684\u504f\u501a\uff0c\u56e0\u6b64\uff0c\u5f53\u60a8\u8ba1\u7b97\u80bf\u7624\u76f8\u5bf9\u4e8e\u6b63\u5e38\u5bf9\u7167\u7684\u5bf9\u6570\u6bd4\u65f6\uff0c\u504f\u501a\u5c31\u4f1a\u62b5\u6d88\u3002\u4f46\u662f\uff0c\u6211\u4e4b\u6240\u4ee5\u5199\u8fd9\u7bc7\u6587\u7ae0\uff0c\u662f\u56e0\u4e3a\u6211\u6709\u4e0d\u5e78\u7684\u7ecf\u9a8c\uff0c\u65e0\u6cd5\u6d88\u9664\u90a3\u4e9b\u504f\u89c1[2]\u3002\u56fe2\u663e\u793a\u4e86\u5f15\u8d77\u7684\u95ee\u9898\u3002\u5b83\u6839\u636eGC\u542b\u91cf\u7ed8\u5236log2\uff08\u80bf\u7624/\u5bf9\u7167\uff09\u3002\u901a\u5e38\uff0c\u8fd9\u770b\u8d77\u6765\u5f88\u5e73\u5766\uff0c\u4f46\u662f\u5c31GC\u542b\u91cf\u800c\u8a00\uff0c\u660e\u663e\u5b58\u5728\u5f02\u65b9\u5dee\uff0c\u8fd9\u662f\u4e0d\u5e0c\u671b\u7684\u3002\u4e3a\u4e86\u66f4\u6e05\u695a\u5730\u663e\u793a\u5f02\u65b9\u5dee\uff0c\u56fe3\u663e\u793a\u4e860.005 GC\u542b\u91cf\u7684\u7a97\u53e3\u4e2d\u7684\u65b9\u5dee\u4f30\u8ba1\u3002 DNA fragments would ideally be uniformly sampled from throughout the genome, but Illumina sequencing machines (for example) tend to have a bias with very high or low GC content. GC content is the number G and C basepairs in the sequenced read. Other biases in sampling the genome may also occur. However, this is usually dealt with by sequencing a paired normal tissue sample from the same patient. The normal control sample then has those same biases, so when you compute a log ratio of the tumor over normal control, the biases cancel out. However, the reason why I am writing this post is I had the unfortunate experience with having data where those biases did not cancel out [2]. Figure 2 shows the issue that caused. It plots the log2(tumor/control) against the GC content. Normally this would appear flat, but there is clear heteroskedasticity with respect to GC content, which was undesirable. To more clearly show the heteroskedasticity, Figure 3 shows the variance estimate in windows of 0.005 GC content. https://murphycj.github.io/heteroskedasticity-correction/","title":"\u80bf\u7624\u62f7\u8d1d\u6570\u6570\u636e\u4e2d\u7684\u5f02\u65b9\u5dee\u6821\u6b63"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/#aneuploidy","text":"It is not a CNV. 1. (45, X) - Turner syndrome. 2. In uniparental disomy, both copies of a chromosome come from the same parent (with no contribution from the other parent). 3. Trisomy 21, Trisomy 18, Trisomy 13 - Down, Edwards, Patau. (47, XXX), (47, XXY), (47, XYY). 4. XXXX, XXYY, XXXXX, XXXXY and XYYYY. https://ngschool.eu/sites/default/files/uploads/20160802/1.pdf","title":"Aneuploidy\u975e\u6574\u500d\u4f53"},{"location":"08_DNA/05_somatic/003_CNV/00_cnv/#general-cnv-analysis-strategy","text":"The analysis strategy for CNVs depends on inheritance mode and other factors. These are examples of ananlysis steps that are commonly performed: Check for compound heterozygous variants: CNV/CNV und CNV/SNV Note: For the analysis of compound heterozygous CNV and SNVs, the filtering of the small variants is relevent: use the dominant_relaxed filter. Check for homozygous deletions using the copy number=0 filter Check for microdeletion syndromes using min regions=10 filter Check for CNVs matching the patient phenotype (target region and/or phenotypes filter) Check for CNVs in ACMG target-region https://bioconductor.org/packages/release/bioc/html/CNVtools.html","title":"General CNV analysis strategy"},{"location":"08_DNA/05_somatic/003_CNV/01_facets/","text":"","title":"01 facets"},{"location":"08_DNA/05_somatic/003_CNV/02_%20Canvas/","text":"","title":"02  Canvas"},{"location":"08_DNA/05_somatic/003_CNV/07_Canvas/","text":"","title":"07 Canvas"},{"location":"08_DNA/05_somatic/003_CNV/08_PennCNV/","text":"https://austinpublishinggroup.com/proteomics-bioinformatics-genomics/fulltext/ajpbg-v2-id1009.php","title":"08 PennCNV"},{"location":"08_DNA/05_somatic/005_MSI/01_/","text":"","title":"01 "},{"location":"08_DNA/05_somatic/008_cfdna/00/","text":"Duplex Sequencing SSCS DCS","title":"00"},{"location":"08_DNA/05_somatic/008_cfdna/00/#duplex-sequencing","text":"SSCS DCS","title":"Duplex Sequencing"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/00_%E4%BB%8B%E7%BB%8D/","text":"ploidy ploidy: the amount of DNA per tumour cell, expressed as multiples of haploid genomes. https://www.crick.ac.uk/research/labs/peter-van-loo/software> The ploidy of cancer cells refers to the amount of DNA they contain. If there's a normal amount of DNA in the cells, they are said to be diploid. These cancers tend to grow and spread more slowly. If the amount of DNA is abnormal, then the cells are called aneuploid. These cancers tend to be more aggressive. (They tend to grow and spread faster.) https://www.cancer.org/cancer/breast-cancer/understanding-a-breast-cancer-diagnosis/ploidy-and-cell-proliferation.html Loss of heterozygosity (LOH) Loss of heterozygosity (LOH) is a cross chromosomal event that results in loss of the entire gene and the surrounding chromosomal region. The loss of heterozygosity is a common occurrence in cancer, where it indicates the absence of a functional tumor suppressor gene in the lost region. However, many people remain healthy with such a loss, because there still is one functional gene left on the other chromosome of the chromosome pair. The remaining copy of the tumor suppressor gene can be inactivated by a point mutation, leaving no tumor suppressor gene to protect the body. Loss of heterozygosity does not imply a homozygous state (which would require the presence of two identical alleles in the cell). https://en.wikipedia.org/wiki/Loss_of_heterozygosity#Breast_Cancer_and_BRCA1/2","title":"00 \u4ecb\u7ecd"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/00_%E4%BB%8B%E7%BB%8D/#ploidy","text":"ploidy: the amount of DNA per tumour cell, expressed as multiples of haploid genomes. https://www.crick.ac.uk/research/labs/peter-van-loo/software> The ploidy of cancer cells refers to the amount of DNA they contain. If there's a normal amount of DNA in the cells, they are said to be diploid. These cancers tend to grow and spread more slowly. If the amount of DNA is abnormal, then the cells are called aneuploid. These cancers tend to be more aggressive. (They tend to grow and spread faster.) https://www.cancer.org/cancer/breast-cancer/understanding-a-breast-cancer-diagnosis/ploidy-and-cell-proliferation.html","title":"ploidy"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/00_%E4%BB%8B%E7%BB%8D/#loss-of-heterozygosity-loh","text":"Loss of heterozygosity (LOH) is a cross chromosomal event that results in loss of the entire gene and the surrounding chromosomal region. The loss of heterozygosity is a common occurrence in cancer, where it indicates the absence of a functional tumor suppressor gene in the lost region. However, many people remain healthy with such a loss, because there still is one functional gene left on the other chromosome of the chromosome pair. The remaining copy of the tumor suppressor gene can be inactivated by a point mutation, leaving no tumor suppressor gene to protect the body. Loss of heterozygosity does not imply a homozygous state (which would require the presence of two identical alleles in the cell). https://en.wikipedia.org/wiki/Loss_of_heterozygosity#Breast_Cancer_and_BRCA1/2","title":"Loss of heterozygosity (LOH)"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/01_sequenza/","text":"\u4ecb\u7ecd \u8bf4\u660e\u6587\u6863\uff1ahttps://cran.r-project.org/web/packages/sequenza/vignettes/sequenza.html \u8bf4\u660e\u6587\u6863\uff1ahttps://bitbucket.org/sequenzatools/sequenza/src/master/ \u8be5\u8f6f\u4ef6\u5305\u62ec\u4e24\u4e2a\u90e8\u5206: + a python-based preprocessing tool + an R package implementing the model fitting and visualization functions python\u811a\u672c\u90e8\u5206\u53ef\u4ee5\u5206\u62102\u4e2a\u6b65\u9aa4\uff1a + First, it calculates the GC content in sliding windows from a genome reference file in FASTA format. + Second, it processes the sequencing data from the tumor and normal specimens, which must be in the Pileup format, as output by SAMtools R\u5305\u7684\u6d41\u7a0b\u4e5f\u53ef\u4ee5\u5206\u62103\u4e2a\u6b65\u9aa4\uff1a + first, . extract efficiently reads the input file into R, performs GC-content normalization of the tumor versus normal depth ratio, and performs allele-specific segmentation using the \u2018copynumber\u2019 package. + Second, .fit applies the model to infer cellularity and ploidy parameters and copy number profiles. Finally, .results returns the results of the estimation together with alternative solutions and visualization of the data and the model along the genome and the individual chromosomes. https://cran.r-project.org/web/packages//vignettes/.pdf \u5b89\u88c5 source(\"https://bioconductor.org/biocLite.R\") biocLite(\"copynumber\") install.packages(\"\") Workflow overview Generating a genome-wide GC content file /local_data1/work/zhangbo/software/R-3.5.1/library//exec/-utils.py \u2212utils.py GC\u2212windows \u2212w 50 hg19.fa | gzip > hg19.gc50Base.txt.gz (http://hgdownload-test.cse.ucsc.edu/goldenPath/hg19/gc5Base/). A typical workflow developed with on pre-aligned sequencing files (BAM format) is structured as follows: Generating pileup files from BAM files samtools mpileup \u2212f hg19.fasta \u2212Q 20 normal.bam | gzip > normal.pileup.gz samtools mpileup \u2212f hg19.fasta \u2212Q 20 tumor.bam | gzip > tumor.pileup.gz Generate a seqz file Convert pileup to seqz format Converting VarScan2 output to seqz snp <- read.table(\"varscan.snp\", header = TRUE, sep = \"\\t\") cnv <- read.table(\"varscan.copynumber\", header = TRUE, sep = \"\\t\") seqz.data <- VarScan2seqz(varscan.somatic = snp, varscan.copynumber = cnv) write.table(seqz.data, \"my.sample.seqz\", col.names = TRUE, row.names = FALSE, sep = \"\\t\") for exome sequencing, we recommend that you supply varscan.copynumber. Exploring the seqz file and depth ratio nor-malization details 1. Quality control library() data.file <- system.file(\"data\", \"example.seqz.txt.gz\", package = \"\") seqz.data <- read.seqz(data.file) > str(seqz.data) 'data.frame': 53937 obs. of 14 variables: $ chromosome : chr \"1\" \"1\" \"1\" \"1\" ... $ position : int 866168 878255 880150 881992 884173 886261 900298 900632 902140 909313 ... $ base.ref : chr \"C\" \"T\" \"G\" \"G\" ... $ depth.normal : int 7 21 9 53 80 9 105 105 30 41 ... $ depth.tumor : int 10 10 16 37 61 10 78 72 14 16 ... $ depth.ratio : num 1.429 0.476 1.778 0.698 0.762 ... $ Af : num 0.9 0.9 0.9 0.514 0.586 0.9 0.837 0.629 0.5 0.6 ... $ Bf : num 0 0 0 0.486 0.397 0 0 0.371 0 0.4 ... $ zygosity.normal: chr \"hom\" \"hom\" \"hom\" \"het\" ... $ GC.percent : num 66 72 54 63 64 65 69 63 72 68 ... $ good.reads : num 10 10 10 35 58 10 43 35 10 15 ... $ AB.normal : chr \"C\" \"T\" \"G\" \"AC\" ... $ AB.tumor : chr \"A0.1\" \"G0.1\" \"C0.1\" \".\" ... $ tumor.strand : chr \"A1.0\" \"G1.0\" \"C0.0\" \"0\" ... Each aligned base, in the next generation sequencing, is associated with a quality score. The -utils.py software is capable of filtering out bases with a quality score lower then a specified value (default, 20). The number of reads that have passed the filter is returned in the column good.reads, while the depth.tumor column contains the raw depth indicated in the pileup.-utils.py\u811a\u672c\u80fd\u591f\u8fc7\u6ee4\u6389\u8d28\u91cf\u4f4e\u4e8e20\u7684\u78b1\u57fa\u3002\u5728good.reads\u4e00\u5217\u8868\u793a\u4e86\u901a\u8fc7\u8fc7\u6ee4\u6761\u4ef6\u7684reads\u6570\u76ee\u3002\u4f46\u662fdepth.tumor\u5217\u662f\u5305\u542b\u4e86\u539f\u59cbreads\u6570\u76ee\u3002 2. Quality control 3. Normalization of depth ratio We attempt to remove this bias by normalizing with the mean depth ratio value of a corresponding GC content value. gc.stats <- gc.sample.stats(data.file) str(gc.stats) gc.stats <- gc.norm(x = seqz.data$depth.ratio, gc = seqz.data$GC.percent) #\u6216\u8005 gc.vect <- setNames(gc.stats$raw.mean, gc.stats$gc.values) seqz.data$adjusted.ratio <- seqz.data$depth.ratio / gc.vect[as.character(seqz.data$GC.percent)] \u56fe\u5f62\uff1a par(mfrow = c(1,2), cex = 1, las = 1, bty = 'l') matplot(gc.stats$gc.values, gc.stats$raw, type = 'b', col = 1, pch = c(1, 19, 1), lty = c(2, 1, 2), xlab = 'GC content (%)', ylab = 'Uncorrected depth ratio') legend('topright', legend = colnames(gc.stats$raw), pch = c(1, 19, 1)) > hist2(seqz.data$depth.ratio, seqz.data$adjusted.ratio, breaks = prettyLog, key = vkey, panel.first = abline(0, 1, lty = 2), xlab = 'Uncorrected depth ratio', ylab = 'GC-adjusted depth ratio') hist2(seqz.data$depth.ratio, seqz.data$adjusted.ratio, + breaks = prettyLog, key = vkey, panel.first = abline(0, 1, lty = 2), + xlab = 'Uncorrected depth ratio', ylab = 'GC-adjusted depth ratio') Analyzing sequencing data with R \u5305\u62ec\uff1a + Extract the relevant information from the raw seqz file. + Fit the sequenza model to infer cellularity and ploidy. + Apply the inferred parameters to estimate the copy number profile .extract: extract the information from the seqz file test <- sequenza.extract(data.file, verbose = FALSE) > names(test) [1] \"BAF\" \"ratio\" \"mutations\" \"segments\" \"chromosomes\" [6] \"gc\" \"avg.depth\" Plot chromosome view with mutations, BAF, depth ratio and segments Inference of cellularity and ploidy .fit: run grid-search approach to estimate cellularity and ploidy CP <- .fit(test) .results: write files and plots using suggested or selected solution .results(.extract = test, cp.table = CP, sample.id = \"Test\", out.dir=\"TEST\") Allele-specific segmentation using the depth ratio and the B allele frequen- cies (BAFs) Infer cellularity and ploidy by model fitting Call CNV and variant alleles \u7ed3\u679c\u8bf4\u660e This file contains three \u201cpages\u201d of copy number events through the entire genomic block. + The first page shows copy numbers of the A (red) and B (blue) alleles, + The second page shows overall copy number changes, and + The third page shows the B allele frequency and depth ratio through genomic block.","title":"\u4ecb\u7ecd"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/01_sequenza/#_1","text":"\u8bf4\u660e\u6587\u6863\uff1ahttps://cran.r-project.org/web/packages/sequenza/vignettes/sequenza.html \u8bf4\u660e\u6587\u6863\uff1ahttps://bitbucket.org/sequenzatools/sequenza/src/master/ \u8be5\u8f6f\u4ef6\u5305\u62ec\u4e24\u4e2a\u90e8\u5206: + a python-based preprocessing tool + an R package implementing the model fitting and visualization functions python\u811a\u672c\u90e8\u5206\u53ef\u4ee5\u5206\u62102\u4e2a\u6b65\u9aa4\uff1a + First, it calculates the GC content in sliding windows from a genome reference file in FASTA format. + Second, it processes the sequencing data from the tumor and normal specimens, which must be in the Pileup format, as output by SAMtools R\u5305\u7684\u6d41\u7a0b\u4e5f\u53ef\u4ee5\u5206\u62103\u4e2a\u6b65\u9aa4\uff1a + first, . extract efficiently reads the input file into R, performs GC-content normalization of the tumor versus normal depth ratio, and performs allele-specific segmentation using the \u2018copynumber\u2019 package. + Second, .fit applies the model to infer cellularity and ploidy parameters and copy number profiles. Finally, .results returns the results of the estimation together with alternative solutions and visualization of the data and the model along the genome and the individual chromosomes. https://cran.r-project.org/web/packages//vignettes/.pdf","title":"\u4ecb\u7ecd"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/01_sequenza/#_2","text":"source(\"https://bioconductor.org/biocLite.R\") biocLite(\"copynumber\") install.packages(\"\")","title":"\u5b89\u88c5"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/01_sequenza/#workflow-overview","text":"","title":"Workflow overview"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/01_sequenza/#generating-a-genome-wide-gc-content-file","text":"/local_data1/work/zhangbo/software/R-3.5.1/library//exec/-utils.py \u2212utils.py GC\u2212windows \u2212w 50 hg19.fa | gzip > hg19.gc50Base.txt.gz (http://hgdownload-test.cse.ucsc.edu/goldenPath/hg19/gc5Base/). A typical workflow developed with on pre-aligned sequencing files (BAM format) is structured as follows: Generating pileup files from BAM files samtools mpileup \u2212f hg19.fasta \u2212Q 20 normal.bam | gzip > normal.pileup.gz samtools mpileup \u2212f hg19.fasta \u2212Q 20 tumor.bam | gzip > tumor.pileup.gz","title":"Generating a genome-wide GC content file"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/01_sequenza/#generate-a-seqz-file","text":"Convert pileup to seqz format Converting VarScan2 output to seqz snp <- read.table(\"varscan.snp\", header = TRUE, sep = \"\\t\") cnv <- read.table(\"varscan.copynumber\", header = TRUE, sep = \"\\t\") seqz.data <- VarScan2seqz(varscan.somatic = snp, varscan.copynumber = cnv) write.table(seqz.data, \"my.sample.seqz\", col.names = TRUE, row.names = FALSE, sep = \"\\t\") for exome sequencing, we recommend that you supply varscan.copynumber.","title":"Generate a seqz file"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/01_sequenza/#exploring-the-seqz-file-and-depth-ratio-nor-malization-details","text":"","title":"Exploring the seqz file and depth ratio nor-malization details"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/01_sequenza/#1-quality-control","text":"library() data.file <- system.file(\"data\", \"example.seqz.txt.gz\", package = \"\") seqz.data <- read.seqz(data.file) > str(seqz.data) 'data.frame': 53937 obs. of 14 variables: $ chromosome : chr \"1\" \"1\" \"1\" \"1\" ... $ position : int 866168 878255 880150 881992 884173 886261 900298 900632 902140 909313 ... $ base.ref : chr \"C\" \"T\" \"G\" \"G\" ... $ depth.normal : int 7 21 9 53 80 9 105 105 30 41 ... $ depth.tumor : int 10 10 16 37 61 10 78 72 14 16 ... $ depth.ratio : num 1.429 0.476 1.778 0.698 0.762 ... $ Af : num 0.9 0.9 0.9 0.514 0.586 0.9 0.837 0.629 0.5 0.6 ... $ Bf : num 0 0 0 0.486 0.397 0 0 0.371 0 0.4 ... $ zygosity.normal: chr \"hom\" \"hom\" \"hom\" \"het\" ... $ GC.percent : num 66 72 54 63 64 65 69 63 72 68 ... $ good.reads : num 10 10 10 35 58 10 43 35 10 15 ... $ AB.normal : chr \"C\" \"T\" \"G\" \"AC\" ... $ AB.tumor : chr \"A0.1\" \"G0.1\" \"C0.1\" \".\" ... $ tumor.strand : chr \"A1.0\" \"G1.0\" \"C0.0\" \"0\" ... Each aligned base, in the next generation sequencing, is associated with a quality score. The -utils.py software is capable of filtering out bases with a quality score lower then a specified value (default, 20). The number of reads that have passed the filter is returned in the column good.reads, while the depth.tumor column contains the raw depth indicated in the pileup.-utils.py\u811a\u672c\u80fd\u591f\u8fc7\u6ee4\u6389\u8d28\u91cf\u4f4e\u4e8e20\u7684\u78b1\u57fa\u3002\u5728good.reads\u4e00\u5217\u8868\u793a\u4e86\u901a\u8fc7\u8fc7\u6ee4\u6761\u4ef6\u7684reads\u6570\u76ee\u3002\u4f46\u662fdepth.tumor\u5217\u662f\u5305\u542b\u4e86\u539f\u59cbreads\u6570\u76ee\u3002","title":"1. Quality control"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/01_sequenza/#2-quality-control","text":"","title":"2. Quality control"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/01_sequenza/#3-normalization-of-depth-ratio","text":"We attempt to remove this bias by normalizing with the mean depth ratio value of a corresponding GC content value. gc.stats <- gc.sample.stats(data.file) str(gc.stats) gc.stats <- gc.norm(x = seqz.data$depth.ratio, gc = seqz.data$GC.percent) #\u6216\u8005 gc.vect <- setNames(gc.stats$raw.mean, gc.stats$gc.values) seqz.data$adjusted.ratio <- seqz.data$depth.ratio / gc.vect[as.character(seqz.data$GC.percent)] \u56fe\u5f62\uff1a par(mfrow = c(1,2), cex = 1, las = 1, bty = 'l') matplot(gc.stats$gc.values, gc.stats$raw, type = 'b', col = 1, pch = c(1, 19, 1), lty = c(2, 1, 2), xlab = 'GC content (%)', ylab = 'Uncorrected depth ratio') legend('topright', legend = colnames(gc.stats$raw), pch = c(1, 19, 1)) > hist2(seqz.data$depth.ratio, seqz.data$adjusted.ratio, breaks = prettyLog, key = vkey, panel.first = abline(0, 1, lty = 2), xlab = 'Uncorrected depth ratio', ylab = 'GC-adjusted depth ratio') hist2(seqz.data$depth.ratio, seqz.data$adjusted.ratio, + breaks = prettyLog, key = vkey, panel.first = abline(0, 1, lty = 2), + xlab = 'Uncorrected depth ratio', ylab = 'GC-adjusted depth ratio')","title":"3. Normalization of depth ratio"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/01_sequenza/#analyzing-sequencing-data-with-r","text":"\u5305\u62ec\uff1a + Extract the relevant information from the raw seqz file. + Fit the sequenza model to infer cellularity and ploidy. + Apply the inferred parameters to estimate the copy number profile","title":"Analyzing sequencing data with R"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/01_sequenza/#extract-extract-the-information-from-the-seqz-file","text":"test <- sequenza.extract(data.file, verbose = FALSE) > names(test) [1] \"BAF\" \"ratio\" \"mutations\" \"segments\" \"chromosomes\" [6] \"gc\" \"avg.depth\" Plot chromosome view with mutations, BAF, depth ratio and segments Inference of cellularity and ploidy","title":".extract: extract the information from the seqz file"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/01_sequenza/#fit-run-grid-search-approach-to-estimate-cellularity-and-ploidy","text":"CP <- .fit(test)","title":".fit: run grid-search approach to estimate cellularity and ploidy"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/01_sequenza/#results-write-files-and-plots-using-suggested-or-selected-solution","text":".results(.extract = test, cp.table = CP, sample.id = \"Test\", out.dir=\"TEST\") Allele-specific segmentation using the depth ratio and the B allele frequen- cies (BAFs) Infer cellularity and ploidy by model fitting Call CNV and variant alleles","title":".results: write files and plots using suggested or selected solution"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/01_sequenza/#_3","text":"This file contains three \u201cpages\u201d of copy number events through the entire genomic block. + The first page shows copy numbers of the A (red) and B (blue) alleles, + The second page shows overall copy number changes, and + The third page shows the B allele frequency and depth ratio through genomic block.","title":"\u7ed3\u679c\u8bf4\u660e"},{"location":"08_DNA/05_somatic/009_CellularityAndPloidy/02_ABSOLUTE/","text":"https://www.jianshu.com/p/468077752689 https://www.genepattern.org/modules/docs/ABSOLUTE/2","title":"02 ABSOLUTE"},{"location":"08_DNA/05_somatic/010_HLA/001_polysolver/","text":"POLYSOLVER consists of the following steps: (i) Improved retrieval and alignment of HLA reads Reads in the WES data that potentially originate from the HLA region are retrieved based on matches to a tag library derived from all known HLA alleles. These reads are then aligned to a full-length genomic library of all known HLA alleles using a precise alignment method, keeping all best-scoring alignments for use in subsequent steps. (ii) Inference of the HLA alleles using a two-step Bayesian classification approach Inference of the two alleles for each HLA gene is based on a Bayesian calculation that takes into account the base qualities of aligned reads, observed insert sizes, as well as the ethnicity-dependent prior probabilities of each allele. POLYSOLVER-based mutation detection consists of the following steps: (i) Inference of HLA type by applying POLYSOLVER on the normal sample (ii) Re-alignment of the HLA reads in both tumor and normal samples to the inferred HLA-alleles while filtering out likely erroneous alignments (iii) Application of standard tools to detect somatic mutations (MuTect and Strelka) by comparing the re-aligned tumor and normal HLA reads (iv). Annotation of the detected mutations with gene compartment and amino acid change information","title":"001 polysolver"},{"location":"08_DNA/05_somatic/010_HLA/003_HLAreporter/","text":"","title":"003 HLAreporter"},{"location":"08_DNA/05_somatic/010_HLA/00_%E7%AE%80%E4%BB%8B/","text":"\u6297\u539f\u4ecb\u7ecd--\u4ece\u516d\u4e2a\u65b9\u9762\u5b8c\u6574\u9610\u8ff0\u6297\u539f https://mp.weixin.qq.com/s?__biz=MzUyNjk3Mjk1Ng==&mid=2247483937&idx=1&sn=e4b4cc837ed34819bf0a6eddab72937c&chksm=fa07e352cd706a4493581531ab7f12d9232496abd574f687e2a761955e5381df53a85c4f4aee&scene=21#wechat_redirect hla \u4e3b\u8981\u7ec4\u7ec7\u76f8\u5bb9\u6027\u590d\u5408\u4f53(major histocompatibility complex\uff0cMHC) \u662f\u6307\u67d3\u8272\u4f53\u4e0a\u4e00\u7ec4\u51b3\u5b9a\u79fb\u690d\u7ec4\u7ec7\u662f\u5426\u76f8\u5bb9\u3001\u4e0e\u514d\u75ab\u5e94\u7b54\u5bc6\u5207\u76f8\u5173\u3001\u7d27\u5bc6\u8fde\u9501\u7684\u57fa\u56e0\u7fa4\u3002\u4e3b\u8981\u7ec4\u7ec7\u76f8\u5bb9\u6027\u6297\u539f\u662f\u5f15\u8d77\u5668\u5b98\u79fb\u690d\u6392\u65a5\u7684\u4e3b\u8981\u6297\u539f\u3002\u5176\u7f16\u7801\u7684\u5206\u5b50\u53c2\u4e0e\u6297\u539f\u9012\u5448\uff0c\u5236\u7ea6\u7ec6\u80de\u95f4\u76f8\u4e92\u8bc6\u522b\u53ca\u8bf1\u5bfc\u514d\u75ab\u5e94\u7b54\u3002 \u4e0d\u540c\u7684\u810a\u690e\u52a8\u7269\u6709\u4e0d\u540c\u7684MHC\u3002\u5c0f\u9f20\u7684MHC\u79f0\u4e3aH-2\u590d\u5408\u4f53\uff0c\u5728\u7b2c17\u53f7\u67d3\u8272\u4f53\u4e0a\u3002\u4eba\u7684MHC\u79f0\u4e3a\u4eba\u7c7b\u767d\u7ec6\u80de\u6297\u539f\uff08human leukocyte antigen\uff0cHLA\uff09\u57fa\u56e0\u590d\u5408\u4f53\uff0c\u4f4d\u4e8e\u4eba\u7b2c6\u53f7\u67d3\u8272\u4f53\u77ed\u81c2\uff0c\u7ecf\u5178HLA\u533a\u57df\u5168\u957f\u7ea63600kb\uff0c\u5171\u6709224\u4e2a\u57fa\u56e0\u5ea7\u4f4d\uff0c128\u4e2a\u4e3a\u529f\u80fd\u6027\u57fa\u56e0\uff0c96\u4e2a\u4e3a\u5047\u57fa\u56e0\uff0c\u662f\u8fc4\u4eca\u5df2\u77e5\u57fa\u56e0\u4e2d\u7b49\u4f4d\u57fa\u56e0\u591a\u6001\u6027\u6700\u9ad8\u7684\u57fa\u56e0\u590d\u5408\u4f53\u30022003\u5e74\u5b8c\u6210\u4e86\u6574\u4e2a\u7b2c6\u53f7\u67d3\u8272\u4f53\u77ed\u81c2\u7684\u5e8f\u5217\u5206\u6790\u540e\u63d0\u51fa\u4e86\u6269\u5c55\u7684\u4e3b\u8981\u7ec4\u7ec7\u76f8\u5bb9\u6027\u590d\u5408\u4f53\uff08xMHC\uff09\u7684\u65b0\u6982\u5ff5\u3002 HLA\u590d\u5408\u4f53\u662f\u8fc4\u4eca\u4e3a\u6b62\u6240\u77e5\u4eba\u7c7b\u591a\u6001\u6027\u6700\u4e30\u5bcc\u7684\u9057\u4f20\u7cfb\u7edf\u3002\u622a\u6b6212\u5e7410\u6708\uff0cHLA\u7b49\u4f4d\u57fa\u56e0\u5df2\u8fbe8712\u4e2a\uff0c\u5176\u4e2d\u4ee5\u7ecf\u5178HLA-I\u548cII\u4e3a\u4e3b \u7ecf\u5178HLA\u6240\u5728\u533a\u57df\u5177\u6709\u4ee5\u4e0b\u7279\u70b9\uff1a + \u2460\u662f\u514d\u75ab\u529f\u80fd\u76f8\u5173\u57fa\u56e0\u6700\u96c6\u4e2d\u3001\u6700\u591a\u7684\u4e00\u4e2a\u533a\u57df\uff0c218\u57fa\u56e0\u4e2d40%\u57fa\u56e0\u4ea7\u7269\u5747\u5177\u6709\u514d\u75ab\u529f\u80fd\uff1b + \u2461\u662f\u57fa\u56e0\u5bc6\u5ea6\u6700\u9ad8\u7684\u4e00\u4e2a\u533a\u57df\uff0c\u5e73\u5747\u6bcf16kb\u5c31\u6709\u4e00\u4e2a\u57fa\u56e0\uff1b + \u2462\u662f\u591a\u6001\u6027\u6700\u4e30\u5bcc\u7684\u4e00\u4e2a\u533a\u57df\uff1b\u2463\u662f\u4e0e\u75be\u75c5\u5173\u8054\u6700\u4e3a\u5bc6\u5207\u7684\u4e00\u4e2a\u533a\u57df\u3002 \u6839\u636e\u5404\u57fa\u56e0\u53ca\u5176\u7f16\u7801\u4ea7\u7269\u7684\u5206\u5e03\u548c\u529f\u80fd\u4e0d\u540c\uff0c\u7ecf\u5178HLA\u590d\u5408\u4f53\u4e3a\u5206\u4e09\u7c7b\uff1aI\u7c7b\u57fa\u56e0\u3001II\u7c7b\u57fa\u56e0\u548cIII\u7c7b\u57fa\u56e0\uff08\u5982\u4e0b\u56fe\uff09\u3002 \u7ecf\u5178HLA I\u7c7b\u57fa\u56e0\uff08\u7b80\u79f0HLA I\u7c7b\u57fa\u56e0\uff09\uff0c\u5305\u62ecA\u3001B\u3001C\u4e09\u4e2a\u57fa\u56e0\u5ea7\u4f4d\uff0c\u7f16\u7801\u4ea7\u7269\u5206\u522b\u4e3aHLA-A\u3001HLA-B\u3001HLA-C\u5206\u5b50\u7684\u03b1\u94fe\uff08\u5373\u91cd\u94fe\uff09\u3002HLA I\u7c7b\u5206\u5b50\u5728\u7edd\u5927\u90e8\u5206\u6709\u6838\u7ec6\u80de\u8868\u9762\u8868\u8fbe\uff0c\u4f46\u8868\u8fbe\u6c34\u5e73\u6709\u6240\u4e0d\u540c\u3002\u80bf\u7624\u7ec6\u80de\u8868\u9762\u7684HLA I\u7c7b\u8868\u8fbe\u4e0b\u8c03\u6216\u7f3a\u5931\uff0c\u56e0\u6b64\u80bf\u7624\u7ec6\u80de\u53ef\u9003\u907f\u514d\u75ab\u76d1\u89c6\u3002 \u7ecf\u5178HLA II\u7c7b\u57fa\u56e0\uff08\u7b80\u79f0HLA II\u7c7b\u57fa\u56e0\uff09\uff0c\u5305\u62ecDR\u3001DQ\u3001DP\u4e09\u4e2a\u533a\u57df\uff0c\u6bcf\u4e2a\u533a\u57df\u53c8\u5305\u542b\u82e5\u5e72\u4e2aA\u548cB\u57fa\u56e0\uff0c\u5206\u522b\u7f16\u7801HLA II\u7c7b\u5206\u5b50\uff08HLA-DR\u3001HLA-DQ\u3001HLA-DP\uff09\u7684\u03b1\u94fe\u548c\u03b2\u94fe\u3002HLA II\u7c7b\u5206\u5b50\u4e3b\u8981\u8868\u8fbe\u5728\u6297\u539f\u63d0\u5448\u7ec6\u80de\uff08\u6811\u7a81\u72b6\u7ec6\u80de\u3001B\u7ec6\u80de\u3001\u5de8\u566c\u7ec6\u80de\uff09\u8868\u9762\u3002 HLA\u590d\u5408\u4f53\u7684\u4e09\u4e2a\u9057\u4f20\u7279\u6027\u662f\u9ad8\u5ea6\u591a\u6001\u6027\u3001\u5171\u663e\u6027\u8868\u8fbe\u3001\u5355\u4f53\u578b\u9057\u4f20\u548c\u8fde\u9501\u4e0d\u5e73\u8861\u3002HLA\u5c5e\u4eba\u7c7b\u591a\u6001\u6027\u6700\u4e3a\u4e30\u5bcc\u7684\u57fa\u56e0\u7cfb\u7edf\uff0c\u63ed\u793a\u4e86\u4eba\u7fa4\u4e2d\u4e24\u4e2a\u65e0\u4eb2\u7f18\u5173\u7cfb\u4e2a\u4f53\u95f4HLA\u7b49\u4f4d\u57fa\u56e0\u76f8\u540c\u7684\u6982\u7387\u975e\u5e38\u4f4e\u3002\u56e0\u4e3a\u5bf9\u6bcf\u4e00\u4e2a\u4e2a\u4f53\uff0c\u4efb\u4f55\u4e00\u4e2aHLA\u5ea7\u4f4d\u53ea\u80fd\u67092\u4e2a\u7b49\u4f4d\u57fa\u56e0\uff0c\u5206\u522b\u6765\u81ea\u7236\u6bcd\u4eb2\uff0e\u8fd9\u4e9b\u7b49\u4f4d\u57fa\u56e0\u5747\u80fd\u5f97\u5230\u5145\u5206\u7684\u8868\u8fbe\uff0c\u79f0\u4e3a\u5171\u663e\u6027\uff08co-dominance\uff09\u3002\u7531\u4e8e\u4eba\u7c7b\u662f\u968f\u673a\u5a5a\u914d\u7684\u6742\u5408\u7fa4\u4f53\uff0c\u56e0\u800c\u83b7\u53d6\u8fd9\u4e24\u4e2a\u57fa\u56e0\u5e94\u8be5\u662f\u968f\u673a\u7684\uff0c\u5982HLA-B\u4e3a\u4f8b\uff0c\u610f\u5473\u7740\u4ece2798\u4e2a\u7b49\u4f4d\u57fa\u56e0\u4e2d\u4efb\u53d6\u4e24\u4e2a\uff0c\u4e24\u4e2a\u4e2a\u4f53\u5f97\u5230\u5b8c\u5168\u76f8\u540cB\u5ea7\u4f4d\u7b49\u4f4d\u57fa\u56e0\u7684\u6982\u7387\u81ea\u7136\u5f88\u5c0f\u3002\u5982\u679c\u518d\u7b97\u4e0a\u5176\u4ed6\uff0c\u4e24\u4e2a\u65e0\u4eb2\u7f18\u5173\u7cfb\u4e2a\u4f53\u5168\u90e8HLA\u7b49\u4f4d\u57fa\u56e0\u76f8\u540c\u7684\u6982\u7387\u51e0\u4e4e\u4e3a\u96f6\u3002 HLA\u7cfb\u7edf\u7684\u591a\u6001\u6027\u4e0eTCR/BCR\u5e93\u7684\u591a\u6837\u6027\u4e0d\u540c\uff0c\u5176\u8868\u73b0\u5728\u79cd\u7fa4\u5185\u7684\u4e0d\u540c\u4e2a\u4f53\u4e4b\u95f4\uff0c\u67d0\u79cd\u610f\u4e49\u4e0a\uff0c\u662f\u79cd\u7fa4\u4e3a\u4e86\u5e94\u5bf9\u5404\u79cd\u75c5\u539f\u4f53\u5165\u4fb5\u800c\u5f62\u6210\u7684\u4e00\u4e2a\u50a8\u5907\u5e93\u3002\u663e\u7136\uff0c\u5176\u591a\u6837\u6027\u4e0d\u5728\u4e2a\u4f53\u5185\u7684\u6dcb\u5df4\u7ec6\u80de\u514b\u964d\u6c34\u5e73\uff0c\u800c\u5728\u79cd\u7fa4\u5185\u7684\u4e2a\u4f53\u6c34\u5e73\u3002HLA\u7684\u591a\u6001\u6027\uff0e\u4f53\u73b0\u4e86\u79cd\u7fa4\u6f5c\u5728\u7684\u5e94\u7b54\u80fd\u529b\uff0c\u4fdd\u8bc1\u4e86\u79cd\u7fa4\u7684\u5ef6\u7eed\u53ca\u7a33\u5b9a\u6027\u3002 \u540c\u65f6HLA\u7b49\u4f4d\u57fa\u56e0\u9891\u7387\u5728\u79cd\u7fa4\u5185\u7684\u4e0d\u540c\u4eba\u79cd\u3001\u4e0d\u540c\u6c11\u65cf\u3001\u4e0d\u540c\u5730\u57df\u5b58\u5728\u5dee\u5f02\u3002\u5982HLA-A2\u662f\u4e16\u754c\u8303\u56f4\u5185\u7edd\u5927\u591a\u6570\u6c11\u65cf\u5e38\u89c1\u7684\u6297\u539f\uff0c\u4f46\u5728\u5df4\u5e03\u4e9a\u65b0\u51e0\u5185\u4e0d\u5b58\u5728\uff1b\u53c8\u5982HLA-A3\u3001HLA-B7\u3001HLA\uff0dDRl\u662f\u5728\u767d\u4eba\u4e2d\u8f83\u4e3a\u5e38\u89c1\u7684\u767d\u7ec6\u80de\u6297\u539f\uff0c\u4f46\u5728\u4e1c\u65b9\u4eba\u4e2d\u9891\u7387\u5f88\u4f4e\uff1b\u4e1c\u65b9\u4eba\u4e2d\u5e38\u89c1\u7684HLA-B46\u3001HLA-DR9\u5728\u767d\u4eba\u4e2d\u5374\u5341\u5206\u7f55\u89c1\u3002\u56e0\u800cHLA\u7cfb\u7edf\u53c8\u6210\u4e86\u4e00\u4e2a\u826f\u597d\u7684\u7fa4\u4f53\u6807\u5fd7\uff0c\u5bf9\u7814\u7a76\u4eba\u7c7b\u8d77\u6e90\u3001\u8fc1\u79fb\u3001\u6df7\u6742\u53ca\u67d0\u4e9b\u75be\u75c5\u7684\u5411\u53d1\u6709\u5f88\u9ad8\u7684\u4ef7\u503c\u3002 HLA\u5206\u578b\u65b9\u6cd5 HLA\u5206\u578b\u65b9\u6cd5\u4e3b\u8981\u5305\u62ec\u8840\u6e05\u5b66\u5206\u578b\u548cDNA\u5206\u578b\u3002\u8840\u6e05\u5b66\u5206\u578b\u6280\u672f\u4fa7\u91cd\u4e8e\u5206\u6790HA\u6297\u539f\u7684\u7279\u5f02\u6027\uff0cDNA\u5206\u578b\u65b9\u6cd5\u5219\u4fa7\u91cd\u4e8e\u5206\u6790\u57fa\u56e0\u672c\u8eab\u7684\u591a\u6001\u6027\u3002 HLA\u5206\u578b\u7684\u5206\u8fa8\u7387\u53ef\u4ee5\u5206\u4e3a\u4ee5\u4e0b\u56db\u7c7b\uff08\u56fe2\uff09\uff1a a. 2\u4f4d\u4e3a\u7b49\u4f4d\u57fa\u56e0\uff1b b. 4\u4f4d\u4e3a\u7279\u5b9aHLA \u86cb\u767d\u8d28\uff1b c. 6\u4f4d\u4e3a\u7279\u5b9aHLA \u7f16\u7801\u5e8f\u5217(CDS)\uff1b d. 8\u4f4d\u7279\u5b9a\u7684HLA \u57fa\u56e0\u5e8f\u5217\u5305\u62ec\u672a\u7ffb\u8bd1\u533a\u548c\u5185\u542b\u5b50\u3002 https://pzweuj.github.io/2017/09/23/HLA-alleles.html \u53c2\u8003\u6570\u636e\u5e93 HLA\u53c2\u8003\u6570\u636e\u5e93 \u8be5\u68c0\u6d4b\u4f7f\u7528\u56fd\u9645\u514d\u75ab\u9057\u4f20\u5b66\u6570\u636e\u5e93\uff08IMGT Database\uff09\u6570\u636e\u516c\u5e03\u7684HLA\u57fa\u56e0\u6570\u636e\u4f5c\u4e3a\u53c2\u8003\uff08IMGT/HLA\u6570\u636e\u5e93\uff09\u3002 \u8be5\u6570\u636e\u5e93\u5305\u542b\u4e86\u4e16\u754c\u536b\u751f\u7ec4\u7ec7HLA\u547d\u540d\u59d4\u5458\u4f1a\u6b63\u5f0f\u547d\u540d\u7684\u5168\u90e8HLA\u7b49\u4f4d\u57fa\u56e0\u7684\u8bb0\u5f55\uff0c\u5e76\u4e8e1998\u5e7412\u670816\u65e5\u9996\u6b21\u516c\u5f00\u53d1\u8868\uff0c\u63d0\u4f9b\u4e86\u53ef\u641c\u7d22\u7684\u9ad8\u5ea6\u7cbe\u9009\u7684HLA\u5e8f\u5217\u6570\u636e\u3002 IMGT/HLA\u6570\u636e\u5e93\u901a\u8fc7HLA\u751f\u7269\u4fe1\u606f\u5b66\u7814\u7a76\u7ec4\u4ee5\u53ca\u6b27\u6d32\u751f\u4fe1\u606f\u5b66\u7814\u7a76\u6240\u7684\u5408\u4f5c\uff0c\u4e0d\u65ad\u66f4\u65b0HLA\u57fa\u56e0\u7684\u76f8\u5173\u5e8f\u5217\u4fe1\u606f\uff0c\u5e76\u5728\u7f51\u7ad9\u4e0a\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684HLA\u7b49\u4f4d\u57fa\u56e0\u5e8f\u5217\u7684\u5728\u7ebf\u5206\u6790\u529f\u80fd\uff0c\u662f\u6700\u5e38\u7528\u7684HLA\u5206\u578b\u53c2\u8003\u6570\u636e\u5e93\u3002 HLA\u9891\u7387\u6570\u636e\u5e93 \u8be5\u68c0\u6d4b\u4f7f\u7528\u7684HLA\u7684\u9891\u7387\u6570\u636e\u6765\u81ea\u4e8e\u4e2d\u534e\u9aa8\u9ad3\u5e93\u53d1\u8868\u7684\u7684\u300a\u4e2d\u56fd\u5e38\u89c1\u53ca\u7684HLA\u7b49\u4f4d\u57fa\u56e0 (CWD)2.2\u7248\u672c\u300b\u3002 2007\u5e74\u7f8e\u56fd\u7ec4\u7ec7\u76f8\u5bb9\u548c\u514d\u75ab\u9057\u4f20\u534f\u4f1a(ASHI)\u6210\u7acb\u4e86\u4e00\u4e2a\u7279\u8bbe\u59d4\u5458\u4f1a\uff0c\u63d0\u51fa\u5e38\u89c1\u53ca\u786e\u8ba4\u7684\u7b49\u4f4d\u57fa\u56e0\u8868\uff08Common alleles and well documented alleles\uff0cCWD\uff09\uff0c \u8fd9\u4e2a\u8868\u53ef\u4ee5\u4e3a\u4e34\u5e8aHLA\u9ad8\u5206\u8fa8\u7387\u5206\u578b\u68c0\u6d4b\u548c\u5b9e\u9a8c\u5ba4\u8bc4\u4f30\u63d0\u4f9b\u53c2\u8003\u4f9d\u636e\u3002 \u6700\u65b0\u53d1\u8868\u76842.2\u7248\u672c\u603b\u4f53\u5206\u6790\u7684\u9ad8\u5206\u8fa8\u5206\u578b\u6570\u636e\u9ad8\u8fbe84\u4e07\u4f59\u4efd\uff0c\u76f8\u5e94\u7684CWD\u6570\u91cf\u5982\u4e0b\uff1aHLA-A\u6709153\u4e2a\uff0c HLA-B\u6709216\u4e2a\uff0cHLA-C\u6709123\u4e2a\uff0cHLA-DRB1\u6709132\u4e2a\u4ee5\u53caDQB1\u670946\u4e2a\uff0c\u662f\u4e2d\u56fd\u6700\u6743\u5a01\u7684HLA\u9ad8\u5206\u8fa8\u7387\u5206\u578b\u6570\u636e\u5e93\u3002","title":"00 \u7b80\u4ecb"},{"location":"08_DNA/05_somatic/010_HLA/00_%E7%AE%80%E4%BB%8B/#-","text":"https://mp.weixin.qq.com/s?__biz=MzUyNjk3Mjk1Ng==&mid=2247483937&idx=1&sn=e4b4cc837ed34819bf0a6eddab72937c&chksm=fa07e352cd706a4493581531ab7f12d9232496abd574f687e2a761955e5381df53a85c4f4aee&scene=21#wechat_redirect","title":"\u6297\u539f\u4ecb\u7ecd--\u4ece\u516d\u4e2a\u65b9\u9762\u5b8c\u6574\u9610\u8ff0\u6297\u539f"},{"location":"08_DNA/05_somatic/010_HLA/00_%E7%AE%80%E4%BB%8B/#hla","text":"\u4e3b\u8981\u7ec4\u7ec7\u76f8\u5bb9\u6027\u590d\u5408\u4f53(major histocompatibility complex\uff0cMHC) \u662f\u6307\u67d3\u8272\u4f53\u4e0a\u4e00\u7ec4\u51b3\u5b9a\u79fb\u690d\u7ec4\u7ec7\u662f\u5426\u76f8\u5bb9\u3001\u4e0e\u514d\u75ab\u5e94\u7b54\u5bc6\u5207\u76f8\u5173\u3001\u7d27\u5bc6\u8fde\u9501\u7684\u57fa\u56e0\u7fa4\u3002\u4e3b\u8981\u7ec4\u7ec7\u76f8\u5bb9\u6027\u6297\u539f\u662f\u5f15\u8d77\u5668\u5b98\u79fb\u690d\u6392\u65a5\u7684\u4e3b\u8981\u6297\u539f\u3002\u5176\u7f16\u7801\u7684\u5206\u5b50\u53c2\u4e0e\u6297\u539f\u9012\u5448\uff0c\u5236\u7ea6\u7ec6\u80de\u95f4\u76f8\u4e92\u8bc6\u522b\u53ca\u8bf1\u5bfc\u514d\u75ab\u5e94\u7b54\u3002 \u4e0d\u540c\u7684\u810a\u690e\u52a8\u7269\u6709\u4e0d\u540c\u7684MHC\u3002\u5c0f\u9f20\u7684MHC\u79f0\u4e3aH-2\u590d\u5408\u4f53\uff0c\u5728\u7b2c17\u53f7\u67d3\u8272\u4f53\u4e0a\u3002\u4eba\u7684MHC\u79f0\u4e3a\u4eba\u7c7b\u767d\u7ec6\u80de\u6297\u539f\uff08human leukocyte antigen\uff0cHLA\uff09\u57fa\u56e0\u590d\u5408\u4f53\uff0c\u4f4d\u4e8e\u4eba\u7b2c6\u53f7\u67d3\u8272\u4f53\u77ed\u81c2\uff0c\u7ecf\u5178HLA\u533a\u57df\u5168\u957f\u7ea63600kb\uff0c\u5171\u6709224\u4e2a\u57fa\u56e0\u5ea7\u4f4d\uff0c128\u4e2a\u4e3a\u529f\u80fd\u6027\u57fa\u56e0\uff0c96\u4e2a\u4e3a\u5047\u57fa\u56e0\uff0c\u662f\u8fc4\u4eca\u5df2\u77e5\u57fa\u56e0\u4e2d\u7b49\u4f4d\u57fa\u56e0\u591a\u6001\u6027\u6700\u9ad8\u7684\u57fa\u56e0\u590d\u5408\u4f53\u30022003\u5e74\u5b8c\u6210\u4e86\u6574\u4e2a\u7b2c6\u53f7\u67d3\u8272\u4f53\u77ed\u81c2\u7684\u5e8f\u5217\u5206\u6790\u540e\u63d0\u51fa\u4e86\u6269\u5c55\u7684\u4e3b\u8981\u7ec4\u7ec7\u76f8\u5bb9\u6027\u590d\u5408\u4f53\uff08xMHC\uff09\u7684\u65b0\u6982\u5ff5\u3002 HLA\u590d\u5408\u4f53\u662f\u8fc4\u4eca\u4e3a\u6b62\u6240\u77e5\u4eba\u7c7b\u591a\u6001\u6027\u6700\u4e30\u5bcc\u7684\u9057\u4f20\u7cfb\u7edf\u3002\u622a\u6b6212\u5e7410\u6708\uff0cHLA\u7b49\u4f4d\u57fa\u56e0\u5df2\u8fbe8712\u4e2a\uff0c\u5176\u4e2d\u4ee5\u7ecf\u5178HLA-I\u548cII\u4e3a\u4e3b \u7ecf\u5178HLA\u6240\u5728\u533a\u57df\u5177\u6709\u4ee5\u4e0b\u7279\u70b9\uff1a + \u2460\u662f\u514d\u75ab\u529f\u80fd\u76f8\u5173\u57fa\u56e0\u6700\u96c6\u4e2d\u3001\u6700\u591a\u7684\u4e00\u4e2a\u533a\u57df\uff0c218\u57fa\u56e0\u4e2d40%\u57fa\u56e0\u4ea7\u7269\u5747\u5177\u6709\u514d\u75ab\u529f\u80fd\uff1b + \u2461\u662f\u57fa\u56e0\u5bc6\u5ea6\u6700\u9ad8\u7684\u4e00\u4e2a\u533a\u57df\uff0c\u5e73\u5747\u6bcf16kb\u5c31\u6709\u4e00\u4e2a\u57fa\u56e0\uff1b + \u2462\u662f\u591a\u6001\u6027\u6700\u4e30\u5bcc\u7684\u4e00\u4e2a\u533a\u57df\uff1b\u2463\u662f\u4e0e\u75be\u75c5\u5173\u8054\u6700\u4e3a\u5bc6\u5207\u7684\u4e00\u4e2a\u533a\u57df\u3002 \u6839\u636e\u5404\u57fa\u56e0\u53ca\u5176\u7f16\u7801\u4ea7\u7269\u7684\u5206\u5e03\u548c\u529f\u80fd\u4e0d\u540c\uff0c\u7ecf\u5178HLA\u590d\u5408\u4f53\u4e3a\u5206\u4e09\u7c7b\uff1aI\u7c7b\u57fa\u56e0\u3001II\u7c7b\u57fa\u56e0\u548cIII\u7c7b\u57fa\u56e0\uff08\u5982\u4e0b\u56fe\uff09\u3002 \u7ecf\u5178HLA I\u7c7b\u57fa\u56e0\uff08\u7b80\u79f0HLA I\u7c7b\u57fa\u56e0\uff09\uff0c\u5305\u62ecA\u3001B\u3001C\u4e09\u4e2a\u57fa\u56e0\u5ea7\u4f4d\uff0c\u7f16\u7801\u4ea7\u7269\u5206\u522b\u4e3aHLA-A\u3001HLA-B\u3001HLA-C\u5206\u5b50\u7684\u03b1\u94fe\uff08\u5373\u91cd\u94fe\uff09\u3002HLA I\u7c7b\u5206\u5b50\u5728\u7edd\u5927\u90e8\u5206\u6709\u6838\u7ec6\u80de\u8868\u9762\u8868\u8fbe\uff0c\u4f46\u8868\u8fbe\u6c34\u5e73\u6709\u6240\u4e0d\u540c\u3002\u80bf\u7624\u7ec6\u80de\u8868\u9762\u7684HLA I\u7c7b\u8868\u8fbe\u4e0b\u8c03\u6216\u7f3a\u5931\uff0c\u56e0\u6b64\u80bf\u7624\u7ec6\u80de\u53ef\u9003\u907f\u514d\u75ab\u76d1\u89c6\u3002 \u7ecf\u5178HLA II\u7c7b\u57fa\u56e0\uff08\u7b80\u79f0HLA II\u7c7b\u57fa\u56e0\uff09\uff0c\u5305\u62ecDR\u3001DQ\u3001DP\u4e09\u4e2a\u533a\u57df\uff0c\u6bcf\u4e2a\u533a\u57df\u53c8\u5305\u542b\u82e5\u5e72\u4e2aA\u548cB\u57fa\u56e0\uff0c\u5206\u522b\u7f16\u7801HLA II\u7c7b\u5206\u5b50\uff08HLA-DR\u3001HLA-DQ\u3001HLA-DP\uff09\u7684\u03b1\u94fe\u548c\u03b2\u94fe\u3002HLA II\u7c7b\u5206\u5b50\u4e3b\u8981\u8868\u8fbe\u5728\u6297\u539f\u63d0\u5448\u7ec6\u80de\uff08\u6811\u7a81\u72b6\u7ec6\u80de\u3001B\u7ec6\u80de\u3001\u5de8\u566c\u7ec6\u80de\uff09\u8868\u9762\u3002 HLA\u590d\u5408\u4f53\u7684\u4e09\u4e2a\u9057\u4f20\u7279\u6027\u662f\u9ad8\u5ea6\u591a\u6001\u6027\u3001\u5171\u663e\u6027\u8868\u8fbe\u3001\u5355\u4f53\u578b\u9057\u4f20\u548c\u8fde\u9501\u4e0d\u5e73\u8861\u3002HLA\u5c5e\u4eba\u7c7b\u591a\u6001\u6027\u6700\u4e3a\u4e30\u5bcc\u7684\u57fa\u56e0\u7cfb\u7edf\uff0c\u63ed\u793a\u4e86\u4eba\u7fa4\u4e2d\u4e24\u4e2a\u65e0\u4eb2\u7f18\u5173\u7cfb\u4e2a\u4f53\u95f4HLA\u7b49\u4f4d\u57fa\u56e0\u76f8\u540c\u7684\u6982\u7387\u975e\u5e38\u4f4e\u3002\u56e0\u4e3a\u5bf9\u6bcf\u4e00\u4e2a\u4e2a\u4f53\uff0c\u4efb\u4f55\u4e00\u4e2aHLA\u5ea7\u4f4d\u53ea\u80fd\u67092\u4e2a\u7b49\u4f4d\u57fa\u56e0\uff0c\u5206\u522b\u6765\u81ea\u7236\u6bcd\u4eb2\uff0e\u8fd9\u4e9b\u7b49\u4f4d\u57fa\u56e0\u5747\u80fd\u5f97\u5230\u5145\u5206\u7684\u8868\u8fbe\uff0c\u79f0\u4e3a\u5171\u663e\u6027\uff08co-dominance\uff09\u3002\u7531\u4e8e\u4eba\u7c7b\u662f\u968f\u673a\u5a5a\u914d\u7684\u6742\u5408\u7fa4\u4f53\uff0c\u56e0\u800c\u83b7\u53d6\u8fd9\u4e24\u4e2a\u57fa\u56e0\u5e94\u8be5\u662f\u968f\u673a\u7684\uff0c\u5982HLA-B\u4e3a\u4f8b\uff0c\u610f\u5473\u7740\u4ece2798\u4e2a\u7b49\u4f4d\u57fa\u56e0\u4e2d\u4efb\u53d6\u4e24\u4e2a\uff0c\u4e24\u4e2a\u4e2a\u4f53\u5f97\u5230\u5b8c\u5168\u76f8\u540cB\u5ea7\u4f4d\u7b49\u4f4d\u57fa\u56e0\u7684\u6982\u7387\u81ea\u7136\u5f88\u5c0f\u3002\u5982\u679c\u518d\u7b97\u4e0a\u5176\u4ed6\uff0c\u4e24\u4e2a\u65e0\u4eb2\u7f18\u5173\u7cfb\u4e2a\u4f53\u5168\u90e8HLA\u7b49\u4f4d\u57fa\u56e0\u76f8\u540c\u7684\u6982\u7387\u51e0\u4e4e\u4e3a\u96f6\u3002 HLA\u7cfb\u7edf\u7684\u591a\u6001\u6027\u4e0eTCR/BCR\u5e93\u7684\u591a\u6837\u6027\u4e0d\u540c\uff0c\u5176\u8868\u73b0\u5728\u79cd\u7fa4\u5185\u7684\u4e0d\u540c\u4e2a\u4f53\u4e4b\u95f4\uff0c\u67d0\u79cd\u610f\u4e49\u4e0a\uff0c\u662f\u79cd\u7fa4\u4e3a\u4e86\u5e94\u5bf9\u5404\u79cd\u75c5\u539f\u4f53\u5165\u4fb5\u800c\u5f62\u6210\u7684\u4e00\u4e2a\u50a8\u5907\u5e93\u3002\u663e\u7136\uff0c\u5176\u591a\u6837\u6027\u4e0d\u5728\u4e2a\u4f53\u5185\u7684\u6dcb\u5df4\u7ec6\u80de\u514b\u964d\u6c34\u5e73\uff0c\u800c\u5728\u79cd\u7fa4\u5185\u7684\u4e2a\u4f53\u6c34\u5e73\u3002HLA\u7684\u591a\u6001\u6027\uff0e\u4f53\u73b0\u4e86\u79cd\u7fa4\u6f5c\u5728\u7684\u5e94\u7b54\u80fd\u529b\uff0c\u4fdd\u8bc1\u4e86\u79cd\u7fa4\u7684\u5ef6\u7eed\u53ca\u7a33\u5b9a\u6027\u3002 \u540c\u65f6HLA\u7b49\u4f4d\u57fa\u56e0\u9891\u7387\u5728\u79cd\u7fa4\u5185\u7684\u4e0d\u540c\u4eba\u79cd\u3001\u4e0d\u540c\u6c11\u65cf\u3001\u4e0d\u540c\u5730\u57df\u5b58\u5728\u5dee\u5f02\u3002\u5982HLA-A2\u662f\u4e16\u754c\u8303\u56f4\u5185\u7edd\u5927\u591a\u6570\u6c11\u65cf\u5e38\u89c1\u7684\u6297\u539f\uff0c\u4f46\u5728\u5df4\u5e03\u4e9a\u65b0\u51e0\u5185\u4e0d\u5b58\u5728\uff1b\u53c8\u5982HLA-A3\u3001HLA-B7\u3001HLA\uff0dDRl\u662f\u5728\u767d\u4eba\u4e2d\u8f83\u4e3a\u5e38\u89c1\u7684\u767d\u7ec6\u80de\u6297\u539f\uff0c\u4f46\u5728\u4e1c\u65b9\u4eba\u4e2d\u9891\u7387\u5f88\u4f4e\uff1b\u4e1c\u65b9\u4eba\u4e2d\u5e38\u89c1\u7684HLA-B46\u3001HLA-DR9\u5728\u767d\u4eba\u4e2d\u5374\u5341\u5206\u7f55\u89c1\u3002\u56e0\u800cHLA\u7cfb\u7edf\u53c8\u6210\u4e86\u4e00\u4e2a\u826f\u597d\u7684\u7fa4\u4f53\u6807\u5fd7\uff0c\u5bf9\u7814\u7a76\u4eba\u7c7b\u8d77\u6e90\u3001\u8fc1\u79fb\u3001\u6df7\u6742\u53ca\u67d0\u4e9b\u75be\u75c5\u7684\u5411\u53d1\u6709\u5f88\u9ad8\u7684\u4ef7\u503c\u3002","title":"hla"},{"location":"08_DNA/05_somatic/010_HLA/00_%E7%AE%80%E4%BB%8B/#hla_1","text":"HLA\u5206\u578b\u65b9\u6cd5\u4e3b\u8981\u5305\u62ec\u8840\u6e05\u5b66\u5206\u578b\u548cDNA\u5206\u578b\u3002\u8840\u6e05\u5b66\u5206\u578b\u6280\u672f\u4fa7\u91cd\u4e8e\u5206\u6790HA\u6297\u539f\u7684\u7279\u5f02\u6027\uff0cDNA\u5206\u578b\u65b9\u6cd5\u5219\u4fa7\u91cd\u4e8e\u5206\u6790\u57fa\u56e0\u672c\u8eab\u7684\u591a\u6001\u6027\u3002 HLA\u5206\u578b\u7684\u5206\u8fa8\u7387\u53ef\u4ee5\u5206\u4e3a\u4ee5\u4e0b\u56db\u7c7b\uff08\u56fe2\uff09\uff1a a. 2\u4f4d\u4e3a\u7b49\u4f4d\u57fa\u56e0\uff1b b. 4\u4f4d\u4e3a\u7279\u5b9aHLA \u86cb\u767d\u8d28\uff1b c. 6\u4f4d\u4e3a\u7279\u5b9aHLA \u7f16\u7801\u5e8f\u5217(CDS)\uff1b d. 8\u4f4d\u7279\u5b9a\u7684HLA \u57fa\u56e0\u5e8f\u5217\u5305\u62ec\u672a\u7ffb\u8bd1\u533a\u548c\u5185\u542b\u5b50\u3002 https://pzweuj.github.io/2017/09/23/HLA-alleles.html \u53c2\u8003\u6570\u636e\u5e93 HLA\u53c2\u8003\u6570\u636e\u5e93 \u8be5\u68c0\u6d4b\u4f7f\u7528\u56fd\u9645\u514d\u75ab\u9057\u4f20\u5b66\u6570\u636e\u5e93\uff08IMGT Database\uff09\u6570\u636e\u516c\u5e03\u7684HLA\u57fa\u56e0\u6570\u636e\u4f5c\u4e3a\u53c2\u8003\uff08IMGT/HLA\u6570\u636e\u5e93\uff09\u3002 \u8be5\u6570\u636e\u5e93\u5305\u542b\u4e86\u4e16\u754c\u536b\u751f\u7ec4\u7ec7HLA\u547d\u540d\u59d4\u5458\u4f1a\u6b63\u5f0f\u547d\u540d\u7684\u5168\u90e8HLA\u7b49\u4f4d\u57fa\u56e0\u7684\u8bb0\u5f55\uff0c\u5e76\u4e8e1998\u5e7412\u670816\u65e5\u9996\u6b21\u516c\u5f00\u53d1\u8868\uff0c\u63d0\u4f9b\u4e86\u53ef\u641c\u7d22\u7684\u9ad8\u5ea6\u7cbe\u9009\u7684HLA\u5e8f\u5217\u6570\u636e\u3002 IMGT/HLA\u6570\u636e\u5e93\u901a\u8fc7HLA\u751f\u7269\u4fe1\u606f\u5b66\u7814\u7a76\u7ec4\u4ee5\u53ca\u6b27\u6d32\u751f\u4fe1\u606f\u5b66\u7814\u7a76\u6240\u7684\u5408\u4f5c\uff0c\u4e0d\u65ad\u66f4\u65b0HLA\u57fa\u56e0\u7684\u76f8\u5173\u5e8f\u5217\u4fe1\u606f\uff0c\u5e76\u5728\u7f51\u7ad9\u4e0a\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684HLA\u7b49\u4f4d\u57fa\u56e0\u5e8f\u5217\u7684\u5728\u7ebf\u5206\u6790\u529f\u80fd\uff0c\u662f\u6700\u5e38\u7528\u7684HLA\u5206\u578b\u53c2\u8003\u6570\u636e\u5e93\u3002 HLA\u9891\u7387\u6570\u636e\u5e93 \u8be5\u68c0\u6d4b\u4f7f\u7528\u7684HLA\u7684\u9891\u7387\u6570\u636e\u6765\u81ea\u4e8e\u4e2d\u534e\u9aa8\u9ad3\u5e93\u53d1\u8868\u7684\u7684\u300a\u4e2d\u56fd\u5e38\u89c1\u53ca\u7684HLA\u7b49\u4f4d\u57fa\u56e0 (CWD)2.2\u7248\u672c\u300b\u3002 2007\u5e74\u7f8e\u56fd\u7ec4\u7ec7\u76f8\u5bb9\u548c\u514d\u75ab\u9057\u4f20\u534f\u4f1a(ASHI)\u6210\u7acb\u4e86\u4e00\u4e2a\u7279\u8bbe\u59d4\u5458\u4f1a\uff0c\u63d0\u51fa\u5e38\u89c1\u53ca\u786e\u8ba4\u7684\u7b49\u4f4d\u57fa\u56e0\u8868\uff08Common alleles and well documented alleles\uff0cCWD\uff09\uff0c \u8fd9\u4e2a\u8868\u53ef\u4ee5\u4e3a\u4e34\u5e8aHLA\u9ad8\u5206\u8fa8\u7387\u5206\u578b\u68c0\u6d4b\u548c\u5b9e\u9a8c\u5ba4\u8bc4\u4f30\u63d0\u4f9b\u53c2\u8003\u4f9d\u636e\u3002 \u6700\u65b0\u53d1\u8868\u76842.2\u7248\u672c\u603b\u4f53\u5206\u6790\u7684\u9ad8\u5206\u8fa8\u5206\u578b\u6570\u636e\u9ad8\u8fbe84\u4e07\u4f59\u4efd\uff0c\u76f8\u5e94\u7684CWD\u6570\u91cf\u5982\u4e0b\uff1aHLA-A\u6709153\u4e2a\uff0c HLA-B\u6709216\u4e2a\uff0cHLA-C\u6709123\u4e2a\uff0cHLA-DRB1\u6709132\u4e2a\u4ee5\u53caDQB1\u670946\u4e2a\uff0c\u662f\u4e2d\u56fd\u6700\u6743\u5a01\u7684HLA\u9ad8\u5206\u8fa8\u7387\u5206\u578b\u6570\u636e\u5e93\u3002","title":"HLA\u5206\u578b\u65b9\u6cd5"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/","text":"[toc] \u57fa\u56e0\uff0c\u4f4d\u4e8e6\u53f7\u67d3\u8272\u4f53\u4e0a\u77ed\u81c2\u4e0a\uff0c\u957f\u7ea64000Kb\u3002\u662f\u76ee\u524d\u6240\u77e5\u4eba\u4f53\u6700\u590d\u6742\u7684\u9057\u4f20\u591a\u6001\u6027\u7cfb\u7edf\uff0c\u6709\u51e0\u5341\u4e2a\u57fa\u56e0\u5ea7\u4f4d\uff0c\u6bcf\u4e2a\u57fa\u56e0\u5ea7\u4f4d\u53c8\u6709\u51e0\u5341\u4e2a\u7b49\u4f4d\u57fa\u56e0\uff0c\u4e14\u5448\u5171\u663e\u6027\u8868\u8fbe\u3002\u7531\u4e8eMHC\u57fa\u56e0\u4f4d\u4e8e\u540c\u4e00\u6761\u67d3\u8272\u4f53\u4e0a\uff0c\u5176\u591a\u57fa\u56e0\u5ea7\u4f4d\u4e0a\u7684\u57fa\u56e0\u578b\u7ec4\u5408\u76f8\u5bf9\u7a33\u5b9a\uff0c\u5f88\u5c11\u53d1\u751f\u540c\u6e90\u67d3\u8272\u4f53\u95f4\u4ea4\u6362\uff0c\u8fd9\u5c31\u6784\u6210\u4e86\u4ee5\u5355\u5143\u578b\uff08HAPLOTYPE\uff0c\u5373\u5728\u540c\u4e00\u6761\u67d3\u8272\u4f53\u4e0a\u7d27\u5bc6\u8fde\u9501\u7684\u4e00\u7cfb\u5217\u7b49\u4f4d\u57fa\u56e0\u7684\u7279\u6b8a\u7ec4\u5408\uff09\u4e3a\u7279\u5f81\u7684\u9057\u4f20\u3002\u6309\u4e2d\u56fd\u4eba\u5e38\u89c1\u7684A\u5ea7\u4f4d\u57fa\u56e0\u670913\u4e2a\uff0cB\u5ea7\u4f4d\u57fa\u56e0\u670930\u4e2a\u8ba1\u7b97\uff0c\u53ef\u7ec4\u6210\u7684\u5355\u5143\u578b\u7ea6\u670913\u00d730\uff1d390\u79cd\u4e4b\u591a\u3002 https://www.nature.com/articles/nbt.3344 LOH https://bitbucket.org/mcgranahanlab/loh https://mp.weixin.qq.com/s/IgdAyckTTUeVMCUNUxrbww Install conda install -c bioconda jellyfish conda install -c conda-forge jellyfish /lustre/Work/zhangbo/software/Anaconda3/envs/loh/bin/Rscript /lustre/Work/zhangbo/tmp/exon_more//loh/loh/LOHscript.R \\ --patientId example \\ --outputDir output \\ --Path /lustre/Work/zhangbo/tmp/exon_more//loh/loh/example-file/s \\ --fastaLoc /lustre/Work/zhangbo/tmp/exon_more//loh/loh/data/example.patient.Fasta.fa \\ --exonLoc /lustre/Work/zhangbo/tmp/exon_more//loh/loh/data/.dat \\ --CopyNumLoc /lustre/Work/zhangbo/tmp/exon_more//loh/loh/example-file/solutions.txt reporter Beside -A,B,C, DRB1, DQB1 etc I would like to analyse DRA and KIR(KIR3DL1) genes. pyloa https://github.com/felixfan/Py -HD version: v1.2.0.1 depth: 133x \u5b98\u7f51\u5730\u5740\uff1ahttps://www.genome.med.kyoto-u.ac.jp/-HD/ Install # bowtie2 axel https://github.com/BenLangmead/bowtie2/releases/download/v2.3.4.2/bowtie2-2.3.4.2-linux-x86_64.zip # https://www.genome.med.kyoto-u.ac.jp/-HD/ # update.dictionary.sh Running /lustre/Work/zhangbo/software/hd.1.2.0.1/bin/hd.sh \\ -t 6 \\ -m 100 \\ -c 0.95 \\ -f /lustre/Work/zhangbo/software/hd.1.2.0.1/freq_data/ \\ $fastq_1 $fastq_2 \\ /lustre/Work/zhangbo/software/hd.1.2.0.1/_gene.split.txt \\ /lustre/Work/zhangbo/software/hd.1.2.0.1/dictionary/ \\ $sampleid \\ output_dir snp2 https://jiawen.zd200572.com/431.html https://jiawen.zd200572.com/123.html http://www.bioconductor.org/packages/devel/bioc/html/HIBAG.html scan https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-017-1671-3 scan v2 uses Suffix Array (SA) method instead of BWA-mem for alignment with IMGT/ Database. x https://github.com/humanlongevity/ \u5bf9A\u3001B\u3001C\u3001DPB1\u3001DRB1\u8fdb\u884c\u5206\u578b\u3002 attes https://github.com/cliu32/attes Athlon -HD \u53ef\u4ee5\u5bf9classI\u3001ClassII\u3001ClassIII\u5168\u90e8\u8fdb\u884c\u5206\u578b\u3002 https://www.genome.med.kyoto-u.ac.jp/-HD/ Optitype miner http://www.bcgsc.ca/platform/bioinfo/software/miner POLYSOLVER https://software.broadinstitute.org/cancer/cga/polysolver https://github.com/jason-weirather/-polysolver https://github.com/researchapps/polysolver seq2 RNA-Seq https://bitbucket.org/sebastian_boegel/seq2 https://genomemedicine.biomedcentral.com/articles/10.1186/gm403 wget https://bitbucket.org/sebastian_boegel/seq2/get/seq2_v2.2.tar.gz tar -zxvf seq2_v2.2.tar.gz PT https://bmcgenomics.biomedcentral.com/articles/10.1186/1471-2164-15-325 -VBSeq http://nagasakilab.csml.org// Allelelist.txt: ftp://ftp.ebi.ac.uk/pub/databases/ipd/imgt//Allelelist.txt _all.fasta: ftp://ftp.ebi.ac.uk/pub/databases/ipd/imgt//fasta/*gen.fasta https://www.zd200572.com/2017/09/10/x/ https://github.com/uci-cbcl/-bind https://github.com/mskcc/loh https://github.com/humanlongevity/ http://fred-2.github.io/ https://github.com/FRED-2/OptiType https://github.com/NCBI-Hackathons/HLAClustRView","title":"010 HLA"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#loh","text":"https://bitbucket.org/mcgranahanlab/loh https://mp.weixin.qq.com/s/IgdAyckTTUeVMCUNUxrbww","title":"LOH"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#install","text":"conda install -c bioconda jellyfish conda install -c conda-forge jellyfish","title":"Install"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#_1","text":"/lustre/Work/zhangbo/software/Anaconda3/envs/loh/bin/Rscript /lustre/Work/zhangbo/tmp/exon_more//loh/loh/LOHscript.R \\ --patientId example \\ --outputDir output \\ --Path /lustre/Work/zhangbo/tmp/exon_more//loh/loh/example-file/s \\ --fastaLoc /lustre/Work/zhangbo/tmp/exon_more//loh/loh/data/example.patient.Fasta.fa \\ --exonLoc /lustre/Work/zhangbo/tmp/exon_more//loh/loh/data/.dat \\ --CopyNumLoc /lustre/Work/zhangbo/tmp/exon_more//loh/loh/example-file/solutions.txt","title":""},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#reporter","text":"Beside -A,B,C, DRB1, DQB1 etc I would like to analyse DRA and KIR(KIR3DL1) genes.","title":"reporter"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#pyloa","text":"https://github.com/felixfan/Py","title":"pyloa"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#-hd","text":"version: v1.2.0.1 depth: 133x \u5b98\u7f51\u5730\u5740\uff1ahttps://www.genome.med.kyoto-u.ac.jp/-HD/","title":"-HD"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#install_1","text":"# bowtie2 axel https://github.com/BenLangmead/bowtie2/releases/download/v2.3.4.2/bowtie2-2.3.4.2-linux-x86_64.zip # https://www.genome.med.kyoto-u.ac.jp/-HD/ # update.dictionary.sh","title":"Install"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#running","text":"/lustre/Work/zhangbo/software/hd.1.2.0.1/bin/hd.sh \\ -t 6 \\ -m 100 \\ -c 0.95 \\ -f /lustre/Work/zhangbo/software/hd.1.2.0.1/freq_data/ \\ $fastq_1 $fastq_2 \\ /lustre/Work/zhangbo/software/hd.1.2.0.1/_gene.split.txt \\ /lustre/Work/zhangbo/software/hd.1.2.0.1/dictionary/ \\ $sampleid \\ output_dir","title":"Running"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#_2","text":"","title":""},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#snp2","text":"https://jiawen.zd200572.com/431.html https://jiawen.zd200572.com/123.html http://www.bioconductor.org/packages/devel/bioc/html/HIBAG.html","title":"snp2"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#scan","text":"https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-017-1671-3 scan v2 uses Suffix Array (SA) method instead of BWA-mem for alignment with IMGT/ Database.","title":"scan"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#x","text":"https://github.com/humanlongevity/ \u5bf9A\u3001B\u3001C\u3001DPB1\u3001DRB1\u8fdb\u884c\u5206\u578b\u3002","title":"x"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#attes","text":"https://github.com/cliu32/attes","title":"attes"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#athlon","text":"","title":"Athlon"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#-hd_1","text":"\u53ef\u4ee5\u5bf9classI\u3001ClassII\u3001ClassIII\u5168\u90e8\u8fdb\u884c\u5206\u578b\u3002 https://www.genome.med.kyoto-u.ac.jp/-HD/","title":"-HD"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#optitype","text":"","title":"Optitype"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#miner","text":"http://www.bcgsc.ca/platform/bioinfo/software/miner","title":"miner"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#polysolver","text":"https://software.broadinstitute.org/cancer/cga/polysolver https://github.com/jason-weirather/-polysolver https://github.com/researchapps/polysolver","title":"POLYSOLVER"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#seq2","text":"RNA-Seq https://bitbucket.org/sebastian_boegel/seq2 https://genomemedicine.biomedcentral.com/articles/10.1186/gm403 wget https://bitbucket.org/sebastian_boegel/seq2/get/seq2_v2.2.tar.gz tar -zxvf seq2_v2.2.tar.gz","title":"seq2"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#pt","text":"https://bmcgenomics.biomedcentral.com/articles/10.1186/1471-2164-15-325","title":"PT"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#-vbseq","text":"http://nagasakilab.csml.org// Allelelist.txt: ftp://ftp.ebi.ac.uk/pub/databases/ipd/imgt//Allelelist.txt _all.fasta: ftp://ftp.ebi.ac.uk/pub/databases/ipd/imgt//fasta/*gen.fasta https://www.zd200572.com/2017/09/10/x/","title":"-VBSeq"},{"location":"08_DNA/05_somatic/010_HLA/010_HLA/#httpsgithubcomuci-cbcl-bind","text":"https://github.com/mskcc/loh https://github.com/humanlongevity/ http://fred-2.github.io/ https://github.com/FRED-2/OptiType https://github.com/NCBI-Hackathons/HLAClustRView","title":"https://github.com/uci-cbcl/-bind"},{"location":"08_DNA/05_somatic/010_HLA/010_seq2HLA/","text":"http://hla.alleles.org/nomenclature/index.html http://web.illumina.com.cn/landing/documents/product_introduction/informatics/ngs-immuno-oncology-tech-note-1170-2016-013-chs-v5-web.pdf?backurl=http://web.illumina.com.cn/landing/products_view.asp?newsid=86 http://tron-mainz.de/tron-facilities/computational-medicine/seq2hla/ http://tron-mainz.de/tron-facilities/computational-medicine/seq2hla/ http://blogs.biomedcentral.com/bmcblog/2013/01/03/reverting-to-type/","title":"010 seq2HLA"},{"location":"08_DNA/05_somatic/011_NIPT/00/","text":"NIPT\u5373\u975e\u4fb5\u5165\u6027\u4ea7\u524d\u68c0\u6d4b\uff0c\u9002\u7528\u4e8e\u68c0\u6d4b21\u300118\u300113\u53f7\u67d3\u8272\u4f53\u7684\u4e09\u4f53\u7efc\u5408\u5f81\u3002\u5b9e\u9645\u4e0a\uff0cNIPT\u7684\u5206\u6790\u6d41\u7a0b\u4e0eCNV\u7684\u5206\u6790\u6d41\u7a0b\u76f8\u4f3c\u3002\u4e3b\u8981\u7684\u5206\u6790\u6d41\u7a0b\u662f\u5148\u5f97\u5230\u552f\u4e00\u6bd4\u5bf9\u7684reads\uff0c\u518d\u63d0\u53d6\u6bcf\u6761\u67d3\u8272\u4f53\u7684reads\u6765\u505a\u4e00\u4e2aZ\u68c0\u9a8c\u5f97\u5230Z\u503c\uff0c\u56e0\u4e3aZ\u503c\u5728[-3, 3]\u8fd9\u4e2a\u8303\u56f4\u7684\u7edf\u8ba1\u5b66\u610f\u4e49\u4e0a\u662f\u5360\u4e8699%\uff0c\u56e0\u6b64\u8ba4\u4e3a\u8d85\u51fa\u8fd9\u4e2a\u8303\u56f4\u65f6\u5c31\u662f\u9633\u6027\u3002 https://www.ncbi.nlm.nih.gov/bioproject/PRJNA400134 https://pzweuj.github.io/2019/03/20/NIPT.html https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3130771/ https://github.com/VUmcCGP/wisecondor https://github.com/VUmcCGP/wisecondor/tree/legacy https://academic.oup.com/nar/article/42/5/e31/1063962 https://github.com/VUmcCGP/sanefalcon https://www.linkedin.com/in/rstraver","title":"00"},{"location":"08_DNA/05_somatic/012_mutation_sig/00_%E7%AE%80%E4%BB%8B/","text":"\u6982\u5ff5 \u80cc\u666f\u4ecb\u7ecd \u6982\u5ff5 \u80cc\u666f\u4ecb\u7ecd \u7ec6\u80de\u7684\u57fa\u56e0\u7ec4\u4e0d\u65ad\u53d7\u5230\u5185\u6e90\u6027\u548c\u73af\u5883\u6027dna\u635f\u4f24\u7684\u5a01\u80c1\uff0c\u4f8b\u5982\u7d2b\u5916\u7ebf\u548c\u81ea\u53d1\u53cd\u5e94\u3002\u4e3a\u4e86\u7ef4\u62a4\u5b83\u4eec\u7684\u57fa\u56e0\u7ec4\u5b8c\u6574\u6027\uff0c\u7ec6\u80de\u5229\u7528\u5404\u79cd\u673a\u5236\u4fee\u590d\u53d7\u635f\u7684dna\u3002\u65e0\u8bba\u662f\u5728\u590d\u5236\u4e4b\u524d\u4e0d\u6b63\u786e\u5730\u4fee\u590d\u8fd8\u662f\u672a\u4fee\u590d\uff0c\u8fd9\u4e9b\u90fd\u4f1a\u5bfc\u81f4\u7a81\u53d8\u88ab\u6574\u5408\u5230\u57fa\u56e0\u7ec4\u4e2d\u3002\u6bcf\u4e00\u4e2a\u7a81\u53d8\u8fc7\u7a0b\u90fd\u4f1a\u7559\u4e0b\u4e00\u4e2a\u4e0d\u540c\u7684\u57fa\u56e0\u7ec4\u6807\u8bb0\u3002\u4f8b\u5982\uff0c\u7d2b\u5916\u5149\u4f18\u5148\u8bf1\u5bfccc>tt\u3002\u4e8c\u6838\u82f7\u9178\u66ff\u6362\uff0c\u800c5-\u7532\u57fa\u80de\u5627\u5576\u7684\u81ea\u53d1\u8131\u6c28\u5bfc\u81f4cpg\u4f4d\u70b9\u7684c>t\u53d6\u4ee3\uff0c\u56e0\u6b64\uff0c\u7a81\u53d8\u6a21\u5f0f\u53ef\u4ee5\u7528\u6765\u63a8\u65ad\u54ea\u4e9b\u53d8\u5f02\u3002 \u5728\u8fc7\u53bb\u7684\u51e0\u5e74\u91cc\uff0c\u5bf9\u4e0d\u540c\u4eba\u7c7b\u764c\u75c7\u7c7b\u578b\u7684\u80bf\u7624\u57fa\u56e0\u7ec4\u6570\u636e\u7684\u5927\u89c4\u6a21\u5206\u6790\u63ed\u793a\u4e8630\u79cd\u7a81\u53d8\u6a21\u5f0f\uff0c\u8fd9\u4e9b\u6240\u8c13\u7684\u201c\u7a81\u53d8\u4fe1\u53f7\u201d\u7684\u7279\u5f81\u662f\u78b1\u57fa\u66ff\u4ee3\u7c7b\u578b\u7684\u7279\u5b9a\u8d21\u732e\u3002\u5728\u4e00\u5b9a\u7684\u5e8f\u5217\u80cc\u666f\u4e0b\uff0c\u6bcf\u4e2a\u7a81\u53d8\u7279\u5f81\u88ab\u8ba4\u4e3a\u53cd\u6620\u4e86\u5355\u4e00\u7684\u7a81\u53d8\u673a\u5236\u3002\u7136\u800c\uff0c\u5927\u591a\u6570\u7a81\u53d8\u7279\u5f81\u7684\u75c5\u56e0\u76ee\u524d\u5c1a\u4e0d\u6e05\u695a\u3002\u4e3a\u4e86\u5728\u529f\u80fd\u4e0a\u5c06\u7a81\u53d8\u7279\u5f81\u4e0e\u751f\u7269\u8fc7\u7a0b\u8054\u7cfb\u8d77\u6765\uff0c\u8bc4\u4f30\u8fd9\u4e9b\u7a81\u53d8\u7279\u5f81\u5728\u66b4\u9732\u4e8e\u7279\u5b9a\u8bf1\u53d8\u5242\u6216\u7ec6\u80de\u7684\u7ec6\u80de\u4e2d\u7684\u8d21\u732e\u3002 https://www.nature.com/articles/nature12477 https://cancer.sanger.ac.uk/cosmic/signatures \u80bf\u7624\u7a81\u53d8\u9891\u8c31\u9488\u5bf9\u70b9\u7a81\u53d8\u8fdb\u884c\u5b9a\u4e49\uff0cA,T,C,G\u56db\u79cd\u78b1\u57fa\u4e24\u4e24\u7a81\u53d8\uff0c\u5171\u67094X3=12\u79cd\u6392\u5217\uff0c\u8003\u8651\u5230\u6b63\u8d1f\u94fe\u78b1\u57fa\u914d\u5bf9\u539f\u5219\uff0c\u6b63\u94fe\u4e0a\u7684A->C\u7a81\u53d8\uff0c\u5bf9\u5e94\u8d1f\u94fe\u4e0a\u4e3aT->G, \u6240\u4ee5\u8fdb\u4e00\u6b65\u8f6c\u6362\u6210\u4e86\u4e00\u4e2a\u7ec4\u5408\u7684\u95ee\u9898\uff0c\u6240\u4ee5\u67d0\u4e2a\u4f4d\u70b9\u7684\u7a81\u53d8\u53ef\u4ee5\u5212\u5206\u4e3a\u4ee5\u4e0b6\u79cd\u6a21\u5f0f C>A, \u8868\u793aC>A\u548cG>T\u4e24\u79cd C>G, \u8868\u793aC>G\u548cG>C\u4e24\u79cd C>T, \u8868\u793aC>T\u548cG>A\u4e24\u79cd T>A, \u8868\u793aT>A\u548cA>T\u4e24\u79cd T>C, \u8868\u793aT>C\u548cA>G\u4e24\u79cd T>G, \u8868\u793aT>G\u548cA>C\u4e24\u79cd \u8fdb\u4e00\u6b65\u8003\u8651\u7a81\u53d8\u4f4d\u70b9\u6240\u5904\u7684\u5e8f\u5217\u4e0a\u4e0b\u6587\u73af\u5883\uff0c\u5373\u4e0a\u4e0b\u6e38\u5404\u53d6\u4e00\u4e2a\u78b1\u57fa\u518d\u52a0\u4e0a\u7a81\u53d8\u4f4d\u70b9\u7684\u78b1\u57fa\uff0c\u7ec4\u6210\u4e863\u4e2a\u78b1\u57fa\u7684motif, \u53ef\u4ee5\u67094X4X6=96\u79cd\u6a21\u5f0f\uff0c\u6bcf\u79cd\u6a21\u5f0f\u7684\u9891\u7387\u5206\u5e03\u5c31\u662f\u7a81\u53d8\u9891\u8c31\u3002\u7a81\u53d8\u9891\u8c31\u53ef\u4ee5\u5f53\u505a\u4e00\u4e2a\u80bf\u7624\u6837\u672c\u7684\u7279\u5f81\uff0c\u8fdb\u884c\u6837\u672c\u95f4\u7684\u6bd4\u8f83\u3002 \u4e3a\u4ec0\u4e48\u662f\u516d\u7c7b\uff1f \u4ee5A:T>C:G\u4e3a\u4f8b\uff0c\u6b64\u79cd\u7c7b\u578bSNP\u7a81\u53d8\u5305\u62ecA>C\u548cT>G\u3002\u7531\u4e8e\u6d4b\u5e8f\u6570\u636e\u65e2\u53ef\u6bd4\u5bf9\u5230\u53c2\u8003\u57fa\u56e0\u7ec4\u7684\u6b63\u94fe\uff0c\u4e5f\u53ef\u6bd4\u5bf9\u5230\u53c2\u8003\u57fa\u56e0\u7ec4\u7684\u8d1f\u94fe\uff0c\u5f53T>C\u7c7b\u578b\u7a81\u53d8\u51fa\u73b0\u5728\u53c2\u8003\u57fa\u56e0\u7ec4\u6b63\u94fe\u4e0a\uff0cA>G\u7c7b\u578b\u7a81\u53d8\u5373\u5728\u53c2\u8003\u57fa\u56e0\u7ec4\u8d1f\u94fe\u7684\u76f8\u540c\u4f4d\u7f6e\uff0c\u6240\u4ee5\u5c06T>C\u548cA>G\u5212\u5206\u6210\u4e00\u7c7b,\u6362\u53e5\u8bdd\u8bf4\u6211\u4eec\u53ea\u8003\u8651\u6b63\u94fe\u7684\u7a81\u53d8\u5f62\u5f0f\uff0c\u53c2\u8003\u78b1\u57fa\u53ea\u5141\u8bb8\u6709C\u6216\u8005T\uff0c\u56e0\u4e3a\u5b83\u4eec\u7b49\u4ef7\u4e8eG\u6216\u8005A\u3002\u6240\u4ee5\u5168\u57fa\u56e0\u7ec4SNP\u7a81\u53d8\u53ef\u4ee5\u5206\u6210\u8fd96\u7c7b\u3002 \u4e0d\u540c\u7684\u7a81\u53d8\u539f\u56e0\u4f1a\u4ea7\u751f\u72ec\u7279\u7684\u7a81\u53d8\u7c7b\u578b\u7ec4\u5408\uff0c\u79f0\u4e3aMutations Signature\u3002 \u6bcf\u4e00\u79cd\u7a81\u53d8\u7279\u5f81\u53cd\u6620\u4e86\u4e00\u79cd\u80bf\u7624\u4f53\u7ec6\u80de\u7a81\u53d8\u7684\u7269\u7406\u3001\u5316\u5b66\u6216\u751f\u7269\u8fc7\u7a0b\u3002 https://m.chuansongme.com/n/3076687853030 \u4e0d\u540c\u7684\u7279\u5f81\u6709\u4e0d\u540c\u7684\u751f\u7269\u5b66\u542b\u4e49\uff0chttps://en.wikipedia.org/wiki/Mutational_signatures \u6bd4\u5982\u6587\u7ae0 https://www.nature.com/articles/s41586-019-1056-z \u91cc\u9762\uff0c\u5c31\u662f\u4f7f\u7528\u4e86 \u8fd9\u4e9bsignature\u533a\u5206\u751f\u5b58\uff01 \u975e\u8d1f\u77e9\u9635\u5206\u89e3\u8fd9\u4e2a\u7b97\u6cd5\u5f97\u5230signature\u5177\u4f53\u9700\u8981\u770b\u6587\u732e\uff1b + https://cancer.sanger.ac.uk/cosmic/signatures + https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6001047/ + https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5753213/ https://software.broadinstitute.org/cancer/cga/msp","title":"00 \u7b80\u4ecb"},{"location":"08_DNA/05_somatic/012_mutation_sig/00_%E7%AE%80%E4%BB%8B/#_1","text":"","title":"\u6982\u5ff5"},{"location":"08_DNA/05_somatic/012_mutation_sig/00_%E7%AE%80%E4%BB%8B/#_2","text":"\u7ec6\u80de\u7684\u57fa\u56e0\u7ec4\u4e0d\u65ad\u53d7\u5230\u5185\u6e90\u6027\u548c\u73af\u5883\u6027dna\u635f\u4f24\u7684\u5a01\u80c1\uff0c\u4f8b\u5982\u7d2b\u5916\u7ebf\u548c\u81ea\u53d1\u53cd\u5e94\u3002\u4e3a\u4e86\u7ef4\u62a4\u5b83\u4eec\u7684\u57fa\u56e0\u7ec4\u5b8c\u6574\u6027\uff0c\u7ec6\u80de\u5229\u7528\u5404\u79cd\u673a\u5236\u4fee\u590d\u53d7\u635f\u7684dna\u3002\u65e0\u8bba\u662f\u5728\u590d\u5236\u4e4b\u524d\u4e0d\u6b63\u786e\u5730\u4fee\u590d\u8fd8\u662f\u672a\u4fee\u590d\uff0c\u8fd9\u4e9b\u90fd\u4f1a\u5bfc\u81f4\u7a81\u53d8\u88ab\u6574\u5408\u5230\u57fa\u56e0\u7ec4\u4e2d\u3002\u6bcf\u4e00\u4e2a\u7a81\u53d8\u8fc7\u7a0b\u90fd\u4f1a\u7559\u4e0b\u4e00\u4e2a\u4e0d\u540c\u7684\u57fa\u56e0\u7ec4\u6807\u8bb0\u3002\u4f8b\u5982\uff0c\u7d2b\u5916\u5149\u4f18\u5148\u8bf1\u5bfccc>tt\u3002\u4e8c\u6838\u82f7\u9178\u66ff\u6362\uff0c\u800c5-\u7532\u57fa\u80de\u5627\u5576\u7684\u81ea\u53d1\u8131\u6c28\u5bfc\u81f4cpg\u4f4d\u70b9\u7684c>t\u53d6\u4ee3\uff0c\u56e0\u6b64\uff0c\u7a81\u53d8\u6a21\u5f0f\u53ef\u4ee5\u7528\u6765\u63a8\u65ad\u54ea\u4e9b\u53d8\u5f02\u3002 \u5728\u8fc7\u53bb\u7684\u51e0\u5e74\u91cc\uff0c\u5bf9\u4e0d\u540c\u4eba\u7c7b\u764c\u75c7\u7c7b\u578b\u7684\u80bf\u7624\u57fa\u56e0\u7ec4\u6570\u636e\u7684\u5927\u89c4\u6a21\u5206\u6790\u63ed\u793a\u4e8630\u79cd\u7a81\u53d8\u6a21\u5f0f\uff0c\u8fd9\u4e9b\u6240\u8c13\u7684\u201c\u7a81\u53d8\u4fe1\u53f7\u201d\u7684\u7279\u5f81\u662f\u78b1\u57fa\u66ff\u4ee3\u7c7b\u578b\u7684\u7279\u5b9a\u8d21\u732e\u3002\u5728\u4e00\u5b9a\u7684\u5e8f\u5217\u80cc\u666f\u4e0b\uff0c\u6bcf\u4e2a\u7a81\u53d8\u7279\u5f81\u88ab\u8ba4\u4e3a\u53cd\u6620\u4e86\u5355\u4e00\u7684\u7a81\u53d8\u673a\u5236\u3002\u7136\u800c\uff0c\u5927\u591a\u6570\u7a81\u53d8\u7279\u5f81\u7684\u75c5\u56e0\u76ee\u524d\u5c1a\u4e0d\u6e05\u695a\u3002\u4e3a\u4e86\u5728\u529f\u80fd\u4e0a\u5c06\u7a81\u53d8\u7279\u5f81\u4e0e\u751f\u7269\u8fc7\u7a0b\u8054\u7cfb\u8d77\u6765\uff0c\u8bc4\u4f30\u8fd9\u4e9b\u7a81\u53d8\u7279\u5f81\u5728\u66b4\u9732\u4e8e\u7279\u5b9a\u8bf1\u53d8\u5242\u6216\u7ec6\u80de\u7684\u7ec6\u80de\u4e2d\u7684\u8d21\u732e\u3002 https://www.nature.com/articles/nature12477 https://cancer.sanger.ac.uk/cosmic/signatures \u80bf\u7624\u7a81\u53d8\u9891\u8c31\u9488\u5bf9\u70b9\u7a81\u53d8\u8fdb\u884c\u5b9a\u4e49\uff0cA,T,C,G\u56db\u79cd\u78b1\u57fa\u4e24\u4e24\u7a81\u53d8\uff0c\u5171\u67094X3=12\u79cd\u6392\u5217\uff0c\u8003\u8651\u5230\u6b63\u8d1f\u94fe\u78b1\u57fa\u914d\u5bf9\u539f\u5219\uff0c\u6b63\u94fe\u4e0a\u7684A->C\u7a81\u53d8\uff0c\u5bf9\u5e94\u8d1f\u94fe\u4e0a\u4e3aT->G, \u6240\u4ee5\u8fdb\u4e00\u6b65\u8f6c\u6362\u6210\u4e86\u4e00\u4e2a\u7ec4\u5408\u7684\u95ee\u9898\uff0c\u6240\u4ee5\u67d0\u4e2a\u4f4d\u70b9\u7684\u7a81\u53d8\u53ef\u4ee5\u5212\u5206\u4e3a\u4ee5\u4e0b6\u79cd\u6a21\u5f0f C>A, \u8868\u793aC>A\u548cG>T\u4e24\u79cd C>G, \u8868\u793aC>G\u548cG>C\u4e24\u79cd C>T, \u8868\u793aC>T\u548cG>A\u4e24\u79cd T>A, \u8868\u793aT>A\u548cA>T\u4e24\u79cd T>C, \u8868\u793aT>C\u548cA>G\u4e24\u79cd T>G, \u8868\u793aT>G\u548cA>C\u4e24\u79cd \u8fdb\u4e00\u6b65\u8003\u8651\u7a81\u53d8\u4f4d\u70b9\u6240\u5904\u7684\u5e8f\u5217\u4e0a\u4e0b\u6587\u73af\u5883\uff0c\u5373\u4e0a\u4e0b\u6e38\u5404\u53d6\u4e00\u4e2a\u78b1\u57fa\u518d\u52a0\u4e0a\u7a81\u53d8\u4f4d\u70b9\u7684\u78b1\u57fa\uff0c\u7ec4\u6210\u4e863\u4e2a\u78b1\u57fa\u7684motif, \u53ef\u4ee5\u67094X4X6=96\u79cd\u6a21\u5f0f\uff0c\u6bcf\u79cd\u6a21\u5f0f\u7684\u9891\u7387\u5206\u5e03\u5c31\u662f\u7a81\u53d8\u9891\u8c31\u3002\u7a81\u53d8\u9891\u8c31\u53ef\u4ee5\u5f53\u505a\u4e00\u4e2a\u80bf\u7624\u6837\u672c\u7684\u7279\u5f81\uff0c\u8fdb\u884c\u6837\u672c\u95f4\u7684\u6bd4\u8f83\u3002 \u4e3a\u4ec0\u4e48\u662f\u516d\u7c7b\uff1f \u4ee5A:T>C:G\u4e3a\u4f8b\uff0c\u6b64\u79cd\u7c7b\u578bSNP\u7a81\u53d8\u5305\u62ecA>C\u548cT>G\u3002\u7531\u4e8e\u6d4b\u5e8f\u6570\u636e\u65e2\u53ef\u6bd4\u5bf9\u5230\u53c2\u8003\u57fa\u56e0\u7ec4\u7684\u6b63\u94fe\uff0c\u4e5f\u53ef\u6bd4\u5bf9\u5230\u53c2\u8003\u57fa\u56e0\u7ec4\u7684\u8d1f\u94fe\uff0c\u5f53T>C\u7c7b\u578b\u7a81\u53d8\u51fa\u73b0\u5728\u53c2\u8003\u57fa\u56e0\u7ec4\u6b63\u94fe\u4e0a\uff0cA>G\u7c7b\u578b\u7a81\u53d8\u5373\u5728\u53c2\u8003\u57fa\u56e0\u7ec4\u8d1f\u94fe\u7684\u76f8\u540c\u4f4d\u7f6e\uff0c\u6240\u4ee5\u5c06T>C\u548cA>G\u5212\u5206\u6210\u4e00\u7c7b,\u6362\u53e5\u8bdd\u8bf4\u6211\u4eec\u53ea\u8003\u8651\u6b63\u94fe\u7684\u7a81\u53d8\u5f62\u5f0f\uff0c\u53c2\u8003\u78b1\u57fa\u53ea\u5141\u8bb8\u6709C\u6216\u8005T\uff0c\u56e0\u4e3a\u5b83\u4eec\u7b49\u4ef7\u4e8eG\u6216\u8005A\u3002\u6240\u4ee5\u5168\u57fa\u56e0\u7ec4SNP\u7a81\u53d8\u53ef\u4ee5\u5206\u6210\u8fd96\u7c7b\u3002 \u4e0d\u540c\u7684\u7a81\u53d8\u539f\u56e0\u4f1a\u4ea7\u751f\u72ec\u7279\u7684\u7a81\u53d8\u7c7b\u578b\u7ec4\u5408\uff0c\u79f0\u4e3aMutations Signature\u3002 \u6bcf\u4e00\u79cd\u7a81\u53d8\u7279\u5f81\u53cd\u6620\u4e86\u4e00\u79cd\u80bf\u7624\u4f53\u7ec6\u80de\u7a81\u53d8\u7684\u7269\u7406\u3001\u5316\u5b66\u6216\u751f\u7269\u8fc7\u7a0b\u3002 https://m.chuansongme.com/n/3076687853030 \u4e0d\u540c\u7684\u7279\u5f81\u6709\u4e0d\u540c\u7684\u751f\u7269\u5b66\u542b\u4e49\uff0chttps://en.wikipedia.org/wiki/Mutational_signatures \u6bd4\u5982\u6587\u7ae0 https://www.nature.com/articles/s41586-019-1056-z \u91cc\u9762\uff0c\u5c31\u662f\u4f7f\u7528\u4e86 \u8fd9\u4e9bsignature\u533a\u5206\u751f\u5b58\uff01 \u975e\u8d1f\u77e9\u9635\u5206\u89e3\u8fd9\u4e2a\u7b97\u6cd5\u5f97\u5230signature\u5177\u4f53\u9700\u8981\u770b\u6587\u732e\uff1b + https://cancer.sanger.ac.uk/cosmic/signatures + https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6001047/ + https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5753213/ https://software.broadinstitute.org/cancer/cga/msp","title":"\u80cc\u666f\u4ecb\u7ecd"},{"location":"08_DNA/05_somatic/012_mutation_sig/00_%E7%AE%80%E4%BB%8B/#_3","text":"","title":""},{"location":"08_DNA/05_somatic/012_mutation_sig/01_MutationalPattern/","text":"Mutational Pattern\u7684R\u5305\u63d0\u4f9b\u4e86\u4e00\u5957\u6613\u4e8e\u4f7f\u7528\u7684\u5de5\u5177\u96c6\uff0c\u7528\u4e8e\u5728\u80bf\u7624\u6837\u672c\u6216DNA\u4fee\u590d\u7f3a\u9677\u7ec6\u80de\u7684\u78b1\u57fa\u66ff\u6362\u76ee\u5f55\u4e2d\u63cf\u8ff0\u548c\u53ef\u89c6\u5316\u7a81\u53d8\u6a21\u5f0f\u3002\u8f6f\u4ef6\u5305\u6db5\u76d6\u5e7f\u6cdb\u7684\u6a21\u5f0f\uff0c\u5305\u62ec\uff1a\u7a81\u53d8\u7279\u5f81\u3001\u8f6c\u5f55\u94fe\u504f\u501a\u3001\u57fa\u56e0\u7ec4\u5206\u5e03\u548c\u4e0e\u57fa\u56e0\u7ec4\u7279\u5f81\u7684\u5173\u8054\uff0c\u8fd9\u5bf9\u4e8e\u7814\u7a76\u7a81\u53d8\u8fc7\u7a0b\u7684\u6d3b\u52a8\u5177\u6709\u5171\u540c\u7684\u610f\u4e49\u3002\u91cd\u65b0\u63d0\u53d6\u7a81\u53d8\u7279\u5f81\uff0c\u5e76\u63a8\u65ad\u5148\u524d\u8bc6\u522b\u7684\u7a81\u53d8\u7279\u5f81\u7684\u8d21\u732e\u3002 https://www.jianshu.com/p/1347a0ee74a0 https://bioconductor.org/packages/release/bioc/vignettes/MutationalPatterns/inst/doc/Introduction_to_MutationalPatterns.pdf 3.1 Base substitution types 3.2 Mutation spectrum \u7a81\u53d8\u9891\u8c31\u53cd\u6620\u4e86\u6bcf\u79cd\u7a81\u53d8\u5728\u5355\u78b1\u57fa\u5206\u7c7b\u7684\u76f8\u5bf9\u8d21\u732e\u3002 plot_spectrum 3.3 96 mutational profile","title":"01 MutationalPattern"},{"location":"08_DNA/05_somatic/012_mutation_sig/01_MutationalPattern/#31-base-substitution-types","text":"","title":"3.1 Base substitution types"},{"location":"08_DNA/05_somatic/012_mutation_sig/01_MutationalPattern/#32-mutation-spectrum","text":"\u7a81\u53d8\u9891\u8c31\u53cd\u6620\u4e86\u6bcf\u79cd\u7a81\u53d8\u5728\u5355\u78b1\u57fa\u5206\u7c7b\u7684\u76f8\u5bf9\u8d21\u732e\u3002 plot_spectrum","title":"3.2 Mutation spectrum"},{"location":"08_DNA/05_somatic/012_mutation_sig/01_MutationalPattern/#33-96-mutational-profile","text":"","title":"3.3 96 mutational profile"},{"location":"08_DNA/05_somatic/012_mutation_sig/01_MutationalPattern/#_1","text":"","title":""},{"location":"08_DNA/05_somatic/012_mutation_sig/02_SigProfilerMatrixGenerator/","text":"[toc] https://osf.io/s93d5/wiki/5.%20Output%20-%20DBS/ $ python3 >>from SigProfilerMatrixGenerator.scripts import SigProfilerMatrixGeneratorFunc as matGen >>matrices = matGen.SigProfilerMatrixGeneratorFunc(project, genome, vcfFiles, exome=False, bed_file=None, chrom_based=False, plot=False, tsb_stat=False, seqInfo=False) output SBS: Single Base Substitution \u5355\u78b1\u57fa\u53d6\u4ee3\uff08SBS\uff09\u7684\u5206\u7c7b\u3002 SBS\u7684\u5b8c\u6574\u5206\u7c7b\u5305\u62ecWatson-Crick\u78b1\u57fa\u5bf9\u4e2d\u7684\u4e24\u4e2a\u78b1\u57fa\u3002 \u4e3a\u4e86\u7b80\u5316\u6b64\u8868\u793a\u6cd5\uff0c\u53ef\u4ee5\u4f7f\u7528\u560c\u5464\u6216\u5627\u5576\u78b1\u3002 SigProfilerMatrixGenerator\u5c06\u5627\u5576\u5206\u7c7b\u7528\u4f5c\u6807\u51c6 File # of sequences test.DBS78.all 78 pyrimidine double nucleotide variants test.DBS186.all 36 dinucleotide combinations that have only all purines or all pyrimidines x 4 transcriptional bias categories = 144 + 42 classified in the Q transcriptional bias category = 186 test.DBS1248.all Possible starting nucleotides (4) x 78 x possible ending nucleotides (4)= 1,248 total combinations test.DBS2976.all Possible starting nucleotides (4) x 186 x possible ending nucleotides (4) = 2,976 DBS: Double Base Substitution DBS-78 Insertions and Deletions, Indels (ID) Transcriptional Strand Bias (TSB)","title":"02 SigProfilerMatrixGenerator"},{"location":"08_DNA/05_somatic/012_mutation_sig/02_SigProfilerMatrixGenerator/#output","text":"","title":"output"},{"location":"08_DNA/05_somatic/012_mutation_sig/02_SigProfilerMatrixGenerator/#sbs-single-base-substitution","text":"\u5355\u78b1\u57fa\u53d6\u4ee3\uff08SBS\uff09\u7684\u5206\u7c7b\u3002 SBS\u7684\u5b8c\u6574\u5206\u7c7b\u5305\u62ecWatson-Crick\u78b1\u57fa\u5bf9\u4e2d\u7684\u4e24\u4e2a\u78b1\u57fa\u3002 \u4e3a\u4e86\u7b80\u5316\u6b64\u8868\u793a\u6cd5\uff0c\u53ef\u4ee5\u4f7f\u7528\u560c\u5464\u6216\u5627\u5576\u78b1\u3002 SigProfilerMatrixGenerator\u5c06\u5627\u5576\u5206\u7c7b\u7528\u4f5c\u6807\u51c6","title":"SBS: Single Base Substitution"},{"location":"08_DNA/05_somatic/012_mutation_sig/02_SigProfilerMatrixGenerator/#_1","text":"File # of sequences test.DBS78.all 78 pyrimidine double nucleotide variants test.DBS186.all 36 dinucleotide combinations that have only all purines or all pyrimidines x 4 transcriptional bias categories = 144 + 42 classified in the Q transcriptional bias category = 186 test.DBS1248.all Possible starting nucleotides (4) x 78 x possible ending nucleotides (4)= 1,248 total combinations test.DBS2976.all Possible starting nucleotides (4) x 186 x possible ending nucleotides (4) = 2,976","title":""},{"location":"08_DNA/05_somatic/012_mutation_sig/02_SigProfilerMatrixGenerator/#dbs-double-base-substitution","text":"DBS-78","title":"DBS: Double Base Substitution"},{"location":"08_DNA/05_somatic/012_mutation_sig/02_SigProfilerMatrixGenerator/#insertions-and-deletions-indels-id","text":"","title":"Insertions and Deletions, Indels (ID)"},{"location":"08_DNA/05_somatic/012_mutation_sig/02_SigProfilerMatrixGenerator/#transcriptional-strand-bias-tsb","text":"","title":"Transcriptional Strand Bias (TSB)"},{"location":"08_DNA/05_somatic/012_mutation_sig/03_superFreq/","text":"However, read depth alone is not sufficient to provide information critical for interpreting cancer genomes, such as copy-neutral loss of heterozygosity (CN-LOH), tumor-normal admixture, and potential sample contamination.","title":"03 superFreq"},{"location":"08_DNA/05_somatic/012_mutation_sig/04_deconstructSigs/","text":"https://zhuanlan.zhihu.com/p/99537144 https://zhuanlan.zhihu.com/p/98446111","title":"04 deconstructSigs"},{"location":"08_DNA/05_somatic/013_mutation_spectrum/00/","text":"\u901a\u8fc7\u7a81\u53d8\u9891\u8c31\u5206\u6790\u6211\u4eec\u53ef\u4ee5\u5f97\u77e5\u5404\u4e2a\u80bf\u7624\u6837\u672c\u5404\u79cd\u7c7b\u578b\u7a81\u53d8\uff08\u5982C>A/G>T\uff09\u7684\u6570\u91cf\u53ca\u6837\u672c\u662f\u5426\u6709\u67d0\u79cd\u7c7b\u578b\u7a81\u53d8\u7684\u504f\u597d\u6027\uff1b\u901a\u8fc7\u5206\u6790\u4f53\u7ec6\u80de\u7a81\u53d8\u9891\u8c31\u53ca\u7a81\u53d8\u7279\u5f81\uff0c\u53ef\u4ee5\u7814\u7a76\u4e0d\u540c\u80bf\u7624\u79cd\u7684\u4f53\u7ec6\u80de\u70b9\u7a81\u53d8\u7279\u70b9\u3002","title":"00"},{"location":"08_DNA/05_somatic/014_fusion/000_%E7%BB%BC%E8%BF%B0/","text":"chimeraviz https://github.com/stianlagstad/chimeraviz https://github.com/FusionAnnotator https://fusionhub.persistent.co.in/ benchmark https://github.com/fusiontranscripts/FusionBenchmarking/wiki Simulated Fusion Data Sets Simulated chimeric transcripts were generated using custom scripts, developed and released as the Fusion Simulator Toolkit (https://FusionSimulatorToolkit.github.io). https://data.broadinstitute.org/Trinity/CTAT_FUSIONTRANS_BENCHMARKING/ Simulated Reads","title":"000 \u7efc\u8ff0"},{"location":"08_DNA/05_somatic/014_fusion/000_%E7%BB%BC%E8%BF%B0/#chimeraviz","text":"https://github.com/stianlagstad/chimeraviz https://github.com/FusionAnnotator https://fusionhub.persistent.co.in/","title":"chimeraviz"},{"location":"08_DNA/05_somatic/014_fusion/000_%E7%BB%BC%E8%BF%B0/#benchmark","text":"https://github.com/fusiontranscripts/FusionBenchmarking/wiki","title":"benchmark"},{"location":"08_DNA/05_somatic/014_fusion/000_%E7%BB%BC%E8%BF%B0/#simulated-fusion-data-sets","text":"Simulated chimeric transcripts were generated using custom scripts, developed and released as the Fusion Simulator Toolkit (https://FusionSimulatorToolkit.github.io). https://data.broadinstitute.org/Trinity/CTAT_FUSIONTRANS_BENCHMARKING/","title":"Simulated Fusion Data Sets"},{"location":"08_DNA/05_somatic/014_fusion/000_%E7%BB%BC%E8%BF%B0/#simulated-reads","text":"","title":"Simulated Reads"},{"location":"08_DNA/05_somatic/014_fusion/014_STARfusion/","text":"Data Resources Required https://data.broadinstitute.org/Trinity/CTAT_RESOURCE_LIB/ plug-n\u662f\u5df2\u7ecf\u5efa\u7acb\u597d\u7684reference lib, \u800csource\u91cc\u9762\u5305\u542b\u4e86\u6240\u9700\u7684\u539f\u59cb\u6587\u4ef6\u3002\u4ece\u539f\u59cb\u6587\u4ef6\u6784\u5efareference lib\u7684\u547d\u4ee4\u5982\u4e0b: tar xvf GRCh37_v19_CTAT_lib_Feb092018.source_data.tar.gz cd GRCh37_v19_CTAT_lib_Feb092018/ /local_data1/work/zhangbo/software/STAR-Fusion/FusionFilter/prep_genome_lib.pl \\ --genome_fa ref_genome.fa \\ --gtf ref_annot.gtf \\ -fusion_annot_lib CTAT_HumanFusionLib.v0.1.0.dat.gz \\ --annot_filter_rule AnnotFilterRule.pm \\ --pfam_db PFAM.domtblout.dat.gz http://note.youdao.com/noteshare?id=365f4e006571dab8d6b4e411eca81e57","title":"014 STARfusion"},{"location":"08_DNA/05_somatic/014_fusion/014_STARfusion/#data-resources-required","text":"https://data.broadinstitute.org/Trinity/CTAT_RESOURCE_LIB/ plug-n\u662f\u5df2\u7ecf\u5efa\u7acb\u597d\u7684reference lib, \u800csource\u91cc\u9762\u5305\u542b\u4e86\u6240\u9700\u7684\u539f\u59cb\u6587\u4ef6\u3002\u4ece\u539f\u59cb\u6587\u4ef6\u6784\u5efareference lib\u7684\u547d\u4ee4\u5982\u4e0b: tar xvf GRCh37_v19_CTAT_lib_Feb092018.source_data.tar.gz cd GRCh37_v19_CTAT_lib_Feb092018/ /local_data1/work/zhangbo/software/STAR-Fusion/FusionFilter/prep_genome_lib.pl \\ --genome_fa ref_genome.fa \\ --gtf ref_annot.gtf \\ -fusion_annot_lib CTAT_HumanFusionLib.v0.1.0.dat.gz \\ --annot_filter_rule AnnotFilterRule.pm \\ --pfam_db PFAM.domtblout.dat.gz http://note.youdao.com/noteshare?id=365f4e006571dab8d6b4e411eca81e57","title":"Data Resources Required"},{"location":"08_DNA/05_somatic/014_fusion/014_gFusion/","text":"https://www.researchgate.net/publication/318793554_GFusion_an_Effective_Algorithm_to_Identify_Fusion_Genes_from_Cancer_RNA-Seq_Data","title":"014 gFusion"},{"location":"08_DNA/05_somatic/016_%E5%85%8B%E9%9A%86%E8%BF%9B%E5%8C%96/00/","text":"https://www.yuque.com/biotrainee/wes/rrwrli","title":"00"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/","text":"VCF ID: some ID for the variant, if known (e.g., dbSNP) REF, ALT: reference and alternative alleles (on forward strand of reference) QUAL = -10*log(1-p), where p is the probability of variant being present given the read data FILTER: whether the variant failed a filter (filters defined by the user or program processing the file) GT (genotype): 0/0 reference homozygote 0/1 reference-alternative heterozygote 1/1 alternative homozygote 0/2, 1/2, 2/2, etc. - possible if more than one alternative allele present ./. missing data AD: allele depths DP: total depth (may be different from sum of AD depths, a the latter include only reads significantly supporting alleles) PL: genotype likelihoods (phred-scaled), normalized to the best genotype, e.g., PL(0/1) = -10*log[ Prob(data|0/1) / Prob(data|best_genotype) ] GQ: genotype quality \u2013 this is just PL of the second-best genotype QUAL\uff1a\u57fa\u4e8ePhred\u683c\u5f0f\u7684\u8868\u793aALT\u7684\u8d28\u91cf\uff0c\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a\u53ef\u9760\u6027\uff1b\u53ef\u4ee5\u7406\u89e3\u4e3a\u6240call\u51fa\u6765\u7684\u53d8\u5f02\u4f4d\u70b9\u7684\u8d28\u91cf\u503c\u3002Q=-10lgP\uff0cQ\u8868\u793a\u8d28\u91cf\u503c\uff1bP\u8868\u793a\u8fd9\u4e2a\u4f4d\u70b9\u53d1\u751f\u9519\u8bef\u7684\u6982\u7387\u3002\u56e0\u6b64\uff0c\u5982\u679c\u60f3\u628a\u9519\u8bef\u7387\u4ece\u63a7\u5236\u572890%\u4ee5\u4e0a\uff0cP\u7684\u9608\u503c\u5c31\u662f1/10\uff0c\u90a3lg\uff081/10\uff09=-1\uff0cQ=\uff08-10\uff09*\uff08-1\uff09=10\u3002\u540c\u7406\uff0c\u5f53Q=20\u65f6\uff0c\u9519\u8bef\u7387\u5c31\u63a7\u5236\u5728\u4e860.01\u3002\u8fd9\u4e2a\u53c2\u6570\u5176\u5b9e\u548cmpileup\u7684-Q\u662f\u91cd\u590d\u7684\u3002 MQ\u4e0d\u540c\u4e8eMAPQ\uff0c\u662fRMS Mapping Quality\uff0c\u516c\u5f0f\u5b9a\u4e49\u5982\u4e0b\uff1aq\u6307\u7684\u662f\u6bd4\u5bf9\u5230\u8fd9\u4e2a\u53c2\u8003\u57fa\u56e0\u7ec4\u78b1\u57fa\u4e0a\u7684\u6bd4\u5bf9\u8d28\u91cf\uff0c\u5373MAPQ\u3002\u53c2\u8003\u4e4b\u524d\u8bf4\u7684\uff0cMAPQ\u8bbe\u7f6e\u4e3a20\uff0c\u5047\u8bbe\u6bcf\u4e2a\u78b1\u57fa\u7684MAPQ\u90fd\u662f20\uff0c\u5219MQ\u4e3a20\u3002 $$RMS=\\sqrt{\\frac{1}{N}\\sum_{n}^{i=1}q_{i}^{2}}$$ \u5927\u591a\u6570\u7684reads\u7684MAPQ\u90fd\u572860\u3002 Local Realignment Why? + Each read is independently aligned to the reference genome to cut down on the computational cost. + But this means that many reads spanning indels are likely to be misaligned. + We see this as regions containing indels as well as clusters of mismatching bases. How does it work? + Step 1: Identify regions likely in need of realignment. + 1 \u2013 At least one read contains an indel. + 2 \u2013 A cluster of mismatching bases exists. + 3 \u2013 An already known indel segregates at the site. + Step 2: Perform a multiple sequence realignment in this region, such that the number of mismatching bases is minimized across all reads. Local reaglinment http://www.cbs.dtu.dk/courses/27626/Lectures/post_alignment_variantcalling_SR.pdf Ambiguity of alignment at indel sites Re-alignment no longer recommended if the genotyping method used downstream involves local haplotype assembly FreeBayes\uff0cre-alignment implicit in the assembly algorithm\uff1b HaplotypeCaller Still needed if genotypes called from allelic depths at individual sites: UnifiedGenotyper (GATK) samtools Duplicate marking/removal Why do we have duplicates in our data? \u2022 The PCR amplification step included in the majority of NGS library construction techniques can introduce duplicates in the data. Why do we need to remove these? + It will bias our variant calls. + PCR errors are propagated and sampled many times giving rise to FP variant calls. Basic concepts of duplicate marking http://picard.sourceforge.net/ algorithm: 1. Identify genomic position and strand for 5\u2019-most bases. 2. Mark reads that are duplicatesof each other. 3. Within a group of duplicate reads the read with the highest sum of base quality scores is retained. But it is not perfect\u2026 + Does not account for sequencing errors. + Does not account for natural duplicates. + Does not account for duplicate reads with different mapping locations Duplicate reads (fragments) Optical duplicates: (Illumina) generated when a single cluster of reads is part of two adjacent tiles' on the same slide and used to compute two read calls separately \u2022 Very similar in sequence (except sequencing errors). \u2022 Identified where the first, say, 50 bases are identical between two reads and the read\u2019s coordinates are close Library duplicates (aka PCR duplicates): generated when the original sample is preamplified to such extent that initial unique targets are PCR replicated prior to library preparation and will lead to several independent spots on the Illumina slide. \u2022 do not have to be adjacent on the slide \u2022 share a very high level of sequence identity \u2022 align to the same place on reference \u2022 identified from alignment to reference Removing (marking) duplicates with PICARD java -jar $PICARDDIR/picard.jar \\ MarkDuplicates \\ INPUT=sample1.sorted.bam \\ OUTPUT=sample1.sorted.dedup.bam \\ METRICS_FILE=sample1.sorted.dedup.metrics.txt The metrics file will contain some stats about the de-duping In the resulting BAM file, only one fragment from each duplicate group survives unchanged, other duplicate fragments are given a flag 0x400 and will not be used downstream. Optimally, detection and marking of duplicate fragments should be done per library, i.e., over all read groups corresponding to a given library. \u2022 In practice, often sufficient to do it per lane (read group). Base quality score recalibration How it works! 1. Collect information regarding the following features of the bases: + Reported quality score + Position within the read (machine cycle) + Dinucleotide context (current base plus previous base) 2. Count the number of times a site was a mismatch to the reference (excluding known polymorphic sites). 3. Estimate new quality score as: $$Phred-scaled quality score =\\frac{# of reference mismatches +1}{# of observed bases +2}$$ Example: We observed A [AA, pos. 35, Q20] a 1,000,000 times.A in this context mismatches the reference a 1,000 times. This gives us: Q value = -10log10((1,000+1)/(1,000,000+2)) ~ Q30 BQSR Caveats: Local indel realignment should be done before recalibration Known variation (SNPs and indels) have to be excluded (not a source of errors) Variants found from read pileup; PL from allelic read depths and base qualities Variants found from locally assembled haplotypes; PL from read alignment to haplotypes Variant calling & genotyping The posterior probability of each genotype given the pileup of sequence reads is given by Bayes theorem: p(G|D): Prob. of genotype given data (posterior probability) p(G): Prior prob. based on allele freqs. from HW p(D|G): Prob. of data given genotype (genotype likelihood) p(D): Prob. of data p(b|G): Prob. of genotype given observed base at a site e is the Phred scaled quality score of the base Variant filtration (soft) Variant quality score recalibration Variants as points in a cloud can be modeled using a Gaussian mixture model. This model is used to estimate the probability that a variant is a true variant rather than a sequencer error or a data processing artifact. The model is trained on known \u2018true sites\u2019. Model parameters are applied to each variant in the input vcf-file and each variant is flagged by a VQSLOD score, which is the log odds ratio of the variant being a true variant versus being a false variant under the trained Gaussian mixture model. Annotation Genotyping: Maximum likelihood estimator \u5047\u8bbe\u5728\u67d0\u4e2a\u603b\u6df1\u5ea6\u4e3a90\u6761reads\u7684SNP\u4f4d\u70b9\u89c2\u5bdf\u523025\u6761\u7a81\u53d8reads\uff0c\u8be5\u600e\u4e48\u4f30\u8ba1\u8be5\u4f4d\u70b9\u7684\u57fa\u56e0\u578b\u5462\uff1f \u4e09\u79cd\u53ef\u80fd\u7684\u57fa\u56e0\u578b\uff1a + RR + RA + AA \u8ba1\u7b97\u4f3c\u7136\u503c\uff0c\u5373\u67d0\u4e2a\u6307\u5b9a\u57fa\u56e0\u578b\u89c2\u5bdf\u503c\u7684\u53ef\u80fd\u6027 + P(25AltReads,65RefReads|RR) + P(25AltReads,65RefReads|RA) + P(25AltReads,65RefReads|AA) \u901a\u5e38\uff0c\u6211\u4eec\u89c2\u5bdf\u5230\u7a81\u53d8reads\u6570\u76ee\u670d\u4ece\u4e8c\u9879\u5206\u5e03\uff1a $$L(x|G) =\\binom{90}{25}p^{25}(1-p)^{^{25}}$$ p\u7684\u51fd\u6570\uff0c\u5047\u8bbe\u8be5\u4f4d\u70b9\u662f\u4e8c\u500d\u4f53\uff0c\u5219p\u67093\u79cd\u53ef\u80fd\u7684\u503c\uff1a + RR -> p=0 + RA -> p=0.5 + AA -> p=1 \u7531\u4e8e\u8981\u8003\u8651\u5230\u6bd4\u5bf9\u4e2d\u7684\u6280\u672f\u9519\u8bef\uff1a + RR -> p=0.05 + RA -> p=0.5 + AA -> p=0.95 Incorporating additional information in our model Bayesian Inference Bayesian Statistics vs. Frequentist Statistics The main problem of Statistcal Inference is the estimation of a specific feature (parameter) of a population (for example, the genotype of a given individual on a given locus) Classic (Frequentist) Statistics assume that the feature is deterministic(fixed at the time of our observation) Bayesian Statistics assume that the feature is random This (apparently) small technical difference creates a huge philosophical dis;nc;on (and a lot of technicali;es too) Sta;s;cians tend to be very passionate around each approach (although some are pragma;c) Bayesian Statistics \u2022 If the feature of the popula;on that we want to es;mate is a random variable, it must have a probability distribu;on. We call this the prior distribu9on: P(G) \u2022 We take a sample from the popula;on, measure our observa;ons, and compute the likelihood or our data: P(R|G) \u2022 We can then update our knowledge of the distribu;on of the parameter and obtain its posterior distribu9on using the Bayes Theorem: P(G | R) = P(G)P(R |G) P(R) \u2022 P(R) is difficult to compute and it is the same for all possible genotypes, so in most applica;ons we just need to compute the numerator. \u2022 We obtain a probability distribu;on! Not a single value! But we can obtain a range of values with high probability (credible interval), or summarise the distribu;on with the most likely value (maximum a posteriori) or the mean (posterior mean) Na\u00efve Bayesian genotyping: Posterior probability $$L(x|G) =\\binom{90}{25}p^{25}(1-p)^{^{25}}$$ We need to consider Prior probabili;es for each genotype: + $P(RR)=0.75$ + $P(RA)=0.15$ + $P(AA)=0.10$ We can compute posterior probabili;es: + P(RR|x)=P(x|RR)P(RR) + P(RA|x)=P(x|RA)P(RA) + P(AA|x)=P(x|AA)P(AA) In situations where we don\u2019t have much data (lower depth), or there is more noise, the prior can have more impact in the posterior. Let\u2019s assume now 10 variant reads out of 50: Haplotype likelihood function in HaplotypeCaller Define active regions The program determines which regions of the genome it needs to operate on, based on the presence of significant evidence for variation. Determine haplotypes by re-assembly of the active region For each ActiveRegion, the program builds a De Bruijn-like graph to reassemble the ActiveRegion, and identifies what are the possible haplotypes present in the data. The program then realigns each haplotype against the reference haplotype using the Smith-Waterman algorithm in order to identify potentially variant sites. Determine likelihoods of the haplotypes given the read data P{Dj|H} For each ActiveRegion, the program performs a pairwise alignment of each read against each haplotype using the PairHMM algorithm. This produces a matrix of likelihoods of haplotypes given the read data. These likelihoods are then marginalized to obtain the likelihoods of alleles for each potentially variant site given the read data. Assign sample genotypes For each potentially variant site, the program applies Bayes\u2019 rule, using the likelihoods of alleles given the read data to calculate the likelihoods of each genotype per sample given the read data observed for that sample. The most likely genotype is then assigned to the sample. Haplotype assembly uses reads from all samples (rather than one at a time), and so\u2026resulting VCF file will not be exactly equivalent to that obtained from gVCF mode runs followed by GenotypeGVCF Broad recommends running HaplotypeCaller-based pipeline instead of UnifiedGenotyper However, still recommended for Pooled sample cases High ploidy cases -stand_call_conf [number] Variants with quality score (QUAL) less than [number] will not be written to VCF file. Good to set this low \u2013 better have too many raw variants than too few. Can always filter VCF file later. Default: 30. -dcov [int] Read depth at any locus will be capped at [number]; the goal is to provide even distribution of read start positions while removing excess coverage. For truly unbiased down-sampling, use -dfrac Defaults are usually high (250) \u2013 can be reduced to speed things up Haplotypes and Computational Phasing A haplotype is a set of gene;c features that tend to be inherited together In our context, we are interested in a set of SNPs that tend to be inherited together. Why? Because it will make variant calling more robust","title":"VCF"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#vcf","text":"ID: some ID for the variant, if known (e.g., dbSNP) REF, ALT: reference and alternative alleles (on forward strand of reference) QUAL = -10*log(1-p), where p is the probability of variant being present given the read data FILTER: whether the variant failed a filter (filters defined by the user or program processing the file) GT (genotype): 0/0 reference homozygote 0/1 reference-alternative heterozygote 1/1 alternative homozygote 0/2, 1/2, 2/2, etc. - possible if more than one alternative allele present ./. missing data AD: allele depths DP: total depth (may be different from sum of AD depths, a the latter include only reads significantly supporting alleles) PL: genotype likelihoods (phred-scaled), normalized to the best genotype, e.g., PL(0/1) = -10*log[ Prob(data|0/1) / Prob(data|best_genotype) ] GQ: genotype quality \u2013 this is just PL of the second-best genotype QUAL\uff1a\u57fa\u4e8ePhred\u683c\u5f0f\u7684\u8868\u793aALT\u7684\u8d28\u91cf\uff0c\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a\u53ef\u9760\u6027\uff1b\u53ef\u4ee5\u7406\u89e3\u4e3a\u6240call\u51fa\u6765\u7684\u53d8\u5f02\u4f4d\u70b9\u7684\u8d28\u91cf\u503c\u3002Q=-10lgP\uff0cQ\u8868\u793a\u8d28\u91cf\u503c\uff1bP\u8868\u793a\u8fd9\u4e2a\u4f4d\u70b9\u53d1\u751f\u9519\u8bef\u7684\u6982\u7387\u3002\u56e0\u6b64\uff0c\u5982\u679c\u60f3\u628a\u9519\u8bef\u7387\u4ece\u63a7\u5236\u572890%\u4ee5\u4e0a\uff0cP\u7684\u9608\u503c\u5c31\u662f1/10\uff0c\u90a3lg\uff081/10\uff09=-1\uff0cQ=\uff08-10\uff09*\uff08-1\uff09=10\u3002\u540c\u7406\uff0c\u5f53Q=20\u65f6\uff0c\u9519\u8bef\u7387\u5c31\u63a7\u5236\u5728\u4e860.01\u3002\u8fd9\u4e2a\u53c2\u6570\u5176\u5b9e\u548cmpileup\u7684-Q\u662f\u91cd\u590d\u7684\u3002 MQ\u4e0d\u540c\u4e8eMAPQ\uff0c\u662fRMS Mapping Quality\uff0c\u516c\u5f0f\u5b9a\u4e49\u5982\u4e0b\uff1aq\u6307\u7684\u662f\u6bd4\u5bf9\u5230\u8fd9\u4e2a\u53c2\u8003\u57fa\u56e0\u7ec4\u78b1\u57fa\u4e0a\u7684\u6bd4\u5bf9\u8d28\u91cf\uff0c\u5373MAPQ\u3002\u53c2\u8003\u4e4b\u524d\u8bf4\u7684\uff0cMAPQ\u8bbe\u7f6e\u4e3a20\uff0c\u5047\u8bbe\u6bcf\u4e2a\u78b1\u57fa\u7684MAPQ\u90fd\u662f20\uff0c\u5219MQ\u4e3a20\u3002 $$RMS=\\sqrt{\\frac{1}{N}\\sum_{n}^{i=1}q_{i}^{2}}$$ \u5927\u591a\u6570\u7684reads\u7684MAPQ\u90fd\u572860\u3002","title":"VCF"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#local-realignment","text":"Why? + Each read is independently aligned to the reference genome to cut down on the computational cost. + But this means that many reads spanning indels are likely to be misaligned. + We see this as regions containing indels as well as clusters of mismatching bases. How does it work? + Step 1: Identify regions likely in need of realignment. + 1 \u2013 At least one read contains an indel. + 2 \u2013 A cluster of mismatching bases exists. + 3 \u2013 An already known indel segregates at the site. + Step 2: Perform a multiple sequence realignment in this region, such that the number of mismatching bases is minimized across all reads.","title":"Local Realignment"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#local-reaglinment","text":"http://www.cbs.dtu.dk/courses/27626/Lectures/post_alignment_variantcalling_SR.pdf","title":"Local reaglinment"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#ambiguity-of-alignment-at-indel-sites","text":"Re-alignment no longer recommended if the genotyping method used downstream involves local haplotype assembly FreeBayes\uff0cre-alignment implicit in the assembly algorithm\uff1b HaplotypeCaller Still needed if genotypes called from allelic depths at individual sites: UnifiedGenotyper (GATK) samtools","title":"Ambiguity of alignment at indel sites"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#duplicate-markingremoval","text":"Why do we have duplicates in our data? \u2022 The PCR amplification step included in the majority of NGS library construction techniques can introduce duplicates in the data. Why do we need to remove these? + It will bias our variant calls. + PCR errors are propagated and sampled many times giving rise to FP variant calls. Basic concepts of duplicate marking http://picard.sourceforge.net/ algorithm: 1. Identify genomic position and strand for 5\u2019-most bases. 2. Mark reads that are duplicatesof each other. 3. Within a group of duplicate reads the read with the highest sum of base quality scores is retained. But it is not perfect\u2026 + Does not account for sequencing errors. + Does not account for natural duplicates. + Does not account for duplicate reads with different mapping locations","title":"Duplicate marking/removal"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#duplicate-reads-fragments","text":"Optical duplicates: (Illumina) generated when a single cluster of reads is part of two adjacent tiles' on the same slide and used to compute two read calls separately \u2022 Very similar in sequence (except sequencing errors). \u2022 Identified where the first, say, 50 bases are identical between two reads and the read\u2019s coordinates are close Library duplicates (aka PCR duplicates): generated when the original sample is preamplified to such extent that initial unique targets are PCR replicated prior to library preparation and will lead to several independent spots on the Illumina slide. \u2022 do not have to be adjacent on the slide \u2022 share a very high level of sequence identity \u2022 align to the same place on reference \u2022 identified from alignment to reference","title":"Duplicate reads (fragments)"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#removing-marking-duplicates-with-picard","text":"java -jar $PICARDDIR/picard.jar \\ MarkDuplicates \\ INPUT=sample1.sorted.bam \\ OUTPUT=sample1.sorted.dedup.bam \\ METRICS_FILE=sample1.sorted.dedup.metrics.txt The metrics file will contain some stats about the de-duping In the resulting BAM file, only one fragment from each duplicate group survives unchanged, other duplicate fragments are given a flag 0x400 and will not be used downstream. Optimally, detection and marking of duplicate fragments should be done per library, i.e., over all read groups corresponding to a given library. \u2022 In practice, often sufficient to do it per lane (read group).","title":"Removing (marking) duplicates with PICARD"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#base-quality-score-recalibration","text":"How it works! 1. Collect information regarding the following features of the bases: + Reported quality score + Position within the read (machine cycle) + Dinucleotide context (current base plus previous base) 2. Count the number of times a site was a mismatch to the reference (excluding known polymorphic sites). 3. Estimate new quality score as: $$Phred-scaled quality score =\\frac{# of reference mismatches +1}{# of observed bases +2}$$ Example: We observed A [AA, pos. 35, Q20] a 1,000,000 times.A in this context mismatches the reference a 1,000 times. This gives us: Q value = -10log10((1,000+1)/(1,000,000+2)) ~ Q30","title":"Base quality score recalibration"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#bqsr","text":"Caveats: Local indel realignment should be done before recalibration Known variation (SNPs and indels) have to be excluded (not a source of errors) Variants found from read pileup; PL from allelic read depths and base qualities Variants found from locally assembled haplotypes; PL from read alignment to haplotypes","title":"BQSR"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#variant-calling-genotyping","text":"The posterior probability of each genotype given the pileup of sequence reads is given by Bayes theorem: p(G|D): Prob. of genotype given data (posterior probability) p(G): Prior prob. based on allele freqs. from HW p(D|G): Prob. of data given genotype (genotype likelihood) p(D): Prob. of data p(b|G): Prob. of genotype given observed base at a site e is the Phred scaled quality score of the base","title":"Variant calling &amp; genotyping"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#variant-filtration-soft","text":"","title":"Variant filtration (soft)"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#variant-quality-score-recalibration","text":"Variants as points in a cloud can be modeled using a Gaussian mixture model. This model is used to estimate the probability that a variant is a true variant rather than a sequencer error or a data processing artifact. The model is trained on known \u2018true sites\u2019. Model parameters are applied to each variant in the input vcf-file and each variant is flagged by a VQSLOD score, which is the log odds ratio of the variant being a true variant versus being a false variant under the trained Gaussian mixture model.","title":"Variant quality score recalibration"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#annotation","text":"","title":"Annotation"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#genotyping","text":"","title":"Genotyping:"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#maximum-likelihood-estimator","text":"\u5047\u8bbe\u5728\u67d0\u4e2a\u603b\u6df1\u5ea6\u4e3a90\u6761reads\u7684SNP\u4f4d\u70b9\u89c2\u5bdf\u523025\u6761\u7a81\u53d8reads\uff0c\u8be5\u600e\u4e48\u4f30\u8ba1\u8be5\u4f4d\u70b9\u7684\u57fa\u56e0\u578b\u5462\uff1f \u4e09\u79cd\u53ef\u80fd\u7684\u57fa\u56e0\u578b\uff1a + RR + RA + AA \u8ba1\u7b97\u4f3c\u7136\u503c\uff0c\u5373\u67d0\u4e2a\u6307\u5b9a\u57fa\u56e0\u578b\u89c2\u5bdf\u503c\u7684\u53ef\u80fd\u6027 + P(25AltReads,65RefReads|RR) + P(25AltReads,65RefReads|RA) + P(25AltReads,65RefReads|AA) \u901a\u5e38\uff0c\u6211\u4eec\u89c2\u5bdf\u5230\u7a81\u53d8reads\u6570\u76ee\u670d\u4ece\u4e8c\u9879\u5206\u5e03\uff1a $$L(x|G) =\\binom{90}{25}p^{25}(1-p)^{^{25}}$$ p\u7684\u51fd\u6570\uff0c\u5047\u8bbe\u8be5\u4f4d\u70b9\u662f\u4e8c\u500d\u4f53\uff0c\u5219p\u67093\u79cd\u53ef\u80fd\u7684\u503c\uff1a + RR -> p=0 + RA -> p=0.5 + AA -> p=1 \u7531\u4e8e\u8981\u8003\u8651\u5230\u6bd4\u5bf9\u4e2d\u7684\u6280\u672f\u9519\u8bef\uff1a + RR -> p=0.05 + RA -> p=0.5 + AA -> p=0.95","title":"Maximum likelihood estimator"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#incorporating-additional-information-in-our-model","text":"Bayesian Inference","title":"Incorporating additional information in our model"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#bayesian-statistics-vs-frequentist-statistics","text":"The main problem of Statistcal Inference is the estimation of a specific feature (parameter) of a population (for example, the genotype of a given individual on a given locus) Classic (Frequentist) Statistics assume that the feature is deterministic(fixed at the time of our observation) Bayesian Statistics assume that the feature is random This (apparently) small technical difference creates a huge philosophical dis;nc;on (and a lot of technicali;es too) Sta;s;cians tend to be very passionate around each approach (although some are pragma;c)","title":"Bayesian Statistics vs. Frequentist Statistics"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#bayesian-statistics","text":"\u2022 If the feature of the popula;on that we want to es;mate is a random variable, it must have a probability distribu;on. We call this the prior distribu9on: P(G) \u2022 We take a sample from the popula;on, measure our observa;ons, and compute the likelihood or our data: P(R|G) \u2022 We can then update our knowledge of the distribu;on of the parameter and obtain its posterior distribu9on using the Bayes Theorem: P(G | R) = P(G)P(R |G) P(R) \u2022 P(R) is difficult to compute and it is the same for all possible genotypes, so in most applica;ons we just need to compute the numerator. \u2022 We obtain a probability distribu;on! Not a single value! But we can obtain a range of values with high probability (credible interval), or summarise the distribu;on with the most likely value (maximum a posteriori) or the mean (posterior mean)","title":"Bayesian Statistics"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#naive-bayesian-genotyping-posterior-probability","text":"$$L(x|G) =\\binom{90}{25}p^{25}(1-p)^{^{25}}$$ We need to consider Prior probabili;es for each genotype: + $P(RR)=0.75$ + $P(RA)=0.15$ + $P(AA)=0.10$ We can compute posterior probabili;es: + P(RR|x)=P(x|RR)P(RR) + P(RA|x)=P(x|RA)P(RA) + P(AA|x)=P(x|AA)P(AA) In situations where we don\u2019t have much data (lower depth), or there is more noise, the prior can have more impact in the posterior. Let\u2019s assume now 10 variant reads out of 50:","title":"Na\u00efve Bayesian genotyping: Posterior probability"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#haplotype-likelihood-function-in-haplotypecaller","text":"Define active regions The program determines which regions of the genome it needs to operate on, based on the presence of significant evidence for variation. Determine haplotypes by re-assembly of the active region For each ActiveRegion, the program builds a De Bruijn-like graph to reassemble the ActiveRegion, and identifies what are the possible haplotypes present in the data. The program then realigns each haplotype against the reference haplotype using the Smith-Waterman algorithm in order to identify potentially variant sites. Determine likelihoods of the haplotypes given the read data P{Dj|H} For each ActiveRegion, the program performs a pairwise alignment of each read against each haplotype using the PairHMM algorithm. This produces a matrix of likelihoods of haplotypes given the read data. These likelihoods are then marginalized to obtain the likelihoods of alleles for each potentially variant site given the read data. Assign sample genotypes For each potentially variant site, the program applies Bayes\u2019 rule, using the likelihoods of alleles given the read data to calculate the likelihoods of each genotype per sample given the read data observed for that sample. The most likely genotype is then assigned to the sample. Haplotype assembly uses reads from all samples (rather than one at a time), and so\u2026resulting VCF file will not be exactly equivalent to that obtained from gVCF mode runs followed by GenotypeGVCF Broad recommends running HaplotypeCaller-based pipeline instead of UnifiedGenotyper However, still recommended for Pooled sample cases High ploidy cases -stand_call_conf [number] Variants with quality score (QUAL) less than [number] will not be written to VCF file. Good to set this low \u2013 better have too many raw variants than too few. Can always filter VCF file later. Default: 30. -dcov [int] Read depth at any locus will be capped at [number]; the goal is to provide even distribution of read start positions while removing excess coverage. For truly unbiased down-sampling, use -dfrac Defaults are usually high (250) \u2013 can be reduced to speed things up","title":"Haplotype likelihood function in HaplotypeCaller"},{"location":"08_DNA/06_germline/001_Germline-Variants-Calling/#haplotypes-and-computational-phasing","text":"A haplotype is a set of gene;c features that tend to be inherited together In our context, we are interested in a set of SNPs that tend to be inherited together. Why? Because it will make variant calling more robust","title":"Haplotypes and Computational Phasing"},{"location":"08_DNA/06_germline/015/1/","text":"","title":"1"},{"location":"09_scrna/00/","text":"","title":"00"},{"location":"10_NGS/000_linux/","text":"cat /proc/version","title":"000 linux"},{"location":"10_NGS/000_linuxdemo/","text":"\u7b5b\u9009\u591a\u884c time grep -w -f need.id file.txt > filter.out \u5e76\u884c\u5904\u7406 https://kaopubear.top/post/2019-05-17-linuxparallelbasic/","title":"000 linuxdemo"},{"location":"10_NGS/000_linuxdemo/#_1","text":"time grep -w -f need.id file.txt > filter.out","title":"\u7b5b\u9009\u591a\u884c"},{"location":"10_NGS/000_linuxdemo/#_2","text":"https://kaopubear.top/post/2019-05-17-linuxparallelbasic/","title":"\u5e76\u884c\u5904\u7406"},{"location":"10_NGS/001_SRA/","text":"SRA\u6570\u636e\u5e93 \u67e5\u627e\u6570\u636e \u4e0b\u8f7d\u65b9\u6cd5\u9009\u62e9 Ref_Info ascp: download SRA ncbi ascp error EBI wget/axel \u6279\u91cf\u4e0b\u8f7d prefetch: download SRA SRA Run Selector fastq\u2014dump\uff1asra2fastq_pe Ref_Info SRA\u6570\u636e\u5e93 Sequence Read Archive\uff1a\u96b6\u5c5eNCBI (National Center for Biotechnology Information)\uff0c\u5b83\u662f\u4e00\u4e2a\u4fdd\u5b58\u9ad8\u901a\u91cf\u6d4b\u5e8f\u539f\u59cb\u6570\u636e\u4ee5\u53ca\u6bd4\u5bf9\u4fe1\u606f\u548c\u5143\u6570\u636e (metadata) \u7684\u6570\u636e\u5e93\uff0c\u6240\u6709\u5df2\u53d1\u8868\u7684\u6587\u732e\u4e2d\u9ad8\u901a\u91cf\u6d4b\u5e8f\u6570\u636e\u57fa\u672c\u90fd\u4e0a\u4f20\u81f3\u6b64\uff0c\u65b9\u4fbf\u5176\u4ed6\u7814\u7a76\u8005\u4e0b\u8f7d\u53ca\u518d\u7814\u7a76\u3002\u5176\u4e2d\u7684\u6570\u636e\u5219\u662f\u901a\u8fc7\u538b\u7f29\u540e\u4ee5.sra\u6587\u4ef6\u683c\u5f0f\u6765\u4fdd\u5b58\u7684\u3002 SRA\uff08Sequence ReadArchive\uff09\u6570\u636e\u5e93\u662f\u7528\u4e8e\u5b58\u50a8\u4e8c\u4ee3\u6d4b\u5e8f\u7684\u539f\u59cb\u6570\u636e\uff0c\u5305\u62ec 454\uff0cIllumina\uff0cSOLiD\uff0cIonTorrent\uff0cHelicos \u548c CompleteGenomics\u3002\u9664\u4e86\u539f\u59cb\u5e8f\u5217\u6570\u636e\u5916\uff0cSRA\u73b0\u5728\u4e5f\u5b58\u5728raw reads\u5728\u53c2\u8003\u57fa\u56e0\u7684\u6bd4\u5bf9\u4fe1\u606f\u3002 \u6839\u636eSRA\u6570\u636e\u4ea7\u751f\u7684\u7279\u70b9\uff0c\u5c06SRA\u6570\u636e\u5206\u4e3a\u56db\u7c7b\uff1a Studies-- \u7814\u7a76\u8bfe\u9898 Experiments-- \u5b9e\u9a8c\u8bbe\u8ba1 Runs-- \u6d4b\u5e8f\u7ed3\u679c\u96c6 Samples-- \u6837\u54c1\u4fe1\u606f SRA\u4e2d\u6570\u636e\u7ed3\u6784\u7684\u5c42\u6b21\u5173\u7cfb\u4e3a\uff1aStudies->Experiments->Samples->Runs. Studies\u662f\u5c31\u5b9e\u9a8c\u76ee\u6807\u800c\u8a00\u7684\uff0c\u4e00\u4e2astudy \u53ef\u80fd\u5305\u542b\u591a\u4e2aExperiment\u3002 Experiments\u5305\u542b\u4e86Sample\u3001DNA source\u3001\u6d4b\u5e8f\u5e73\u53f0\u3001\u6570\u636e\u5904\u7406\u7b49\u4fe1\u606f\uff1b \u4e00\u4e2aExperiment\u53ef\u80fd\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2aruns\uff1b Runs \u8868\u793a\u6d4b\u5e8f\u4eea\u8fd0\u884c\u6240\u4ea7\u751f\u7684reads\uff1b SRA\u6570\u636e\u5e93\u7528\u4e0d\u540c\u7684\u524d\u7f00\u52a0\u4ee5\u533a\u5206\uff1a ERP\u6216SRP\u8868\u793aStudies\uff1bSRS \u8868\u793a Samples\uff1bSRX \u8868\u793a Experiments\uff1bSRR \u8868\u793a Runs\uff1b Studies: + SRA Study accessions (prefixes SRP, DRP, ERP) + Examples: SRP000002, DRP000617, ERP002000 + BioProject accessions (prefixes PRJNA, PRJDB, PRJEB) + Examples: PRJNA111397, PRJDB90, PRJEB1976 + dbGaP study accessions (prefix phs) + Example: phs000159 + GEO Study (prefix GSE) + Example: GSE12578 Samples: + SRA Sample accessions (prefixes SRS, DRS, ERS) + Examples: SRS000013, DRS000020, ERS000016 + BioSample accessions (prefixes SAMN, SAME) + Examples: SAMN00000013, SAMEA774460 + GEO Sample (prefix GSM) + Example: GSM769008 SRA Experiment(s) + SRA Experiment accessions (prefixes SRX, DRX, ERX) + Example: SRX000002,SRX000003,SRX000004 \u67e5\u627e\u6570\u636e \u5982\u679c\u6587\u732e\u91cc\u9762\u7684SRA\u53f7\uff0c\u90a3\u4e48\u53ef\u4ee5\u76f4\u63a5\u6253\u5f00NCBI\u91cc\u9762\u7684\u641c\u7d22\u754c\u9762\u4e0b\u8f7d \u5982\u679c\u6587\u732e\u91cc\u9762\u662fSRP\u53f7\uff0c\u90a3\u4e48\u8be5SRP\u4f1a\u6d89\u53ca\u5230\u597d\u51e0\u4e2aSRA\u6570\u636e\uff0c\u5f97\u4e00\u4e2a\u4e2a\u5f00\u7f51\u7ad9\u4e0b\u8f7d sratoolkit\u4f7f\u7528\u524d\uff0c\u4e00\u5b9a\u8981\u4fee\u6539config\u6587\u4ef6\uff1a https://github.com/ncbi/sra-tools/wiki/Toolkit-Configuration \u4e0b\u8f7d\u65b9\u6cd5\u9009\u62e9 1\uff09\u9996\u9009Aspera Connect\u8f6f\u4ef6 2\uff09\u5176\u6b21sratoolkit\u4e2d\u7684prefetch\u547d\u4ee4 3\uff09\u6700\u540e\uff0c\u4f7f\u7528sratoolkit\u4e2d\u7684fastq-dump\u548csam-dump\u547d\u4ee4\u4e0b\u8f7d\uff0c\u5982\u679cfastq-dump\u4e0d\u7a33\u5b9a\uff0c\u63a8\u8350\u5927\u5bb6\u5c1d\u8bd5Biostar Handbook\u4e2d\u7684wonderdump\u811a\u672c\u3002 \u8b66\u544a\uff1a\u4e0d\u8981\u7528wget\u6216curl\u53bb\u4e0b\u8f7dsra\u6587\u4ef6\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u4e0b\u8f7d\u7684\u6587\u4ef6\u4e0d\u5b8c\u6574\uff01 Ref_Info https://mp.weixin.qq.com/s/4Dd3L66ddYAS6C96VvN5kg ascp: download SRA ncbi ncbiftp\u8def\u5f84\uff1a ftp://ftp.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/+SRR+\u767b\u9646\u53f7\u524d\u4e09\u4f4d\u6570\u5b57\uff08548\uff09+/SRR+\u5b8c\u6574\u767b\u9646\u53f7\uff085483089\uff09 \u5b89\u88c5ascp\uff1a [zhangbo@mu01 bin]$ wget http://download.asperasoft.com/download/sw/connect/3.7.4/aspera-connect-3.7.4.147727-linux-64.tar.gz #curl -O http://download.asperasoft.com/download/sw/connect/3.6.1/aspera-connect-3.6.1.110647-linux-64.tar.gz [zhangbo@mu01 bin]$ /home/zhangbo/.aspera/connect/bin/ascp -h \u6587\u4ef6\u5355\u4e2a\u4e0b\u8f7d\uff1a $ascp \\ -i /home/zhangbo/.aspera/connect/etc/asperaweb_id_dsa.openssh \\ -k1 -Tr -l100m \\ anonftp@ftp-private.ncbi.nlm.nih.gov:/sra/sra-instant/reads/ByRun/sra/SRR/SRR606/SRR6061295/SRR6061295.sra \\ ~ \u6587\u4ef6\u6279\u91cf\u4e0b\u8f7d\uff1a $ascp \\ -i /home/zhangbo/.aspera/connect/etc/asperaweb_id_dsa.openssh \\ --mode recv --host ftp-private.ncbi.nlm.nih.gov --user anonftp \\ --file-list SRR_Download_List.txt \\ ~ SRR_Download_List.txt\u683c\u5f0f: /sra/sra-instant/reads/ByRun/sra/SRR/SRR606/SRR6061295/SRR6061295.sra /sra/sra-instant/reads/ByRun/sra/SRR/SRR606/SRR6061296/SRR6061296.sra ascp error SRR6061311.sra 100% 4653MB - stalled - EBI wget/axel \u6279\u91cf\u4e0b\u8f7d 20180919:\u6700\u540e\u53d1\u73b0\uff0c\u6211\u7684\u7f51\u901f\u8fd8\u53ef\u4ee5\uff0c\u76f4\u63a5axel\u4e86\uff0cascp\u603b\u662f\u5361\u5728100%\u5904\u3002 SRR6061309 SRR6061310 SRR6061311 SRR6061312 [zhangbo@mu01 cnvdata]$ for i in `cat SRR_Acc_List.txt`;do axel -n 16 ftp://ftp.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR606/${i}/${i}.sra;done prefetch: download SRA prefetch=/local_data1/software/sratoolkit/sratoolkit.2.9.1-1-centos_linux64/bin/prefetch #\u65b9\u6cd5\u4e00 $prefetch --output-directory --option-file SRR_Acc_List.txt #\u65b9\u6cd5\u4e8c $prefetch SRR6061292 20180920:\u53d1\u73b0axel\u7684\u7ed3\u679c\u4e0d\u80fd\u88ab\u8f6c\u5316,\u4e8e\u662f\uff1a $prefetch -t ascp --output-directory /local_data1/work/zhangbo/data/cnvdata/ --max-size 100G --ascp-path \\ \"/home/zhangbo/.aspera/connect/bin/ascp|/home/zhangbo/.aspera/connect/etc/asperaweb_id_dsa.openssh\" --ascp-options \"-k 1 -Tr -l 100M\" \\ SRR6061292 SRA Run Selector \u7f51\u5740\uff1ahttps://www.ncbi.nlm.nih.gov/Traces/study/ https://www.ebi.ac.uk/ena fastq\u2014dump\uff1asra2fastq_pe \u533a\u5206\u6b63\u53cd\u5411reads\u4e00\u5b9a\u8981\u52a0\u4e0a\u5982\u4e0b\u53c2\u6570 /lustre/Work/software/common/sraToolkit/sratoolkit.2.9.0-centos_linux64/bin/fastq-dump \\ --gzip \\ --defline-qual '+' \\ --defline-seq '@$ac-$si/$ri length=$rl' \\ --split-3 ERR1831346.sra /lustre/Work/software/common/sraToolkit/sratoolkit.2.9.0-centos_linux64/bin/fastq-dump \\ --gzip \\ --split-3 ERR1831346.sra \\ -I --origfmt: \u662f\u5426\u8981\u52a0\u4e0a\uff1b Ref_Info http://bioinfostar.com/2017/12/23/How-to-download-SRA-data-zh_CN/ https://anjingwd.github.io/AnJingwd.github.io/2017/08/06/SRA\u683c\u5f0f\u6570\u636e\u52a0\u901f\u4e0b\u8f7d\u6253\u5305\u89e3\u51b3/ https://mp.weixin.qq.com/s/e3xyZKpfkh8rL3sCxVEFlA https://mp.weixin.qq.com/s/04AAaT8Ygp2UcZEbQsrw0A","title":"001 SRA"},{"location":"10_NGS/001_SRA/#sra","text":"Sequence Read Archive\uff1a\u96b6\u5c5eNCBI (National Center for Biotechnology Information)\uff0c\u5b83\u662f\u4e00\u4e2a\u4fdd\u5b58\u9ad8\u901a\u91cf\u6d4b\u5e8f\u539f\u59cb\u6570\u636e\u4ee5\u53ca\u6bd4\u5bf9\u4fe1\u606f\u548c\u5143\u6570\u636e (metadata) \u7684\u6570\u636e\u5e93\uff0c\u6240\u6709\u5df2\u53d1\u8868\u7684\u6587\u732e\u4e2d\u9ad8\u901a\u91cf\u6d4b\u5e8f\u6570\u636e\u57fa\u672c\u90fd\u4e0a\u4f20\u81f3\u6b64\uff0c\u65b9\u4fbf\u5176\u4ed6\u7814\u7a76\u8005\u4e0b\u8f7d\u53ca\u518d\u7814\u7a76\u3002\u5176\u4e2d\u7684\u6570\u636e\u5219\u662f\u901a\u8fc7\u538b\u7f29\u540e\u4ee5.sra\u6587\u4ef6\u683c\u5f0f\u6765\u4fdd\u5b58\u7684\u3002 SRA\uff08Sequence ReadArchive\uff09\u6570\u636e\u5e93\u662f\u7528\u4e8e\u5b58\u50a8\u4e8c\u4ee3\u6d4b\u5e8f\u7684\u539f\u59cb\u6570\u636e\uff0c\u5305\u62ec 454\uff0cIllumina\uff0cSOLiD\uff0cIonTorrent\uff0cHelicos \u548c CompleteGenomics\u3002\u9664\u4e86\u539f\u59cb\u5e8f\u5217\u6570\u636e\u5916\uff0cSRA\u73b0\u5728\u4e5f\u5b58\u5728raw reads\u5728\u53c2\u8003\u57fa\u56e0\u7684\u6bd4\u5bf9\u4fe1\u606f\u3002 \u6839\u636eSRA\u6570\u636e\u4ea7\u751f\u7684\u7279\u70b9\uff0c\u5c06SRA\u6570\u636e\u5206\u4e3a\u56db\u7c7b\uff1a Studies-- \u7814\u7a76\u8bfe\u9898 Experiments-- \u5b9e\u9a8c\u8bbe\u8ba1 Runs-- \u6d4b\u5e8f\u7ed3\u679c\u96c6 Samples-- \u6837\u54c1\u4fe1\u606f SRA\u4e2d\u6570\u636e\u7ed3\u6784\u7684\u5c42\u6b21\u5173\u7cfb\u4e3a\uff1aStudies->Experiments->Samples->Runs. Studies\u662f\u5c31\u5b9e\u9a8c\u76ee\u6807\u800c\u8a00\u7684\uff0c\u4e00\u4e2astudy \u53ef\u80fd\u5305\u542b\u591a\u4e2aExperiment\u3002 Experiments\u5305\u542b\u4e86Sample\u3001DNA source\u3001\u6d4b\u5e8f\u5e73\u53f0\u3001\u6570\u636e\u5904\u7406\u7b49\u4fe1\u606f\uff1b \u4e00\u4e2aExperiment\u53ef\u80fd\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2aruns\uff1b Runs \u8868\u793a\u6d4b\u5e8f\u4eea\u8fd0\u884c\u6240\u4ea7\u751f\u7684reads\uff1b SRA\u6570\u636e\u5e93\u7528\u4e0d\u540c\u7684\u524d\u7f00\u52a0\u4ee5\u533a\u5206\uff1a ERP\u6216SRP\u8868\u793aStudies\uff1bSRS \u8868\u793a Samples\uff1bSRX \u8868\u793a Experiments\uff1bSRR \u8868\u793a Runs\uff1b Studies: + SRA Study accessions (prefixes SRP, DRP, ERP) + Examples: SRP000002, DRP000617, ERP002000 + BioProject accessions (prefixes PRJNA, PRJDB, PRJEB) + Examples: PRJNA111397, PRJDB90, PRJEB1976 + dbGaP study accessions (prefix phs) + Example: phs000159 + GEO Study (prefix GSE) + Example: GSE12578 Samples: + SRA Sample accessions (prefixes SRS, DRS, ERS) + Examples: SRS000013, DRS000020, ERS000016 + BioSample accessions (prefixes SAMN, SAME) + Examples: SAMN00000013, SAMEA774460 + GEO Sample (prefix GSM) + Example: GSM769008 SRA Experiment(s) + SRA Experiment accessions (prefixes SRX, DRX, ERX) + Example: SRX000002,SRX000003,SRX000004","title":"SRA\u6570\u636e\u5e93"},{"location":"10_NGS/001_SRA/#_1","text":"\u5982\u679c\u6587\u732e\u91cc\u9762\u7684SRA\u53f7\uff0c\u90a3\u4e48\u53ef\u4ee5\u76f4\u63a5\u6253\u5f00NCBI\u91cc\u9762\u7684\u641c\u7d22\u754c\u9762\u4e0b\u8f7d \u5982\u679c\u6587\u732e\u91cc\u9762\u662fSRP\u53f7\uff0c\u90a3\u4e48\u8be5SRP\u4f1a\u6d89\u53ca\u5230\u597d\u51e0\u4e2aSRA\u6570\u636e\uff0c\u5f97\u4e00\u4e2a\u4e2a\u5f00\u7f51\u7ad9\u4e0b\u8f7d sratoolkit\u4f7f\u7528\u524d\uff0c\u4e00\u5b9a\u8981\u4fee\u6539config\u6587\u4ef6\uff1a https://github.com/ncbi/sra-tools/wiki/Toolkit-Configuration","title":"\u67e5\u627e\u6570\u636e"},{"location":"10_NGS/001_SRA/#_2","text":"1\uff09\u9996\u9009Aspera Connect\u8f6f\u4ef6 2\uff09\u5176\u6b21sratoolkit\u4e2d\u7684prefetch\u547d\u4ee4 3\uff09\u6700\u540e\uff0c\u4f7f\u7528sratoolkit\u4e2d\u7684fastq-dump\u548csam-dump\u547d\u4ee4\u4e0b\u8f7d\uff0c\u5982\u679cfastq-dump\u4e0d\u7a33\u5b9a\uff0c\u63a8\u8350\u5927\u5bb6\u5c1d\u8bd5Biostar Handbook\u4e2d\u7684wonderdump\u811a\u672c\u3002 \u8b66\u544a\uff1a\u4e0d\u8981\u7528wget\u6216curl\u53bb\u4e0b\u8f7dsra\u6587\u4ef6\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u4e0b\u8f7d\u7684\u6587\u4ef6\u4e0d\u5b8c\u6574\uff01","title":"\u4e0b\u8f7d\u65b9\u6cd5\u9009\u62e9"},{"location":"10_NGS/001_SRA/#ref_info","text":"https://mp.weixin.qq.com/s/4Dd3L66ddYAS6C96VvN5kg","title":"Ref_Info"},{"location":"10_NGS/001_SRA/#ascp-download-sra","text":"","title":"ascp: download SRA"},{"location":"10_NGS/001_SRA/#ncbi","text":"ncbiftp\u8def\u5f84\uff1a ftp://ftp.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/+SRR+\u767b\u9646\u53f7\u524d\u4e09\u4f4d\u6570\u5b57\uff08548\uff09+/SRR+\u5b8c\u6574\u767b\u9646\u53f7\uff085483089\uff09 \u5b89\u88c5ascp\uff1a [zhangbo@mu01 bin]$ wget http://download.asperasoft.com/download/sw/connect/3.7.4/aspera-connect-3.7.4.147727-linux-64.tar.gz #curl -O http://download.asperasoft.com/download/sw/connect/3.6.1/aspera-connect-3.6.1.110647-linux-64.tar.gz [zhangbo@mu01 bin]$ /home/zhangbo/.aspera/connect/bin/ascp -h \u6587\u4ef6\u5355\u4e2a\u4e0b\u8f7d\uff1a $ascp \\ -i /home/zhangbo/.aspera/connect/etc/asperaweb_id_dsa.openssh \\ -k1 -Tr -l100m \\ anonftp@ftp-private.ncbi.nlm.nih.gov:/sra/sra-instant/reads/ByRun/sra/SRR/SRR606/SRR6061295/SRR6061295.sra \\ ~ \u6587\u4ef6\u6279\u91cf\u4e0b\u8f7d\uff1a $ascp \\ -i /home/zhangbo/.aspera/connect/etc/asperaweb_id_dsa.openssh \\ --mode recv --host ftp-private.ncbi.nlm.nih.gov --user anonftp \\ --file-list SRR_Download_List.txt \\ ~ SRR_Download_List.txt\u683c\u5f0f: /sra/sra-instant/reads/ByRun/sra/SRR/SRR606/SRR6061295/SRR6061295.sra /sra/sra-instant/reads/ByRun/sra/SRR/SRR606/SRR6061296/SRR6061296.sra","title":"ncbi"},{"location":"10_NGS/001_SRA/#ascp-error","text":"SRR6061311.sra 100% 4653MB - stalled -","title":"ascp error"},{"location":"10_NGS/001_SRA/#ebi","text":"","title":"EBI"},{"location":"10_NGS/001_SRA/#wgetaxel","text":"20180919:\u6700\u540e\u53d1\u73b0\uff0c\u6211\u7684\u7f51\u901f\u8fd8\u53ef\u4ee5\uff0c\u76f4\u63a5axel\u4e86\uff0cascp\u603b\u662f\u5361\u5728100%\u5904\u3002 SRR6061309 SRR6061310 SRR6061311 SRR6061312 [zhangbo@mu01 cnvdata]$ for i in `cat SRR_Acc_List.txt`;do axel -n 16 ftp://ftp.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR606/${i}/${i}.sra;done","title":"wget/axel \u6279\u91cf\u4e0b\u8f7d"},{"location":"10_NGS/001_SRA/#prefetch-download-sra","text":"prefetch=/local_data1/software/sratoolkit/sratoolkit.2.9.1-1-centos_linux64/bin/prefetch #\u65b9\u6cd5\u4e00 $prefetch --output-directory --option-file SRR_Acc_List.txt #\u65b9\u6cd5\u4e8c $prefetch SRR6061292 20180920:\u53d1\u73b0axel\u7684\u7ed3\u679c\u4e0d\u80fd\u88ab\u8f6c\u5316,\u4e8e\u662f\uff1a $prefetch -t ascp --output-directory /local_data1/work/zhangbo/data/cnvdata/ --max-size 100G --ascp-path \\ \"/home/zhangbo/.aspera/connect/bin/ascp|/home/zhangbo/.aspera/connect/etc/asperaweb_id_dsa.openssh\" --ascp-options \"-k 1 -Tr -l 100M\" \\ SRR6061292","title":"prefetch: download SRA"},{"location":"10_NGS/001_SRA/#sra-run-selector","text":"\u7f51\u5740\uff1ahttps://www.ncbi.nlm.nih.gov/Traces/study/","title":"SRA Run Selector"},{"location":"10_NGS/001_SRA/#_3","text":"https://www.ebi.ac.uk/ena","title":""},{"location":"10_NGS/001_SRA/#fastqdumpsra2fastq_pe","text":"\u533a\u5206\u6b63\u53cd\u5411reads\u4e00\u5b9a\u8981\u52a0\u4e0a\u5982\u4e0b\u53c2\u6570 /lustre/Work/software/common/sraToolkit/sratoolkit.2.9.0-centos_linux64/bin/fastq-dump \\ --gzip \\ --defline-qual '+' \\ --defline-seq '@$ac-$si/$ri length=$rl' \\ --split-3 ERR1831346.sra /lustre/Work/software/common/sraToolkit/sratoolkit.2.9.0-centos_linux64/bin/fastq-dump \\ --gzip \\ --split-3 ERR1831346.sra \\ -I --origfmt: \u662f\u5426\u8981\u52a0\u4e0a\uff1b","title":"fastq\u2014dump\uff1asra2fastq_pe"},{"location":"10_NGS/001_SRA/#ref_info_1","text":"http://bioinfostar.com/2017/12/23/How-to-download-SRA-data-zh_CN/ https://anjingwd.github.io/AnJingwd.github.io/2017/08/06/SRA\u683c\u5f0f\u6570\u636e\u52a0\u901f\u4e0b\u8f7d\u6253\u5305\u89e3\u51b3/ https://mp.weixin.qq.com/s/e3xyZKpfkh8rL3sCxVEFlA https://mp.weixin.qq.com/s/04AAaT8Ygp2UcZEbQsrw0A","title":"Ref_Info"},{"location":"10_NGS/002_%E5%BC%95%E7%89%A9%E8%AE%BE%E8%AE%A1/","text":"\u6839\u636e\u67d3\u8272\u4f53\u8d77\u59cb\u7ec8\u6b62\u70b9\u5750\u6807\u6765\u83b7\u53d6\u78b1\u57fa\u5e8f\u5217 \u5750\u6807\u7cfb\u7edf\u8f6c\u6362 \u6839\u636e\u67d3\u8272\u4f53\u8d77\u59cb\u7ec8\u6b62\u70b9\u5750\u6807\u6765\u83b7\u53d6\u78b1\u57fa\u5e8f\u5217 http://genome.ucsc.edu/cgi-bin/das/hg38/dna?segment=chr17:7676091,7676196 \u6848\u4f8b\uff1a\u5047\u5982\u9700\u8981\u83b7\u53d6hg38\u5750\u6807\u7cfb\u7edf\u4e2d\u7684chr17:7676091-7676196\u57fa\u56e0\u7ec4\u5e8f\u5217: http://genome.ucsc.edu/cgi-bin/das/hg38/dna?segment=chr17:7676091,7676196 \u5750\u6807\u7cfb\u7edf\u8f6c\u6362 https://bioinformatics.mdanderson.org/transvar/ https://pzweuj.github.io/2019/11/12/catch.html","title":"002 \u5f15\u7269\u8bbe\u8ba1"},{"location":"10_NGS/003_shell/","text":"ack rsync tee \u7edf\u8ba1fastq\u4e2d\u6bcf\u4e2a\u8bfb\u957f\u7684counts\u6570 \u76f4\u63a5\u7528awk\u547d\u4ee4 awk '{if(NR%4==2) print length($1)}' read.fastq | sort -n | uniq -c > reads_length.txt NR%4==2\u7684\u610f\u601d\u662f\u4ee5\u6bcf\u56db\u884c\u4e3a\u4e00\u4e2a\u7ec4\uff0c\u7edf\u8ba1\u6bcf\u7ec4\u7684\u7b2c\u4e8c\u884c\uff08\u5728fastq\u6587\u4ef6\u4e2d\u5c31\u662f\u78b1\u57fa\u4fe1\u606f\u884c\uff09\u3002 \u7136\u540e\u7528R library(ggplot2) reads <- read.csv('reads_length.txt', sep=' ', header=FALSE) ggplot(reads, aes(x=reads$V2, y=reads$V1)) + geom_bar(stat='identity') + xlab('read length') + ylab('counts') + ggtitle('Read Length Distribution') shell\u6570\u7ec4 https://www.cnblogs.com/qdhxhz/p/10902110.html for i in `ls /local_data1/MED/projects/linzuopeng/shen/bam/*.sorted.bam` do sample=`basename $i` #array=(`echo $str | tr '.' ' '`) #array=(${string//,/ }) sample_tmp= dir=`dirname $i` oldIFS=$IFS IFS=. arr=($sample) IFS=$oldIFS #for s in ${arr[@]};do;echo \"$s\";done #for i in \"${!array[@]}\"; do echo \"$i\uff1a${array[i]}\";done sample_name=${arr[0]} echo \"/local_data1/work/zhangbo/software/samtools-1.9/samtools view -@ 4 -F 256 -ub $i > $i.tmp.bam \\ && mkdir -p $dir/$sample_name \\ && /local_data1/work/zhangbo/software/bamdst/bamdst -p \\ /local_data1/MED/medicine_temp/S07604514_Covered_sorted_merged_hg19.bed \\ -o $dir/$sample_name $i.tmp.bam \\ && rm -f $i.tmp.bam\" done","title":"003 shell"},{"location":"10_NGS/003_shell/#ack","text":"","title":"ack"},{"location":"10_NGS/003_shell/#rsync","text":"","title":"rsync"},{"location":"10_NGS/003_shell/#tee","text":"","title":"tee"},{"location":"10_NGS/003_shell/#fastqcounts","text":"\u76f4\u63a5\u7528awk\u547d\u4ee4 awk '{if(NR%4==2) print length($1)}' read.fastq | sort -n | uniq -c > reads_length.txt NR%4==2\u7684\u610f\u601d\u662f\u4ee5\u6bcf\u56db\u884c\u4e3a\u4e00\u4e2a\u7ec4\uff0c\u7edf\u8ba1\u6bcf\u7ec4\u7684\u7b2c\u4e8c\u884c\uff08\u5728fastq\u6587\u4ef6\u4e2d\u5c31\u662f\u78b1\u57fa\u4fe1\u606f\u884c\uff09\u3002 \u7136\u540e\u7528R library(ggplot2) reads <- read.csv('reads_length.txt', sep=' ', header=FALSE) ggplot(reads, aes(x=reads$V2, y=reads$V1)) + geom_bar(stat='identity') + xlab('read length') + ylab('counts') + ggtitle('Read Length Distribution')","title":"\u7edf\u8ba1fastq\u4e2d\u6bcf\u4e2a\u8bfb\u957f\u7684counts\u6570"},{"location":"10_NGS/003_shell/#shell","text":"https://www.cnblogs.com/qdhxhz/p/10902110.html for i in `ls /local_data1/MED/projects/linzuopeng/shen/bam/*.sorted.bam` do sample=`basename $i` #array=(`echo $str | tr '.' ' '`) #array=(${string//,/ }) sample_tmp= dir=`dirname $i` oldIFS=$IFS IFS=. arr=($sample) IFS=$oldIFS #for s in ${arr[@]};do;echo \"$s\";done #for i in \"${!array[@]}\"; do echo \"$i\uff1a${array[i]}\";done sample_name=${arr[0]} echo \"/local_data1/work/zhangbo/software/samtools-1.9/samtools view -@ 4 -F 256 -ub $i > $i.tmp.bam \\ && mkdir -p $dir/$sample_name \\ && /local_data1/work/zhangbo/software/bamdst/bamdst -p \\ /local_data1/MED/medicine_temp/S07604514_Covered_sorted_merged_hg19.bed \\ -o $dir/$sample_name $i.tmp.bam \\ && rm -f $i.tmp.bam\" done","title":"shell\u6570\u7ec4"},{"location":"10_NGS/004_genome/","text":"","title":"004 genome"},{"location":"10_NGS/005_docker/","text":"https://github.com/guoshijiang/-virtual-technology \u6982\u5ff5 \u5305\u62ec\u4e09\u4e2a\u57fa\u672c\u6982\u5ff5: \u955c\u50cf\uff08Image\uff09\uff1a \u955c\u50cf\uff08Image\uff09\uff0c\u5c31\u76f8\u5f53\u4e8e\u662f\u4e00\u4e2a root \u6587\u4ef6\u7cfb\u7edf\u3002\u6bd4\u5982\u5b98\u65b9\u955c\u50cf ubuntu:16.04 \u5c31\u5305\u542b\u4e86\u5b8c\u6574\u7684\u4e00\u5957 Ubuntu16.04 \u6700\u5c0f\u7cfb\u7edf\u7684 root \u6587\u4ef6\u7cfb\u7edf\u3002 \u5bb9\u5668\uff08Container\uff09\uff1a\u955c\u50cf\uff08Image\uff09\u548c\u5bb9\u5668\uff08Container\uff09\u7684\u5173\u7cfb\uff0c\u5c31\u50cf\u662f\u9762\u5411\u5bf9\u8c61\u7a0b\u5e8f\u8bbe\u8ba1\u4e2d\u7684\u7c7b\u548c\u5b9e\u4f8b\u4e00\u6837\uff0c\u955c\u50cf\u662f\u9759\u6001\u7684\u5b9a\u4e49\uff0c\u5bb9\u5668\u662f\u955c\u50cf\u8fd0\u884c\u65f6\u7684\u5b9e\u4f53\u3002\u5bb9\u5668\u53ef\u4ee5\u88ab\u521b\u5efa\u3001\u542f\u52a8\u3001\u505c\u6b62\u3001\u5220\u9664\u3001\u6682\u505c\u7b49\u3002 \u4ed3\u5e93\uff08Repository\uff09\uff1a\u4ed3\u5e93\u53ef\u770b\u7740\u4e00\u4e2a\u4ee3\u7801\u63a7\u5236\u4e2d\u5fc3\uff0c\u7528\u6765\u4fdd\u5b58\u955c\u50cf\u3002 ce EE \u57fa\u7840\u4fe1\u606f --version version info ps \u67e5\u770b\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668 stop\u505c\u6b62\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668 start\u542f\u52a8\u5bb9\u5668 ps -a\u67e5\u770b\u7ec8\u6b62\u72b6\u6001\u7684\u5bb9\u5668 rm -f webserver\u547d\u4ee4\u6765\u79fb\u9664\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668 rm $( ps -a -q) \u5220\u9664\u6240\u6709\u5bb9\u5668 images \u5217\u51fa\u672c\u5730\u955c\u50cf rmi \u5220\u9664\u955c\u50cf run \u2014name NAMES IMAGE \u5c06\u955c\u50cfIMAGE\u751f\u6210NAMES\u7684\u5bb9\u5668 image ls \u5217\u51fa\u955c\u50cf search python \u5bfb\u627e\u955c\u50cf pull python:3.5 \u83b7\u53d6\u955c\u50cf run hello-world \u8fd0\u884c\u955c\u50cf #\u590d\u5236\u5bb9\u5668\u5185\u5bb9\u5230\u7269\u7406\u673a cp testIpMap:/testData / \u6ce8\uff1a\u5c06\u5bb9\u5668testIpMap\u7684/\u76ee\u5f55\u4e0b\u7684testData\u6587\u4ef6\u5939\u590d\u5236\u5230\u7269\u7406\u673a\u7684 / \u76ee\u5f55\u4e0b #\u590d\u5236\u7269\u7406\u673a\u5185\u5bb9\u5230\u5bb9\u5668 cp \u7269\u7406\u673a\u76ee\u5f55 \u5bb9\u5668\u540d\uff1a\u5bb9\u5668\u76ee\u5f55 \u5bb9\u5668\u4f7f\u7528 \u5728\u5bb9\u5668\u5185\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f $ run -t -i ubuntu:15.10 /bin/echo \"Hello world\" #: \u7684\u4e8c\u8fdb\u5236\u6267\u884c\u6587\u4ef6\u3002 #run: \u4e0e\u524d\u9762\u7684\u7ec4\u5408\u6765\u8fd0\u884c\u4e00\u4e2a\u5bb9\u5668\u3002 #ubuntu:15.10 \u6307\u5b9a\u8981\u8fd0\u884c\u7684image\uff0c\u9996\u5148\u4ece\u672c\u5730\u4e3b\u673a\u4e0a\u67e5\u627e\u955c\u50cf\u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u4e0d\u5b58\u5728\uff0c \u5c31\u4f1a\u4ece\u955c\u50cf\u4ed3\u5e93 Hub \u4e0b\u8f7d\u516c\u5171\u955c\u50cf\u3002**REPOSITORY:TAG** # /bin/echo \"Hello world\": \u5728\u542f\u52a8\u7684\u5bb9\u5668\u91cc\u6267\u884c\u7684\u547d\u4ee4 * -t\uff1a\u8fdb\u5165\u7ec8\u7aef\uff0c\u5728\u65b0\u5bb9\u5668\u5185\u6307\u5b9a\u4e00\u4e2a\u4f2a\u7ec8\u7aef\u6216\u7ec8\u7aef\u3002 * -i\uff1a\u83b7\u5f97\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u7684\u8fde\u63a5\uff0c\u901a\u8fc7\u83b7\u53d6container\u7684\u8f93\u5165 #\u540e\u53f0\u6a21\u5f0f\u542f\u52a8 run -d ubuntu:15.10 /bin/sh -c \"while true; do echo hello world; sleep 1; done\" # \u9000\u51fa \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c exit \u547d\u4ee4\u6216\u8005\u4f7f\u7528 CTRL+D \u6765\u9000\u51fa\u5bb9\u5668\u3002 # \u8fdb\u5165\u5bb9\u5668 attach exec\uff1a\u63a8\u8350\u5927\u5bb6\u4f7f\u7528 exec \u547d\u4ee4\uff0c\u56e0\u4e3a\u6b64\u9000\u51fa\u5bb9\u5668\u7ec8\u7aef\uff0c\u4e0d\u4f1a\u5bfc\u81f4\u5bb9\u5668\u7684\u505c\u6b62\u3002 ## \u5bfc\u51fa\u548c\u5bfc\u5165\u5bb9\u5668 export 1e560fca3906 > ubuntu.tar \u955c\u50cf\u4f7f\u7528 \u6211\u4eec\u4f7f\u7528 REPOSITORY:TAG \u6765\u5b9a\u4e49\u4e0d\u540c\u7684\u955c\u50cf\u3002 #\u5220\u9664\u955c\u50cf rmi hello-world https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&mid=2247490244&idx=1&sn=f42a566710fa68ebd92b7d350359314e&chksm=fa46dff9cd3156ef7b4cd7d151cbcfc61518c00a10056ed4377ddd6c50858c7f99fb4eb2d3e7&scene=21#wechat_redirect $ docker pull polyactis/accurity $ docker images #Log into the docker image, without mounting. Useful just to look inside the docker. $ docker run -i -t polyactis/accurity /bin/bash # Log into the docker image. # Mount /home/mydata, which contains your bam files and the reference data, to /mnt inside the docker $ docker run -i -t -v /home/mydata:/mnt polyactis/accurity /bin/bash \u95ee\u9898\u6545\u969c mage is being used by stopped container https://stackoverflow.com/questions/51188657/image-is-being-used-by-stopped-container","title":"005 docker"},{"location":"10_NGS/005_docker/#_1","text":"\u5305\u62ec\u4e09\u4e2a\u57fa\u672c\u6982\u5ff5: \u955c\u50cf\uff08Image\uff09\uff1a \u955c\u50cf\uff08Image\uff09\uff0c\u5c31\u76f8\u5f53\u4e8e\u662f\u4e00\u4e2a root \u6587\u4ef6\u7cfb\u7edf\u3002\u6bd4\u5982\u5b98\u65b9\u955c\u50cf ubuntu:16.04 \u5c31\u5305\u542b\u4e86\u5b8c\u6574\u7684\u4e00\u5957 Ubuntu16.04 \u6700\u5c0f\u7cfb\u7edf\u7684 root \u6587\u4ef6\u7cfb\u7edf\u3002 \u5bb9\u5668\uff08Container\uff09\uff1a\u955c\u50cf\uff08Image\uff09\u548c\u5bb9\u5668\uff08Container\uff09\u7684\u5173\u7cfb\uff0c\u5c31\u50cf\u662f\u9762\u5411\u5bf9\u8c61\u7a0b\u5e8f\u8bbe\u8ba1\u4e2d\u7684\u7c7b\u548c\u5b9e\u4f8b\u4e00\u6837\uff0c\u955c\u50cf\u662f\u9759\u6001\u7684\u5b9a\u4e49\uff0c\u5bb9\u5668\u662f\u955c\u50cf\u8fd0\u884c\u65f6\u7684\u5b9e\u4f53\u3002\u5bb9\u5668\u53ef\u4ee5\u88ab\u521b\u5efa\u3001\u542f\u52a8\u3001\u505c\u6b62\u3001\u5220\u9664\u3001\u6682\u505c\u7b49\u3002 \u4ed3\u5e93\uff08Repository\uff09\uff1a\u4ed3\u5e93\u53ef\u770b\u7740\u4e00\u4e2a\u4ee3\u7801\u63a7\u5236\u4e2d\u5fc3\uff0c\u7528\u6765\u4fdd\u5b58\u955c\u50cf\u3002 ce EE","title":"\u6982\u5ff5"},{"location":"10_NGS/005_docker/#_2","text":"--version version info ps \u67e5\u770b\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668 stop\u505c\u6b62\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668 start\u542f\u52a8\u5bb9\u5668 ps -a\u67e5\u770b\u7ec8\u6b62\u72b6\u6001\u7684\u5bb9\u5668 rm -f webserver\u547d\u4ee4\u6765\u79fb\u9664\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668 rm $( ps -a -q) \u5220\u9664\u6240\u6709\u5bb9\u5668 images \u5217\u51fa\u672c\u5730\u955c\u50cf rmi \u5220\u9664\u955c\u50cf run \u2014name NAMES IMAGE \u5c06\u955c\u50cfIMAGE\u751f\u6210NAMES\u7684\u5bb9\u5668 image ls \u5217\u51fa\u955c\u50cf search python \u5bfb\u627e\u955c\u50cf pull python:3.5 \u83b7\u53d6\u955c\u50cf run hello-world \u8fd0\u884c\u955c\u50cf #\u590d\u5236\u5bb9\u5668\u5185\u5bb9\u5230\u7269\u7406\u673a cp testIpMap:/testData / \u6ce8\uff1a\u5c06\u5bb9\u5668testIpMap\u7684/\u76ee\u5f55\u4e0b\u7684testData\u6587\u4ef6\u5939\u590d\u5236\u5230\u7269\u7406\u673a\u7684 / \u76ee\u5f55\u4e0b #\u590d\u5236\u7269\u7406\u673a\u5185\u5bb9\u5230\u5bb9\u5668 cp \u7269\u7406\u673a\u76ee\u5f55 \u5bb9\u5668\u540d\uff1a\u5bb9\u5668\u76ee\u5f55","title":"\u57fa\u7840\u4fe1\u606f"},{"location":"10_NGS/005_docker/#_3","text":"","title":"\u5bb9\u5668\u4f7f\u7528"},{"location":"10_NGS/005_docker/#_4","text":"$ run -t -i ubuntu:15.10 /bin/echo \"Hello world\" #: \u7684\u4e8c\u8fdb\u5236\u6267\u884c\u6587\u4ef6\u3002 #run: \u4e0e\u524d\u9762\u7684\u7ec4\u5408\u6765\u8fd0\u884c\u4e00\u4e2a\u5bb9\u5668\u3002 #ubuntu:15.10 \u6307\u5b9a\u8981\u8fd0\u884c\u7684image\uff0c\u9996\u5148\u4ece\u672c\u5730\u4e3b\u673a\u4e0a\u67e5\u627e\u955c\u50cf\u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u4e0d\u5b58\u5728\uff0c \u5c31\u4f1a\u4ece\u955c\u50cf\u4ed3\u5e93 Hub \u4e0b\u8f7d\u516c\u5171\u955c\u50cf\u3002**REPOSITORY:TAG** # /bin/echo \"Hello world\": \u5728\u542f\u52a8\u7684\u5bb9\u5668\u91cc\u6267\u884c\u7684\u547d\u4ee4 * -t\uff1a\u8fdb\u5165\u7ec8\u7aef\uff0c\u5728\u65b0\u5bb9\u5668\u5185\u6307\u5b9a\u4e00\u4e2a\u4f2a\u7ec8\u7aef\u6216\u7ec8\u7aef\u3002 * -i\uff1a\u83b7\u5f97\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u7684\u8fde\u63a5\uff0c\u901a\u8fc7\u83b7\u53d6container\u7684\u8f93\u5165 #\u540e\u53f0\u6a21\u5f0f\u542f\u52a8 run -d ubuntu:15.10 /bin/sh -c \"while true; do echo hello world; sleep 1; done\" # \u9000\u51fa \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c exit \u547d\u4ee4\u6216\u8005\u4f7f\u7528 CTRL+D \u6765\u9000\u51fa\u5bb9\u5668\u3002 # \u8fdb\u5165\u5bb9\u5668 attach exec\uff1a\u63a8\u8350\u5927\u5bb6\u4f7f\u7528 exec \u547d\u4ee4\uff0c\u56e0\u4e3a\u6b64\u9000\u51fa\u5bb9\u5668\u7ec8\u7aef\uff0c\u4e0d\u4f1a\u5bfc\u81f4\u5bb9\u5668\u7684\u505c\u6b62\u3002 ## \u5bfc\u51fa\u548c\u5bfc\u5165\u5bb9\u5668 export 1e560fca3906 > ubuntu.tar","title":"\u5728\u5bb9\u5668\u5185\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f"},{"location":"10_NGS/005_docker/#_5","text":"\u6211\u4eec\u4f7f\u7528 REPOSITORY:TAG \u6765\u5b9a\u4e49\u4e0d\u540c\u7684\u955c\u50cf\u3002 #\u5220\u9664\u955c\u50cf rmi hello-world https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&mid=2247490244&idx=1&sn=f42a566710fa68ebd92b7d350359314e&chksm=fa46dff9cd3156ef7b4cd7d151cbcfc61518c00a10056ed4377ddd6c50858c7f99fb4eb2d3e7&scene=21#wechat_redirect","title":"\u955c\u50cf\u4f7f\u7528"},{"location":"10_NGS/005_docker/#_6","text":"$ docker pull polyactis/accurity $ docker images #Log into the docker image, without mounting. Useful just to look inside the docker. $ docker run -i -t polyactis/accurity /bin/bash # Log into the docker image. # Mount /home/mydata, which contains your bam files and the reference data, to /mnt inside the docker $ docker run -i -t -v /home/mydata:/mnt polyactis/accurity /bin/bash","title":""},{"location":"10_NGS/005_docker/#_7","text":"","title":"\u95ee\u9898\u6545\u969c"},{"location":"10_NGS/005_docker/#mage-is-being-used-by-stopped-container","text":"https://stackoverflow.com/questions/51188657/image-is-being-used-by-stopped-container","title":"mage is being used by stopped container"},{"location":"10_NGS/005_docker%E8%BF%9B%E9%98%B6/","text":"docker\u521b\u5efa\u955c\u50cf https://blog.51cto.com/14154700/2436956 \u5728 Dockerfile \u4e2d\uff0c \u6bcf\u4e00\u6761\u6307\u4ee4\u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a\u955c\u50cf\u5c42\uff0c\u7ee7\u800c\u4f1a\u589e\u52a0\u6574\u4f53\u955c\u50cf\u7684\u5927\u5c0f\u3002 \u7cbe\u7b80\u955c\u50cf https://bingohuang.com/simplify-docker-image-1/","title":"005 docker\u8fdb\u9636"},{"location":"10_NGS/005_docker%E8%BF%9B%E9%98%B6/#docker","text":"https://blog.51cto.com/14154700/2436956 \u5728 Dockerfile \u4e2d\uff0c \u6bcf\u4e00\u6761\u6307\u4ee4\u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a\u955c\u50cf\u5c42\uff0c\u7ee7\u800c\u4f1a\u589e\u52a0\u6574\u4f53\u955c\u50cf\u7684\u5927\u5c0f\u3002","title":"docker\u521b\u5efa\u955c\u50cf"},{"location":"10_NGS/005_docker%E8%BF%9B%E9%98%B6/#_1","text":"https://bingohuang.com/simplify-docker-image-1/","title":"\u7cbe\u7b80\u955c\u50cf"},{"location":"10_NGS/006_git/","text":"GitLab\u914d\u7f6e\u6dfb\u52a0SSH Key #\u5ba2\u6237\u7aef\u914d\u7f6e\u751f\u6210SSH\u5bc6\u94a5\u5bf9 [zhangbo@mu01 zhangbo]$ cd ~/.ssh/ [zhangbo@mu01 .ssh]$ ssh-keygen -t rsa -C \"2624699466@qq.com\" Generating public/private rsa key pair. Enter file in which to save the key (/home/zhangbo/.ssh/id_rsa): gitlab Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in gitlab. Your public key has been saved in gitlab.pub. The key fingerprint is: SHA256:K385paevBpvjUSFDih3LD3Dk1icc/vHniqQMQiUr1R4 2624699466@qq.com The key's randomart image is: +---[RSA 2048]----+ | ..+ o | | O O . | | + E B + | | . * + * + | | . o . S o . . | | o .o .o | | . o o+.+ . | | . =++*... | | .=++*o | +----[SHA256]-----+ SHA256:YMFuwIOIYjIB9wZK+vtVMykN469bPB39TOv8LXp60vM 2624699466@qq.com #\u6dfb\u52a0SSH Key\u5230GitLab \u767b\u5f55GitLab\u4e4b\u540e: Profile Settings => SSH Keys => Add SSH key","title":"006 git"},{"location":"10_NGS/006_git/#gitlabssh-key","text":"#\u5ba2\u6237\u7aef\u914d\u7f6e\u751f\u6210SSH\u5bc6\u94a5\u5bf9 [zhangbo@mu01 zhangbo]$ cd ~/.ssh/ [zhangbo@mu01 .ssh]$ ssh-keygen -t rsa -C \"2624699466@qq.com\" Generating public/private rsa key pair. Enter file in which to save the key (/home/zhangbo/.ssh/id_rsa): gitlab Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in gitlab. Your public key has been saved in gitlab.pub. The key fingerprint is: SHA256:K385paevBpvjUSFDih3LD3Dk1icc/vHniqQMQiUr1R4 2624699466@qq.com The key's randomart image is: +---[RSA 2048]----+ | ..+ o | | O O . | | + E B + | | . * + * + | | . o . S o . . | | o .o .o | | . o o+.+ . | | . =++*... | | .=++*o | +----[SHA256]-----+ SHA256:YMFuwIOIYjIB9wZK+vtVMykN469bPB39TOv8LXp60vM 2624699466@qq.com #\u6dfb\u52a0SSH Key\u5230GitLab \u767b\u5f55GitLab\u4e4b\u540e: Profile Settings => SSH Keys => Add SSH key","title":"GitLab\u914d\u7f6e\u6dfb\u52a0SSH Key"},{"location":"10_NGS/007_ack/","text":"","title":"007 ack"},{"location":"10_NGS/008_tmux/","text":"\u8f93\u5165 Tmux \u524d\u7f00\u548c\u4e00\u4e2a\u5192\u53f7\u547c\u51fa\u547d\u4ee4\u63d0\u793a\u884c session # \u5217\u51fa\u6240\u6709\u4f1a\u8bdd\uff1a tmux ls # \u65b0\u5efa\u4e00\u4e2a\u65e0\u540d\u79f0\u7684\u4f1a\u8bdd tmux # \u65b0\u5efa\u4e00\u4e2a\u540d\u79f0\u4e3ademo\u7684\u4f1a\u8bdd tmux new -s demo # \u65ad\u5f00\u5f53\u524d\u4f1a\u8bdd\uff0c\u4f1a\u8bdd\u5728\u540e\u53f0\u8fd0\u884c tmux detach # \u9ed8\u8ba4\u8fdb\u5165\u7b2c\u4e00\u4e2a\u4f1a\u8bdd tmux a # \u8fdb\u5165\u5230\u540d\u79f0\u4e3ademo\u7684\u4f1a\u8bdd tmux a -t demo # \u5173\u95eddemo\u4f1a\u8bdd tmux kill-session -t demo # \u5173\u95ed\u670d\u52a1\u5668\uff0c\u6240\u6709\u7684\u4f1a\u8bdd\u90fd\u5c06\u5173\u95ed tmux kill-server ## window c \u521b\u5efa\u65b0\u7a97\u53e3 w \u5217\u51fa\u6240\u6709\u7a97\u53e3 n \u540e\u4e00\u4e2a\u7a97\u53e3 p \u524d\u4e00\u4e2a\u7a97\u53e3 f \u67e5\u627e\u7a97\u53e3 , \u91cd\u547d\u540d\u5f53\u524d\u7a97\u53e3 & \u5173\u95ed\u5f53\u524d\u7a97\u53e3 % \u5782\u76f4\u5206\u5272 \" \u6c34\u5e73\u5206\u5272 o \u4ea4\u6362\u7a97\u683c x \u5173\u95ed\u7a97\u683c \u237d \u5de6\u8fb9\u8fd9\u4e2a\u7b26\u53f7\u4ee3\u8868\u7a7a\u683c\u952e - \u5207\u6362\u5e03\u5c40 q \u663e\u793a\u6bcf\u4e2a\u7a97\u683c\u662f\u7b2c\u51e0\u4e2a\uff0c\u5f53\u6570\u5b57\u51fa\u73b0\u7684\u65f6\u5019\u6309\u6570\u5b57\u51e0\u5c31\u9009\u4e2d\u7b2c\u51e0\u4e2a\u7a97\u683c { \u4e0e\u4e0a\u4e00\u4e2a\u7a97\u683c\u4ea4\u6362\u4f4d\u7f6e } \u4e0e\u4e0b\u4e00\u4e2a\u7a97\u683c\u4ea4\u6362\u4f4d\u7f6e z \u5207\u6362\u7a97\u683c\u6700\u5927\u5316/\u6700\u5c0f\u5316 \u8f93\u5165 Tmux \u524d\u7f00\u548c\u4e00\u4e2a\u5192\u53f7\u547c\u51fa\u547d\u4ee4\u63d0\u793a\u884c ## session # \u5217\u51fa\u6240\u6709\u4f1a\u8bdd\uff1a tmux ls # \u65b0\u5efa\u4e00\u4e2a\u65e0\u540d\u79f0\u7684\u4f1a\u8bdd tmux # \u65b0\u5efa\u4e00\u4e2a\u540d\u79f0\u4e3ademo\u7684\u4f1a\u8bdd tmux new -s demo # \u65ad\u5f00\u5f53\u524d\u4f1a\u8bdd\uff0c\u4f1a\u8bdd\u5728\u540e\u53f0\u8fd0\u884c tmux detach # \u9ed8\u8ba4\u8fdb\u5165\u7b2c\u4e00\u4e2a\u4f1a\u8bdd tmux a # \u8fdb\u5165\u5230\u540d\u79f0\u4e3ademo\u7684\u4f1a\u8bdd tmux a -t demo # \u5173\u95eddemo\u4f1a\u8bdd tmux kill-session -t demo # \u5173\u95ed\u670d\u52a1\u5668\uff0c\u6240\u6709\u7684\u4f1a\u8bdd\u90fd\u5c06\u5173\u95ed tmux kill-server ## window # \u521b\u5efa\u65b0\u7a97\u53e3 prefix + c # \u5217\u51fa\u6240\u6709\u7a97\u53e3 prefix + w # \u540e\u4e00\u4e2a\u7a97\u53e3 n #\u524d\u4e00\u4e2a\u7a97\u53e3 p #\u91cd\u547d\u540d\u5f53\u524d\u7a97\u53e3 , \u5173\u95ed\u5f53\u524d\u7a97\u53e3 & % \u5782\u76f4\u5206\u5272 \" \u6c34\u5e73\u5206\u5272 o \u4ea4\u6362\u7a97\u683c x \u5173\u95ed\u7a97\u683c \u237d \u5de6\u8fb9\u8fd9\u4e2a\u7b26\u53f7\u4ee3\u8868\u7a7a\u683c\u952e - \u5207\u6362\u5e03\u5c40 q \u663e\u793a\u6bcf\u4e2a\u7a97\u683c\u662f\u7b2c\u51e0\u4e2a\uff0c\u5f53\u6570\u5b57\u51fa\u73b0\u7684\u65f6\u5019\u6309\u6570\u5b57\u51e0\u5c31\u9009\u4e2d\u7b2c\u51e0\u4e2a\u7a97\u683c { \u4e0e\u4e0a\u4e00\u4e2a\u7a97\u683c\u4ea4\u6362\u4f4d\u7f6e } \u4e0e\u4e0b\u4e00\u4e2a\u7a97\u683c\u4ea4\u6362\u4f4d\u7f6e z \u5207\u6362\u7a97\u683c\u6700\u5927\u5316/\u6700\u5c0f\u5316","title":"008 tmux"},{"location":"10_NGS/008_tmux/#session","text":"# \u5217\u51fa\u6240\u6709\u4f1a\u8bdd\uff1a tmux ls # \u65b0\u5efa\u4e00\u4e2a\u65e0\u540d\u79f0\u7684\u4f1a\u8bdd tmux # \u65b0\u5efa\u4e00\u4e2a\u540d\u79f0\u4e3ademo\u7684\u4f1a\u8bdd tmux new -s demo # \u65ad\u5f00\u5f53\u524d\u4f1a\u8bdd\uff0c\u4f1a\u8bdd\u5728\u540e\u53f0\u8fd0\u884c tmux detach # \u9ed8\u8ba4\u8fdb\u5165\u7b2c\u4e00\u4e2a\u4f1a\u8bdd tmux a # \u8fdb\u5165\u5230\u540d\u79f0\u4e3ademo\u7684\u4f1a\u8bdd tmux a -t demo # \u5173\u95eddemo\u4f1a\u8bdd tmux kill-session -t demo # \u5173\u95ed\u670d\u52a1\u5668\uff0c\u6240\u6709\u7684\u4f1a\u8bdd\u90fd\u5c06\u5173\u95ed tmux kill-server ## window c \u521b\u5efa\u65b0\u7a97\u53e3 w \u5217\u51fa\u6240\u6709\u7a97\u53e3 n \u540e\u4e00\u4e2a\u7a97\u53e3 p \u524d\u4e00\u4e2a\u7a97\u53e3 f \u67e5\u627e\u7a97\u53e3 , \u91cd\u547d\u540d\u5f53\u524d\u7a97\u53e3 & \u5173\u95ed\u5f53\u524d\u7a97\u53e3 % \u5782\u76f4\u5206\u5272 \" \u6c34\u5e73\u5206\u5272 o \u4ea4\u6362\u7a97\u683c x \u5173\u95ed\u7a97\u683c \u237d \u5de6\u8fb9\u8fd9\u4e2a\u7b26\u53f7\u4ee3\u8868\u7a7a\u683c\u952e - \u5207\u6362\u5e03\u5c40 q \u663e\u793a\u6bcf\u4e2a\u7a97\u683c\u662f\u7b2c\u51e0\u4e2a\uff0c\u5f53\u6570\u5b57\u51fa\u73b0\u7684\u65f6\u5019\u6309\u6570\u5b57\u51e0\u5c31\u9009\u4e2d\u7b2c\u51e0\u4e2a\u7a97\u683c { \u4e0e\u4e0a\u4e00\u4e2a\u7a97\u683c\u4ea4\u6362\u4f4d\u7f6e } \u4e0e\u4e0b\u4e00\u4e2a\u7a97\u683c\u4ea4\u6362\u4f4d\u7f6e z \u5207\u6362\u7a97\u683c\u6700\u5927\u5316/\u6700\u5c0f\u5316 \u8f93\u5165 Tmux \u524d\u7f00\u548c\u4e00\u4e2a\u5192\u53f7\u547c\u51fa\u547d\u4ee4\u63d0\u793a\u884c ## session # \u5217\u51fa\u6240\u6709\u4f1a\u8bdd\uff1a tmux ls # \u65b0\u5efa\u4e00\u4e2a\u65e0\u540d\u79f0\u7684\u4f1a\u8bdd tmux # \u65b0\u5efa\u4e00\u4e2a\u540d\u79f0\u4e3ademo\u7684\u4f1a\u8bdd tmux new -s demo # \u65ad\u5f00\u5f53\u524d\u4f1a\u8bdd\uff0c\u4f1a\u8bdd\u5728\u540e\u53f0\u8fd0\u884c tmux detach # \u9ed8\u8ba4\u8fdb\u5165\u7b2c\u4e00\u4e2a\u4f1a\u8bdd tmux a # \u8fdb\u5165\u5230\u540d\u79f0\u4e3ademo\u7684\u4f1a\u8bdd tmux a -t demo # \u5173\u95eddemo\u4f1a\u8bdd tmux kill-session -t demo # \u5173\u95ed\u670d\u52a1\u5668\uff0c\u6240\u6709\u7684\u4f1a\u8bdd\u90fd\u5c06\u5173\u95ed tmux kill-server ## window # \u521b\u5efa\u65b0\u7a97\u53e3 prefix + c # \u5217\u51fa\u6240\u6709\u7a97\u53e3 prefix + w # \u540e\u4e00\u4e2a\u7a97\u53e3 n #\u524d\u4e00\u4e2a\u7a97\u53e3 p #\u91cd\u547d\u540d\u5f53\u524d\u7a97\u53e3 , \u5173\u95ed\u5f53\u524d\u7a97\u53e3 & % \u5782\u76f4\u5206\u5272 \" \u6c34\u5e73\u5206\u5272 o \u4ea4\u6362\u7a97\u683c x \u5173\u95ed\u7a97\u683c \u237d \u5de6\u8fb9\u8fd9\u4e2a\u7b26\u53f7\u4ee3\u8868\u7a7a\u683c\u952e - \u5207\u6362\u5e03\u5c40 q \u663e\u793a\u6bcf\u4e2a\u7a97\u683c\u662f\u7b2c\u51e0\u4e2a\uff0c\u5f53\u6570\u5b57\u51fa\u73b0\u7684\u65f6\u5019\u6309\u6570\u5b57\u51e0\u5c31\u9009\u4e2d\u7b2c\u51e0\u4e2a\u7a97\u683c { \u4e0e\u4e0a\u4e00\u4e2a\u7a97\u683c\u4ea4\u6362\u4f4d\u7f6e } \u4e0e\u4e0b\u4e00\u4e2a\u7a97\u683c\u4ea4\u6362\u4f4d\u7f6e z \u5207\u6362\u7a97\u683c\u6700\u5927\u5316/\u6700\u5c0f\u5316","title":"session"},{"location":"10_NGS/009_NCBI/","text":"api https://www.ncbi.nlm.nih.gov/home/develop/api/","title":"api"},{"location":"10_NGS/009_NCBI/#api","text":"https://www.ncbi.nlm.nih.gov/home/develop/api/","title":"api"},{"location":"10_NGS/010_Allele%20Balance/","text":"","title":"010 Allele Balance"},{"location":"10_NGS/011_ORF/","text":"","title":"011 ORF"},{"location":"10_NGS/012_%E4%B8%8B%E8%BD%BD/","text":"rsync\u65ad\u70b9\u7eed\u4f20 \u7f51\u7edc\u4f20\u8f93\u901f\u5ea6\u5f88\u5927\u7a0b\u5ea6\u4e0a\u4f1a\u5f71\u54cd\u6211\u7684\u5de5\u4f5c\u3002\u670d\u52a1\u5668\u4e0e\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u8fde\uff0c\u6709\u65f6scp\u4e0d\u662f\u6700\u597d\u7684\u9009\u62e9\uff0c\u4f8b\u5982\uff1a\u7f51\u7edc\u51fa\u73b0\u95ee\u9898\uff0c\u4e24\u4e2a\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u8fde\u63a5\u65ad\u5f00\u540e\uff0c\u4f7f\u7528scp\u518d\u6b21\u8fde\u63a5\u65f6\u65e0\u6cd5\u8fdb\u884c\u65ad\u70b9\u7eed\u4f20\u3002 \u4f7f\u7528rsync\u505a\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u6587\u4ef6\u4f20\u8f93\uff08\u5907\u4efd\uff09\uff0c\u53ef\u4ee5\u505a\u5230\u65ad\u70b9\u7eed\u4f20\u3002 rsync -avzP -e 'ssh -p 8888' abc@xxx.xxx.xxx.xxxx:/home/abc/filename ./ wget\u5e76\u884c\u4e0b\u8f7d -P 8\u516b\u7ebf\u7a0b\uff0c-t 0\u65e0\u9650\u91cd\u8bd5\uff0c-nv \u4e0b\u8f7d\u65f6\u53ea\u663e\u793a\u66f4\u65b0\u548c\u51fa\u9519\u4fe1\u606f\uff0c\u4e0d\u663e\u793a\u6307\u4ee4\u7684\u8be6\u7ec6\u6267\u884c\u8fc7\u7a0b \u5c31\u662f\u8f93\u5165\u7684\u5730\u5740urls.txt\uff0c\u6bcf\u4e00\u884c\u7528\u4e00\u4e2awget\u547d\u4ee4\u8fdb\u884c\u4e0b\u8f7d\uff0c\u4e00\u6b21\u6700\u591a\u540c\u65f6\u4e0b\u8f7d8\u4e2a\u6587\u4ef6\u3002 xargs -P 8 -n 1 wget -nv -c -t 0 <urls.txt wget\u4e0b\u8f7d\u52a8\u6001\u8fde\u63a5\u7684\u6587\u4ef6 wget -c 'http://some.site.com/download?id=234&status=download' -O output_filename \u968f\u65f6\u4e0a\u7f51\u68c0\u7d22\u4e00\u4e0b\uff0c\u4e0a\u9762\u8fd9\u4e2a\u65b9\u6cd5\u4e0d\u4e00\u5b9a\u6bcf\u4e2a\u52a8\u6001\u8fde\u63a5\u7684\u6587\u4ef6\u90fd\u80fd\u4e0b\u8f7d\uff0c\u4f8b\u5982google\u7f51\u76d8\u7684\u3002 aria2\u5206\u6bb5\u4e0b\u8f7d\u5927\u6587\u4ef6 -s 3 \u5206\u62103\u4efd\uff0c-x 3 \u75283\u4e2a\u8fde\u63a5\u4ece\u670d\u52a1\u5668\u4e0b\u8f7d\u6587\u4ef6 aria2c -s 3 -x 3 \"https://baidu.com/d/datadump.current.zip\" bypy\u5c06\u767e\u5ea6\u4e91\u76d8\u6570\u636e\u4e0b\u8f7d\u5230\u670d\u52a1\u5668 \u5b89\u88c5\u4fe1\u606f\uff1a(bypy)[https://github.com/houtianze/bypy] \u6d4b\u8bd5\u53d1\u73b0\uff0c\u5927\u6587\u4ef6\u4e0a\u4f20\u6bd4\u6162\u3002\u6587\u4ef6\u53ea\u80fd\u4e0a\u4f20\u5230\u5168\u90e8\u6587\u4ef6>apps>bypy\u8fd9\u4e2a\u6587\u4ef6\u5939\u3002 \u4e0b\u8f7d\u4e00\u7cfb\u5217FTP\u4e0a\u7684\u6587\u4ef6 \u8fd9\u662f\u538b\u7bb1\u5e95\u7684\u8001\u7a0b\u5e8f\uff0cfiletype\u8fd9\u91cc\u5176\u5b9e\u4e0d\u9700\u8981\u4f7f\u7528\u4e00\u4e2a\u5faa\u73af\uff0c\u5982\u679c\u53ea\u6709\u4e00\u4e2a\u7c7b\u578b\u7684\u8bdd\uff0c\u76f4\u63a5\u5728\u4e0b\u8f7d\u7684\u5faa\u73af\u4e2d\u7528grep\u7b5b\u51fa\u8fd9\u4e2a\u53d8\u91cf\u3002 #!/bin/bash for filetype in pdf; do for net in `grep \"$filetype\" file.list2 | sed \"s/\\<td\\>\\<a href=\\\"//g\" | sed \"s/\\\"//g\" | sed \"s/<TD//g\"`; do if [ ! -f $net ] then echo $net #wget $path/$net fi done done","title":"012 \u4e0b\u8f7d"},{"location":"10_NGS/013_bed/","text":"\u62ff\u5230\u4e00\u4e2a\u672a\u77e5\u7684 \u9996\u5148\u5e94\u8be5\u505a\u7684\u7684\u5c31\u662fsort merge sort -k1,1 -k2,2n -k3,3n #sort -i A. tools merge [OPTIONS] -i </GFF/VCF/BAM>","title":"013 bed"},{"location":"10_NGS/014_blat/","text":"\u5bf9psl\u8f93\u51fa\u7ed3\u679c\uff0c\u9700\u8981\u6ce8\u610f\u4e00\u4e0b\u51e0\u70b9\uff1a blat\u7684\u7ed3\u679c\u5728subject\u4e0a\u5141\u8bb8\u5b58\u5728\u5f88\u5927\u7684gap\uff08intron\u533a\u57df\uff09\uff0c\u6240\u4ee5\u540c\u4e00\u4e2a\u7ed3\u679c\u5728query\u548csubjects\u4e0a\u8986\u76d6\u7684\u533a\u57df\u53ef\u80fd\u4f1a\u76f8\u5dee\u5f88\u591a\uff0c\u8fd9\u4e00\u70b9\u4e0eblast\u4e0d\u540c\u3002 \u5728\u57fa\u56e0\u5bf9\u57fa\u56e0\u7ec4\u7684\u6bd4\u5bf9\u4e2d\uff0cblock\u7684\u4e2a\u6570\u4e0d\u80fd\u7b49\u540c\u4e8eexon\u7684\u4e2a\u6570\u3002\u56e0\u4e3ablat\u5bf9block\u7684\u5b9a\u4e49\u662f\u4e00\u4e2a\u6ca1\u6709\u63d2\u5165\u7f3a\u5931\u7684\u6bd4\u5bf9\uff0c\u4efb\u4f55\u63d2\u5165\u6216\u8005\u7f3a\u5931\u7684\u78b1\u57fa\u90fd\u4f1a\u4f7f\u4e00\u4e2ablock\u7ec8\u6b62\uff0c\u6240\u4ee5\u4e00\u4e2aexon\u5f88\u53ef\u80fd\u662f\u6709\u5f88\u591ablock\u6784\u6210\u7684\u3002\u56e0\u6b64exon\u548cintron\u7684\u4e2a\u6570\u8981\u901a\u8fc7\u8db3\u591f\u5927\u7684gap\u6765\u5224\u65ad\u3002 psl\u7ed3\u679c\u91cc\u9762\u78b1\u57fa\u4f4d\u7f6e\u7684\u8ba1\u7b97\u662f\u4ece0\u5f00\u59cb\u7684\u800c\u4e0d\u662f1. #blat\u5e38\u89c1\u7528\u6cd5 #\u5904\u7406\u5355\u4e2ajob blat chr11.fa human/test.fa test.psl #\u8f93\u51fa\u4e0d\u542b\u5e8f\u5217 blat chr11.fa human/test.fa -out=pslx test.pslx #\u8f93\u51fa\u542b\u5e8f\u5217 blat chr11.fa human/test.fa -out=blast test.blast #\u8f93\u51fa\u683c\u5f0f\u540cNABI\u7684blast\u683c\u5f0f #\u5e76\u884c\u5904\u7406\u591a\u4e2ajobs time parallel blat chr{}.fa human/human.fa test_{}.psl ::: {1..22} X Y M","title":"014 blat"},{"location":"10_NGS/03/","text":"https://www.bioinfo-scrounger.com/archives/660/ https://www.bioinfo-scrounger.com/archives/647/ https://www.bioinfo-scrounger.com/archives/650/","title":"03"},{"location":"10_NGS/01_QC/01_cutadapt/","text":"Removing adapters \u63a5\u5934\u7684\u79cd\u7c7b\uff1a + Demultiplexing #adapter\u89e3\u6790\uff1breads\u6839\u636eadapter\u4e0d\u540c\u8f93\u51fa\u5230\u4e0d\u540c\u7684\u6587\u4ef6 cutadapt -a one=TATA -a two=GCGC -o trimmed-{name}.fastq.gz input.fastq.gz #result files: demulti-one.fastq.gz, demulti-two.fastq.gz and demulti-unknown.fastq.gz cutadapt -a file:barcodes.fasta --no-trim --untrimmed-o untrimmed.fastq.gz -o trimmed-{name}.fastq.gz input.fastq.gz #result files: trimmed-first.1.fastq.gz, trimmed-second.1.fastq.gz, trimmed-unknown.1.fastq.gz and trimmed-first.2.fastq.gz, trimmed-second.2.fastq.gz, trimmed-unknown.2.fastq.gz https://www.jianshu.com/p/4ee2f4d2292f","title":"01 cutadapt"},{"location":"10_NGS/01_QC/01_cutadapt/#removing-adapters","text":"\u63a5\u5934\u7684\u79cd\u7c7b\uff1a +","title":"Removing adapters"},{"location":"10_NGS/01_QC/01_cutadapt/#demultiplexing","text":"#adapter\u89e3\u6790\uff1breads\u6839\u636eadapter\u4e0d\u540c\u8f93\u51fa\u5230\u4e0d\u540c\u7684\u6587\u4ef6 cutadapt -a one=TATA -a two=GCGC -o trimmed-{name}.fastq.gz input.fastq.gz #result files: demulti-one.fastq.gz, demulti-two.fastq.gz and demulti-unknown.fastq.gz cutadapt -a file:barcodes.fasta --no-trim --untrimmed-o untrimmed.fastq.gz -o trimmed-{name}.fastq.gz input.fastq.gz #result files: trimmed-first.1.fastq.gz, trimmed-second.1.fastq.gz, trimmed-unknown.1.fastq.gz and trimmed-first.2.fastq.gz, trimmed-second.2.fastq.gz, trimmed-unknown.2.fastq.gz https://www.jianshu.com/p/4ee2f4d2292f","title":"Demultiplexing"},{"location":"10_NGS/01_QC/05_fastp/","text":"\u5904\u7406\u6b65\u9aa4\uff1a 1, UMI preprocessing (--umi) 2, global trimming at front (--trim_front) 3, global trimming at tail (--trim_tail) 4, quality pruning at 5' (--cut_front) 5, quality pruning by sliding window (--cut_right) 6, quality pruning at 3' (--cut_tail) 7, trim polyG (--trim_poly_g, enabled by default for NovaSeq/NextSeq data) 8, trim adapter by overlap analysis (enabled by default for PE data) 9, trim adapter by adapter sequence (--adapter_sequence, --adapter_sequence_r2. For PE data, this step is skipped if last step succeeded) 10, trim polyX (--trim_poly_x) 11, trim to max length (---max_len)","title":"05 fastp"},{"location":"11_ML/001_/","text":"\u65e0\u76d1\u7763\u662f\u8bad\u7ec3\u96c6\u6ca1\u6709\u6807\u51c6\u7b54\u6848\uff1b \u65e0\u76d1\u7763\u5b66\u4e60\u662f\u6307\u5bf9\u6ca1\u6709\u6253\u6807\u7b7e\u7684\u6837\u672c\u8fdb\u884c\u5b66\u4e60\uff0c\u76ee\u6807\u662f\u53d1\u73b0\u8bad\u7ec3\u6837\u672c\u7684\u4e2d\u7684\u7ed3\u6784\u6027\u77e5\u8bc6\u3002\u5728\u8fd9\u91cc\uff0c\u5b66\u4e60\u7684\u6837\u672c\u662f\u6ca1\u6709\u6807\u8bb0\u7684\u3002 \u5e38\u89c1\u7684\u65e0\u76d1\u7763\u5b66\u4e60\u7b97\u6cd5\u6709:\u805a\u7c7b\uff0cPCA\u3001\u751f\u6210\u5bf9\u6297\u7f51\u7edc\u3002 \u76d1\u7763\u5b66\u4e60\u662f\u8bad\u7ec3\u96c6\u90fd\u6709\u6807\u51c6\u7b54\u6848\uff1b \u76d1\u7763\u5b66\u4e60\u662f\u6307\u5bf9\u5df2\u7ecf\u6253\u597d\u6807\u7b7e\u7684\u8bad\u7ec3\u6837\u672c\u8fdb\u884c\u5b66\u4e60\uff0c\u76ee\u6807\u662f\u5bf9\u8bad\u7ec3\u6837\u672c\u96c6\u4e4b\u5916\u7684\u6570\u636e\u8fdb\u884c\u9884\u6d4b\u7684\u5b66\u4e60\u65b9\u5f0f\u3002 \u5e38\u89c1\u7684\u76d1\u7763\u5b66\u4e60\u7b97\u6cd5\u6709:\u652f\u6301\u5411\u91cf\u673a\uff08SVM\uff09\uff0cKNN\uff0c\u51b3\u7b56\u6811\uff0c\u6734\u7d20\u8d1d\u53f6\u65af\uff0c\u903b\u8f91\u56de\u5f52\u3002 \u534a\u76d1\u7763\u5b66\u4e60\u662f\u4e00\u5c0f\u90e8\u5206\u8bad\u7ec3\u96c6\u6709\u6807\u51c6\u7b54\u6848\uff0c\u5927\u90e8\u5206\u8bad\u7ec3\u96c6\u6ca1\u6709\u6807\u51c6\u7b54\u6848\uff1b \u5e38\u89c1\u7684\u534a\u76d1\u7763\u5b66\u4e60\u7b97\u6cd5:TSVM\uff0cS3VM\uff0c\u751f\u6210\u5f0f\u65b9\u6cd5\uff0c\u534a\u76d1\u7763\u805a\u7c7b\u3002 \u5f3a\u5316\u5b66\u4e60\u662f\u7ed9\u5230\u5956\u52b1\u6216\u60e9\u7f5a\u7684\u523a\u6fc0\uff0c\u901a\u8fc7\u8bd5\u9519\u548c\u53cd\u9988\u6765\u8fdb\u884c\u5b66\u4e60\u3002 \u6781\u5927\u4f3c\u7136\u6cd5 \u6700\u5c0f\u4e8c\u4e58 \u6781\u5927\u4f3c\u7136\u4f30\u8ba1\u4ece\u5b57\u9762\u4e0a\u6765\u7406\u89e3\u53ef\u4ee5\u62c6\u6210\u4e09\u4e2a\u8bcd\uff0c\u5206\u522b\u662f\u201c\u6781\u5927\u201d\u3001\u201c\u4f3c\u7136\u201d\u3001\u201c\u4f30\u8ba1\u201d\uff0c\u5206\u522b\u7684\u610f\u601d\u5982\u4e0b\uff1a \u6781\u5927:\u6700\u5927\u7684\u6982\u7387 \u4f3c\u7136\uff1a\u770b\u8d77\u6765\u662f\u8fd9\u4e2a\u6837\u5b50\u7684 \u4f30\u8ba1\uff1a\u5c31\u662f\u8fd9\u4e2a\u6837\u5b50\u7684 \u8fde\u8d77\u6765\u5c31\u662f\uff0c\u6700\u5927\u7684\u6982\u7387\u770b\u8d77\u6765\u662f\u8fd9\u4e2a\u6837\u5b50\u7684\u90a3\u5c31\u662f\u8fd9\u4e2a\u6837\u5b50\u7684\u3002\u600e\u4e48\u6837\uff0c\u662f\u4e0d\u662f\u5f88\u6734\u7d20\uff1f \u6781\u5927\u4f3c\u7136\u6cd5\uff08the Principle of Maximum Likelihood\uff09\u662f\u7531\u9ad8\u65af\u548c\u8d39\u5e0c\u5c14\u5148\u540e\u63d0\u51fa\u7684\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u7684\u57fa\u7840\u662f\u6781\u5927\u4f3c\u7136\u539f\u7406\u3002 \u6781\u5927\u4f3c\u7136\u6cd5\u7684\u539f\u7406\u662f\uff1a\u6837\u672c\u6240\u5c55\u73b0\u7684\u72b6\u6001\u5c31\u662f\u6240\u6709\u53ef\u80fd\u72b6\u6001\u4e2d\u51fa\u73b0\u6982\u7387\u6700\u5927\u7684\u90a3\u4e2a\u72b6\u6001\u3002 \u4e0e\u6700\u5c0f\u4e8c\u4e58\u7684\u533a\u522b\uff1f 1\uff09\u6700\u5c0f\u4e8c\u4e58\u662f\u6c42\u8ba1\u7b97\u503c\u4e0e\u5b9e\u9645\u503c\u7684\u6b27\u5f0f\u8ddd\u79bb\u6700\u5c0f\u7684\u53c2\u6570\uff0c\u662f\u4ecelost function\u7684\u89d2\u5ea6\u53bb\u770b\u7684\u3002\u800c\u6781\u5927\u4f3c\u7136\u662f\u6c42\u76ee\u524d\u8fd9\u4e2a\u89c2\u6d4b\u6570\u636e\u51fa\u73b0\u6982\u7387\u6700\u5927\u7684\u53c2\u6570\uff0c\u662f\u4ece\u6982\u7387\u7684\u89d2\u5ea6\u53bb\u770b\u3002 2\uff09\u6781\u5927\u4f3c\u7136\u662f\u8981\u6709\u5206\u5e03\u5047\u8bbe\u7684\uff0c\u800c\u6700\u5c0f\u4e8c\u4e58\u6ca1\u6709\u8fd9\u4e2a\u5047\u8bbe\u3002 3\uff09\u5f53\u6781\u5927\u4f3c\u7136\u7684\u5206\u5e03\u5047\u8bbe\u4e3a\u9ad8\u65af\u5206\u5e03\u7684\u65f6\u5019\uff0c\u662f\u548c\u6700\u5c0f\u4e8c\u4e58\u6cd5\u7b49\u4ef7\u7684\u3002 \u903b\u8f91\u56de\u5f52\u548c\u7ebf\u6027\u56de\u5f52 https://www.jianshu.com/p/eb6de2925a57 \u8861\u91cf\u6a21\u578b\u597d\u574f \u51c6\u786e\u7387 = \u9009\u51fa\u7684\u6b63\u786e\u4fe1\u606f\u6761\u6570 / \u9009\u51fa\u7684\u4fe1\u606f\u603b\u6761\u6570 \u53ec\u56de\u7387 = \u9009\u51fa\u6b63\u786e\u4fe1\u606f\u6761\u6570 / \u6837\u672c\u4e2d\u7684\u4fe1\u606f\u6761\u6570 \u4e3e\u4e2a\u6817\u5b50\uff0c\u6211\u4eec\u6709100\u4e2a\u82f9\u679c\u670990\u4e2a\u662f\u597d\u7684\uff0c10\u4e2a\u662f\u574f\u7684\u3002 \u6211\u4eec\u5f04\u4e86\u4e00\u4e2a\u7b97\u6cd5\u6765\u627e\u51fa\u574f\u7684\u82f9\u679c\u3002\u6211\u4eec\u5224\u65ad85\u4e2a\u662f\u597d\u7684\uff0c15\u4e2a\u662f\u574f\u7684\u3002\u5176\u4e2d85\u4e2a\u597d\u7684\u91cc\u9762\uff0c\u67092\u4e2a\u662f\u574f\u7684\uff1b15\u4e2a\u574f\u7684\u91cc\u9762\u67097\u4e2a\u662f\u597d\u7684\u3002 \u51c6\u786e\u7387= 8/15 = 53.33% \u53ec\u56de\u7387= 8/10 = 80% F\u503c\uff08F-Score\uff09= \u51c6\u786e\u7387\u53ec\u56de\u73872/(\u51c6\u786e\u7387+\u53ec\u56de\u7387) \u4e0a\u9762\u9009\u82f9\u679c\u7684\u4f8b\u5b50\uff0cF\u503c= 0.53330.82 /(0.5333+0.8) = 63.99% ROC\u548cAUC","title":"001 "},{"location":"11_ML/001_/#_1","text":"","title":"\u6781\u5927\u4f3c\u7136\u6cd5 \u6700\u5c0f\u4e8c\u4e58"},{"location":"11_ML/001_/#_2","text":"\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\u4ece\u5b57\u9762\u4e0a\u6765\u7406\u89e3\u53ef\u4ee5\u62c6\u6210\u4e09\u4e2a\u8bcd\uff0c\u5206\u522b\u662f\u201c\u6781\u5927\u201d\u3001\u201c\u4f3c\u7136\u201d\u3001\u201c\u4f30\u8ba1\u201d\uff0c\u5206\u522b\u7684\u610f\u601d\u5982\u4e0b\uff1a \u6781\u5927:\u6700\u5927\u7684\u6982\u7387 \u4f3c\u7136\uff1a\u770b\u8d77\u6765\u662f\u8fd9\u4e2a\u6837\u5b50\u7684 \u4f30\u8ba1\uff1a\u5c31\u662f\u8fd9\u4e2a\u6837\u5b50\u7684 \u8fde\u8d77\u6765\u5c31\u662f\uff0c\u6700\u5927\u7684\u6982\u7387\u770b\u8d77\u6765\u662f\u8fd9\u4e2a\u6837\u5b50\u7684\u90a3\u5c31\u662f\u8fd9\u4e2a\u6837\u5b50\u7684\u3002\u600e\u4e48\u6837\uff0c\u662f\u4e0d\u662f\u5f88\u6734\u7d20\uff1f \u6781\u5927\u4f3c\u7136\u6cd5\uff08the Principle of Maximum Likelihood\uff09\u662f\u7531\u9ad8\u65af\u548c\u8d39\u5e0c\u5c14\u5148\u540e\u63d0\u51fa\u7684\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u7684\u57fa\u7840\u662f\u6781\u5927\u4f3c\u7136\u539f\u7406\u3002 \u6781\u5927\u4f3c\u7136\u6cd5\u7684\u539f\u7406\u662f\uff1a\u6837\u672c\u6240\u5c55\u73b0\u7684\u72b6\u6001\u5c31\u662f\u6240\u6709\u53ef\u80fd\u72b6\u6001\u4e2d\u51fa\u73b0\u6982\u7387\u6700\u5927\u7684\u90a3\u4e2a\u72b6\u6001\u3002","title":""},{"location":"11_ML/001_/#_3","text":"1\uff09\u6700\u5c0f\u4e8c\u4e58\u662f\u6c42\u8ba1\u7b97\u503c\u4e0e\u5b9e\u9645\u503c\u7684\u6b27\u5f0f\u8ddd\u79bb\u6700\u5c0f\u7684\u53c2\u6570\uff0c\u662f\u4ecelost function\u7684\u89d2\u5ea6\u53bb\u770b\u7684\u3002\u800c\u6781\u5927\u4f3c\u7136\u662f\u6c42\u76ee\u524d\u8fd9\u4e2a\u89c2\u6d4b\u6570\u636e\u51fa\u73b0\u6982\u7387\u6700\u5927\u7684\u53c2\u6570\uff0c\u662f\u4ece\u6982\u7387\u7684\u89d2\u5ea6\u53bb\u770b\u3002 2\uff09\u6781\u5927\u4f3c\u7136\u662f\u8981\u6709\u5206\u5e03\u5047\u8bbe\u7684\uff0c\u800c\u6700\u5c0f\u4e8c\u4e58\u6ca1\u6709\u8fd9\u4e2a\u5047\u8bbe\u3002 3\uff09\u5f53\u6781\u5927\u4f3c\u7136\u7684\u5206\u5e03\u5047\u8bbe\u4e3a\u9ad8\u65af\u5206\u5e03\u7684\u65f6\u5019\uff0c\u662f\u548c\u6700\u5c0f\u4e8c\u4e58\u6cd5\u7b49\u4ef7\u7684\u3002","title":"\u4e0e\u6700\u5c0f\u4e8c\u4e58\u7684\u533a\u522b\uff1f"},{"location":"11_ML/001_/#_4","text":"https://www.jianshu.com/p/eb6de2925a57","title":"\u903b\u8f91\u56de\u5f52\u548c\u7ebf\u6027\u56de\u5f52"},{"location":"11_ML/001_/#_5","text":"\u51c6\u786e\u7387 = \u9009\u51fa\u7684\u6b63\u786e\u4fe1\u606f\u6761\u6570 / \u9009\u51fa\u7684\u4fe1\u606f\u603b\u6761\u6570 \u53ec\u56de\u7387 = \u9009\u51fa\u6b63\u786e\u4fe1\u606f\u6761\u6570 / \u6837\u672c\u4e2d\u7684\u4fe1\u606f\u6761\u6570 \u4e3e\u4e2a\u6817\u5b50\uff0c\u6211\u4eec\u6709100\u4e2a\u82f9\u679c\u670990\u4e2a\u662f\u597d\u7684\uff0c10\u4e2a\u662f\u574f\u7684\u3002 \u6211\u4eec\u5f04\u4e86\u4e00\u4e2a\u7b97\u6cd5\u6765\u627e\u51fa\u574f\u7684\u82f9\u679c\u3002\u6211\u4eec\u5224\u65ad85\u4e2a\u662f\u597d\u7684\uff0c15\u4e2a\u662f\u574f\u7684\u3002\u5176\u4e2d85\u4e2a\u597d\u7684\u91cc\u9762\uff0c\u67092\u4e2a\u662f\u574f\u7684\uff1b15\u4e2a\u574f\u7684\u91cc\u9762\u67097\u4e2a\u662f\u597d\u7684\u3002 \u51c6\u786e\u7387= 8/15 = 53.33% \u53ec\u56de\u7387= 8/10 = 80% F\u503c\uff08F-Score\uff09= \u51c6\u786e\u7387\u53ec\u56de\u73872/(\u51c6\u786e\u7387+\u53ec\u56de\u7387) \u4e0a\u9762\u9009\u82f9\u679c\u7684\u4f8b\u5b50\uff0cF\u503c= 0.53330.82 /(0.5333+0.8) = 63.99% ROC\u548cAUC","title":"\u8861\u91cf\u6a21\u578b\u597d\u574f"},{"location":"11_ML/%E8%B4%9D%E5%8F%B6%E6%96%AF/","text":"","title":"\u8d1d\u53f6\u65af"},{"location":"12_RNA/00/","text":"rnaseq umi https://janbio.home.blog","title":"00"},{"location":"12_RNA/00/#rnaseq-umi","text":"https://janbio.home.blog","title":"rnaseq umi"},{"location":"12_RNA/miRNA/01/","text":"","title":"01"},{"location":"13_R_PERL_wdl/00.PERL/","text":"\u5b89\u88c5\u6a21\u5757 \u624b\u5de5\u5b89\u88c5 # \u4ece CPAN(https://metacpan.org/)\u4e0b\u8f7d\u4e86 BioPerl \u6a21\u5757 1.7.5 \u7248\u7684\u538b\u7f29\u6587\u4ef6 BioPerl-1.7.5.tar.gz # \u5047\u8bbe\u653e\u5728/usr/local/src/\u4e0b\u3002 $ cd /usr/local/src # \u89e3\u538b\u7f29\u8fd9\u4e2a\u6587\u4ef6,\u8fd9\u65f6\u4f1a\u65b0\u5efa\u4e00\u4e2a BioPerl-1.7.5 \u7684\u76ee\u5f55\u3002 $ tar xvzf BioPerl-1.7.5.tar.gz # \u6362\u5230\u89e3\u538b\u540e\u7684\u76ee\u5f55 $ cd BioPerl-1.7.5 # \u751f\u6210 makefile\uff0c\u5982\u679c\u8981\u6307\u5b9a\u6a21\u5757\u7684\u5b89\u88c5\u8def\u5f84\uff0c\u9700\u8981\u6dfb\u52a0 PREFIX=/path/to/install \u8def\u5f84 $ perl Makefile.PL (PREFIX=/home/shenweiyan/perl_modules) # \u751f\u6210\u6a21\u5757 $ make # \u6d4b\u8bd5\u6a21\u5757(\u8fd9\u6b65\u53ef\u6709\u53ef\u65e0)\uff1a $ make test # \u5982\u679c\u6d4b\u8bd5\u7ed3\u679c\u62a5\u544a\"all test ok\"\uff0c\u60a8\u5c31\u53ef\u4ee5\u653e\u5fc3\u5730\u5b89\u88c5\u7f16\u8bd1\u597d\u7684\u6a21\u5757\u4e86\u3002 # \u5b89\u88c5\u6a21\u5757\u524d\uff0c\u5148\u8981\u786e\u4fdd\u60a8\u5bf9 perl5 \u5b89\u88c5\u76ee\u5f55\u6709\u53ef\u5199\u6743\u9650(\u901a\u5e38\u4ee5 su \u547d\u4ee4\u83b7\u5f97)\uff0c\u6267\u884c\uff1a $ make install # \u73b0\u5728\uff0c\u8bd5\u8bd5 Bio::SeqIO \u6a21\u5757\u5427\u3002\u5982\u679c\u4e0b\u9762\u7684\u547d\u4ee4\u6ca1\u6709\u7ed9\u51fa\u4efb\u4f55\u8f93\u51fa\uff0c\u90a3\u5c31\u6ca1\u95ee\u9898\u3002 $ perl -MBio::SeqIO -e1 # \u5982\u679c\u6307\u5b9a PREFIX \u5b89\u88c5\u8def\u5f84\uff0c\u6a21\u5757\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u9700\u8981\u628a\u6a21\u5757\u5b89\u88c5\u7684\u65b0\u8def\u5f84\u6dfb\u52a0\u5230 PERL5LIB \u73af\u5883\u53d8\u91cf $ export PERL5LIB=$PERL5LIB:/home/shenweiyan/perl_modules/lib/site_perl //\u6216\u8005\u628a\u8be5\u884c\u5185\u5bb9\u6dfb\u52a0\u5230 ~/.bashrc perl -MCPAN -e 'install \u6a21\u5757' cpan -i \u6a21\u5757\u540d conda\u7684perl\u548c\u7cfb\u7edf\u7684perl\u51b2\u7a81 perl: symbol lookup error: /home/wangjw/perl5/lib/perl5/x86_64-linux-thread-multi/auto/Cwd/Cwd.so: undefined symbol \u8fd9\u4e2a\u95ee\u9898\u663e\u7136\u6211\u7528\u7cfb\u7edfperl\u5b89\u88c5\u7684\u8f6f\u4ef6\u88abconda\u7684perl\u6709\u9650\u67e5\u627e\u5230\u5bfc\u81f4\uff0c\u7528 perl -V \u548c perl -e '{print \"$_\\n\" foreach @INC}'\u53ef\u4ee5\u53d1\u73b0conda\u7684perl\u67e5\u627e\u8def\u5f84\u4f4e\u4e8e\u6211\u4e3a\u7cfb\u7edfperl\u5b89\u88c5\u7684\u8def\u5f84\uff0c\u89e3\u51b3\u65b9\u6848\u5982\u4e0b\u3002\uff08\u5982\u679c\u6211\u4eec\u624b\u52a8\u5b89\u88c5\u7684\u5305\uff0c\u6216\u8005\u5b89\u88c5\u5230\u4e86\u4e00\u4e2a\u975e\u9ed8\u8ba4\u7684\u67e5\u627e\u8def\u5f84\u4e0b(\u4f8b\u5982\u4e0d\u540c\u7528\u6237\u5b89\u88c5\u5230\u4e86\u4e0d\u540c\u5bb6\u76ee\u5f55\u4e0b)\uff0c\u8fd9\u65f6\u53ef\u4ee5\u901a\u8fc7\u5728shell\u4e2d\u8bbe\u7f6ePERL5LIB\u73af\u5883\u53d8\u91cf\uff0cperl\u4f1a\u4e34\u65f6\u4ece\u8fd9\u4e2a\u73af\u5883\u53d8\u91cf\u4e2d\u53bb\u67e5\u627e\u6a21\u5757\u3002\uff09 export PERL5LIB=\"\" https://www.jianshu.com/p/9e90b3524fe2 https://cloud.tencent.com/developer/article/1055044 https://codeday.me/bug/20181210/431702.html https://yq.aliyun.com/articles/650551 PERLLIB and PERL5LIB I'd recommend using PERL5LIB over PERLLIB as that makes it clear it is related to Perl 5)","title":"00.PERL"},{"location":"13_R_PERL_wdl/00.PERL/#_1","text":"","title":"\u5b89\u88c5\u6a21\u5757"},{"location":"13_R_PERL_wdl/00.PERL/#_2","text":"# \u4ece CPAN(https://metacpan.org/)\u4e0b\u8f7d\u4e86 BioPerl \u6a21\u5757 1.7.5 \u7248\u7684\u538b\u7f29\u6587\u4ef6 BioPerl-1.7.5.tar.gz # \u5047\u8bbe\u653e\u5728/usr/local/src/\u4e0b\u3002 $ cd /usr/local/src # \u89e3\u538b\u7f29\u8fd9\u4e2a\u6587\u4ef6,\u8fd9\u65f6\u4f1a\u65b0\u5efa\u4e00\u4e2a BioPerl-1.7.5 \u7684\u76ee\u5f55\u3002 $ tar xvzf BioPerl-1.7.5.tar.gz # \u6362\u5230\u89e3\u538b\u540e\u7684\u76ee\u5f55 $ cd BioPerl-1.7.5 # \u751f\u6210 makefile\uff0c\u5982\u679c\u8981\u6307\u5b9a\u6a21\u5757\u7684\u5b89\u88c5\u8def\u5f84\uff0c\u9700\u8981\u6dfb\u52a0 PREFIX=/path/to/install \u8def\u5f84 $ perl Makefile.PL (PREFIX=/home/shenweiyan/perl_modules) # \u751f\u6210\u6a21\u5757 $ make # \u6d4b\u8bd5\u6a21\u5757(\u8fd9\u6b65\u53ef\u6709\u53ef\u65e0)\uff1a $ make test # \u5982\u679c\u6d4b\u8bd5\u7ed3\u679c\u62a5\u544a\"all test ok\"\uff0c\u60a8\u5c31\u53ef\u4ee5\u653e\u5fc3\u5730\u5b89\u88c5\u7f16\u8bd1\u597d\u7684\u6a21\u5757\u4e86\u3002 # \u5b89\u88c5\u6a21\u5757\u524d\uff0c\u5148\u8981\u786e\u4fdd\u60a8\u5bf9 perl5 \u5b89\u88c5\u76ee\u5f55\u6709\u53ef\u5199\u6743\u9650(\u901a\u5e38\u4ee5 su \u547d\u4ee4\u83b7\u5f97)\uff0c\u6267\u884c\uff1a $ make install # \u73b0\u5728\uff0c\u8bd5\u8bd5 Bio::SeqIO \u6a21\u5757\u5427\u3002\u5982\u679c\u4e0b\u9762\u7684\u547d\u4ee4\u6ca1\u6709\u7ed9\u51fa\u4efb\u4f55\u8f93\u51fa\uff0c\u90a3\u5c31\u6ca1\u95ee\u9898\u3002 $ perl -MBio::SeqIO -e1 # \u5982\u679c\u6307\u5b9a PREFIX \u5b89\u88c5\u8def\u5f84\uff0c\u6a21\u5757\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u9700\u8981\u628a\u6a21\u5757\u5b89\u88c5\u7684\u65b0\u8def\u5f84\u6dfb\u52a0\u5230 PERL5LIB \u73af\u5883\u53d8\u91cf $ export PERL5LIB=$PERL5LIB:/home/shenweiyan/perl_modules/lib/site_perl //\u6216\u8005\u628a\u8be5\u884c\u5185\u5bb9\u6dfb\u52a0\u5230 ~/.bashrc","title":"\u624b\u5de5\u5b89\u88c5"},{"location":"13_R_PERL_wdl/00.PERL/#perl-mcpan-e-install","text":"","title":"perl -MCPAN -e 'install \u6a21\u5757'"},{"location":"13_R_PERL_wdl/00.PERL/#cpan-i","text":"","title":"cpan -i \u6a21\u5757\u540d"},{"location":"13_R_PERL_wdl/00.PERL/#condaperlperl","text":"perl: symbol lookup error: /home/wangjw/perl5/lib/perl5/x86_64-linux-thread-multi/auto/Cwd/Cwd.so: undefined symbol \u8fd9\u4e2a\u95ee\u9898\u663e\u7136\u6211\u7528\u7cfb\u7edfperl\u5b89\u88c5\u7684\u8f6f\u4ef6\u88abconda\u7684perl\u6709\u9650\u67e5\u627e\u5230\u5bfc\u81f4\uff0c\u7528 perl -V \u548c perl -e '{print \"$_\\n\" foreach @INC}'\u53ef\u4ee5\u53d1\u73b0conda\u7684perl\u67e5\u627e\u8def\u5f84\u4f4e\u4e8e\u6211\u4e3a\u7cfb\u7edfperl\u5b89\u88c5\u7684\u8def\u5f84\uff0c\u89e3\u51b3\u65b9\u6848\u5982\u4e0b\u3002\uff08\u5982\u679c\u6211\u4eec\u624b\u52a8\u5b89\u88c5\u7684\u5305\uff0c\u6216\u8005\u5b89\u88c5\u5230\u4e86\u4e00\u4e2a\u975e\u9ed8\u8ba4\u7684\u67e5\u627e\u8def\u5f84\u4e0b(\u4f8b\u5982\u4e0d\u540c\u7528\u6237\u5b89\u88c5\u5230\u4e86\u4e0d\u540c\u5bb6\u76ee\u5f55\u4e0b)\uff0c\u8fd9\u65f6\u53ef\u4ee5\u901a\u8fc7\u5728shell\u4e2d\u8bbe\u7f6ePERL5LIB\u73af\u5883\u53d8\u91cf\uff0cperl\u4f1a\u4e34\u65f6\u4ece\u8fd9\u4e2a\u73af\u5883\u53d8\u91cf\u4e2d\u53bb\u67e5\u627e\u6a21\u5757\u3002\uff09 export PERL5LIB=\"\" https://www.jianshu.com/p/9e90b3524fe2 https://cloud.tencent.com/developer/article/1055044 https://codeday.me/bug/20181210/431702.html https://yq.aliyun.com/articles/650551","title":"conda\u7684perl\u548c\u7cfb\u7edf\u7684perl\u51b2\u7a81"},{"location":"13_R_PERL_wdl/00.PERL/#perllib-and-perl5lib","text":"I'd recommend using PERL5LIB over PERLLIB as that makes it clear it is related to Perl 5)","title":"PERLLIB and PERL5LIB"},{"location":"13_R_PERL_wdl/00.R/","text":"\u5b89\u88c5R wget -c https://mirrors.tuna.tsinghua.edu.cn/CRAN/src/base/R-3/R-3.6.2.tar.gz --enable-R-shlib --enable-memory-profiling --prefix= make -j 8 make install \u955c\u50cf\u5207\u6362 rm(list = ls()) options()$repos options()$BioC_mirror options(BioC_mirror=\"https://mirrors.ustc.edu.cn/bioc/\") options(\"repos\" = c(CRAN=\"https://mirrors.tuna.tsinghua.edu.cn/CRAN/\")) options()$repos options()$BioC_mirror source(\"https://bioconductor.org/biocLite.R\") biocLite(\"TCGAbiolinks\") library(\"TCGAbiolinks\") windows\u4e0b\u66f4\u65b0R \u53ef\u4ee5\u901a\u8fc7Rstudio \u66f4\u65b0R\uff0c\u4e5f\u53ef\u4ee5\u5728R console\u4e2d\u66f4\u65b0,\u53ea\u9700\u8981\u4e09\u6b65\uff1a 1\uff0cinstall.packages(\"installr \") 2\uff0crequire(installr) 3,updateR() \u5b89\u88c5r\u4e2d\u7684\u62a5\u9519 https://www.jianshu.com/p/edb234eed915","title":"00.R"},{"location":"13_R_PERL_wdl/00.R/#r","text":"wget -c https://mirrors.tuna.tsinghua.edu.cn/CRAN/src/base/R-3/R-3.6.2.tar.gz --enable-R-shlib --enable-memory-profiling --prefix= make -j 8 make install","title":"\u5b89\u88c5R"},{"location":"13_R_PERL_wdl/00.R/#_1","text":"rm(list = ls()) options()$repos options()$BioC_mirror options(BioC_mirror=\"https://mirrors.ustc.edu.cn/bioc/\") options(\"repos\" = c(CRAN=\"https://mirrors.tuna.tsinghua.edu.cn/CRAN/\")) options()$repos options()$BioC_mirror source(\"https://bioconductor.org/biocLite.R\") biocLite(\"TCGAbiolinks\") library(\"TCGAbiolinks\")","title":"\u955c\u50cf\u5207\u6362"},{"location":"13_R_PERL_wdl/00.R/#windowsr","text":"\u53ef\u4ee5\u901a\u8fc7Rstudio \u66f4\u65b0R\uff0c\u4e5f\u53ef\u4ee5\u5728R console\u4e2d\u66f4\u65b0,\u53ea\u9700\u8981\u4e09\u6b65\uff1a 1\uff0cinstall.packages(\"installr \") 2\uff0crequire(installr) 3,updateR()","title":"windows\u4e0b\u66f4\u65b0R"},{"location":"13_R_PERL_wdl/00.R/#r_1","text":"https://www.jianshu.com/p/edb234eed915","title":"\u5b89\u88c5r\u4e2d\u7684\u62a5\u9519"},{"location":"13_R_PERL_wdl/00.WDL/","text":"","title":"00.WDL"},{"location":"13_R_PERL_wdl/001_%E8%B4%9D%E5%8F%B6%E6%96%AF/","text":"\u601d\u60f3\uff1a\u6839\u636e\u67d0\u4e9b\u4e2a\u5148\u9a8c\u6982\u7387\u8ba1\u7b97Y\u53d8\u91cf\u5c5e\u4e8e\u67d0\u4e2a\u7c7b\u522b\u7684\u540e\u9a8c\u6982\u7387. $$P(\\frac{Y}{X}) = \\frac{P(YX)}{P(X)} = \\frac{P(X|Y)}{P(Y)}$$ \u5982\u679c\u8981\u8ba1\u7b97X\u6761\u4ef6\u4e0bY\u53d1\u751f\u7684\u6982\u7387\uff0c\u53ea\u9700\u8981\u8ba1\u7b97\u51fa\u540e\u9762\u7b49\u5f0f\u7684\u4e09\u4e2a\u90e8\u5206\uff0cX\u4e8b\u4ef6\u7684\u6982\u7387\uff08P(X)\uff09\uff0c\u662fX\u7684\u5148\u9a8c\u6982\u7387\u3001Y\u5c5e\u4e8e\u67d0\u7c7b\u7684\u6982\u7387\uff08P(Y)\uff09\uff0c\u662fY\u7684\u5148\u9a8c\u6982\u7387\u3001\u4ee5\u53ca\u5df2\u77e5Y\u7684\u67d0\u4e2a\u5206\u7c7b\u4e0b\uff0c\u4e8b\u4ef6X\u7684\u6982\u7387\uff08P(X|Y)\uff09\uff0c\u662f\u540e\u9a8c\u6982\u7387\u3002 \u8d1d\u53f6\u65af\u5b9a\u7406\uff0c\u6216\u4e4b\u524d\u6240\u8bf4\u7684\u6761\u4ef6\u6982\u7387\u5b9a\u7406\uff0c\u662f\u7528\u6765\u8ba1\u7b97\u67d0\u4e00\u4e8b\u4ef6(E)\u5df2\u7ecf\u53d1\u751f(\u4f8b\u5982\u5728\u6d4b\u8bd5\u4e2d\u88ab\u8bca\u65ad\u4e3a\u9633\u6027)\u65f6\u5047\u8bbe(H)\u4e3a\u771f\u7684\u6982\u7387\u3002\u8ba1\u7b97\u516c\u5f0f\u5982\u4e0b\uff1a $$P(H|E) = \\frac{P(E|H)P(H)}{P(E)}$$ ==> $$P(H|E)P(E) = P(E|H)P(H)$$ \u7b49\u53f7\u5de6\u8fb9\u7684P\uff08H|E\uff09\u9879\u662f\u5df2\u7ecf\u5728\u75be\u75c5\u6d4b\u8bd5\u4e2d\u8bca\u65ad\u4e3a\u9633\u6027\uff08E\uff09\u7684\u6761\u4ef6\u4e0b\u60a3\u75c5\uff08H\uff09\u7684\u6982\u7387\uff0c\u8fd9\u662f\u6211\u4eec\u5b9e\u9645\u60f3\u8981\u8ba1\u7b97\u7684\u3002\u6982\u7387\u9879\u4e2d\u7684\u7ad6\u7ebf\uff08|\uff09\u8868\u793a\u6761\u4ef6\u6982\u7387\uff08\u5373\uff0c B\u7684\u6761\u4ef6\u4e0bA\u7684\u6982\u7387\u8868\u793a\u4e3aP\uff08A|B\uff09\uff09\u3002 \u5047\u5982\u5047\u8bbe\u4e3a\u771f\uff0c\u5219\u53f3\u8fb9\u5206\u5b50\u7684\u5de6\u9879P\uff08E|H\uff09\u662f\u4e8b\u4ef6\u7684\u6982\u7387\u3002\u5728\u793a\u4f8b\u4e2d\uff0c\u5c31\u662f\u6211\u4eec\u60a3\u6709\u8fd9\u79cd\u75be\u75c5\u7684\u60c5\u51b5\u4e0b\uff0c\u5728\u6d4b\u8bd5\u4e2d\u88ab\u8bca\u65ad\u4e3a\u9633\u6027\u7684\u53ef\u80fd\u6027\u3002 \u65c1\u8fb9\u7684P\uff08H\uff09\u9879\u662f\u5728\u4efb\u4f55\u4e8b\u4ef6\u53d1\u751f\u4e4b\u524d\u5047\u8bbe\u7684\u5148\u9a8c\u6982\u7387\u3002\u8fd9\u662f\u5728\u8fdb\u884c\u4efb\u4f55\u68c0\u67e5\u4e4b\u524d\u60a3\u4e0a\u75be\u75c5\u7684\u53ef\u80fd\u6027\u3002 \u6700\u540e\uff0c\u5206\u6bcd\u4e0a\u7684P\uff08E\uff09\u9879\u662f\u4e8b\u4ef6\u7684\u6982\u7387\uff0c\u5373\u88ab\u8bca\u65ad\u4e3a\u75be\u75c5\u9633\u6027\u7684\u6982\u7387\u3002\u8be5\u9879\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5206\u89e3\u4e3a\u4e24\u4e2a\u8f83\u5c0f\u9879\u7684\u548c\uff1a\u60a3\u75c5\u4e14\u68c0\u6d4b\u4e3a\u9633\u6027\u548c\u4e0d\u60a3\u75c5\u4e14\u68c0\u6d4b\u4e3a\u9633\u6027\u3002","title":"001 \u8d1d\u53f6\u65af"},{"location":"14_immune/00/","text":"immunotherapy \u514d\u75ab\u7597\u6cd5 https://github.com/griffithlab/pVACtools https://ncbi.github.io/igblast/cook/How-to-set-up.html https://www.jianshu.com/p/821a6fb7cf41 http://www.biomart.cn/specials/bgitechsolutions/article/62757 http://www.gene-health.com/a/keyanfuwu/qita/20181016/69.html http://seqhealth.cn/list/26.html http://www.chictr.org.cn/showproj.aspx?proj=49170 http://www.lc-bio.com/news/show-585.html http://gb.oversea.cnki.net/KCMS/detail/detail.aspx?filename=1015964277.nh&dbcode=CMFD&dbname=CMFD2016 https://mp.weixin.qq.com/s/-XQktvQfOKyx7VjQSWT9Kw","title":"00"},{"location":"14_immune/01_%20pVACtools/","text":"","title":"01  pVACtools"},{"location":"14_immune/01_IMGT/","text":"","title":"01 IMGT"},{"location":"15_python/000_course/","text":"","title":"000 course"},{"location":"15_python/001_pandas/","text":"2. \u884c\u5217\u9009\u62e9 2.1 \u884c\u9009\u62e9 2.1.1 \u6839\u636e\u5305\u542b\u7684\u5b57\u7b26\u4e32\u9009\u62e9\u884c 2.1.2 \u9009\u62e9\u5305\u542b\u7a7a\u683c\u7684\u884c 2.2. \u5217\u9009\u62e9 2.2.1. \u6839\u636e\u5217\u503c\u9009\u62e9\u884c 2.2.2. \u9009\u62e9\u5217\u503c\u4e0d\u7b49\u4e8esome_value\u7684\u884c 2.2.3. \u5217\u540d\u91cc\u662f\u5426\u5305\u542b\u5b57\u7b26\u4e32 3 \u5e38\u89c1\u64cd\u4f5c 3.1 \u53bb\u91cd\u590d 3.2 \u4ecepython \u4e2d\u7684\u5217\u540d\u79f0\u68c0\u7d22\u5217\u7d22\u5f15 3.2.1. get_loc() 3.2.2. searchsorted() 3.3 \u68c0\u7d22\u67d0\u5b57\u6bcd\u5f00\u5934\u7684\u884c 3.4 \u8bfb\u5199 DataFrame.to_excel\u591a\u6b21\u5199\u5165\u4e0d\u540cSheet 4. apply & map Remap values in column with a dict Ref_Info Get top biggest values from each column of the .DataFrame merge multiple dfs 2. \u884c\u5217\u9009\u62e9 2.1 \u884c\u9009\u62e9 df = pd.DataFrame(...) #\u4efb\u610f\u521d\u59cb\u5316\u4e00\u4e2a\u5217\u6570\u4e3a3\u7684DataFrame df.columns=['a', 'b', 'c'] df['b'] df.b #\u8fd9\u91ccb\u4e3a\u5217\u540d\u79f0\uff0c\u4f46\u5fc5\u987b\u662f\u8fde\u7eed\u5b57\u7b26\u4e32\uff0c\u4e0d\u80fd\u6709\u7a7a\u683c\u3002\u5982\u679c\u5217\u660e\u6709\u7a7a\u683c\uff0c\u5219\u53ea\u80fd\u91c7\u53d6\u7b2c1\u79cd\u65b9\u6cd5 data1[data1.columns[1:]] data1[5:10] #\u8fd9\u91cc\u53d66\u523011\u884c\u7684\u6240\u6709\u6570\u636e\uff0c\u800c\u4e0d\u662f\u5217\u6570\u636e .loc,.iloc,.ix,\u53ea\u52a0\u7b2c\u4e00\u4e2a\u53c2\u6570\u5982.loc([1,2]),.iloc([2:3]),.ix[2]\u2026\u5219\u8fdb\u884c\u7684\u662f\u884c\u9009\u62e9 2. .loc,.at\uff0c\u9009\u5217\u662f\u53ea\u80fd\u662f\u5217\u540d\uff0c\u4e0d\u80fd\u662fposition 3. .iloc,.iat\uff0c\u9009\u5217\u662f\u53ea\u80fd\u662fposition\uff0c\u4e0d\u80fd\u662f\u5217\u540d 4. df[]\u53ea\u80fd\u8fdb\u884c\u884c\u9009\u62e9\uff0c\u6216\u5217\u9009\u62e9\uff0c\u4e0d\u80fd\u540c\u65f6\u8fdb\u884c\u5217\u9009\u62e9\uff0c\u5217\u9009\u62e9\u53ea\u80fd\u662f\u5217\u540d\u3002 2.1.1 \u6839\u636e\u5305\u542b\u7684\u5b57\u7b26\u4e32\u9009\u62e9\u884c s.str.findall(\"[a-z]\") 2.1.2 \u9009\u62e9\u5305\u542b\u7a7a\u683c\u7684\u884c tmp.loc[tmp[\"Related Diseases\"].str.contains(\"Leuk\", na = False)] 2.2. \u5217\u9009\u62e9 2.2.1. \u6839\u636e\u5217\u503c\u9009\u62e9\u884c df.loc[df['column_name'] == some_value] \u9009\u62e9\u5217\u503c\u5728\u53ef\u8fed\u4ee3\u503csome_values\u4e2d\u7684\u884c\uff0c\u8bf7\u4f7f\u7528isin\uff1a df.loc[df['column_name'].isin(some_values)] 2.2.2. \u9009\u62e9\u5217\u503c\u4e0d\u7b49\u4e8esome_value\u7684\u884c df.loc[df['column_name'] != some_value] isin\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u7cfb\u5217\uff0c\u6240\u4ee5\u8981\u9009\u62e9\u503c\u4e0d\u5728some_values\u7684\u884c\uff0c\u4f7f\u7528\u301c\u6765\u5426\u5b9a\u5e03\u5c14\u7cfb\u5217\uff1a df.loc[~df['column_name'].isin(some_values)] df.loc[(df['A'] == 'foo') & (df['B'] == 'one')] 2.2.3. \u5217\u540d\u91cc\u662f\u5426\u5305\u542b\u5b57\u7b26\u4e32 short_way = [df.columns.get_loc(col) for col in query_cols if \"xx\" in col] df.columns.str.contains(\"xxx\") df.columns.str.find(\"xxx\") df.columns.str.match(\"xxx\") df.loc[0:1,['A','B']] ## \u53d6\u884cindex\u4e3a0\u4e0e1\u4e4b\u95f4\u7684,\u5217\u6807\u7b7e\u4e3aA,B\u7684\uff0c\u8fd4\u56deDataFrame 3 \u5e38\u89c1\u64cd\u4f5c 3.1 \u53bb\u91cd\u590d DataFrame\u7684duplicated\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u578bSeries,\u8868\u793a\u5404\u884c\u662f\u5426\u91cd\u590d\u884c\u3002 \u800c drop_duplicates\u65b9\u6cd5\uff0c\u5b83\u7528\u4e8e\u8fd4\u56de\u4e00\u4e2a\u79fb\u9664\u4e86\u91cd\u590d\u884c\u7684DataFrame 3.2 \u4ecepython \u4e2d\u7684\u5217\u540d\u79f0\u68c0\u7d22\u5217\u7d22\u5f15 3.2.1. get_loc() df = DataFrame({\"pear\": [1,2,3], \"apple\": [2,3,4], \"orange\": [3,4,5]}) In [46]: df.columns Out[46]: Index([apple, orange, pear], dtype=object) In [47]: df.columns.get_loc(\"pear\") Out[47]: 2 https://stackoverflow.com/questions/13021654/get-column-index-from-column-name-in-python- 3.2.2. searchsorted() You could use np.where, which returns a tuple of row and column indices where your value is present. Use np.searchsorted - np.searchsorted(s.index.values,'D') Or use the method, like so - s.index.searchsorted('D') https://stackoverflow.com/questions/48911071/more-effective-way-to-use--get-loc https://stackoverflow.com/questions/13021654/get-column-index-from-column-name-in-python- 3.3 \u68c0\u7d22\u67d0\u5b57\u6bcd\u5f00\u5934\u7684\u884c https://stackoverflow.com/questions/40249152/python-3--select-dataframe-using-startswith-or https://stackoverflow.com/questions/15325182/how-to-filter-rows-in--by-regex https://stackoverflow.com/questions/17071871/select-rows-from-a-dataframe-based-on-values-in-a-column-in- 3.4 \u8bfb\u5199 df.to_csv(r'Z:\\temp\\test.csv',quoting=1,mode='w',index=False,header=True,encoding= 'utf-8',columns=['TABNAME','TIME']) DataFrame.to_excel\u591a\u6b21\u5199\u5165\u4e0d\u540cSheet >>> writer = pd.ExcelWriter('output.xlsx') >>> df1.to_excel(writer,'Sheet1') >>> df2.to_excel(writer,'Sheet2') >>> writer.save() 4. apply & map https://stackoverflow.com/questions/40083266/replace-comma-with-dot- https://stackoverflow.com/questions/19377969/combine-two-columns-of-text-in-dataframe-in--python \u67e5\u770b\u6570\u636e\u7c7b\u578b df.applymap(type) Remap values in column with a dict >>> df = pd.DataFrame({'col2': {0: 'a', 1: 2, 2: np.nan}, 'col1': {0: 'w', 1: 1, 2: 2}}) >>> di = {1: \"A\", 2: \"B\"} >>> df col1 col2 0 w a 1 1 2 2 2 NaN >>> df.replace({\"col1\": di}) col1 col2 0 w a 1 A 2 2 B NaN or directly on the Series, i.e. df[\"col1\"].replace(di, inplace=True). Ref_Info https://stackoverflow.com/questions/20250771/remap-values-in--column-with-a-dict Get top biggest values from each column of the .DataFrame Here is my .DataFrame: import as pd data = pd.DataFrame({ 'first': [40, 32, 56, 12, 89], 'second': [13, 45, 76, 19, 45], 'third': [98, 56, 87, 12, 67] }, index = ['first', 'second', 'third', 'fourth', 'fifth']) I want to create a new DataFrame that will contain top 3 values from each column of my data DataFrame. Here is an expected output: first second third 0 89 76 98 1 56 45 87 2 40 45 67 #1 def sorted(s, num): tmp = s.sort_values(ascending=False)[:num] # earlier s.order(..) tmp.index = range(num) return tmp data.apply(lambda x: sorted(x, 3)) #2 pd.DataFrame({c: data[c].nlargest(3).values for c in data}) https://xlsxwriter.readthedocs.io/working_with_.html https://xlsxwriter.readthedocs.io/_examples.html merge multiple dfs https://stackoverflow.com/questions/44327999/python--merge-multiple-dataframes/44338256 https://stackoverflow.com/questions/23668427/-three-way-joining-multiple-dataframes-on-columns \u8bbe\u7f6eexcel\u8fb9\u6846 https://mp.weixin.qq.com/s/6hBKbaV3Ygfddi_yvzW75Q \u66ff\u6362\u67d0\u5217\u5b57\u7b26\u4e32 pd.DataFrame({'col1': ['$46.51', '$38.00', 40], 'col2': [1, 2, 3]}).to_csv('test_df.csv', index=False) >>> pd.read_csv('test_df.csv', converters={'col1': lambda s: float(s.replace('$', ''))}) col1 col2 0 46.51 1 1 38.00 2 2 40.00 3 #\u663e\u793a\u6240\u6709\u5217 pd.set_option('display.max_columns', None) #\u663e\u793a\u6240\u6709\u884c pd.set_option('display.max_rows', None) #\u8bbe\u7f6evalue\u7684\u663e\u793a\u957f\u5ea6\u4e3a100\uff0c\u9ed8\u8ba4\u4e3a50 pd.set_option('max_colwidth',100)","title":"001 pandas"},{"location":"15_python/001_pandas/#2","text":"","title":"2. \u884c\u5217\u9009\u62e9"},{"location":"15_python/001_pandas/#21","text":"df = pd.DataFrame(...) #\u4efb\u610f\u521d\u59cb\u5316\u4e00\u4e2a\u5217\u6570\u4e3a3\u7684DataFrame df.columns=['a', 'b', 'c'] df['b'] df.b #\u8fd9\u91ccb\u4e3a\u5217\u540d\u79f0\uff0c\u4f46\u5fc5\u987b\u662f\u8fde\u7eed\u5b57\u7b26\u4e32\uff0c\u4e0d\u80fd\u6709\u7a7a\u683c\u3002\u5982\u679c\u5217\u660e\u6709\u7a7a\u683c\uff0c\u5219\u53ea\u80fd\u91c7\u53d6\u7b2c1\u79cd\u65b9\u6cd5 data1[data1.columns[1:]] data1[5:10] #\u8fd9\u91cc\u53d66\u523011\u884c\u7684\u6240\u6709\u6570\u636e\uff0c\u800c\u4e0d\u662f\u5217\u6570\u636e .loc,.iloc,.ix,\u53ea\u52a0\u7b2c\u4e00\u4e2a\u53c2\u6570\u5982.loc([1,2]),.iloc([2:3]),.ix[2]\u2026\u5219\u8fdb\u884c\u7684\u662f\u884c\u9009\u62e9 2. .loc,.at\uff0c\u9009\u5217\u662f\u53ea\u80fd\u662f\u5217\u540d\uff0c\u4e0d\u80fd\u662fposition 3. .iloc,.iat\uff0c\u9009\u5217\u662f\u53ea\u80fd\u662fposition\uff0c\u4e0d\u80fd\u662f\u5217\u540d 4. df[]\u53ea\u80fd\u8fdb\u884c\u884c\u9009\u62e9\uff0c\u6216\u5217\u9009\u62e9\uff0c\u4e0d\u80fd\u540c\u65f6\u8fdb\u884c\u5217\u9009\u62e9\uff0c\u5217\u9009\u62e9\u53ea\u80fd\u662f\u5217\u540d\u3002","title":"2.1 \u884c\u9009\u62e9"},{"location":"15_python/001_pandas/#211","text":"s.str.findall(\"[a-z]\")","title":"2.1.1 \u6839\u636e\u5305\u542b\u7684\u5b57\u7b26\u4e32\u9009\u62e9\u884c"},{"location":"15_python/001_pandas/#212","text":"tmp.loc[tmp[\"Related Diseases\"].str.contains(\"Leuk\", na = False)]","title":"2.1.2 \u9009\u62e9\u5305\u542b\u7a7a\u683c\u7684\u884c"},{"location":"15_python/001_pandas/#22","text":"","title":"2.2. \u5217\u9009\u62e9"},{"location":"15_python/001_pandas/#221","text":"df.loc[df['column_name'] == some_value] \u9009\u62e9\u5217\u503c\u5728\u53ef\u8fed\u4ee3\u503csome_values\u4e2d\u7684\u884c\uff0c\u8bf7\u4f7f\u7528isin\uff1a df.loc[df['column_name'].isin(some_values)]","title":"2.2.1. \u6839\u636e\u5217\u503c\u9009\u62e9\u884c"},{"location":"15_python/001_pandas/#222-some_value","text":"df.loc[df['column_name'] != some_value] isin\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u7cfb\u5217\uff0c\u6240\u4ee5\u8981\u9009\u62e9\u503c\u4e0d\u5728some_values\u7684\u884c\uff0c\u4f7f\u7528\u301c\u6765\u5426\u5b9a\u5e03\u5c14\u7cfb\u5217\uff1a df.loc[~df['column_name'].isin(some_values)] df.loc[(df['A'] == 'foo') & (df['B'] == 'one')]","title":"2.2.2. \u9009\u62e9\u5217\u503c\u4e0d\u7b49\u4e8esome_value\u7684\u884c"},{"location":"15_python/001_pandas/#223","text":"short_way = [df.columns.get_loc(col) for col in query_cols if \"xx\" in col] df.columns.str.contains(\"xxx\") df.columns.str.find(\"xxx\") df.columns.str.match(\"xxx\") df.loc[0:1,['A','B']] ## \u53d6\u884cindex\u4e3a0\u4e0e1\u4e4b\u95f4\u7684,\u5217\u6807\u7b7e\u4e3aA,B\u7684\uff0c\u8fd4\u56deDataFrame","title":"2.2.3. \u5217\u540d\u91cc\u662f\u5426\u5305\u542b\u5b57\u7b26\u4e32"},{"location":"15_python/001_pandas/#3","text":"","title":"3 \u5e38\u89c1\u64cd\u4f5c"},{"location":"15_python/001_pandas/#31","text":"DataFrame\u7684duplicated\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u578bSeries,\u8868\u793a\u5404\u884c\u662f\u5426\u91cd\u590d\u884c\u3002 \u800c drop_duplicates\u65b9\u6cd5\uff0c\u5b83\u7528\u4e8e\u8fd4\u56de\u4e00\u4e2a\u79fb\u9664\u4e86\u91cd\u590d\u884c\u7684DataFrame","title":"3.1 \u53bb\u91cd\u590d"},{"location":"15_python/001_pandas/#32-python","text":"","title":"3.2 \u4ecepython \u4e2d\u7684\u5217\u540d\u79f0\u68c0\u7d22\u5217\u7d22\u5f15"},{"location":"15_python/001_pandas/#321-get_loc","text":"df = DataFrame({\"pear\": [1,2,3], \"apple\": [2,3,4], \"orange\": [3,4,5]}) In [46]: df.columns Out[46]: Index([apple, orange, pear], dtype=object) In [47]: df.columns.get_loc(\"pear\") Out[47]: 2 https://stackoverflow.com/questions/13021654/get-column-index-from-column-name-in-python-","title":"3.2.1. get_loc()"},{"location":"15_python/001_pandas/#322-searchsorted","text":"You could use np.where, which returns a tuple of row and column indices where your value is present. Use np.searchsorted - np.searchsorted(s.index.values,'D') Or use the method, like so - s.index.searchsorted('D') https://stackoverflow.com/questions/48911071/more-effective-way-to-use--get-loc https://stackoverflow.com/questions/13021654/get-column-index-from-column-name-in-python-","title":"3.2.2. searchsorted()"},{"location":"15_python/001_pandas/#33","text":"https://stackoverflow.com/questions/40249152/python-3--select-dataframe-using-startswith-or https://stackoverflow.com/questions/15325182/how-to-filter-rows-in--by-regex https://stackoverflow.com/questions/17071871/select-rows-from-a-dataframe-based-on-values-in-a-column-in-","title":"3.3 \u68c0\u7d22\u67d0\u5b57\u6bcd\u5f00\u5934\u7684\u884c"},{"location":"15_python/001_pandas/#34","text":"df.to_csv(r'Z:\\temp\\test.csv',quoting=1,mode='w',index=False,header=True,encoding= 'utf-8',columns=['TABNAME','TIME'])","title":"3.4 \u8bfb\u5199"},{"location":"15_python/001_pandas/#dataframeto_excelsheet","text":">>> writer = pd.ExcelWriter('output.xlsx') >>> df1.to_excel(writer,'Sheet1') >>> df2.to_excel(writer,'Sheet2') >>> writer.save()","title":"DataFrame.to_excel\u591a\u6b21\u5199\u5165\u4e0d\u540cSheet"},{"location":"15_python/001_pandas/#4-apply-map","text":"https://stackoverflow.com/questions/40083266/replace-comma-with-dot- https://stackoverflow.com/questions/19377969/combine-two-columns-of-text-in-dataframe-in--python \u67e5\u770b\u6570\u636e\u7c7b\u578b df.applymap(type)","title":"4. apply &amp; map"},{"location":"15_python/001_pandas/#remap-values-in-column-with-a-dict","text":">>> df = pd.DataFrame({'col2': {0: 'a', 1: 2, 2: np.nan}, 'col1': {0: 'w', 1: 1, 2: 2}}) >>> di = {1: \"A\", 2: \"B\"} >>> df col1 col2 0 w a 1 1 2 2 2 NaN >>> df.replace({\"col1\": di}) col1 col2 0 w a 1 A 2 2 B NaN or directly on the Series, i.e. df[\"col1\"].replace(di, inplace=True).","title":"Remap values in  column with a dict"},{"location":"15_python/001_pandas/#ref_info","text":"https://stackoverflow.com/questions/20250771/remap-values-in--column-with-a-dict","title":"Ref_Info"},{"location":"15_python/001_pandas/#get-top-biggest-values-from-each-column-of-the-dataframe","text":"Here is my .DataFrame: import as pd data = pd.DataFrame({ 'first': [40, 32, 56, 12, 89], 'second': [13, 45, 76, 19, 45], 'third': [98, 56, 87, 12, 67] }, index = ['first', 'second', 'third', 'fourth', 'fifth']) I want to create a new DataFrame that will contain top 3 values from each column of my data DataFrame. Here is an expected output: first second third 0 89 76 98 1 56 45 87 2 40 45 67 #1 def sorted(s, num): tmp = s.sort_values(ascending=False)[:num] # earlier s.order(..) tmp.index = range(num) return tmp data.apply(lambda x: sorted(x, 3)) #2 pd.DataFrame({c: data[c].nlargest(3).values for c in data}) https://xlsxwriter.readthedocs.io/working_with_.html https://xlsxwriter.readthedocs.io/_examples.html","title":"Get top biggest values from each column of the .DataFrame"},{"location":"15_python/001_pandas/#merge-multiple-dfs","text":"https://stackoverflow.com/questions/44327999/python--merge-multiple-dataframes/44338256 https://stackoverflow.com/questions/23668427/-three-way-joining-multiple-dataframes-on-columns \u8bbe\u7f6eexcel\u8fb9\u6846 https://mp.weixin.qq.com/s/6hBKbaV3Ygfddi_yvzW75Q \u66ff\u6362\u67d0\u5217\u5b57\u7b26\u4e32 pd.DataFrame({'col1': ['$46.51', '$38.00', 40], 'col2': [1, 2, 3]}).to_csv('test_df.csv', index=False) >>> pd.read_csv('test_df.csv', converters={'col1': lambda s: float(s.replace('$', ''))}) col1 col2 0 46.51 1 1 38.00 2 2 40.00 3","title":"merge multiple dfs"},{"location":"15_python/001_pandas/#_1","text":"#\u663e\u793a\u6240\u6709\u5217 pd.set_option('display.max_columns', None) #\u663e\u793a\u6240\u6709\u884c pd.set_option('display.max_rows', None) #\u8bbe\u7f6evalue\u7684\u663e\u793a\u957f\u5ea6\u4e3a100\uff0c\u9ed8\u8ba4\u4e3a50 pd.set_option('max_colwidth',100)","title":""},{"location":"15_python/002_xls/","text":"\u6570\u636e\u8ffd\u52a0 #a file a b c d #b file a1 b1 c1 d1 #\u53d8\u6210 a b c d a1 b1 c1 d1 import pandas as pd import os #\u6587\u4ef6\u8def\u5f84 file_dir = r'C:\\Users\\Administrator\\Desktop\\2019\u5e74\u96c6\u56e2\u5927\u5b66\u751f\u62db\u8058' #\u6784\u5efa\u65b0\u7684\u8868\u683c\u540d\u79f0 new_filename = file_dir + '\\\\new_file.xls' #\u627e\u5230\u6587\u4ef6\u8def\u5f84\u4e0b\u7684\u6240\u6709\u8868\u683c\u540d\u79f0\uff0c\u8fd4\u56de\u5217\u8868 file_list = os.listdir(file_dir) new_list = [] for file in file_list: #\u91cd\u6784\u6587\u4ef6\u8def\u5f84 file_path = os.path.join(file_dir,file) #\u5c06excel\u8f6c\u6362\u6210DataFrame dataframe = pd.read_excel(file_path) #\u4fdd\u5b58\u5230\u65b0\u5217\u8868\u4e2d new_list.append(dataframe) #\u591a\u4e2aDataFrame\u5408\u5e76\u4e3a\u4e00\u4e2a df = pd.concat(new_list) #\u5199\u5165\u5230\u4e00\u4e2a\u65b0excel\u8868\u4e2d df.to_excel(new_filename,index=False)","title":"002 xls"},{"location":"15_python/002_xls/#_1","text":"#a file a b c d #b file a1 b1 c1 d1 #\u53d8\u6210 a b c d a1 b1 c1 d1 import pandas as pd import os #\u6587\u4ef6\u8def\u5f84 file_dir = r'C:\\Users\\Administrator\\Desktop\\2019\u5e74\u96c6\u56e2\u5927\u5b66\u751f\u62db\u8058' #\u6784\u5efa\u65b0\u7684\u8868\u683c\u540d\u79f0 new_filename = file_dir + '\\\\new_file.xls' #\u627e\u5230\u6587\u4ef6\u8def\u5f84\u4e0b\u7684\u6240\u6709\u8868\u683c\u540d\u79f0\uff0c\u8fd4\u56de\u5217\u8868 file_list = os.listdir(file_dir) new_list = [] for file in file_list: #\u91cd\u6784\u6587\u4ef6\u8def\u5f84 file_path = os.path.join(file_dir,file) #\u5c06excel\u8f6c\u6362\u6210DataFrame dataframe = pd.read_excel(file_path) #\u4fdd\u5b58\u5230\u65b0\u5217\u8868\u4e2d new_list.append(dataframe) #\u591a\u4e2aDataFrame\u5408\u5e76\u4e3a\u4e00\u4e2a df = pd.concat(new_list) #\u5199\u5165\u5230\u4e00\u4e2a\u65b0excel\u8868\u4e2d df.to_excel(new_filename,index=False)","title":"\u6570\u636e\u8ffd\u52a0"},{"location":"15_python/003_conda/","text":"[toc] \u662f\u4e00\u4e2a\u5305\u7ba1\u7406\u5668\uff0cmini\u662f\u7684\u5b89\u88c5\u5305/\u5de5\u5177\uff0cana\u662f\u4e00\u4e2a\u7684\u79d1\u5b66python\u7684\u53d1\u884c\u7248\u3002 --version update create -n myenv scipy=0.15.0 #\u521b\u5efa\u4e00\u4e2a\u542b\u6709\u6307\u5b9a\u7248\u672c\u8f6f\u4ef6\u7684\u73af\u5883 install -n myenv bwa #\u5b89\u88c5bwa\u5230\u73af\u5883myenv\u4e2d \u4e5f\u53ef\u4ee5\u901a\u8fc7-c\u6307\u5b9a\u901a\u8fc7\u67d0\u4e2achannel\u5b89\u88c5 list #\u67e5\u770b\u5f53\u524d\u73af\u5883\u4e2d\u5b89\u88c5\u7684\u8f6f\u4ef6 list -n myenv \uff03\u67e5\u770b\u67d0\u4e2a\u73af\u5883\u4e2d\u5b89\u88c5\u7684\u5305 list -n myenv scipy \uff03\u67e5\u770bmyenv\u73af\u5883\u4e2d\u662f\u5426\u5b89\u88c5\u8f6f\u4ef6scipy remove --name myenv --all #\u79fb\u9664\u4e00\u4e2a\u73af\u5883 --name\uff0f-n env remove --name myenv #\u6548\u679c\u540c\u4e0a info --envs #\u786e\u8ba4\u67d0\u4e2a\u73af\u5883\u88ab\u5220\u9664\uff0c\u5982\u679c\u80fd\u5728\u663e\u793a\u7684\u73af\u5883list\u4e2d\u770b\u5230\u8bf4\u660e\u6ca1\u88ab\u5220\u9664\uff0c\u5f53\u524d\u73af\u5883\u7528\"*\"\u8868\u793a env list #\u540c\u4e0a list --explicit #\u67e5\u770b\u5f53\u524d\u73af\u5883\u7684\u5b89\u88c5\u5305\u7684\u5177\u4f53list list --explicit > spec-file.txt #\u5bfc\u51fa\u5177\u4f53list create --name myenv --file spec-file.txt #\u901a\u8fc7\u5b89\u88c5\u5305\u7684\u5177\u4f53list\u5728\u5176\u4ed6\u673a\u5668\uff08\u6700\u597d\u7cfb\u7edf\u76f8\u540c\uff09\u4e0a\u91cd\u5efa\u73af\u5883 install --name oldmyenv --file spec-file.txt #\u5c06\u5b89\u88c5\u5305list\u4e2d\u7684\u8f6f\u4ef6\u88c5\u5230oldmyenv\u73af\u5883\u4e2d search numpy #\u5dee\u627e\u67d0\u4e2a\u5305 update -n myenv numpy #\u66f4\u65b0myenv\u73af\u5883\u4e2d\u7684\u67d0\u4e2a\u5305 remove -n myenv numpy #\u5220\u9664myenv\u73af\u5883\u4e2d\u7684\u67d0\u4e2a\u5305 update #\u66f4\u65b0\u81ea\u8eab Pin versions with yml file env create -n pcgr --file _environment.yml name: pcgr channels: - bio - -forge - defaults - ana dependencies: # # PCGR: python - python>=3.6 - pip - numpy - cython HTTPError: HTTP 000 CONNECTION FAILED for url config --set show_channel_urls yes update ana-navigator config --set ssl_verify no ==>\u76ee\u524d\u6211\u4f7f\u7528\u7684\u955c\u50cf: channels: - https://mirrors.tuna.tsinghua.edu.cn/ana/cloud/msys2/ - https://mirrors.tuna.tsinghua.edu.cn/ana/pkgs/free/ - https://mirrors.ustc.edu.cn/ana/pkgs/r/ # - https://mirrors.ustc.edu.cn/ana/pkgs/free/ - https://mirrors.tuna.tsinghua.edu.cn/ana/cloud/bio/ - bio - r # - https://mirrors.tuna.tsinghua.edu.cn/ana/cloud/-forge/ # - defaults # - -forge ssl_verify: false show_channel_urls: true \u5728\u5199YAML\u7684\u65f6\u5019\u4e3b\u8981\u628a\u4f60\u7684channel\u5199\u4e0a\u53bb, \u5e76\u4e14\u4e00\u5b9a\u8981\u628adefault\u653e\u5230\u6700\u540e. \u5bf9\u4e8ePython\u548cR\u5f00\u53d1\u7684\u5de5\u5177,\u8bf7\u5c3d\u91cf\u521b\u5efa\u7684\u65b0\u7684\u73af\u5883\u8fdb\u884c\u7ba1\u7406. \u4f7f\u7528yaml\u6587\u4ef6 https://github.com/SciLifeLab/Sarek/blob/master/docs/.md \u955c\u50cf\u95ee\u9898 \u4e8c\u3001\u4f7f\u7528\u5b98\u65b9\u955c\u50cf 2.1 \u8bbe\u7f6e\u5b98\u65b9\u955c\u50cf \u76ee\u524d\uff0c\u6700\u4f73\u89e3\u51b3\u529e\u6cd5\u662f\u5220\u9664\u6240\u6709\u7b2c\u4e09\u65b9\u955c\u50cf\u94fe\u63a5\uff0c\u6062\u590d\u5230\u9ed8\u8ba4\u8bbe\u7f6e\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a config --remove-key channels config --show # \u67e5\u770b\u7684\u914d\u7f6e\uff0c\u786e\u8ba4channels \u589e\u52a0r\u3001-forge\u3001bio\u7684channels\uff1a config --add channels r # R\u8f6f\u4ef6\u5305 config --add channels -forge # \u793e\u533a\u7ef4\u62a4\u7684\u4e0d\u5728\u9ed8\u8ba4\u901a\u9053\u4e2d\u7684\u8f6f\u4ef6 config --add channels bio # \u751f\u7269\u4fe1\u606f\u5b66\u7c7b\u5de5\u5177 \u67e5\u770bchannels\u662f\u5426\u6dfb\u52a0\u6210\u529f\uff1a config --get channels 2.2 bio 1.jupyter notebook\u4e2d\u8bbe\u7f6e\u663e\u793a\u6700\u5927\u884c\u548c\u5217\u53ca\u6d6e\u70b9\u6570,\u5728head\u89c2\u5bdf\u884c\u548c\u5217\u65f6\u4e0d\u4f1a\u7701\u7565 pd.set_option(\u2018max_columns\u2019,1000) pd.set_option(\u2018max_row\u2019,300) pd.set_option(\u2018display.float_format\u2019, lambda x: \u2018%.5f\u2019 % x) #\u663e\u793a\u6240\u6709\u5217 pd.set_option('display.max_columns', None) #\u663e\u793a\u6240\u6709\u884c pd.set_option('display.max_rows', None) #\u8bbe\u7f6evalue\u7684\u663e\u793a\u957f\u5ea6\u4e3a100\uff0c\u9ed8\u8ba4\u4e3a50 pd.set_option('max_colwidth',100) https://github.com/mozilla/jupyter-notebook-gist \u5982\u4f55\u901a\u8fc7pip\u5c06packages\u5b89\u88c5\u5230\u73af\u5883\u4e2d \u4f7f\u7528\u73af\u5883\u4e2d\u7684pip\u5b89\u88c5 pip install --upgrade --force-reinstall <package>","title":"003 conda"},{"location":"15_python/003_conda/#_1","text":"--version update create -n myenv scipy=0.15.0 #\u521b\u5efa\u4e00\u4e2a\u542b\u6709\u6307\u5b9a\u7248\u672c\u8f6f\u4ef6\u7684\u73af\u5883 install -n myenv bwa #\u5b89\u88c5bwa\u5230\u73af\u5883myenv\u4e2d \u4e5f\u53ef\u4ee5\u901a\u8fc7-c\u6307\u5b9a\u901a\u8fc7\u67d0\u4e2achannel\u5b89\u88c5 list #\u67e5\u770b\u5f53\u524d\u73af\u5883\u4e2d\u5b89\u88c5\u7684\u8f6f\u4ef6 list -n myenv \uff03\u67e5\u770b\u67d0\u4e2a\u73af\u5883\u4e2d\u5b89\u88c5\u7684\u5305 list -n myenv scipy \uff03\u67e5\u770bmyenv\u73af\u5883\u4e2d\u662f\u5426\u5b89\u88c5\u8f6f\u4ef6scipy remove --name myenv --all #\u79fb\u9664\u4e00\u4e2a\u73af\u5883 --name\uff0f-n env remove --name myenv #\u6548\u679c\u540c\u4e0a info --envs #\u786e\u8ba4\u67d0\u4e2a\u73af\u5883\u88ab\u5220\u9664\uff0c\u5982\u679c\u80fd\u5728\u663e\u793a\u7684\u73af\u5883list\u4e2d\u770b\u5230\u8bf4\u660e\u6ca1\u88ab\u5220\u9664\uff0c\u5f53\u524d\u73af\u5883\u7528\"*\"\u8868\u793a env list #\u540c\u4e0a list --explicit #\u67e5\u770b\u5f53\u524d\u73af\u5883\u7684\u5b89\u88c5\u5305\u7684\u5177\u4f53list list --explicit > spec-file.txt #\u5bfc\u51fa\u5177\u4f53list create --name myenv --file spec-file.txt #\u901a\u8fc7\u5b89\u88c5\u5305\u7684\u5177\u4f53list\u5728\u5176\u4ed6\u673a\u5668\uff08\u6700\u597d\u7cfb\u7edf\u76f8\u540c\uff09\u4e0a\u91cd\u5efa\u73af\u5883 install --name oldmyenv --file spec-file.txt #\u5c06\u5b89\u88c5\u5305list\u4e2d\u7684\u8f6f\u4ef6\u88c5\u5230oldmyenv\u73af\u5883\u4e2d search numpy #\u5dee\u627e\u67d0\u4e2a\u5305 update -n myenv numpy #\u66f4\u65b0myenv\u73af\u5883\u4e2d\u7684\u67d0\u4e2a\u5305 remove -n myenv numpy #\u5220\u9664myenv\u73af\u5883\u4e2d\u7684\u67d0\u4e2a\u5305 update #\u66f4\u65b0\u81ea\u8eab","title":""},{"location":"15_python/003_conda/#pin-versions-with-yml-file","text":"env create -n pcgr --file _environment.yml name: pcgr channels: - bio - -forge - defaults - ana dependencies: # # PCGR: python - python>=3.6 - pip - numpy - cython","title":"Pin versions with yml file"},{"location":"15_python/003_conda/#httperror-http-000-connection-failed-for-url","text":"config --set show_channel_urls yes update ana-navigator config --set ssl_verify no ==>\u76ee\u524d\u6211\u4f7f\u7528\u7684\u955c\u50cf: channels: - https://mirrors.tuna.tsinghua.edu.cn/ana/cloud/msys2/ - https://mirrors.tuna.tsinghua.edu.cn/ana/pkgs/free/ - https://mirrors.ustc.edu.cn/ana/pkgs/r/ # - https://mirrors.ustc.edu.cn/ana/pkgs/free/ - https://mirrors.tuna.tsinghua.edu.cn/ana/cloud/bio/ - bio - r # - https://mirrors.tuna.tsinghua.edu.cn/ana/cloud/-forge/ # - defaults # - -forge ssl_verify: false show_channel_urls: true \u5728\u5199YAML\u7684\u65f6\u5019\u4e3b\u8981\u628a\u4f60\u7684channel\u5199\u4e0a\u53bb, \u5e76\u4e14\u4e00\u5b9a\u8981\u628adefault\u653e\u5230\u6700\u540e. \u5bf9\u4e8ePython\u548cR\u5f00\u53d1\u7684\u5de5\u5177,\u8bf7\u5c3d\u91cf\u521b\u5efa\u7684\u65b0\u7684\u73af\u5883\u8fdb\u884c\u7ba1\u7406.","title":"HTTPError: HTTP 000 CONNECTION FAILED for url"},{"location":"15_python/003_conda/#yaml","text":"https://github.com/SciLifeLab/Sarek/blob/master/docs/.md","title":"\u4f7f\u7528yaml\u6587\u4ef6"},{"location":"15_python/003_conda/#_2","text":"\u4e8c\u3001\u4f7f\u7528\u5b98\u65b9\u955c\u50cf 2.1 \u8bbe\u7f6e\u5b98\u65b9\u955c\u50cf \u76ee\u524d\uff0c\u6700\u4f73\u89e3\u51b3\u529e\u6cd5\u662f\u5220\u9664\u6240\u6709\u7b2c\u4e09\u65b9\u955c\u50cf\u94fe\u63a5\uff0c\u6062\u590d\u5230\u9ed8\u8ba4\u8bbe\u7f6e\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a config --remove-key channels config --show # \u67e5\u770b\u7684\u914d\u7f6e\uff0c\u786e\u8ba4channels \u589e\u52a0r\u3001-forge\u3001bio\u7684channels\uff1a config --add channels r # R\u8f6f\u4ef6\u5305 config --add channels -forge # \u793e\u533a\u7ef4\u62a4\u7684\u4e0d\u5728\u9ed8\u8ba4\u901a\u9053\u4e2d\u7684\u8f6f\u4ef6 config --add channels bio # \u751f\u7269\u4fe1\u606f\u5b66\u7c7b\u5de5\u5177 \u67e5\u770bchannels\u662f\u5426\u6dfb\u52a0\u6210\u529f\uff1a config --get channels 2.2 bio","title":"\u955c\u50cf\u95ee\u9898"},{"location":"15_python/003_conda/#_3","text":"","title":""},{"location":"15_python/003_conda/#1jupyter-notebookhead","text":"pd.set_option(\u2018max_columns\u2019,1000) pd.set_option(\u2018max_row\u2019,300) pd.set_option(\u2018display.float_format\u2019, lambda x: \u2018%.5f\u2019 % x) #\u663e\u793a\u6240\u6709\u5217 pd.set_option('display.max_columns', None) #\u663e\u793a\u6240\u6709\u884c pd.set_option('display.max_rows', None) #\u8bbe\u7f6evalue\u7684\u663e\u793a\u957f\u5ea6\u4e3a100\uff0c\u9ed8\u8ba4\u4e3a50 pd.set_option('max_colwidth',100)","title":"1.jupyter notebook\u4e2d\u8bbe\u7f6e\u663e\u793a\u6700\u5927\u884c\u548c\u5217\u53ca\u6d6e\u70b9\u6570,\u5728head\u89c2\u5bdf\u884c\u548c\u5217\u65f6\u4e0d\u4f1a\u7701\u7565"},{"location":"15_python/003_conda/#_4","text":"https://github.com/mozilla/jupyter-notebook-gist","title":""},{"location":"15_python/003_conda/#pippackages","text":"\u4f7f\u7528\u73af\u5883\u4e2d\u7684pip\u5b89\u88c5 pip install --upgrade --force-reinstall <package>","title":"\u5982\u4f55\u901a\u8fc7pip\u5c06packages\u5b89\u88c5\u5230\u73af\u5883\u4e2d"},{"location":"15_python/004_%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E5%99%A8/","text":"\u6027\u80fd\u5206\u6790\u5668 lineprofiler \u2013 \u9010\u884c\u6027\u80fd\u5206\u6790\u3002 memoryprofiler \u2013 \u76d1\u63a7 Python \u4ee3\u7801\u7684\u5185\u5b58\u4f7f\u7528\u3002 profiling \u2013 \u4e00\u4e2a\u4ea4\u4e92\u5f0f Python \u6027\u80fd\u5206\u6790\u5de5\u5177\u3002 \u4efb\u52a1\u8c03\u5ea6\u5e93 APScheduler \u2013 \u8f7b\u5de7\u4f46\u5f3a\u5927\u7684\u8fdb\u7a0b\u5185\u4efb\u52a1\u8c03\u5ea6\uff0c\u4f7f\u4f60\u53ef\u4ee5\u8c03\u5ea6\u51fd\u6570\u3002 django-schedule \u2013 \u4e00\u4e2a Django \u6392\u7a0b\u5e94\u7528\u3002 doit \u2013 \u4e00\u4e2a\u4efb\u52a1\u6267\u884c\u548c\u6784\u5efa\u5de5\u5177\u3002 gunnery \u2013 \u5206\u5e03\u5f0f\u7cfb\u7edf\u4f7f\u7528\u7684\u591a\u7528\u9014\u4efb\u52a1\u6267\u884c\u5de5\u5177 \uff0c\u5177\u6709 web \u4ea4\u4e92\u754c\u9762\u3002 Joblib \u2013 \u4e00\u7ec4\u4e3a Python \u63d0\u4f9b\u8f7b\u91cf\u7ea7\u4f5c\u4e1a\u6d41\u6c34\u7ebf\u7684\u5de5\u5177\u3002 Plan \u2013 \u5982\u6709\u795e\u52a9\u5730\u7f16\u5199 crontab \u6587\u4ef6\u3002 schedule \u2013 \u4eba\u6027\u5316\u7684 Python \u4efb\u52a1\u8c03\u5ea6\u5e93\u3002 Spiff \u2013 \u4f7f\u7528\u7eaf Python \u5b9e\u73b0\u7684\u5f3a\u5927\u7684\u5de5\u4f5c\u6d41\u5f15\u64ce\u3002 TaskFlow \u2013 \u4e00\u4e2a\u53ef\u4ee5\u8ba9\u4f60\u65b9\u4fbf\u6267\u884c\u4efb\u52a1\u7684 Python \u5e93\uff0c\u4e00\u81f4\u5e76\u4e14\u53ef\u9760\u3002","title":"004 \u6027\u80fd\u5206\u6790\u5668"},{"location":"15_python/005_request/","text":"","title":"005 request"},{"location":"15_python/005_%E7%88%AC%E8%99%AB/","text":"Robots\u534f\u8bae robots\u662f\u7f51\u7ad9\u8ddf\u722c\u866b\u95f4\u7684\u534f\u8bae\uff0crobots.txt\uff08\u7edf\u4e00\u5c0f\u5199\uff09\u662f\u4e00\u79cd\u5b58\u653e\u4e8e\u7f51\u7ad9\u6839\u76ee\u5f55\u4e0b\u7684ASCII\u7f16\u7801\u7684\u6587\u672c\u6587\u4ef6\uff0c\u5b83\u901a\u5e38\u544a\u8bc9\u7f51\u7edc\u641c\u7d22\u5f15\u64ce\u7684\u6f2b\u6e38\u5668\uff08\u53c8\u79f0\u7f51\u7edc\u8718\u86db\uff09\uff0c\u6b64\u7f51\u7ad9\u4e2d\u7684\u54ea\u4e9b\u5185\u5bb9\u662f\u4e0d\u5e94\u88ab\u641c\u7d22\u5f15\u64ce\u7684\u6f2b\u6e38\u5668\u83b7\u53d6\u7684\uff0c\u54ea\u4e9b\u662f\u53ef\u4ee5\u88ab\u6f2b\u6e38\u5668\u83b7\u53d6\u7684\u3002 Selenium http://www.sohu.com/a/290128640_120050566","title":"Robots\u534f\u8bae"},{"location":"15_python/005_%E7%88%AC%E8%99%AB/#robots","text":"robots\u662f\u7f51\u7ad9\u8ddf\u722c\u866b\u95f4\u7684\u534f\u8bae\uff0crobots.txt\uff08\u7edf\u4e00\u5c0f\u5199\uff09\u662f\u4e00\u79cd\u5b58\u653e\u4e8e\u7f51\u7ad9\u6839\u76ee\u5f55\u4e0b\u7684ASCII\u7f16\u7801\u7684\u6587\u672c\u6587\u4ef6\uff0c\u5b83\u901a\u5e38\u544a\u8bc9\u7f51\u7edc\u641c\u7d22\u5f15\u64ce\u7684\u6f2b\u6e38\u5668\uff08\u53c8\u79f0\u7f51\u7edc\u8718\u86db\uff09\uff0c\u6b64\u7f51\u7ad9\u4e2d\u7684\u54ea\u4e9b\u5185\u5bb9\u662f\u4e0d\u5e94\u88ab\u641c\u7d22\u5f15\u64ce\u7684\u6f2b\u6e38\u5668\u83b7\u53d6\u7684\uff0c\u54ea\u4e9b\u662f\u53ef\u4ee5\u88ab\u6f2b\u6e38\u5668\u83b7\u53d6\u7684\u3002","title":"Robots\u534f\u8bae"},{"location":"15_python/005_%E7%88%AC%E8%99%AB/#selenium","text":"http://www.sohu.com/a/290128640_120050566","title":"Selenium"},{"location":"15_python/007_parallel/","text":"\u591a\u8fdb\u7a0b\u53ef\u4ee5\u6709\u6548\u5229\u7528\u670d\u52a1\u5668\u591a\u6838CPU\u7684\u8ba1\u7b97\u8d44\u6e90\uff0c\u52a0\u901f\u8fd0\u884c\u6548\u7387\uff0c\u5728python\u4e2d\uff0c\u901a\u8fc7\u5185\u7f6e\u6a21\u5757multiprocessing\u6765\u8fdb\u884c\u591a\u8fdb\u7a0b\u7f16\u7a0b\u3002 \u5b50\u8fdb\u7a0b\u901a\u8fc7Process\u7c7b\u6765\u8bbe\u7f6e\uff0c\u793a\u4f8b\u5982\u4e0b from multiprocessing import Process import subprocess import shlex def cal_seqs(fq): print('calculate fastq sequences') cnt = 0 with open(fq) as f: for line in f: cnt += 1 print('fastq sequences : {}'.format(cnt / 4)) def fastqc(fq): cmd = 'fastqc -t 10 {}'.format(fq) cmd_args = shlex.split(cmd) p = subprocess.Popen(cmd_args, stdout = subprocess.PIPE) p.stdout.read() if __name__ == '__main__': fq = 'test.fq' p = Process(target = fastqc, args = (fq, )) p.start() cal_seqs(fq) print('Finish calculate fastq sequences') \u4e0a\u8ff0\u4ee3\u7801 \u542f\u52a8\u4e86\u4e00\u4e2a\u5b50\u8fdb\u7a0b \u6765\u8fd0\u884cfastqc, \u4e3b\u8fdb\u7a0b\u5219\u6267\u884c\u8ba1\u7b97fastq\u6587\u4ef6\u7684\u5e8f\u5217\u6570\uff0c\u8fd0\u884c\u4e0a\u8ff0\u4ee3\u7801\uff0c\u4f60\u4f1a\u770b\u5230\u7c7b\u4f3c\u5982\u4e0b\u7684\u8f93\u51fa calculate fastq sequences fastq sequences : 100000 Finish calculate fastq sequences Started analysis of test.fq Approx 5% complete for test.fq Approx 10% complete for test.fq Approx 15% complete for test.fq Approx 20% complete for test.fq \u4e3b\u8fdb\u7a0b\u4e2d\u7684\u884c\u6570\u8ba1\u7b97\u5148\u6267\u884c\u5b8c\u6bd5\uff0c\u5b50\u8fdb\u7a0b\u540e\u6267\u884c\u5b8c\u6bd5\uff0c \u8bf4\u660e\u5b50\u8fdb\u7a0b\u662f\u975e\u963b\u585e\u7684\u3002\u5728\u4e3b\u8fdb\u7a0b\u4e2d\u542f\u52a8\u4e86\u5b50\u8fdb\u7a0b\u540e\uff0c\u4e3b\u8fdb\u7a0b\u4e0d\u7ba1\u5b50\u8fdb\u7a0b\u662f\u5426\u8fd0\u884c\u7ed3\u675f\uff0c\u63a5\u7740\u5f80\u4e0b\u6267\u884c\u8ba1\u7b97\u884c\u6570\u7684\u7ed3\u679c\uff0c\u8fd9\u5c31\u662f\u975e\u963b\u585e\u3002\u5982\u679c\u9700\u8981\u7b49\u5b50\u8fdb\u7a0b\u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u4e3b\u8fdb\u7a0b\u518d\u76f4\u63a5\u6267\u884c\uff0c\u4e5f\u5c31\u662f\u963b\u585e\u5f0f\u7684\u8fd0\u884c\uff0c\u9700\u8981join\u51fd\u6570\u6765\u8fdb\u884c\u963b\u585e\uff0c\u4e0a\u8ff0\u4ee3\u7801\u4fee\u6539\u5982\u4e0b from multiprocessing import Process import subprocess import shlex def cal_seqs(fq): print('calculate fastq sequences') cnt = 0 with open(fq) as f: for line in f: cnt += 1 print('fastq sequences : {}'.format(cnt / 4)) def fastqc(fq): cmd = 'fastqc -t 10 {}'.format(fq) cmd_args = shlex.split(cmd) p = subprocess.Popen(cmd_args, stdout = subprocess.PIPE) p.stdout.read() if __name__ == '__main__': fq = 'test.fq' p = Process(target = fastqc, args = (fq, )) p.start() p.join() cal_seqs(fq) print('Finish calculate fastq sequences') \u518d\u6b21\u8fd0\u884c\uff0c\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u8f93\u51fa Started analysis of test.fq Approx 5% complete for test.fq Approx 10% complete for test.fq ... Approx 95% complete for test.fq Approx 100% complete for test.fq calculate fastq sequences fastq sequences : 100000 Finish calculate fastq sequences join\u7684\u4f5c\u7528\u5c31\u662f\u963b\u585e\u5b50\u7a0b\u5e8f\uff0c\u7b49\u5f85\u5b50\u8fdb\u7a0b\u6267\u884c\u5b8c\u6bd5\u4e4b\u540e\uff0c\u4e3b\u8fdb\u7a0b\u624d\u53ef\u4ee5\u63a5\u7740\u5f80\u4e0b\u6267\u884c\u3002\u5982\u679c\u53ea\u662f\u9700\u8981\u6267\u884c\u67d0\u4e9b\u7a0b\u5e8f\uff0c\u800c\u4e14\u4e0b\u6587\u4e2d\u4e5f\u4e0d\u4f9d\u8d56\u5176\u7ed3\u679c\uff0c\u53ef\u4ee5\u9009\u62e9\u975e\u963b\u585e\u5f0f\u7684\u8fd0\u884c\uff0c\u5982\u679c\u4e0b\u6587\u9700\u8981\u4f9d\u8d56\u5176\u7ed3\u679c\uff0c\u5c31\u9700\u8981\u963b\u585e\u5f0f\u7684\u8fd0\u884c\u4e86\uff0c\u5e94\u8be5\u6839\u636e\u5b9e\u9645\u60c5\u51b5\uff0c\u7075\u6d3b\u8fdb\u884c\u9009\u62e9\u3002 \u5bf9\u4e8e\u591a\u4e2a\u6837\u672c\u7684\u91cd\u590d\u5904\u7406\uff0c\u53ef\u4ee5\u7528\u591a\u8fdb\u7a0b\u8fbe\u5230\u5e76\u884c\u7684\u76ee\u7684\uff0c\u4ee3\u7801\u793a\u4f8b\u5982\u4e0b process_list = [] samples = ['control1', 'control2', 'control3', 'case1', 'case2', 'case3'] for sample in sample: fq = '{}.fq'.format(sample) p = Process(target = fastqc, args = (sample, )) p.start() process_list.append(p) # \u6839\u636e\u9700\u8981\u9009\u62e9\u662f\u5426\u963b\u585e for p in process_list: p.join() \u4e0a\u8ff0\u4ee3\u7801\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u4f1a\u4e00\u6b21\u6027\u5c06\u6240\u6709\u7684\u6837\u672c\u90fd\u5e76\u884c\uff0c\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u7ed3\u5408\u8ba1\u7b97\u8d44\u6e90\u6765\u63a7\u5236\u6700\u5927\u7684\u5e76\u884c\u6570\uff0c\u6b64\u65f6\u53ef\u4ee5\u4f7f\u7528\u8fdb\u7a0b\u6c60Pool\u7c7b\uff0c\u53ef\u4ee5\u65b9\u4fbf\u7684\u6307\u5b9a\u6700\u5927\u8fdb\u7a0b\u6570\uff0c\u793a\u4f8b\u5982\u4e0b p = Pool(3) process_list = [] samples = ['control1', 'control2', 'control3', 'case1', 'case2', 'case3'] for sample in sample: fq = '{}.fq'.format(sample) p.append_async(target = fastqc, args = (sample, )) p.close() p.join() \u4e0a\u8ff0\u4ee3\u7801\u8fd8\u53ef\u4ee5\u7528map\u65b9\u6cd5\u8fdb\u884c\u6539\u5199\uff0c\u66f4\u52a0\u7b80\u4fbf\uff0c\u6539\u5199\u4e4b\u540e\u7684\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b from multiprocessing import Pool import subprocess import shlex def fastqc(fq): cmd = 'fastqc -t 10 {}'.format(fq) cmd_args = shlex.split(cmd) p = subprocess.Popen(cmd_args, stdout = subprocess.PIPE) p.stdout.read() if __name__ == '__main__': samples = ['control1.fq', 'control2.fq', 'control3.fq', 'case1.fq', 'case2.fq', 'case3.fq'] with Pool(3) as p: samples = ['control1.fq', 'control2.fq', 'control3.fq', 'case1.fq', 'case2.fq', 'case3.fq'] p.map(fastqc, samples) print('Finish') \u4ee5\u4e0a\u5c31\u662fpython\u591a\u8fdb\u7a0b\u7684\u57fa\u672c\u7528\u6cd5\uff0c\u9664\u6b64\u4ee5\u5916\uff0cpython\u8fd8\u652f\u6301\u8fdb\u7a0b\u95f4\u901a\u4fe1\u4ee5\u53ca\u5171\u4eab\u53d8\u91cf\uff0c\u66f4\u9ad8\u7ea7\u7684\u7528\u6cd5\u8bf7\u67e5\u770b\u5b98\u65b9\u7684API\u6587\u6863\u3002","title":"007 parallel"},{"location":"16_TGS/001/","text":"Nanopore Nanopore\u6d4b\u5e8f\u7684\u4e0b\u673a\u6570\u636e\u7684\u539f\u59cb\u6570\u636e\u683c\u5f0f\u4e3a\u5305\u542b\u6240\u6709\u539f\u59cb\u6d4b\u5e8f\u7535\u4fe1\u53f7\u7684\u4e8c\u4ee3fast5\u683c\u5f0f\u3002\u901a\u8fc7MinKNOW2.2\u8f6f\u4ef6\u5305\u4e2d\u7684Guppy\u8f6f\u4ef6\u8fdb\u884cbase calling\u540e\u4f1a\u5c06fast5\u683c\u5f0f\u6570\u636e\u8f6c\u6362\u4e3afastq\u683c\u5f0f\uff0c\u7528\u4e8e\u540e\u7eed\u8d28\u63a7\u5206\u6790\u3002\uff08\u901a\u5e38\u6d4b\u5e8f\u670d\u52a1\u5546\u4f1a\u7ed9\u4f60fastq\u683c\u5f0f\u7684\u6570\u636e\u7ed3\u679c\uff09 https://mp.weixin.qq.com/s/7gd3R4H1C0EmbkV4DupbKA \u6d4b\u8bd5\u4eea\u5668\u79cd\u7c7b MinION: ONT\u6700\u77e5\u540d\u4ea7\u54c1\uff0c\u4ec5\u6709U\u76d8\u5927\u5c0f\uff0c\u63d2\u5165\u666e\u901aPC\u7535\u8111\u5373\u53ef\u8fd0\u884c\uff0c\u4e00\u6b21\u53ef\u8fd0\u884c\u4e00\u4e2aflow cells\uff0c\u4ea7\u51fa\u7ea610-30Gb\u7684\u6d4b\u5e8f\u6570\u636e\uff0c\u8fd0\u884c\u65f6\u957f\u7ea648\u5c0f\u65f6\uff1b Flongle: MinION\u548cGridION X5\u6d4b\u5e8f\u4eea\u7684\u9002\u914d\u5668\uff08adapter\uff0cflow cell dongle\uff09\uff0c\u4ec5\u4f9b\u4e00\u6b21\u6027\u4f7f\u7528\u3002\u4e0d\u540c\u4e8eMinION\u6d41\u52a8\u69fd\u542b\u6709512\u4e2a\u901a\u9053\uff0cFlongle\u542b\u6709126\u4e2a\u901a\u9053\u3002\u5b83\u76ee\u524d\u6700\u591a\u80fd\u751f\u62101.8 Gb\u6570\u636e\u3002 PromethION: PromethION\u662fONT\u63a8\u51fa\u7684\u6700\u65b0\u6b3e\u8d85\u9ad8\u901a\u91cf\u6d4b\u5e8f\u8bbe\u5907\uff0c\u5b83\u652f\u6301\u5b9e\u65f6\u3001\u957f\u8bfb\u957f\u3001\u76f4\u63a5DNA\u548cRNA\u6d4b\u5e8f\u5de5\u4f5c\u6d41\u7a0b\u3002\u4e00\u6b21\u53ef\u8fd0\u884c24 (PromethION 24) \u523048 (PromethION 48) \u4e2a\u6d4b\u5e8f\u82af\u7247\uff0c\u6309\u7167\u6bcf\u5f20\u6d4b\u5e8f\u82af\u7247\u5305\u542b3,000\u4e2a\u7eb3\u7c73\u5b54\u901a\u9053\uff0c\u6240\u6709\u82af\u7247\u540c\u65f6\u8fd0\u884c\u5c06\u53ef\u4ea7\u51fa\u9ad8\u8fbe7.6Tb\u751a\u81f3\u662f15Tb\u7684\u6570\u636e\uff0c\u8fd9\u80fd\u591f\u6ee1\u8db3\u8d85\u9ad8\u901a\u91cf\u7684\u3001\u5feb\u901f\u5468\u8f6c\u6d4b\u5e8f\u9700\u6c42\u3002\u9002\u7528\u4e8e\u5927\u89c4\u6a21\u7fa4\u4f53\u9057\u4f20\u5b66\u7814\u7a76\u548c\u5927\u578b\u52a8\u690d\u7269\u57fa\u56e0\u7ec4\u6d4b\u5e8f\u9879\u76ee\uff1b GridION GridION X5\u7cfb\u7edf\u7684\u6d4b\u5e8f\u90e8\u5206\u5305\u542b\u4e94\u4e2a flow cells\uff0c\u8fd9\u4e9bflow cells\u53ef\u5355\u72ec\u4f7f\u7528\u6216\u534f\u540c\u4f7f\u7528\uff0c\u5e76\u901a\u8fc7USB\u8fde\u63a5\u5230\u8ba1\u7b97\u673a\u3002\u5229\u7528\u73b0\u6709\u7684\u8bd5\u5242\u548c\u8f6f\u4ef6\u6bcf\u8fd0\u884c48\u5c0f\u65f6\u53ef\u751f\u6210\u9ad8\u8fbe150GB\u7684\u6d4b\u5e8f\u6570\u636e\u3002GridION X5\u7684\u51fa\u73b0\u586b\u8865\u4e86MinION\u548cPromethION\u4e4b\u95f4\u7684\u7a7a\u767d\u3002 https://github.com/wdecoster https://github.com/wdecoster/NanoPlot https://zhuanlan.zhihu.com/p/115115901","title":"Nanopore"},{"location":"16_TGS/001/#nanopore","text":"Nanopore\u6d4b\u5e8f\u7684\u4e0b\u673a\u6570\u636e\u7684\u539f\u59cb\u6570\u636e\u683c\u5f0f\u4e3a\u5305\u542b\u6240\u6709\u539f\u59cb\u6d4b\u5e8f\u7535\u4fe1\u53f7\u7684\u4e8c\u4ee3fast5\u683c\u5f0f\u3002\u901a\u8fc7MinKNOW2.2\u8f6f\u4ef6\u5305\u4e2d\u7684Guppy\u8f6f\u4ef6\u8fdb\u884cbase calling\u540e\u4f1a\u5c06fast5\u683c\u5f0f\u6570\u636e\u8f6c\u6362\u4e3afastq\u683c\u5f0f\uff0c\u7528\u4e8e\u540e\u7eed\u8d28\u63a7\u5206\u6790\u3002\uff08\u901a\u5e38\u6d4b\u5e8f\u670d\u52a1\u5546\u4f1a\u7ed9\u4f60fastq\u683c\u5f0f\u7684\u6570\u636e\u7ed3\u679c\uff09 https://mp.weixin.qq.com/s/7gd3R4H1C0EmbkV4DupbKA","title":"Nanopore"},{"location":"16_TGS/001/#_1","text":"MinION: ONT\u6700\u77e5\u540d\u4ea7\u54c1\uff0c\u4ec5\u6709U\u76d8\u5927\u5c0f\uff0c\u63d2\u5165\u666e\u901aPC\u7535\u8111\u5373\u53ef\u8fd0\u884c\uff0c\u4e00\u6b21\u53ef\u8fd0\u884c\u4e00\u4e2aflow cells\uff0c\u4ea7\u51fa\u7ea610-30Gb\u7684\u6d4b\u5e8f\u6570\u636e\uff0c\u8fd0\u884c\u65f6\u957f\u7ea648\u5c0f\u65f6\uff1b Flongle: MinION\u548cGridION X5\u6d4b\u5e8f\u4eea\u7684\u9002\u914d\u5668\uff08adapter\uff0cflow cell dongle\uff09\uff0c\u4ec5\u4f9b\u4e00\u6b21\u6027\u4f7f\u7528\u3002\u4e0d\u540c\u4e8eMinION\u6d41\u52a8\u69fd\u542b\u6709512\u4e2a\u901a\u9053\uff0cFlongle\u542b\u6709126\u4e2a\u901a\u9053\u3002\u5b83\u76ee\u524d\u6700\u591a\u80fd\u751f\u62101.8 Gb\u6570\u636e\u3002 PromethION: PromethION\u662fONT\u63a8\u51fa\u7684\u6700\u65b0\u6b3e\u8d85\u9ad8\u901a\u91cf\u6d4b\u5e8f\u8bbe\u5907\uff0c\u5b83\u652f\u6301\u5b9e\u65f6\u3001\u957f\u8bfb\u957f\u3001\u76f4\u63a5DNA\u548cRNA\u6d4b\u5e8f\u5de5\u4f5c\u6d41\u7a0b\u3002\u4e00\u6b21\u53ef\u8fd0\u884c24 (PromethION 24) \u523048 (PromethION 48) \u4e2a\u6d4b\u5e8f\u82af\u7247\uff0c\u6309\u7167\u6bcf\u5f20\u6d4b\u5e8f\u82af\u7247\u5305\u542b3,000\u4e2a\u7eb3\u7c73\u5b54\u901a\u9053\uff0c\u6240\u6709\u82af\u7247\u540c\u65f6\u8fd0\u884c\u5c06\u53ef\u4ea7\u51fa\u9ad8\u8fbe7.6Tb\u751a\u81f3\u662f15Tb\u7684\u6570\u636e\uff0c\u8fd9\u80fd\u591f\u6ee1\u8db3\u8d85\u9ad8\u901a\u91cf\u7684\u3001\u5feb\u901f\u5468\u8f6c\u6d4b\u5e8f\u9700\u6c42\u3002\u9002\u7528\u4e8e\u5927\u89c4\u6a21\u7fa4\u4f53\u9057\u4f20\u5b66\u7814\u7a76\u548c\u5927\u578b\u52a8\u690d\u7269\u57fa\u56e0\u7ec4\u6d4b\u5e8f\u9879\u76ee\uff1b GridION GridION X5\u7cfb\u7edf\u7684\u6d4b\u5e8f\u90e8\u5206\u5305\u542b\u4e94\u4e2a flow cells\uff0c\u8fd9\u4e9bflow cells\u53ef\u5355\u72ec\u4f7f\u7528\u6216\u534f\u540c\u4f7f\u7528\uff0c\u5e76\u901a\u8fc7USB\u8fde\u63a5\u5230\u8ba1\u7b97\u673a\u3002\u5229\u7528\u73b0\u6709\u7684\u8bd5\u5242\u548c\u8f6f\u4ef6\u6bcf\u8fd0\u884c48\u5c0f\u65f6\u53ef\u751f\u6210\u9ad8\u8fbe150GB\u7684\u6d4b\u5e8f\u6570\u636e\u3002GridION X5\u7684\u51fa\u73b0\u586b\u8865\u4e86MinION\u548cPromethION\u4e4b\u95f4\u7684\u7a7a\u767d\u3002 https://github.com/wdecoster https://github.com/wdecoster/NanoPlot https://zhuanlan.zhihu.com/p/115115901","title":"\u6d4b\u8bd5\u4eea\u5668\u79cd\u7c7b"},{"location":"16_TGS/002_minimap2/","text":"\u7b2c\u4e00\u6b65\uff1a\u5efa\u7acb\u7d22\u5f15 minimap2 -d co92.min co92.fna","title":"002 minimap2"},{"location":"16_TGS/002_minimap2/#_1","text":"minimap2 -d co92.min co92.fna","title":"\u7b2c\u4e00\u6b65\uff1a\u5efa\u7acb\u7d22\u5f15"},{"location":"slides/20191121/","text":"Strand Orientation Bias Detector (SOBDetector) to remove artifacts from sequencing data of formalin fixed samples. by analyzing the orientation of paired end sequences that are spanning the variants\u2019 locations. The most prominent of those is the deamination of cytosines, which introduces CFT/GFA mutations (Oh et al., 2015). As a measure of the strand orientation, we defined the strand orientation bias (SOB) score, as the following: SOB = (#F1R2alt - #F2R1alt)/(#F1R2alt + #F1R2alt') where #ofF1R2alt is the number of alternate allele supporting reads that are in the forward 1st, reverse 2nd orientation. SOB score lies in the [-1,1] interval, and the closer it is to the two extrema, the higher the probability, that the corresponding variant is a sequencing artifact. https://github.com/mikdio/SOBDetector Benchmark of tools for CNV detection from NGS panel data in a genetic diagnostics context Five tools (DECoN, CoNVaDING, panelcn.MOPS, ExomeDepth and CODEX2) were tested against four genetic diagnostics datasets (495 samples, 231 CNVs) (ICR96, panelcnDataset, In-house Miseq and In-HouseHiSeq) The dataset ICR96 exon CNV validation series (Mahamdallie et al., 2017) was downloaded from the European Genome-phenome Archive (EGA) (EGAD00001003335) and contained 96 samples captured with TruSight Cancer Panel v2 (100 genes) and sequenced in a single HiSeq lane with 101-base pairedend reads. panelcnDataset (Povysil et al., 2017) was also downloaded from EGA (EGAS00001002481) and had 170 samples captured using TruSight Cancer Panel (94 genes, Illumina) and sequenced on a MiSeq instrument with 151-base paired-end reads. s. Only 161 out of the 170 samples were used in this work and 9 were removed because they presented alterations out of the scope of this benchmark: 5 presented CNVs smaller than an exon (IBK9, IBK23, IBK67, IBK153, IBK166) and 4 contained ALUs insertions instead of CNVs (IBK141, IBK142, IBK143, IBK151). IBK141 ALU insertion was not reported in the original publication but identified in this work (Supplementary File 1).","title":"20191121"},{"location":"slides/20191121/#strand-orientation-bias-detector-sobdetector-to-remove-artifacts-from-sequencing-data-of-formalin-fixed-samples","text":"by analyzing the orientation of paired end sequences that are spanning the variants\u2019 locations. The most prominent of those is the deamination of cytosines, which introduces CFT/GFA mutations (Oh et al., 2015). As a measure of the strand orientation, we defined the strand orientation bias (SOB) score, as the following: SOB = (#F1R2alt - #F2R1alt)/(#F1R2alt + #F1R2alt') where #ofF1R2alt is the number of alternate allele supporting reads that are in the forward 1st, reverse 2nd orientation. SOB score lies in the [-1,1] interval, and the closer it is to the two extrema, the higher the probability, that the corresponding variant is a sequencing artifact. https://github.com/mikdio/SOBDetector","title":"Strand Orientation Bias Detector (SOBDetector) to remove artifacts from sequencing data of formalin fixed samples."},{"location":"slides/20191121/#benchmark-of-tools-for-cnv-detection-from-ngs-panel-data-in-a-genetic-diagnostics-context","text":"Five tools (DECoN, CoNVaDING, panelcn.MOPS, ExomeDepth and CODEX2) were tested against four genetic diagnostics datasets (495 samples, 231 CNVs) (ICR96, panelcnDataset, In-house Miseq and In-HouseHiSeq) The dataset ICR96 exon CNV validation series (Mahamdallie et al., 2017) was downloaded from the European Genome-phenome Archive (EGA) (EGAD00001003335) and contained 96 samples captured with TruSight Cancer Panel v2 (100 genes) and sequenced in a single HiSeq lane with 101-base pairedend reads. panelcnDataset (Povysil et al., 2017) was also downloaded from EGA (EGAS00001002481) and had 170 samples captured using TruSight Cancer Panel (94 genes, Illumina) and sequenced on a MiSeq instrument with 151-base paired-end reads. s. Only 161 out of the 170 samples were used in this work and 9 were removed because they presented alterations out of the scope of this benchmark: 5 presented CNVs smaller than an exon (IBK9, IBK23, IBK67, IBK153, IBK166) and 4 contained ALUs insertions instead of CNVs (IBK141, IBK142, IBK143, IBK151). IBK141 ALU insertion was not reported in the original publication but identified in this work (Supplementary File 1).","title":"Benchmark of tools for CNV detection from NGS panel data in a genetic diagnostics context"},{"location":"slides/20191122/","text":"The purpose READ_NAME_REGEX is to specify a regular expression that will capture from the read name the physical location of the cluster in the lane. This is used to distinguish optical duplicates (cases in which the cluster-finding software has incorrectly identified a single cluster as two clusters), from PCR duplicates. If two reads are considered duplicates of one another, and their physical locations are close to one another (as defined by OPTICAL_DUPLICATE_PIXEL_DISTANCE), then they are considered optical duplicates, and excluded from the computation of estimated library size. The default value for READ_NAME_REGEX is a regular expression that captures physical location from the conventional Illumina read name format. If you read the usage for this option, you'll see that the regex must contain 3 capture groups, which yours does not, thus the exception. It appears that your read names do not include physical location, so you can either leave the default value and ignore the warning message, or you can pass READ_NAME_REGEX=null, which will suppress this functionality entirely. That seems the most appropriate thing to do since your reads don't contain physical location info. A00881:156:HTV2LDSXX:4:1377:32090:34522","title":"20191122"},{"location":"slides/20191128/","text":"Blood-based tumor mutational burden as a predictor of clinical benefit in non-small-cell lung cancer patients treated with atezolizumab https://www.nature.com/articles/s41591-018-0134-3 MAF(Mutation Annotation Format ) MAF\u683c\u5f0f\uff1ahttps://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format/ vcf2maf: https://github.com/mskcc/vcf2maf annovarToMaf \u9700\u8981\u7684\u5fc5\u8981\u5217\u6709\uff1a Hugo_Symbol Chromosome Start_Position End_Position Reference_Allele Tumor_Seq_Allele2 Variant_Classification Variant_Type and Tumor_Sample_Barcode\uff0c \u53e6\u5916\u8fd8\u53ef\u4ee5\u989d\u5916\u518d\u52a0\u4e0aVAF (Variant Allele Frequecy)\u5217\u548camino acid change information","title":"Blood-based tumor mutational burden as a predictor of clinical benefit in non-small-cell lung cancer patients treated with atezolizumab"},{"location":"slides/20191128/#blood-based-tumor-mutational-burden-as-a-predictor-of-clinical-benefit-in-non-small-cell-lung-cancer-patients-treated-with-atezolizumab","text":"https://www.nature.com/articles/s41591-018-0134-3","title":"Blood-based tumor mutational burden as a predictor of clinical benefit in non-small-cell lung cancer patients treated with atezolizumab"},{"location":"slides/20191128/#mafmutation-annotation-format","text":"MAF\u683c\u5f0f\uff1ahttps://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format/ vcf2maf: https://github.com/mskcc/vcf2maf annovarToMaf \u9700\u8981\u7684\u5fc5\u8981\u5217\u6709\uff1a Hugo_Symbol Chromosome Start_Position End_Position Reference_Allele Tumor_Seq_Allele2 Variant_Classification Variant_Type and Tumor_Sample_Barcode\uff0c \u53e6\u5916\u8fd8\u53ef\u4ee5\u989d\u5916\u518d\u52a0\u4e0aVAF (Variant Allele Frequecy)\u5217\u548camino acid change information","title":"MAF(Mutation Annotation Format )"},{"location":"slides/20200130/","text":"Enhancing sensitivity and controlling false discovery rate in somatic indel discovery impurity (the ratio of healthy genome copies in the tumor sample) \u5f71\u54cdindel\u7684\u56e0\u7d20\uff1a gap alignment ambiguities twilight zone indels cancer heterogeneity sample purity sampling strand bias Low-frequency variants (i.e. having a VAF close to zero) yield particularly weak, statistically uncertain signals. Turning our attention to real data, we conclude that Varlociraptor achieves superior concordance for variants of VAF at least 20%. For variants of VAF of less than 20%, Varlociraptor is the only tool that discovers considerable amounts of variants. We matched them against the known truth using the vcf-match subcommand of RBT15 with parameters --max-dist 50 --max-len-diff 50 . This means that we consider a predicted somatic variant to be a true positive if it\u2019s position and length are within 50 bases of the true variant (which reflects approved evaluation practice, see [Wittler et al., 2015] for further reasoning). Melanoma cell line COLO829) ClinCNV: novel method for allele-specific somatic copy-number alterations detection i. Input data and normalization i.1 Generation of input data for ClinCNV Selection of SNVs for BAF analysis and CNA detection. + We use only positions that are likely heterozygous in the normal tissue (BAF between 0.4 and 0.6). + Additionally, to determine whether the particular SNV is het- erozygous or not we take into account \u201cinher- ent biases due to differential mapping affinity between the reference and the variant allele\u201d ([Shen et al., 2016]). i.2 Exclusion of copy-number imbalanced chromosome arms from further normalization process. We use B-allele frequency as an indicator if the genomic region can be used for normalization or not. Namely, we select chromosome arms which are likely to be copy-number neutral and use only them for normalization. i.3 Normalization of coverage profiles ii. Purpose of the in-direct estimation of variances iii. Detailed description of the seg- mentation and calling algorithm a genomic segment that shows the highest evidence that a model different from the baseline fits the observed coverage depth signature better. ClinCNV is a multi-sample caller so all the samples sequenced with the same panel should be analyzed jointly","title":"Enhancing sensitivity and controlling false discovery rate in somatic indel discovery"},{"location":"slides/20200130/#enhancing-sensitivity-and-controlling-false-discovery-rate-in-somatic-indel-discovery","text":"impurity (the ratio of healthy genome copies in the tumor sample) \u5f71\u54cdindel\u7684\u56e0\u7d20\uff1a gap alignment ambiguities twilight zone indels cancer heterogeneity sample purity sampling strand bias Low-frequency variants (i.e. having a VAF close to zero) yield particularly weak, statistically uncertain signals. Turning our attention to real data, we conclude that Varlociraptor achieves superior concordance for variants of VAF at least 20%. For variants of VAF of less than 20%, Varlociraptor is the only tool that discovers considerable amounts of variants. We matched them against the known truth using the vcf-match subcommand of RBT15 with parameters --max-dist 50 --max-len-diff 50 . This means that we consider a predicted somatic variant to be a true positive if it\u2019s position and length are within 50 bases of the true variant (which reflects approved evaluation practice, see [Wittler et al., 2015] for further reasoning). Melanoma cell line COLO829)","title":"Enhancing sensitivity and controlling false discovery rate in somatic indel discovery"},{"location":"slides/20200130/#clincnv-novel-method-for-allele-specific-somatic-copy-number-alterations-detection","text":"","title":"ClinCNV: novel method for allele-specific somatic copy-number alterations detection"},{"location":"slides/20200130/#i-input-data-and-normalization","text":"","title":"i. Input data and normalization"},{"location":"slides/20200130/#i1-generation-of-input-data-for-clincnv","text":"Selection of SNVs for BAF analysis and CNA detection. + We use only positions that are likely heterozygous in the normal tissue (BAF between 0.4 and 0.6). + Additionally, to determine whether the particular SNV is het- erozygous or not we take into account \u201cinher- ent biases due to differential mapping affinity between the reference and the variant allele\u201d ([Shen et al., 2016]).","title":"i.1 Generation of input data for ClinCNV"},{"location":"slides/20200130/#i2-exclusion-of-copy-number-imbalanced-chromosome-arms-from-further-normalization-process","text":"We use B-allele frequency as an indicator if the genomic region can be used for normalization or not. Namely, we select chromosome arms which are likely to be copy-number neutral and use only them for normalization.","title":"i.2 Exclusion of copy-number imbalanced chromosome arms from further normalization process."},{"location":"slides/20200130/#i3-normalization-of-coverage-profiles","text":"ii. Purpose of the in-direct estimation of variances iii. Detailed description of the seg- mentation and calling algorithm a genomic segment that shows the highest evidence that a model different from the baseline fits the observed coverage depth signature better. ClinCNV is a multi-sample caller so all the samples sequenced with the same panel should be analyzed jointly","title":"i.3 Normalization of coverage profiles"},{"location":"slides/cfnda-protocl/","text":"Construct an unmmaped BAM tagged with UMIs java \\ Align reads When you have an unmapped BAM file with RX tags, use a combination of an aligner and Picard\u2019s MergeBamAlignment tool to generate a mapped BAM that includes all necessary metadata. An example invocation follows: Map BAM to consensus reads Identify which reads come from the same source molecule by using fgbio\u2019s GroupReadsByUmi tool, which assigns a unique source molecule ID to each applicable read, stores the ID in the MI tag, and outputs a BAM fi that is sorted by the MI tag and ready for consensus calling. The source molecule is identifi using a combination of UMI sequence and mapping positions from reads 1 and 2. An example invocation follows: GroupReadsByUmi implements several strategies for matching UMIs to account for sequencing error. The adjacency method implements the directed adjacency graph method introduced by UMI-tools [1]. Parameters are available to control how many errors are allowed when matching UMIs at the same position and for filtering (i.e., ignoring) reads with low mapping quality. Low mapping quality reads should be ignored to prevent multiple consensus reads from being generated from multiple mismapped copies of the same source molecule. Combine each set of reads to generate consensus reads using fgbio\u2019s CallMolecularConsensusReads. This step generates unmapped consensus reads from the output of GroupReadsByUmi. There are many parameters that affect the consensus calling; for an up-to-date listing and supporting documentation, run CallMolecularConsensusReads with the -h option. An example invocation follows with recommended parameters: This script produces consensus reads for all molecules that have at least one observation. Filter consensus reads generated by CallMolecularConsensusReads using fgbio\u2019s FilterConsensusReads. There are two kinds of fi 1) masking or filter individual bases in reads, and 2) filtering reads (i.e., not writing them to the output file). Base-level masking/filtering is only applied if per-base tags are present (see the documentation for CallMolecularConsensusReads for tag descriptions). Read-level filtering is always applied. When filtering reads, secondary alignments and supplementary records may be removed independently if they fail one or more filters. If either R1 or R2 primary alignments fail a filter, then all records for the template will be filtered out. There are many parameters that affect the filtering of the consensus reads. For an up-to-date listing and supporting documentation, run FilterConsensusRead with the -h option. FilterConsensusRead can be applied to either mapped or unmapped BAM files. An example invocation with recommended parameters follows: This script produces a filtered, consensus BAM file containing sequences from molecules that were observed at least three times: min-reads=3.","title":"Cfnda protocl"},{"location":"slides/cfnda-protocl/#construct-an-unmmaped-bam-tagged-with-umis","text":"java \\","title":"Construct an unmmaped BAM tagged with UMIs"},{"location":"slides/cfnda-protocl/#align-reads","text":"When you have an unmapped BAM file with RX tags, use a combination of an aligner and Picard\u2019s MergeBamAlignment tool to generate a mapped BAM that includes all necessary metadata. An example invocation follows:","title":"Align reads"},{"location":"slides/cfnda-protocl/#map-bam-to-consensus-reads","text":"Identify which reads come from the same source molecule by using fgbio\u2019s GroupReadsByUmi tool, which assigns a unique source molecule ID to each applicable read, stores the ID in the MI tag, and outputs a BAM fi that is sorted by the MI tag and ready for consensus calling. The source molecule is identifi using a combination of UMI sequence and mapping positions from reads 1 and 2. An example invocation follows: GroupReadsByUmi implements several strategies for matching UMIs to account for sequencing error. The adjacency method implements the directed adjacency graph method introduced by UMI-tools [1]. Parameters are available to control how many errors are allowed when matching UMIs at the same position and for filtering (i.e., ignoring) reads with low mapping quality. Low mapping quality reads should be ignored to prevent multiple consensus reads from being generated from multiple mismapped copies of the same source molecule. Combine each set of reads to generate consensus reads using fgbio\u2019s CallMolecularConsensusReads. This step generates unmapped consensus reads from the output of GroupReadsByUmi. There are many parameters that affect the consensus calling; for an up-to-date listing and supporting documentation, run CallMolecularConsensusReads with the -h option. An example invocation follows with recommended parameters: This script produces consensus reads for all molecules that have at least one observation. Filter consensus reads generated by CallMolecularConsensusReads using fgbio\u2019s FilterConsensusReads. There are two kinds of fi 1) masking or filter individual bases in reads, and 2) filtering reads (i.e., not writing them to the output file). Base-level masking/filtering is only applied if per-base tags are present (see the documentation for CallMolecularConsensusReads for tag descriptions). Read-level filtering is always applied. When filtering reads, secondary alignments and supplementary records may be removed independently if they fail one or more filters. If either R1 or R2 primary alignments fail a filter, then all records for the template will be filtered out. There are many parameters that affect the filtering of the consensus reads. For an up-to-date listing and supporting documentation, run FilterConsensusRead with the -h option. FilterConsensusRead can be applied to either mapped or unmapped BAM files. An example invocation with recommended parameters follows: This script produces a filtered, consensus BAM file containing sequences from molecules that were observed at least three times: min-reads=3.","title":"Map BAM to consensus reads"},{"location":"slides/cosmic/","text":"COSU\u5f00\u5934\u7684\u662fstudy COSS\u5f00\u5934\u7684\u662fsample COSP\u5f00\u5934\u7684\u662fpaper COSM\u5f00\u5934\u7684\u662fCoding Mutations COSN\u5f00\u5934\u7684\u662fNon-Coding Mutations COST\u5f00\u5934\u7684\u662fStructure variation COSF\u5f00\u5934\u662ffusion gene CNV\u6ca1\u6709\u7ed9ID\uff0c\u4f46\u662f\u53ef\u4ee5url\u8bbf\u95ee\u6bcf\u4e00\u4e2a\u8be6\u60c5 methylation\u4e5f\u4e0d\u7ed9ID\uff0c\u66f4\u6ca1\u529e\u6cd5\u8bbf\u95ee\u3002 cosmic\u6d4f\u89c8\u5668\uff1a https://cancer.sanger.ac.uk/genome","title":"Cosmic"},{"location":"slides/marp/","text":"https://marpit.marp.app/directives https://yhatt.github.io/marp/ \u4f8b\u5b50\uff1a https://www.jianshu.com/p/5afc0d1d77f6 Reveal.js","title":"Marp"},{"location":"slides/umi/","text":"https://sfvideo.blob.core.windows.net/sitefinity/docs/default-source/user-guide-manual/analysis-guideline-variant-calling-data-with-umis.pdf?sfvrsn=d0aa3207_26 Construct an unmmaped BAM tagged with UMIs The optimal way to generate a mapped BAM with UMIs depends on the raw data format (e.g., FASTQ, BCL) and existing processing pipelines. Ultimately, you want a BAM file where the UMI sequence is stored in the RX tag for each read. Read 1 and read 2 of the same pair should have the same value stored in the RX tag, regardless which read contains the UMI sequence. Multiple tools exist to help with this process: Picard\u2019s IlluminaBasecallsToSam processes Illumina instrument run folders containing BCL fi and produces demultiplexed, per-sample, unmapped BAM fi The tool extracts UMI sequences from anywhere in the template or index reads into the RX tag. fgbio\u2019s AnnotateBamWithUmis adds the UMIs from a FASTQ fi to the RX tag of reads in a pre-existing BAM fi by matching read names between the fi fgbio\u2019s ExtractUmisFromBam processes unmapped BAM fi where the UMIs are contained within read 1 or read 2 sequences, and extracts the UMI sequences into the RX tag. sd","title":"Umi"},{"location":"slides/umi/#construct-an-unmmaped-bam-tagged-with-umis","text":"The optimal way to generate a mapped BAM with UMIs depends on the raw data format (e.g., FASTQ, BCL) and existing processing pipelines. Ultimately, you want a BAM file where the UMI sequence is stored in the RX tag for each read. Read 1 and read 2 of the same pair should have the same value stored in the RX tag, regardless which read contains the UMI sequence.","title":"Construct an unmmaped BAM tagged with UMIs"},{"location":"slides/umi/#multiple-tools-exist-to-help-with-this-process","text":"Picard\u2019s IlluminaBasecallsToSam processes Illumina instrument run folders containing BCL fi and produces demultiplexed, per-sample, unmapped BAM fi The tool extracts UMI sequences from anywhere in the template or index reads into the RX tag. fgbio\u2019s AnnotateBamWithUmis adds the UMIs from a FASTQ fi to the RX tag of reads in a pre-existing BAM fi by matching read names between the fi fgbio\u2019s ExtractUmisFromBam processes unmapped BAM fi where the UMIs are contained within read 1 or read 2 sequences, and extracts the UMI sequences into the RX tag. sd","title":"Multiple tools exist to help with this process:"},{"location":"slides/%E7%97%85%E6%AF%92%E5%AE%8F%E5%9F%BA%E5%9B%A0%E7%BB%84/","text":"Bottlenecks of virome NGS \u2022 No 16S equivalent \u2022 >99% reads bacteria or host \u2022 Majority of viral sequences from phage \u2022 Most RNA viruses in stool are plant viruses \u2022 Needle in a haystack! http://www.virologyresearch.unsw.edu.au/virology/wp-content/uploads/2018/06/VIM18-Next-Generatioin-Sequencing-Dr-Ki-Wook-Kim.pdf","title":"\u75c5\u6bd2\u5b8f\u57fa\u56e0\u7ec4"}]}